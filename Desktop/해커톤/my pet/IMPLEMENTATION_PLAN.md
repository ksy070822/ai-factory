# 🐾 PetMedical.AI 구현 계획서

## 📋 프로젝트 개요

24시간 반려동물 진료 접근성 문제 해결을 위한 AI 기반 멀티 에이전트 진단 시스템

---

## 🎯 핵심 기능 요구사항

### 1. 반려동물 프로필 관리
- ✅ 여러 마리 반려동물 등록 가능
- ✅ 프로필별 정보 관리 (이름, 종류, 품종, 생년월일, 성별, 중성화, 거주지역)
- ✅ 프로필별 진료 기록 연동

### 2. AI 진료실
- 증상 입력 방식
  - 📷 사진 업로드 (증상 부위 촬영)
  - 🎤 음성 파일 업로드 (증상 설명)
  - 📄 진단서/처방전 업로드 (이전 병원 기록)
  - 📝 텍스트 입력
  - 📋 이전 진료 기록 불러오기

- 멀티 에이전트 시스템 (4명)
  1. **CS Agent (상담 간호사)** 💬
     - 증상 접수 및 초기 상담
     - 환자 정보 확인
     - 응급도 1차 판단
   
  2. **Information Agent (정보수집가)** 🔍
     - 증상 관련 추가 정보 수집
     - 유사 케이스 검색
     - 이전 진료 기록 분석
     - 사진/음성 파일 분석
   
  3. **Veterinarian Agent (전문 수의사)** 👨‍⚕️
     - 종합 진단 수행
     - 위험도 평가
     - 응급 여부 최종 판단
     - 치료 방안 제시
   
  4. **Data Agent (데이터 처리자)** 💾
     - 진료 기록 생성
     - 진단서 템플릿 작성
     - 데이터 저장 및 관리

- 진료 과정 시각화
  - 실시간 에이전트별 진행 상황 표시
  - 단계별 진행 바
  - 에이전트별 메시지 스트림
  - 애니메이션 효과

### 3. 진단서 생성
- 진단 결과
  - 주요 진단명
  - 진단 확률/신뢰도
  - 유사 케이스 참고 정보
  
- 응급도 평가
  - 🟢 경미 (집에서 관리 가능)
  - 🟡 보통 (24시간 내 병원 방문 권장)
  - 🔴 응급 (즉시 병원 방문 필요)
  
- 즉시 조치 사항
  - 구체적인 조치 방법
  - 주의사항
  - 금지 사항
  
- 병원 방문 권장 여부
  - 방문 필요 시기
  - 권장 검사 항목

### 4. 액션 기능

#### 직접 치료하기
- 상세 치료 리포트 제공
- 단계별 조치 가이드
- 예상 회복 기간
- 재진료 시점 안내
- 주의사항 및 금지사항

#### 병원 예약하기
- 주변 병원 추천
  - 카카오맵 API 연동
  - 현재 위치 기반 검색
  - 24시간 운영 병원 우선
  - 평점 높은 순 정렬
  - 3~5개 병원 추천
  
- 병원 선택 및 예약
  - AI 진단서 자동 전송
  - 예약 일시 선택
  - 예약 확인 및 알림

### 5. 마이페이지
- 진료 기록 목록
- 진단서 상세 보기
- 반려동물 프로필 관리
- 병원 예약 내역

### 6. 병원용 기능 (선택)
- 예약 요청 확인
- AI 진단서 검토
- 예약 수락/거절
- 스케줄 관리
- 환자 정보 확인

---

## 🛠 기술 스택

### Frontend
- **React** (현재 사용 중)
- **React Router** - 페이지 라우팅
- **Axios** - API 통신
- **React Query** - 서버 상태 관리
- **Zustand/Redux** - 클라이언트 상태 관리
- **React Hook Form** - 폼 관리
- **React Audio Recorder** - 음성 녹음
- **React Image Upload** - 이미지 업로드
- **Kakao Maps API** - 지도 및 장소 검색

### Backend (필요 시)
- **Node.js + Express** 또는 **Python + FastAPI**
- **MongoDB/PostgreSQL** - 데이터베이스
- **Firebase Storage** 또는 **AWS S3** - 파일 저장
- **JWT** - 인증

### AI/ML
- **OpenAI GPT-4** 또는 **Claude** - 멀티 에이전트
- **Whisper API** - 음성 → 텍스트 변환
- **GPT-4 Vision** - 이미지 분석
- **LangChain** - 에이전트 오케스트레이션

### 외부 API
- **Kakao Maps API** - 병원 검색 및 지도
- **Kakao Local API** - 장소 검색

---

## 📁 프로젝트 구조

```
my-pet/
├── public/
│   └── index.html
├── src/
│   ├── components/
│   │   ├── Profile/
│   │   │   ├── ProfileRegistration.jsx
│   │   │   ├── ProfileList.jsx
│   │   │   └── ProfileDetail.jsx
│   │   ├── Diagnosis/
│   │   │   ├── SymptomInput.jsx
│   │   │   ├── MultiAgentDiagnosis.jsx
│   │   │   ├── AgentMessage.jsx
│   │   │   ├── DiagnosisResult.jsx
│   │   │   └── DiagnosisReport.jsx
│   │   ├── Hospital/
│   │   │   ├── HospitalRecommendation.jsx
│   │   │   ├── HospitalList.jsx
│   │   │   ├── HospitalDetail.jsx
│   │   │   └── AppointmentBooking.jsx
│   │   ├── Treatment/
│   │   │   └── HomeTreatmentGuide.jsx
│   │   ├── MyPage/
│   │   │   ├── MyPage.jsx
│   │   │   ├── DiagnosisHistory.jsx
│   │   │   └── AppointmentHistory.jsx
│   │   └── Common/
│   │       ├── Header.jsx
│   │       ├── Navigation.jsx
│   │       └── LoadingSpinner.jsx
│   ├── services/
│   │   ├── api/
│   │   │   ├── diagnosisApi.js
│   │   │   ├── profileApi.js
│   │   │   ├── hospitalApi.js
│   │   │   └── appointmentApi.js
│   │   ├── ai/
│   │   │   ├── agentOrchestrator.js
│   │   │   ├── csAgent.js
│   │   │   ├── informationAgent.js
│   │   │   ├── veterinarianAgent.js
│   │   │   └── dataAgent.js
│   │   ├── storage/
│   │   │   ├── fileUpload.js
│   │   │   └── audioRecorder.js
│   │   └── kakao/
│   │       └── kakaoMaps.js
│   ├── hooks/
│   │   ├── useDiagnosis.js
│   │   ├── useHospitalSearch.js
│   │   └── useAudioRecorder.js
│   ├── store/
│   │   ├── profileStore.js
│   │   ├── diagnosisStore.js
│   │   └── appointmentStore.js
│   ├── utils/
│   │   ├── dateFormatter.js
│   │   ├── fileValidator.js
│   │   └── constants.js
│   ├── App.jsx
│   ├── App.css
│   └── index.js
├── package.json
└── README.md
```

---

## 🚀 작업 순서 (Phase별 구현)

### Phase 1: 기반 구조 및 프로필 관리 (1-2일)
**목표**: 기본 인프라 구축 및 프로필 관리 완성

1. **프로젝트 설정**
   - [ ] React Router 설정
   - [ ] 상태 관리 라이브러리 설정 (Zustand)
   - [ ] API 클라이언트 설정 (Axios)
   - [ ] 환경 변수 설정 (.env)

2. **프로필 관리 강화**
   - [ ] 여러 반려동물 등록 기능
   - [ ] 프로필 목록 화면
   - [ ] 프로필 선택 기능
   - [ ] 프로필 수정/삭제 기능
   - [ ] 로컬 스토리지 또는 백엔드 연동

3. **네비게이션 구조**
   - [ ] Header 컴포넌트
   - [ ] Bottom Navigation (모바일)
   - [ ] 라우팅 설정

**결과물**: 프로필 등록/관리 완료, 기본 네비게이션 작동

---

### Phase 2: 증상 입력 시스템 (2-3일)
**목표**: 다양한 방식으로 증상 입력 받기

1. **증상 입력 화면**
   - [ ] 증상 입력 메인 화면
   - [ ] 반려동물 선택 드롭다운
   - [ ] 입력 방식 선택 탭 (사진/음성/텍스트/파일)

2. **이미지 업로드**
   - [ ] 이미지 선택/촬영
   - [ ] 이미지 미리보기
   - [ ] 이미지 압축/최적화
   - [ ] 다중 이미지 업로드

3. **음성 입력**
   - [ ] 음성 녹음 기능
   - [ ] 음성 파일 업로드
   - [ ] 음성 → 텍스트 변환 (Whisper API 연동)
   - [ ] 녹음 재생 기능

4. **텍스트 입력**
   - [ ] 증상 설명 텍스트 입력
   - [ ] 증상 카테고리 선택 (선택사항)
   - [ ] 증상 시작 시기 입력

5. **파일 업로드**
   - [ ] 진단서/처방전 PDF 업로드
   - [ ] 파일 파싱 (OCR 또는 텍스트 추출)

6. **이전 기록 불러오기**
   - [ ] 진료 기록 목록 표시
   - [ ] 기록 선택 및 불러오기
   - [ ] 기록 내용 미리보기

**결과물**: 모든 방식으로 증상 입력 가능

---

### Phase 3: 멀티 에이전트 시스템 (3-4일)
**목표**: 4명의 AI 에이전트가 협업하여 진단 수행

1. **AI 에이전트 오케스트레이터**
   - [ ] 에이전트 실행 순서 정의
   - [ ] 에이전트 간 데이터 전달 로직
   - [ ] 에러 처리 및 재시도 로직

2. **CS Agent (상담 간호사)**
   - [ ] 증상 접수 및 환자 정보 확인
   - [ ] 응급도 1차 판단
   - [ ] 프롬프트 설계

3. **Information Agent (정보수집가)**
   - [ ] 증상 관련 정보 수집
   - [ ] 이미지 분석 (GPT-4 Vision)
   - [ ] 음성 분석 결과 통합
   - [ ] 이전 기록 분석
   - [ ] 유사 케이스 검색

4. **Veterinarian Agent (전문 수의사)**
   - [ ] 종합 진단 수행
   - [ ] 위험도 평가
   - [ ] 응급 여부 최종 판단
   - [ ] 치료 방안 제시
   - [ ] 병원 방문 필요 여부 판단

5. **Data Agent (데이터 처리자)**
   - [ ] 진료 기록 구조화
   - [ ] 진단서 템플릿 생성
   - [ ] 데이터 저장

6. **진료 과정 시각화**
   - [ ] 실시간 에이전트 메시지 스트림
   - [ ] 진행 단계 표시
   - [ ] 애니메이션 효과
   - [ ] 로딩 상태 표시

**결과물**: 멀티 에이전트 진단 시스템 완성

---

### Phase 4: 진단서 생성 및 저장 (1-2일)
**목표**: 완성된 진단서 생성 및 저장

1. **진단서 컴포넌트**
   - [ ] 진단서 레이아웃 디자인
   - [ ] 진단 결과 표시
   - [ ] 응급도 표시 (색상 코딩)
   - [ ] 즉시 조치 사항 표시
   - [ ] 병원 방문 권장 여부 표시

2. **진단서 저장**
   - [ ] 로컬 스토리지 저장
   - [ ] 백엔드 API 연동 (선택)
   - [ ] PDF 다운로드 기능 (선택)

3. **진단서 공유**
   - [ ] 진단서 공유 기능
   - [ ] 병원 전송용 포맷

**결과물**: 완성된 진단서 생성 및 저장

---

### Phase 5: 직접 치료하기 기능 (1일)
**목표**: 집에서 할 수 있는 치료 가이드 제공

1. **직접 치료 가이드 화면**
   - [ ] 상세 치료 리포트 표시
   - [ ] 단계별 조치 가이드
   - [ ] 예상 회복 기간
   - [ ] 재진료 시점 안내
   - [ ] 주의사항 및 금지사항

2. **AI 상세 리포트 생성**
   - [ ] 치료 방법 상세 설명
   - [ ] 약물 정보 (처방 필요 시)
   - [ ] 일일 체크리스트

**결과물**: 직접 치료 가이드 완성

---

### Phase 6: 병원 추천 및 예약 (2-3일)
**목표**: 카카오맵 연동 병원 추천 및 예약

1. **카카오맵 API 연동**
   - [ ] 카카오 개발자 계정 설정
   - [ ] API 키 설정
   - [ ] 지도 컴포넌트 구현
   - [ ] 장소 검색 API 연동

2. **병원 검색**
   - [ ] 현재 위치 기반 검색
   - [ ] "동물병원" 키워드 검색
   - [ ] 24시간 운영 병원 필터링
   - [ ] 평점 순 정렬
   - [ ] 거리 계산

3. **병원 목록 표시**
   - [ ] 병원 카드 컴포넌트
   - [ ] 병원 정보 표시 (이름, 주소, 전화번호, 평점, 거리)
   - [ ] 지도에 마커 표시
   - [ ] 병원 상세 정보 모달

4. **예약 기능**
   - [ ] 예약 일시 선택
   - [ ] AI 진단서 첨부
   - [ ] 예약 정보 입력
   - [ ] 예약 확인
   - [ ] 예약 알림

5. **예약 관리**
   - [ ] 예약 내역 확인
   - [ ] 예약 취소
   - [ ] 예약 수정

**결과물**: 병원 추천 및 예약 시스템 완성

---

### Phase 7: 마이페이지 (1일)
**목표**: 사용자 정보 및 기록 관리

1. **마이페이지 메인**
   - [ ] 사용자 정보 표시
   - [ ] 반려동물 목록
   - [ ] 최근 진료 기록

2. **진료 기록 목록**
   - [ ] 진료 기록 카드 리스트
   - [ ] 날짜별 정렬
   - [ ] 검색 기능
   - [ ] 진단서 상세 보기

3. **예약 내역**
   - [ ] 예약 목록
   - [ ] 예약 상태 표시
   - [ ] 예약 상세 정보

**결과물**: 마이페이지 완성

---

### Phase 8: 병원용 기능 (선택, 2-3일)
**목표**: 병원에서 예약 관리 가능

1. **병원 로그인**
   - [ ] 병원 계정 생성/로그인
   - [ ] 병원 정보 등록

2. **예약 관리 대시보드**
   - [ ] 예약 요청 목록
   - [ ] AI 진단서 확인
   - [ ] 예약 수락/거절
   - [ ] 스케줄 캘린더

3. **환자 정보 관리**
   - [ ] 환자 정보 확인
   - [ ] 진료 기록 추가

**결과물**: 병원용 기능 완성

---

### Phase 9: UI/UX 개선 및 최적화 (1-2일)
**목표**: 사용자 경험 개선

1. **반응형 디자인**
   - [ ] 모바일 최적화
   - [ ] 태블릿 레이아웃
   - [ ] 데스크톱 레이아웃

2. **애니메이션 및 인터랙션**
   - [ ] 페이지 전환 애니메이션
   - [ ] 로딩 애니메이션
   - [ ] 버튼 인터랙션

3. **에러 처리**
   - [ ] 에러 메시지 표시
   - [ ] 재시도 기능
   - [ ] 오프라인 처리

4. **성능 최적화**
   - [ ] 이미지 최적화
   - [ ] 코드 스플리팅
   - [ ] 캐싱 전략

**결과물**: 완성된 앱

---

## 🔑 핵심 구현 포인트

### 1. 멀티 에이전트 오케스트레이션
```javascript
// 에이전트 실행 순서
1. CS Agent → 증상 접수, 응급도 1차 판단
2. Information Agent → 정보 수집 (이미지, 음성, 기록 분석)
3. Veterinarian Agent → 종합 진단, 치료 방안
4. Data Agent → 진단서 생성, 저장
```

### 2. AI 프롬프트 설계
- 각 에이전트별 역할 명확히 정의
- 이전 에이전트 결과를 다음 에이전트에 전달
- 구조화된 응답 형식 요청 (JSON)

### 3. 카카오맵 API 활용
- Kakao Local API: 장소 검색
- Kakao Maps API: 지도 표시
- 현재 위치 기반 검색
- 거리 계산 및 정렬

### 4. 파일 처리
- 이미지: 압축, Base64 또는 클라우드 스토리지
- 음성: Whisper API로 텍스트 변환
- PDF: OCR 또는 텍스트 추출

---

## 📊 예상 개발 기간

- **Phase 1-2**: 3-5일 (기반 구조 + 증상 입력)
- **Phase 3**: 3-4일 (멀티 에이전트)
- **Phase 4-5**: 2-3일 (진단서 + 직접 치료)
- **Phase 6**: 2-3일 (병원 추천/예약)
- **Phase 7**: 1일 (마이페이지)
- **Phase 8**: 2-3일 (병원용 기능, 선택)
- **Phase 9**: 1-2일 (최적화)

**총 예상 기간**: 14-21일 (병원용 기능 포함 시 16-24일)

---

## 🚨 주의사항

1. **AI API 비용 관리**
   - GPT-4 Vision, Whisper API 사용량 모니터링
   - 캐싱 전략 수립
   - 무료 티어 활용

2. **개인정보 보호**
   - 반려동물 정보 암호화
   - 진료 기록 보안
   - 파일 업로드 보안

3. **의료 법적 고지**
   - AI 진단은 참고용임을 명시
   - 응급 상황 시 즉시 병원 방문 안내
   - 법적 책임 면제 고지

4. **카카오맵 API 제한**
   - 일일 호출 제한 확인
   - API 키 보안 관리

---

## 📝 다음 단계

1. **즉시 시작 가능한 작업**
   - Phase 1: 프로젝트 설정 및 프로필 관리 강화
   - Phase 2: 증상 입력 시스템 구현

2. **준비 사항**
   - OpenAI API 키 발급
   - 카카오 개발자 계정 및 API 키 발급
   - 백엔드 서버 구축 (선택)

3. **우선순위 조정**
   - MVP: Phase 1-6 (병원 예약까지)
   - 추가 기능: Phase 7-8

---

이 계획서를 기반으로 단계별로 구현을 진행하시면 됩니다. 각 Phase가 완료될 때마다 테스트하고 다음 단계로 진행하는 것을 권장합니다.

