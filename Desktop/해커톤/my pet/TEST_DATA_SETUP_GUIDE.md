# 포괄적인 테스트 데이터 생성 가이드

## 📋 개요

이 가이드는 보호자 계정과 병원 계정에 대한 포괄적인 테스트 데이터를 생성합니다.

### 생성되는 데이터

#### 보호자 계정 (guardian@test.com)
- ✅ 반려동물 4마리 (개 2마리, 고양이 2마리)
- ✅ 일일 케어 로그 360개 (최근 90일 × 4마리)
- ✅ AI 진단 기록 6개
- ✅ 접종 기록 6개
- ✅ 예약 기록 20개 (행복동물병원)
- ✅ 진료 결과 (완료된 예약에 대해)

#### 병원 계정 (clinic@happyvet.com)
- ✅ 예약 기록 90개 (과거 60개 + 미래 30개)
- ✅ 진료 결과 (완료된 예약에 대해)
- ✅ 보호자 계정과 연결된 예약 및 진료 결과 포함

## 🚀 실행 방법

### 1. 사전 준비

#### Firebase Service Account Key 준비

1. Firebase Console → 프로젝트 설정 → 서비스 계정
2. "새 비공개 키 생성" 클릭
3. 다운로드한 JSON 파일을 프로젝트 루트에 `serviceAccountKey.json`으로 저장

또는 기존 파일 사용:
```bash
# hospital-import 폴더에 있는 파일 사용 (자동 감지됨)
```

### 2. 의존성 설치

```bash
cd "my pet"
npm install firebase-admin readline
```

### 3. 스크립트 실행

```bash
node scripts/createComprehensiveTestData.js
```

### 4. 확인 메시지

스크립트가 기존 데이터 존재 여부를 확인합니다:
```
⚠️  기존 데이터가 있을 수 있습니다. 계속하시겠습니까? (y/n):
```

`y`를 입력하면 데이터 생성이 시작됩니다.

## 📊 생성되는 데이터 상세

### 반려동물 (4마리)

1. **초코** (개, 말티즈, 3살, 수컷, 중성화 완료)
2. **루이** (개, 골든리트리버, 2살, 수컷, 미중성화)
3. **나비** (고양이, 페르시안, 2.5살, 암컷, 중성화 완료)
4. **치즈** (고양이, 코리안숏헤어, 1.5살, 수컷, 중성화 완료)

### 일일 케어 로그

- **기간**: 최근 90일
- **총 개수**: 360개 (90일 × 4마리)
- **내용**: 
  - 개: 식사, 산책, 놀이
  - 고양이: 식사, 놀이, 그루밍

### AI 진단 기록

- 초코: 피부염, 소화불량
- 루이: 관절염 의심
- 나비: 호흡기 감염 의심, 치아 문제
- 치즈: 비뇨기 문제 의심

### 접종 기록

- 각 동물당 1-2개씩 (종합백신, 광견병 등)

### 예약 기록

#### 보호자 계정
- 총 20개 예약
- 행복동물병원에 예약
- 최근 3개월간 분산
- 상태: completed (15개), cancelled (5개)

#### 병원 계정
- 총 90개 예약
- 과거 60개 (최근 3개월)
- 미래 30개 (향후 1개월)
- 보호자 계정 예약 포함 (15개)

### 진료 결과

- 완료된 예약에 대해 자동 생성
- 보호자 계정의 진료 결과는 보호자 앱에서 확인 가능
- 병원 계정의 진료 결과는 병원 대시보드에서 관리

## 🔗 데이터 연결 관계

### 예약 → 진료 결과
```
bookings (bookingId) → clinicResults (bookingId)
```

### 보호자 → 반려동물
```
users (userId) → pets (userId)
```

### 반려동물 → 진단/케어 로그
```
pets (petId) → diagnoses (petId)
pets (petId) → dailyLogs (petId)
```

### 병원 → 예약
```
clinics (clinicId) → bookings (clinicId)
```

## ✅ 테스트 시나리오

### 시나리오 1: 보호자 앱에서 예약 생성
1. 보호자 계정 로그인
2. 반려동물 선택
3. AI 진단 완료
4. 병원 예약 생성
5. **확인**: 병원 대시보드에 예약 표시

### 시나리오 2: 병원에서 진료 완료
1. 병원 계정 로그인
2. 오늘 예약 확인
3. 진료 완료 처리
4. 진료 결과 입력 및 저장
5. **확인**: 보호자 앱에 진료 결과 표시

### 시나리오 3: 양방향 데이터 교류
1. 보호자: 예약 생성 → 병원에 표시
2. 병원: 진료 완료 → 보호자에 진료 결과 표시
3. 보호자: 진료 결과 확인
4. **확인**: 모든 데이터가 양쪽에서 정확히 표시

## 🐛 문제 해결

### 오류: "Firebase Service Account를 찾을 수 없습니다"

**해결 방법:**
1. Firebase Console에서 Service Account Key 다운로드
2. 프로젝트 루트에 `serviceAccountKey.json`으로 저장
3. 또는 `hospital-import` 폴더의 기존 파일 사용

### 오류: "보호자 계정을 찾을 수 없습니다"

**해결 방법:**
1. Firebase Console에서 `guardian@test.com` 계정이 생성되어 있는지 확인
2. Firestore `users` 컬렉션에 이메일이 올바르게 저장되어 있는지 확인

### 오류: "병원 계정을 찾을 수 없습니다"

**해결 방법:**
1. Firebase Console에서 `clinic@happyvet.com` 계정이 생성되어 있는지 확인
2. Firestore `users` 컬렉션에 이메일이 올바르게 저장되어 있는지 확인

### 데이터가 중복 생성됨

**해결 방법:**
1. 기존 데이터 삭제 후 다시 실행
2. 또는 스크립트를 수정하여 중복 체크 로직 추가

## 📝 다음 단계

데이터 생성 완료 후:

1. **보호자 계정으로 로그인**
   - 반려동물 4마리 확인
   - 케어 로그 확인
   - 진단 기록 확인
   - 예약 기록 확인
   - 진료 결과 확인

2. **병원 계정으로 로그인**
   - 오늘 예약 확인
   - 월별 예약 확인
   - 진료 완료 처리 테스트
   - 보호자에게 진료 결과 전송 확인

3. **양방향 데이터 교류 테스트**
   - 보호자: 예약 생성 → 병원 확인
   - 병원: 진료 완료 → 보호자 확인
   - 최소 10회 이상 반복 테스트

## 🎯 테스트 체크리스트

- [ ] 보호자 계정 로그인 성공
- [ ] 반려동물 4마리 표시
- [ ] 일일 케어 로그 360개 확인
- [ ] AI 진단 기록 6개 확인
- [ ] 접종 기록 6개 확인
- [ ] 예약 기록 20개 확인
- [ ] 진료 결과 확인
- [ ] 병원 계정 로그인 성공
- [ ] 병원 예약 90개 확인
- [ ] 보호자 예약이 병원에 표시됨
- [ ] 진료 완료 처리 성공
- [ ] 진료 결과가 보호자에게 전송됨
- [ ] 양방향 데이터 교류 정상 작동

**이제 테스트를 시작할 수 있습니다!** 🚀

