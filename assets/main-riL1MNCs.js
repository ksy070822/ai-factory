(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();function Pj(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ly={exports:{}},lu={},Vy={exports:{}},Ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ha=Symbol.for("react.element"),Rj=Symbol.for("react.portal"),Oj=Symbol.for("react.fragment"),Mj=Symbol.for("react.strict_mode"),Lj=Symbol.for("react.profiler"),Vj=Symbol.for("react.provider"),$j=Symbol.for("react.context"),Fj=Symbol.for("react.forward_ref"),Dj=Symbol.for("react.suspense"),Uj=Symbol.for("react.memo"),Bj=Symbol.for("react.lazy"),Ng=Symbol.iterator;function zj(t){return t===null||typeof t!="object"?null:(t=Ng&&t[Ng]||t["@@iterator"],typeof t=="function"?t:null)}var $y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Fy=Object.assign,Dy={};function lo(t,e,n){this.props=t,this.context=e,this.refs=Dy,this.updater=n||$y}lo.prototype.isReactComponent={};lo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};lo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Uy(){}Uy.prototype=lo.prototype;function Om(t,e,n){this.props=t,this.context=e,this.refs=Dy,this.updater=n||$y}var Mm=Om.prototype=new Uy;Mm.constructor=Om;Fy(Mm,lo.prototype);Mm.isPureReactComponent=!0;var jg=Array.isArray,By=Object.prototype.hasOwnProperty,Lm={current:null},zy={key:!0,ref:!0,__self:!0,__source:!0};function Hy(t,e,n){var s,r={},o=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)By.call(e,s)&&!zy.hasOwnProperty(s)&&(r[s]=e[s]);var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];r.children=u}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)r[s]===void 0&&(r[s]=l[s]);return{$$typeof:Ha,type:t,key:o,ref:a,props:r,_owner:Lm.current}}function Hj(t,e){return{$$typeof:Ha,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ha}function qj(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var kg=/\/+/g;function xd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qj(""+t.key):e.toString(36)}function zl(t,e,n,s,r){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Ha:case Rj:a=!0}}if(a)return a=t,r=r(a),t=s===""?"."+xd(a,0):s,jg(r)?(n="",t!=null&&(n=t.replace(kg,"$&/")+"/"),zl(r,e,n,"",function(d){return d})):r!=null&&(Vm(r)&&(r=Hj(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(kg,"$&/")+"/")+t)),e.push(r)),1;if(a=0,s=s===""?".":s+":",jg(t))for(var l=0;l<t.length;l++){o=t[l];var u=s+xd(o,l);a+=zl(o,e,n,u,r)}else if(u=zj(t),typeof u=="function")for(t=u.call(t),l=0;!(o=t.next()).done;)o=o.value,u=s+xd(o,l++),a+=zl(o,e,n,u,r);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function xl(t,e,n){if(t==null)return t;var s=[],r=0;return zl(t,s,"","",function(o){return e.call(n,o,r++)}),s}function Wj(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Kt={current:null},Hl={transition:null},Kj={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:Hl,ReactCurrentOwner:Lm};function qy(){throw Error("act(...) is not supported in production builds of React.")}Ne.Children={map:xl,forEach:function(t,e,n){xl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return xl(t,function(){e++}),e},toArray:function(t){return xl(t,function(e){return e})||[]},only:function(t){if(!Vm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ne.Component=lo;Ne.Fragment=Oj;Ne.Profiler=Lj;Ne.PureComponent=Om;Ne.StrictMode=Mj;Ne.Suspense=Dj;Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kj;Ne.act=qy;Ne.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=Fy({},t.props),r=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=Lm.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)By.call(e,u)&&!zy.hasOwnProperty(u)&&(s[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)s.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:Ha,type:t.type,key:r,ref:o,props:s,_owner:a}};Ne.createContext=function(t){return t={$$typeof:$j,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Vj,_context:t},t.Consumer=t};Ne.createElement=Hy;Ne.createFactory=function(t){var e=Hy.bind(null,t);return e.type=t,e};Ne.createRef=function(){return{current:null}};Ne.forwardRef=function(t){return{$$typeof:Fj,render:t}};Ne.isValidElement=Vm;Ne.lazy=function(t){return{$$typeof:Bj,_payload:{_status:-1,_result:t},_init:Wj}};Ne.memo=function(t,e){return{$$typeof:Uj,type:t,compare:e===void 0?null:e}};Ne.startTransition=function(t){var e=Hl.transition;Hl.transition={};try{t()}finally{Hl.transition=e}};Ne.unstable_act=qy;Ne.useCallback=function(t,e){return Kt.current.useCallback(t,e)};Ne.useContext=function(t){return Kt.current.useContext(t)};Ne.useDebugValue=function(){};Ne.useDeferredValue=function(t){return Kt.current.useDeferredValue(t)};Ne.useEffect=function(t,e){return Kt.current.useEffect(t,e)};Ne.useId=function(){return Kt.current.useId()};Ne.useImperativeHandle=function(t,e,n){return Kt.current.useImperativeHandle(t,e,n)};Ne.useInsertionEffect=function(t,e){return Kt.current.useInsertionEffect(t,e)};Ne.useLayoutEffect=function(t,e){return Kt.current.useLayoutEffect(t,e)};Ne.useMemo=function(t,e){return Kt.current.useMemo(t,e)};Ne.useReducer=function(t,e,n){return Kt.current.useReducer(t,e,n)};Ne.useRef=function(t){return Kt.current.useRef(t)};Ne.useState=function(t){return Kt.current.useState(t)};Ne.useSyncExternalStore=function(t,e,n){return Kt.current.useSyncExternalStore(t,e,n)};Ne.useTransition=function(){return Kt.current.useTransition()};Ne.version="18.3.1";Vy.exports=Ne;var L=Vy.exports;const Gj=Pj(L);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qj=L,Jj=Symbol.for("react.element"),Yj=Symbol.for("react.fragment"),Xj=Object.prototype.hasOwnProperty,Zj=Qj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,e1={key:!0,ref:!0,__self:!0,__source:!0};function Wy(t,e,n){var s,r={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)Xj.call(e,s)&&!e1.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:Jj,type:t,key:o,ref:a,props:r,_owner:Zj.current}}lu.Fragment=Yj;lu.jsx=Wy;lu.jsxs=Wy;Ly.exports=lu;var i=Ly.exports,uh={},Ky={exports:{}},pn={},Gy={exports:{}},Qy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Q,V){var Y=Q.length;Q.push(V);e:for(;0<Y;){var T=Y-1>>>1,B=Q[T];if(0<r(B,V))Q[T]=V,Q[Y]=B,Y=T;else break e}}function n(Q){return Q.length===0?null:Q[0]}function s(Q){if(Q.length===0)return null;var V=Q[0],Y=Q.pop();if(Y!==V){Q[0]=Y;e:for(var T=0,B=Q.length,G=B>>>1;T<G;){var K=2*(T+1)-1,te=Q[K],le=K+1,W=Q[le];if(0>r(te,Y))le<B&&0>r(W,te)?(Q[T]=W,Q[le]=Y,T=le):(Q[T]=te,Q[K]=Y,T=K);else if(le<B&&0>r(W,Y))Q[T]=W,Q[le]=Y,T=le;else break e}}return V}function r(Q,V){var Y=Q.sortIndex-V.sortIndex;return Y!==0?Y:Q.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],d=[],h=1,m=null,p=3,x=!1,v=!1,j=!1,A=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(Q){for(var V=n(d);V!==null;){if(V.callback===null)s(d);else if(V.startTime<=Q)s(d),V.sortIndex=V.expirationTime,e(u,V);else break;V=n(d)}}function R(Q){if(j=!1,E(Q),!v)if(n(u)!==null)v=!0,ie($);else{var V=n(d);V!==null&&Ae(R,V.startTime-Q)}}function $(Q,V){v=!1,j&&(j=!1,w(b),b=-1),x=!0;var Y=p;try{for(E(V),m=n(u);m!==null&&(!(m.expirationTime>V)||Q&&!C());){var T=m.callback;if(typeof T=="function"){m.callback=null,p=m.priorityLevel;var B=T(m.expirationTime<=V);V=t.unstable_now(),typeof B=="function"?m.callback=B:m===n(u)&&s(u),E(V)}else s(u);m=n(u)}if(m!==null)var G=!0;else{var K=n(d);K!==null&&Ae(R,K.startTime-V),G=!1}return G}finally{m=null,p=Y,x=!1}}var D=!1,_=null,b=-1,S=5,I=-1;function C(){return!(t.unstable_now()-I<S)}function P(){if(_!==null){var Q=t.unstable_now();I=Q;var V=!0;try{V=_(!0,Q)}finally{V?N():(D=!1,_=null)}}else D=!1}var N;if(typeof y=="function")N=function(){y(P)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,M=O.port2;O.port1.onmessage=P,N=function(){M.postMessage(null)}}else N=function(){A(P,0)};function ie(Q){_=Q,D||(D=!0,N())}function Ae(Q,V){b=A(function(){Q(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){v||x||(v=!0,ie($))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(Q){switch(p){case 1:case 2:case 3:var V=3;break;default:V=p}var Y=p;p=V;try{return Q()}finally{p=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,V){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var Y=p;p=Q;try{return V()}finally{p=Y}},t.unstable_scheduleCallback=function(Q,V,Y){var T=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?T+Y:T):Y=T,Q){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=Y+B,Q={id:h++,callback:V,priorityLevel:Q,startTime:Y,expirationTime:B,sortIndex:-1},Y>T?(Q.sortIndex=Y,e(d,Q),n(u)===null&&Q===n(d)&&(j?(w(b),b=-1):j=!0,Ae(R,Y-T))):(Q.sortIndex=B,e(u,Q),v||x||(v=!0,ie($))),Q},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(Q){var V=p;return function(){var Y=p;p=V;try{return Q.apply(this,arguments)}finally{p=Y}}}})(Qy);Gy.exports=Qy;var t1=Gy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1=L,fn=t1;function J(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jy=new Set,ha={};function ai(t,e){Gi(t,e),Gi(t+"Capture",e)}function Gi(t,e){for(ha[t]=e,t=0;t<e.length;t++)Jy.add(e[t])}var Ss=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dh=Object.prototype.hasOwnProperty,s1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ig={},Sg={};function r1(t){return dh.call(Sg,t)?!0:dh.call(Ig,t)?!1:s1.test(t)?Sg[t]=!0:(Ig[t]=!0,!1)}function i1(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function o1(t,e,n,s){if(e===null||typeof e>"u"||i1(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Gt(t,e,n,s,r,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kt[t]=new Gt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kt[e]=new Gt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kt[t]=new Gt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kt[t]=new Gt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kt[t]=new Gt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kt[t]=new Gt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kt[t]=new Gt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kt[t]=new Gt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kt[t]=new Gt(t,5,!1,t.toLowerCase(),null,!1,!1)});var $m=/[\-:]([a-z])/g;function Fm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace($m,Fm);kt[e]=new Gt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace($m,Fm);kt[e]=new Gt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace($m,Fm);kt[e]=new Gt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kt[t]=new Gt(t,1,!1,t.toLowerCase(),null,!1,!1)});kt.xlinkHref=new Gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kt[t]=new Gt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Dm(t,e,n,s){var r=kt.hasOwnProperty(e)?kt[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(o1(e,n,r,s)&&(n=null),s||r===null?r1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var Ls=n1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yl=Symbol.for("react.element"),ki=Symbol.for("react.portal"),Ii=Symbol.for("react.fragment"),Um=Symbol.for("react.strict_mode"),hh=Symbol.for("react.profiler"),Yy=Symbol.for("react.provider"),Xy=Symbol.for("react.context"),Bm=Symbol.for("react.forward_ref"),mh=Symbol.for("react.suspense"),fh=Symbol.for("react.suspense_list"),zm=Symbol.for("react.memo"),Js=Symbol.for("react.lazy"),Zy=Symbol.for("react.offscreen"),Eg=Symbol.iterator;function Ro(t){return t===null||typeof t!="object"?null:(t=Eg&&t[Eg]||t["@@iterator"],typeof t=="function"?t:null)}var Qe=Object.assign,yd;function Uo(t){if(yd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);yd=e&&e[1]||""}return`
`+yd+t}var vd=!1;function _d(t,e){if(!t||vd)return"";vd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),o=s.stack.split(`
`),a=r.length-1,l=o.length-1;1<=a&&0<=l&&r[a]!==o[l];)l--;for(;1<=a&&0<=l;a--,l--)if(r[a]!==o[l]){if(a!==1||l!==1)do if(a--,l--,0>l||r[a]!==o[l]){var u=`
`+r[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{vd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Uo(t):""}function a1(t){switch(t.tag){case 5:return Uo(t.type);case 16:return Uo("Lazy");case 13:return Uo("Suspense");case 19:return Uo("SuspenseList");case 0:case 2:case 15:return t=_d(t.type,!1),t;case 11:return t=_d(t.type.render,!1),t;case 1:return t=_d(t.type,!0),t;default:return""}}function ph(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ii:return"Fragment";case ki:return"Portal";case hh:return"Profiler";case Um:return"StrictMode";case mh:return"Suspense";case fh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Xy:return(t.displayName||"Context")+".Consumer";case Yy:return(t._context.displayName||"Context")+".Provider";case Bm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zm:return e=t.displayName||null,e!==null?e:ph(t.type)||"Memo";case Js:e=t._payload,t=t._init;try{return ph(t(e))}catch{}}return null}function l1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ph(e);case 8:return e===Um?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ev(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function c1(t){var e=ev(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){s=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vl(t){t._valueTracker||(t._valueTracker=c1(t))}function tv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=ev(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function hc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gh(t,e){var n=e.checked;return Qe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Tg(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=xr(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function nv(t,e){e=e.checked,e!=null&&Dm(t,"checked",e,!1)}function xh(t,e){nv(t,e);var n=xr(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?yh(t,e.type,n):e.hasOwnProperty("defaultValue")&&yh(t,e.type,xr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ag(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function yh(t,e,n){(e!=="number"||hc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Bo=Array.isArray;function $i(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+xr(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function vh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(J(91));return Qe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Cg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(J(92));if(Bo(n)){if(1<n.length)throw Error(J(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:xr(n)}}function sv(t,e){var n=xr(e.value),s=xr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function Pg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _h(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _l,iv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_l=_l||document.createElement("div"),_l.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_l.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ma(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Yo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},u1=["Webkit","ms","Moz","O"];Object.keys(Yo).forEach(function(t){u1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Yo[e]=Yo[t]})});function ov(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Yo.hasOwnProperty(t)&&Yo[t]?(""+e).trim():e+"px"}function av(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=ov(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var d1=Qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wh(t,e){if(e){if(d1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(J(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(J(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(J(61))}if(e.style!=null&&typeof e.style!="object")throw Error(J(62))}}function bh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nh=null;function Hm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var jh=null,Fi=null,Di=null;function Rg(t){if(t=Ka(t)){if(typeof jh!="function")throw Error(J(280));var e=t.stateNode;e&&(e=mu(e),jh(t.stateNode,t.type,e))}}function lv(t){Fi?Di?Di.push(t):Di=[t]:Fi=t}function cv(){if(Fi){var t=Fi,e=Di;if(Di=Fi=null,Rg(t),e)for(t=0;t<e.length;t++)Rg(e[t])}}function uv(t,e){return t(e)}function dv(){}var wd=!1;function hv(t,e,n){if(wd)return t(e,n);wd=!0;try{return uv(t,e,n)}finally{wd=!1,(Fi!==null||Di!==null)&&(dv(),cv())}}function fa(t,e){var n=t.stateNode;if(n===null)return null;var s=mu(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(J(231,e,typeof n));return n}var kh=!1;if(Ss)try{var Oo={};Object.defineProperty(Oo,"passive",{get:function(){kh=!0}}),window.addEventListener("test",Oo,Oo),window.removeEventListener("test",Oo,Oo)}catch{kh=!1}function h1(t,e,n,s,r,o,a,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Xo=!1,mc=null,fc=!1,Ih=null,m1={onError:function(t){Xo=!0,mc=t}};function f1(t,e,n,s,r,o,a,l,u){Xo=!1,mc=null,h1.apply(m1,arguments)}function p1(t,e,n,s,r,o,a,l,u){if(f1.apply(this,arguments),Xo){if(Xo){var d=mc;Xo=!1,mc=null}else throw Error(J(198));fc||(fc=!0,Ih=d)}}function li(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function mv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Og(t){if(li(t)!==t)throw Error(J(188))}function g1(t){var e=t.alternate;if(!e){if(e=li(t),e===null)throw Error(J(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var o=r.alternate;if(o===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return Og(r),t;if(o===s)return Og(r),e;o=o.sibling}throw Error(J(188))}if(n.return!==s.return)n=r,s=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,s=o;break}if(l===s){a=!0,s=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,s=r;break}if(l===s){a=!0,s=o,n=r;break}l=l.sibling}if(!a)throw Error(J(189))}}if(n.alternate!==s)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?t:e}function fv(t){return t=g1(t),t!==null?pv(t):null}function pv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=pv(t);if(e!==null)return e;t=t.sibling}return null}var gv=fn.unstable_scheduleCallback,Mg=fn.unstable_cancelCallback,x1=fn.unstable_shouldYield,y1=fn.unstable_requestPaint,st=fn.unstable_now,v1=fn.unstable_getCurrentPriorityLevel,qm=fn.unstable_ImmediatePriority,xv=fn.unstable_UserBlockingPriority,pc=fn.unstable_NormalPriority,_1=fn.unstable_LowPriority,yv=fn.unstable_IdlePriority,cu=null,ss=null;function w1(t){if(ss&&typeof ss.onCommitFiberRoot=="function")try{ss.onCommitFiberRoot(cu,t,void 0,(t.current.flags&128)===128)}catch{}}var Dn=Math.clz32?Math.clz32:j1,b1=Math.log,N1=Math.LN2;function j1(t){return t>>>=0,t===0?32:31-(b1(t)/N1|0)|0}var wl=64,bl=4194304;function zo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function gc(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~r;l!==0?s=zo(l):(o&=a,o!==0&&(s=zo(o)))}else a=n&~r,a!==0?s=zo(a):o!==0&&(s=zo(o));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Dn(e),r=1<<n,s|=t[n],e&=~r;return s}function k1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function I1(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-Dn(o),l=1<<a,u=r[a];u===-1?(!(l&n)||l&s)&&(r[a]=k1(l,e)):u<=e&&(t.expiredLanes|=l),o&=~l}}function Sh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function vv(){var t=wl;return wl<<=1,!(wl&4194240)&&(wl=64),t}function bd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function qa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Dn(e),t[e]=n}function S1(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Dn(n),o=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~o}}function Wm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Dn(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var Me=0;function _v(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var wv,Km,bv,Nv,jv,Eh=!1,Nl=[],or=null,ar=null,lr=null,pa=new Map,ga=new Map,Xs=[],E1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lg(t,e){switch(t){case"focusin":case"focusout":or=null;break;case"dragenter":case"dragleave":ar=null;break;case"mouseover":case"mouseout":lr=null;break;case"pointerover":case"pointerout":pa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ga.delete(e.pointerId)}}function Mo(t,e,n,s,r,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:o,targetContainers:[r]},e!==null&&(e=Ka(e),e!==null&&Km(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function T1(t,e,n,s,r){switch(e){case"focusin":return or=Mo(or,t,e,n,s,r),!0;case"dragenter":return ar=Mo(ar,t,e,n,s,r),!0;case"mouseover":return lr=Mo(lr,t,e,n,s,r),!0;case"pointerover":var o=r.pointerId;return pa.set(o,Mo(pa.get(o)||null,t,e,n,s,r)),!0;case"gotpointercapture":return o=r.pointerId,ga.set(o,Mo(ga.get(o)||null,t,e,n,s,r)),!0}return!1}function kv(t){var e=Fr(t.target);if(e!==null){var n=li(e);if(n!==null){if(e=n.tag,e===13){if(e=mv(n),e!==null){t.blockedOn=e,jv(t.priority,function(){bv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ql(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Th(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Nh=s,n.target.dispatchEvent(s),Nh=null}else return e=Ka(n),e!==null&&Km(e),t.blockedOn=n,!1;e.shift()}return!0}function Vg(t,e,n){ql(t)&&n.delete(e)}function A1(){Eh=!1,or!==null&&ql(or)&&(or=null),ar!==null&&ql(ar)&&(ar=null),lr!==null&&ql(lr)&&(lr=null),pa.forEach(Vg),ga.forEach(Vg)}function Lo(t,e){t.blockedOn===e&&(t.blockedOn=null,Eh||(Eh=!0,fn.unstable_scheduleCallback(fn.unstable_NormalPriority,A1)))}function xa(t){function e(r){return Lo(r,t)}if(0<Nl.length){Lo(Nl[0],t);for(var n=1;n<Nl.length;n++){var s=Nl[n];s.blockedOn===t&&(s.blockedOn=null)}}for(or!==null&&Lo(or,t),ar!==null&&Lo(ar,t),lr!==null&&Lo(lr,t),pa.forEach(e),ga.forEach(e),n=0;n<Xs.length;n++)s=Xs[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Xs.length&&(n=Xs[0],n.blockedOn===null);)kv(n),n.blockedOn===null&&Xs.shift()}var Ui=Ls.ReactCurrentBatchConfig,xc=!0;function C1(t,e,n,s){var r=Me,o=Ui.transition;Ui.transition=null;try{Me=1,Gm(t,e,n,s)}finally{Me=r,Ui.transition=o}}function P1(t,e,n,s){var r=Me,o=Ui.transition;Ui.transition=null;try{Me=4,Gm(t,e,n,s)}finally{Me=r,Ui.transition=o}}function Gm(t,e,n,s){if(xc){var r=Th(t,e,n,s);if(r===null)Pd(t,e,s,yc,n),Lg(t,s);else if(T1(r,t,e,n,s))s.stopPropagation();else if(Lg(t,s),e&4&&-1<E1.indexOf(t)){for(;r!==null;){var o=Ka(r);if(o!==null&&wv(o),o=Th(t,e,n,s),o===null&&Pd(t,e,s,yc,n),o===r)break;r=o}r!==null&&s.stopPropagation()}else Pd(t,e,s,null,n)}}var yc=null;function Th(t,e,n,s){if(yc=null,t=Hm(s),t=Fr(t),t!==null)if(e=li(t),e===null)t=null;else if(n=e.tag,n===13){if(t=mv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return yc=t,null}function Iv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(v1()){case qm:return 1;case xv:return 4;case pc:case _1:return 16;case yv:return 536870912;default:return 16}default:return 16}}var sr=null,Qm=null,Wl=null;function Sv(){if(Wl)return Wl;var t,e=Qm,n=e.length,s,r="value"in sr?sr.value:sr.textContent,o=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(s=1;s<=a&&e[n-s]===r[o-s];s++);return Wl=r.slice(t,1<s?1-s:void 0)}function Kl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function jl(){return!0}function $g(){return!1}function gn(t){function e(n,s,r,o,a){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?jl:$g,this.isPropagationStopped=$g,this}return Qe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jl)},persist:function(){},isPersistent:jl}),e}var co={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jm=gn(co),Wa=Qe({},co,{view:0,detail:0}),R1=gn(Wa),Nd,jd,Vo,uu=Qe({},Wa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ym,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Vo&&(Vo&&t.type==="mousemove"?(Nd=t.screenX-Vo.screenX,jd=t.screenY-Vo.screenY):jd=Nd=0,Vo=t),Nd)},movementY:function(t){return"movementY"in t?t.movementY:jd}}),Fg=gn(uu),O1=Qe({},uu,{dataTransfer:0}),M1=gn(O1),L1=Qe({},Wa,{relatedTarget:0}),kd=gn(L1),V1=Qe({},co,{animationName:0,elapsedTime:0,pseudoElement:0}),$1=gn(V1),F1=Qe({},co,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),D1=gn(F1),U1=Qe({},co,{data:0}),Dg=gn(U1),B1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function q1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=H1[t])?!!e[t]:!1}function Ym(){return q1}var W1=Qe({},Wa,{key:function(t){if(t.key){var e=B1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Kl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?z1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ym,charCode:function(t){return t.type==="keypress"?Kl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Kl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),K1=gn(W1),G1=Qe({},uu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ug=gn(G1),Q1=Qe({},Wa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ym}),J1=gn(Q1),Y1=Qe({},co,{propertyName:0,elapsedTime:0,pseudoElement:0}),X1=gn(Y1),Z1=Qe({},uu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ek=gn(Z1),tk=[9,13,27,32],Xm=Ss&&"CompositionEvent"in window,Zo=null;Ss&&"documentMode"in document&&(Zo=document.documentMode);var nk=Ss&&"TextEvent"in window&&!Zo,Ev=Ss&&(!Xm||Zo&&8<Zo&&11>=Zo),Bg=" ",zg=!1;function Tv(t,e){switch(t){case"keyup":return tk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Av(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Si=!1;function sk(t,e){switch(t){case"compositionend":return Av(e);case"keypress":return e.which!==32?null:(zg=!0,Bg);case"textInput":return t=e.data,t===Bg&&zg?null:t;default:return null}}function rk(t,e){if(Si)return t==="compositionend"||!Xm&&Tv(t,e)?(t=Sv(),Wl=Qm=sr=null,Si=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ev&&e.locale!=="ko"?null:e.data;default:return null}}var ik={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ik[t.type]:e==="textarea"}function Cv(t,e,n,s){lv(s),e=vc(e,"onChange"),0<e.length&&(n=new Jm("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var ea=null,ya=null;function ok(t){Bv(t,0)}function du(t){var e=Ai(t);if(tv(e))return t}function ak(t,e){if(t==="change")return e}var Pv=!1;if(Ss){var Id;if(Ss){var Sd="oninput"in document;if(!Sd){var qg=document.createElement("div");qg.setAttribute("oninput","return;"),Sd=typeof qg.oninput=="function"}Id=Sd}else Id=!1;Pv=Id&&(!document.documentMode||9<document.documentMode)}function Wg(){ea&&(ea.detachEvent("onpropertychange",Rv),ya=ea=null)}function Rv(t){if(t.propertyName==="value"&&du(ya)){var e=[];Cv(e,ya,t,Hm(t)),hv(ok,e)}}function lk(t,e,n){t==="focusin"?(Wg(),ea=e,ya=n,ea.attachEvent("onpropertychange",Rv)):t==="focusout"&&Wg()}function ck(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return du(ya)}function uk(t,e){if(t==="click")return du(e)}function dk(t,e){if(t==="input"||t==="change")return du(e)}function hk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zn=typeof Object.is=="function"?Object.is:hk;function va(t,e){if(zn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!dh.call(e,r)||!zn(t[r],e[r]))return!1}return!0}function Kg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Gg(t,e){var n=Kg(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Kg(n)}}function Ov(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ov(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Mv(){for(var t=window,e=hc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=hc(t.document)}return e}function Zm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function mk(t){var e=Mv(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ov(n.ownerDocument.documentElement,n)){if(s!==null&&Zm(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(s.start,r);s=s.end===void 0?o:Math.min(s.end,r),!t.extend&&o>s&&(r=s,s=o,o=r),r=Gg(n,o);var a=Gg(n,s);r&&a&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),o>s?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fk=Ss&&"documentMode"in document&&11>=document.documentMode,Ei=null,Ah=null,ta=null,Ch=!1;function Qg(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ch||Ei==null||Ei!==hc(s)||(s=Ei,"selectionStart"in s&&Zm(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),ta&&va(ta,s)||(ta=s,s=vc(Ah,"onSelect"),0<s.length&&(e=new Jm("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=Ei)))}function kl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ti={animationend:kl("Animation","AnimationEnd"),animationiteration:kl("Animation","AnimationIteration"),animationstart:kl("Animation","AnimationStart"),transitionend:kl("Transition","TransitionEnd")},Ed={},Lv={};Ss&&(Lv=document.createElement("div").style,"AnimationEvent"in window||(delete Ti.animationend.animation,delete Ti.animationiteration.animation,delete Ti.animationstart.animation),"TransitionEvent"in window||delete Ti.transitionend.transition);function hu(t){if(Ed[t])return Ed[t];if(!Ti[t])return t;var e=Ti[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Lv)return Ed[t]=e[n];return t}var Vv=hu("animationend"),$v=hu("animationiteration"),Fv=hu("animationstart"),Dv=hu("transitionend"),Uv=new Map,Jg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kr(t,e){Uv.set(t,e),ai(e,[t])}for(var Td=0;Td<Jg.length;Td++){var Ad=Jg[Td],pk=Ad.toLowerCase(),gk=Ad[0].toUpperCase()+Ad.slice(1);kr(pk,"on"+gk)}kr(Vv,"onAnimationEnd");kr($v,"onAnimationIteration");kr(Fv,"onAnimationStart");kr("dblclick","onDoubleClick");kr("focusin","onFocus");kr("focusout","onBlur");kr(Dv,"onTransitionEnd");Gi("onMouseEnter",["mouseout","mouseover"]);Gi("onMouseLeave",["mouseout","mouseover"]);Gi("onPointerEnter",["pointerout","pointerover"]);Gi("onPointerLeave",["pointerout","pointerover"]);ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ai("onBeforeInput",["compositionend","keypress","textInput","paste"]);ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ho));function Yg(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,p1(s,e,void 0,t),t.currentTarget=null}function Bv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var o=void 0;if(e)for(var a=s.length-1;0<=a;a--){var l=s[a],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==o&&r.isPropagationStopped())break e;Yg(r,l,d),o=u}else for(a=0;a<s.length;a++){if(l=s[a],u=l.instance,d=l.currentTarget,l=l.listener,u!==o&&r.isPropagationStopped())break e;Yg(r,l,d),o=u}}}if(fc)throw t=Ih,fc=!1,Ih=null,t}function Be(t,e){var n=e[Lh];n===void 0&&(n=e[Lh]=new Set);var s=t+"__bubble";n.has(s)||(zv(e,t,2,!1),n.add(s))}function Cd(t,e,n){var s=0;e&&(s|=4),zv(n,t,s,e)}var Il="_reactListening"+Math.random().toString(36).slice(2);function _a(t){if(!t[Il]){t[Il]=!0,Jy.forEach(function(n){n!=="selectionchange"&&(xk.has(n)||Cd(n,!1,t),Cd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Il]||(e[Il]=!0,Cd("selectionchange",!1,e))}}function zv(t,e,n,s){switch(Iv(e)){case 1:var r=C1;break;case 4:r=P1;break;default:r=Gm}n=r.bind(null,e,n,t),r=void 0,!kh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Pd(t,e,n,s,r){var o=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var l=s.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(a===4)for(a=s.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===r||u.nodeType===8&&u.parentNode===r))return;a=a.return}for(;l!==null;){if(a=Fr(l),a===null)return;if(u=a.tag,u===5||u===6){s=o=a;continue e}l=l.parentNode}}s=s.return}hv(function(){var d=o,h=Hm(n),m=[];e:{var p=Uv.get(t);if(p!==void 0){var x=Jm,v=t;switch(t){case"keypress":if(Kl(n)===0)break e;case"keydown":case"keyup":x=K1;break;case"focusin":v="focus",x=kd;break;case"focusout":v="blur",x=kd;break;case"beforeblur":case"afterblur":x=kd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Fg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=M1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=J1;break;case Vv:case $v:case Fv:x=$1;break;case Dv:x=X1;break;case"scroll":x=R1;break;case"wheel":x=ek;break;case"copy":case"cut":case"paste":x=D1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Ug}var j=(e&4)!==0,A=!j&&t==="scroll",w=j?p!==null?p+"Capture":null:p;j=[];for(var y=d,E;y!==null;){E=y;var R=E.stateNode;if(E.tag===5&&R!==null&&(E=R,w!==null&&(R=fa(y,w),R!=null&&j.push(wa(y,R,E)))),A)break;y=y.return}0<j.length&&(p=new x(p,v,null,n,h),m.push({event:p,listeners:j}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",p&&n!==Nh&&(v=n.relatedTarget||n.fromElement)&&(Fr(v)||v[Es]))break e;if((x||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,x?(v=n.relatedTarget||n.toElement,x=d,v=v?Fr(v):null,v!==null&&(A=li(v),v!==A||v.tag!==5&&v.tag!==6)&&(v=null)):(x=null,v=d),x!==v)){if(j=Fg,R="onMouseLeave",w="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(j=Ug,R="onPointerLeave",w="onPointerEnter",y="pointer"),A=x==null?p:Ai(x),E=v==null?p:Ai(v),p=new j(R,y+"leave",x,n,h),p.target=A,p.relatedTarget=E,R=null,Fr(h)===d&&(j=new j(w,y+"enter",v,n,h),j.target=E,j.relatedTarget=A,R=j),A=R,x&&v)t:{for(j=x,w=v,y=0,E=j;E;E=_i(E))y++;for(E=0,R=w;R;R=_i(R))E++;for(;0<y-E;)j=_i(j),y--;for(;0<E-y;)w=_i(w),E--;for(;y--;){if(j===w||w!==null&&j===w.alternate)break t;j=_i(j),w=_i(w)}j=null}else j=null;x!==null&&Xg(m,p,x,j,!1),v!==null&&A!==null&&Xg(m,A,v,j,!0)}}e:{if(p=d?Ai(d):window,x=p.nodeName&&p.nodeName.toLowerCase(),x==="select"||x==="input"&&p.type==="file")var $=ak;else if(Hg(p))if(Pv)$=dk;else{$=ck;var D=lk}else(x=p.nodeName)&&x.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&($=uk);if($&&($=$(t,d))){Cv(m,$,n,h);break e}D&&D(t,p,d),t==="focusout"&&(D=p._wrapperState)&&D.controlled&&p.type==="number"&&yh(p,"number",p.value)}switch(D=d?Ai(d):window,t){case"focusin":(Hg(D)||D.contentEditable==="true")&&(Ei=D,Ah=d,ta=null);break;case"focusout":ta=Ah=Ei=null;break;case"mousedown":Ch=!0;break;case"contextmenu":case"mouseup":case"dragend":Ch=!1,Qg(m,n,h);break;case"selectionchange":if(fk)break;case"keydown":case"keyup":Qg(m,n,h)}var _;if(Xm)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Si?Tv(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(Ev&&n.locale!=="ko"&&(Si||b!=="onCompositionStart"?b==="onCompositionEnd"&&Si&&(_=Sv()):(sr=h,Qm="value"in sr?sr.value:sr.textContent,Si=!0)),D=vc(d,b),0<D.length&&(b=new Dg(b,t,null,n,h),m.push({event:b,listeners:D}),_?b.data=_:(_=Av(n),_!==null&&(b.data=_)))),(_=nk?sk(t,n):rk(t,n))&&(d=vc(d,"onBeforeInput"),0<d.length&&(h=new Dg("onBeforeInput","beforeinput",null,n,h),m.push({event:h,listeners:d}),h.data=_))}Bv(m,e)})}function wa(t,e,n){return{instance:t,listener:e,currentTarget:n}}function vc(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=fa(t,n),o!=null&&s.unshift(wa(t,o,r)),o=fa(t,e),o!=null&&s.push(wa(t,o,r))),t=t.return}return s}function _i(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Xg(t,e,n,s,r){for(var o=e._reactName,a=[];n!==null&&n!==s;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===s)break;l.tag===5&&d!==null&&(l=d,r?(u=fa(n,o),u!=null&&a.unshift(wa(n,u,l))):r||(u=fa(n,o),u!=null&&a.push(wa(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var yk=/\r\n?/g,vk=/\u0000|\uFFFD/g;function Zg(t){return(typeof t=="string"?t:""+t).replace(yk,`
`).replace(vk,"")}function Sl(t,e,n){if(e=Zg(e),Zg(t)!==e&&n)throw Error(J(425))}function _c(){}var Ph=null,Rh=null;function Oh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Mh=typeof setTimeout=="function"?setTimeout:void 0,_k=typeof clearTimeout=="function"?clearTimeout:void 0,ex=typeof Promise=="function"?Promise:void 0,wk=typeof queueMicrotask=="function"?queueMicrotask:typeof ex<"u"?function(t){return ex.resolve(null).then(t).catch(bk)}:Mh;function bk(t){setTimeout(function(){throw t})}function Rd(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),xa(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);xa(e)}function cr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function tx(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var uo=Math.random().toString(36).slice(2),ns="__reactFiber$"+uo,ba="__reactProps$"+uo,Es="__reactContainer$"+uo,Lh="__reactEvents$"+uo,Nk="__reactListeners$"+uo,jk="__reactHandles$"+uo;function Fr(t){var e=t[ns];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Es]||n[ns]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=tx(t);t!==null;){if(n=t[ns])return n;t=tx(t)}return e}t=n,n=t.parentNode}return null}function Ka(t){return t=t[ns]||t[Es],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ai(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(J(33))}function mu(t){return t[ba]||null}var Vh=[],Ci=-1;function Ir(t){return{current:t}}function ze(t){0>Ci||(t.current=Vh[Ci],Vh[Ci]=null,Ci--)}function De(t,e){Ci++,Vh[Ci]=t.current,t.current=e}var yr={},Ft=Ir(yr),tn=Ir(!1),Qr=yr;function Qi(t,e){var n=t.type.contextTypes;if(!n)return yr;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in n)r[o]=e[o];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function nn(t){return t=t.childContextTypes,t!=null}function wc(){ze(tn),ze(Ft)}function nx(t,e,n){if(Ft.current!==yr)throw Error(J(168));De(Ft,e),De(tn,n)}function Hv(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(J(108,l1(t)||"Unknown",r));return Qe({},n,s)}function bc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||yr,Qr=Ft.current,De(Ft,t),De(tn,tn.current),!0}function sx(t,e,n){var s=t.stateNode;if(!s)throw Error(J(169));n?(t=Hv(t,e,Qr),s.__reactInternalMemoizedMergedChildContext=t,ze(tn),ze(Ft),De(Ft,t)):ze(tn),De(tn,n)}var ys=null,fu=!1,Od=!1;function qv(t){ys===null?ys=[t]:ys.push(t)}function kk(t){fu=!0,qv(t)}function Sr(){if(!Od&&ys!==null){Od=!0;var t=0,e=Me;try{var n=ys;for(Me=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}ys=null,fu=!1}catch(r){throw ys!==null&&(ys=ys.slice(t+1)),gv(qm,Sr),r}finally{Me=e,Od=!1}}return null}var Pi=[],Ri=0,Nc=null,jc=0,bn=[],Nn=0,Jr=null,_s=1,ws="";function Mr(t,e){Pi[Ri++]=jc,Pi[Ri++]=Nc,Nc=t,jc=e}function Wv(t,e,n){bn[Nn++]=_s,bn[Nn++]=ws,bn[Nn++]=Jr,Jr=t;var s=_s;t=ws;var r=32-Dn(s)-1;s&=~(1<<r),n+=1;var o=32-Dn(e)+r;if(30<o){var a=r-r%5;o=(s&(1<<a)-1).toString(32),s>>=a,r-=a,_s=1<<32-Dn(e)+r|n<<r|s,ws=o+t}else _s=1<<o|n<<r|s,ws=t}function ef(t){t.return!==null&&(Mr(t,1),Wv(t,1,0))}function tf(t){for(;t===Nc;)Nc=Pi[--Ri],Pi[Ri]=null,jc=Pi[--Ri],Pi[Ri]=null;for(;t===Jr;)Jr=bn[--Nn],bn[Nn]=null,ws=bn[--Nn],bn[Nn]=null,_s=bn[--Nn],bn[Nn]=null}var dn=null,cn=null,He=!1,Vn=null;function Kv(t,e){var n=kn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function rx(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,dn=t,cn=cr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,dn=t,cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Jr!==null?{id:_s,overflow:ws}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=kn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,dn=t,cn=null,!0):!1;default:return!1}}function $h(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Fh(t){if(He){var e=cn;if(e){var n=e;if(!rx(t,e)){if($h(t))throw Error(J(418));e=cr(n.nextSibling);var s=dn;e&&rx(t,e)?Kv(s,n):(t.flags=t.flags&-4097|2,He=!1,dn=t)}}else{if($h(t))throw Error(J(418));t.flags=t.flags&-4097|2,He=!1,dn=t}}}function ix(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;dn=t}function El(t){if(t!==dn)return!1;if(!He)return ix(t),He=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Oh(t.type,t.memoizedProps)),e&&(e=cn)){if($h(t))throw Gv(),Error(J(418));for(;e;)Kv(t,e),e=cr(e.nextSibling)}if(ix(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(J(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){cn=cr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}cn=null}}else cn=dn?cr(t.stateNode.nextSibling):null;return!0}function Gv(){for(var t=cn;t;)t=cr(t.nextSibling)}function Ji(){cn=dn=null,He=!1}function nf(t){Vn===null?Vn=[t]:Vn.push(t)}var Ik=Ls.ReactCurrentBatchConfig;function $o(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var s=n.stateNode}if(!s)throw Error(J(147,t));var r=s,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var l=r.refs;a===null?delete l[o]:l[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,t))}return t}function Tl(t,e){throw t=Object.prototype.toString.call(e),Error(J(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ox(t){var e=t._init;return e(t._payload)}function Qv(t){function e(w,y){if(t){var E=w.deletions;E===null?(w.deletions=[y],w.flags|=16):E.push(y)}}function n(w,y){if(!t)return null;for(;y!==null;)e(w,y),y=y.sibling;return null}function s(w,y){for(w=new Map;y!==null;)y.key!==null?w.set(y.key,y):w.set(y.index,y),y=y.sibling;return w}function r(w,y){return w=mr(w,y),w.index=0,w.sibling=null,w}function o(w,y,E){return w.index=E,t?(E=w.alternate,E!==null?(E=E.index,E<y?(w.flags|=2,y):E):(w.flags|=2,y)):(w.flags|=1048576,y)}function a(w){return t&&w.alternate===null&&(w.flags|=2),w}function l(w,y,E,R){return y===null||y.tag!==6?(y=Ud(E,w.mode,R),y.return=w,y):(y=r(y,E),y.return=w,y)}function u(w,y,E,R){var $=E.type;return $===Ii?h(w,y,E.props.children,R,E.key):y!==null&&(y.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Js&&ox($)===y.type)?(R=r(y,E.props),R.ref=$o(w,y,E),R.return=w,R):(R=ec(E.type,E.key,E.props,null,w.mode,R),R.ref=$o(w,y,E),R.return=w,R)}function d(w,y,E,R){return y===null||y.tag!==4||y.stateNode.containerInfo!==E.containerInfo||y.stateNode.implementation!==E.implementation?(y=Bd(E,w.mode,R),y.return=w,y):(y=r(y,E.children||[]),y.return=w,y)}function h(w,y,E,R,$){return y===null||y.tag!==7?(y=Wr(E,w.mode,R,$),y.return=w,y):(y=r(y,E),y.return=w,y)}function m(w,y,E){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Ud(""+y,w.mode,E),y.return=w,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case yl:return E=ec(y.type,y.key,y.props,null,w.mode,E),E.ref=$o(w,null,y),E.return=w,E;case ki:return y=Bd(y,w.mode,E),y.return=w,y;case Js:var R=y._init;return m(w,R(y._payload),E)}if(Bo(y)||Ro(y))return y=Wr(y,w.mode,E,null),y.return=w,y;Tl(w,y)}return null}function p(w,y,E,R){var $=y!==null?y.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return $!==null?null:l(w,y,""+E,R);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case yl:return E.key===$?u(w,y,E,R):null;case ki:return E.key===$?d(w,y,E,R):null;case Js:return $=E._init,p(w,y,$(E._payload),R)}if(Bo(E)||Ro(E))return $!==null?null:h(w,y,E,R,null);Tl(w,E)}return null}function x(w,y,E,R,$){if(typeof R=="string"&&R!==""||typeof R=="number")return w=w.get(E)||null,l(y,w,""+R,$);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case yl:return w=w.get(R.key===null?E:R.key)||null,u(y,w,R,$);case ki:return w=w.get(R.key===null?E:R.key)||null,d(y,w,R,$);case Js:var D=R._init;return x(w,y,E,D(R._payload),$)}if(Bo(R)||Ro(R))return w=w.get(E)||null,h(y,w,R,$,null);Tl(y,R)}return null}function v(w,y,E,R){for(var $=null,D=null,_=y,b=y=0,S=null;_!==null&&b<E.length;b++){_.index>b?(S=_,_=null):S=_.sibling;var I=p(w,_,E[b],R);if(I===null){_===null&&(_=S);break}t&&_&&I.alternate===null&&e(w,_),y=o(I,y,b),D===null?$=I:D.sibling=I,D=I,_=S}if(b===E.length)return n(w,_),He&&Mr(w,b),$;if(_===null){for(;b<E.length;b++)_=m(w,E[b],R),_!==null&&(y=o(_,y,b),D===null?$=_:D.sibling=_,D=_);return He&&Mr(w,b),$}for(_=s(w,_);b<E.length;b++)S=x(_,w,b,E[b],R),S!==null&&(t&&S.alternate!==null&&_.delete(S.key===null?b:S.key),y=o(S,y,b),D===null?$=S:D.sibling=S,D=S);return t&&_.forEach(function(C){return e(w,C)}),He&&Mr(w,b),$}function j(w,y,E,R){var $=Ro(E);if(typeof $!="function")throw Error(J(150));if(E=$.call(E),E==null)throw Error(J(151));for(var D=$=null,_=y,b=y=0,S=null,I=E.next();_!==null&&!I.done;b++,I=E.next()){_.index>b?(S=_,_=null):S=_.sibling;var C=p(w,_,I.value,R);if(C===null){_===null&&(_=S);break}t&&_&&C.alternate===null&&e(w,_),y=o(C,y,b),D===null?$=C:D.sibling=C,D=C,_=S}if(I.done)return n(w,_),He&&Mr(w,b),$;if(_===null){for(;!I.done;b++,I=E.next())I=m(w,I.value,R),I!==null&&(y=o(I,y,b),D===null?$=I:D.sibling=I,D=I);return He&&Mr(w,b),$}for(_=s(w,_);!I.done;b++,I=E.next())I=x(_,w,b,I.value,R),I!==null&&(t&&I.alternate!==null&&_.delete(I.key===null?b:I.key),y=o(I,y,b),D===null?$=I:D.sibling=I,D=I);return t&&_.forEach(function(P){return e(w,P)}),He&&Mr(w,b),$}function A(w,y,E,R){if(typeof E=="object"&&E!==null&&E.type===Ii&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case yl:e:{for(var $=E.key,D=y;D!==null;){if(D.key===$){if($=E.type,$===Ii){if(D.tag===7){n(w,D.sibling),y=r(D,E.props.children),y.return=w,w=y;break e}}else if(D.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Js&&ox($)===D.type){n(w,D.sibling),y=r(D,E.props),y.ref=$o(w,D,E),y.return=w,w=y;break e}n(w,D);break}else e(w,D);D=D.sibling}E.type===Ii?(y=Wr(E.props.children,w.mode,R,E.key),y.return=w,w=y):(R=ec(E.type,E.key,E.props,null,w.mode,R),R.ref=$o(w,y,E),R.return=w,w=R)}return a(w);case ki:e:{for(D=E.key;y!==null;){if(y.key===D)if(y.tag===4&&y.stateNode.containerInfo===E.containerInfo&&y.stateNode.implementation===E.implementation){n(w,y.sibling),y=r(y,E.children||[]),y.return=w,w=y;break e}else{n(w,y);break}else e(w,y);y=y.sibling}y=Bd(E,w.mode,R),y.return=w,w=y}return a(w);case Js:return D=E._init,A(w,y,D(E._payload),R)}if(Bo(E))return v(w,y,E,R);if(Ro(E))return j(w,y,E,R);Tl(w,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,y!==null&&y.tag===6?(n(w,y.sibling),y=r(y,E),y.return=w,w=y):(n(w,y),y=Ud(E,w.mode,R),y.return=w,w=y),a(w)):n(w,y)}return A}var Yi=Qv(!0),Jv=Qv(!1),kc=Ir(null),Ic=null,Oi=null,sf=null;function rf(){sf=Oi=Ic=null}function of(t){var e=kc.current;ze(kc),t._currentValue=e}function Dh(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Bi(t,e){Ic=t,sf=Oi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Zt=!0),t.firstContext=null)}function Tn(t){var e=t._currentValue;if(sf!==t)if(t={context:t,memoizedValue:e,next:null},Oi===null){if(Ic===null)throw Error(J(308));Oi=t,Ic.dependencies={lanes:0,firstContext:t}}else Oi=Oi.next=t;return e}var Dr=null;function af(t){Dr===null?Dr=[t]:Dr.push(t)}function Yv(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,af(e)):(n.next=r.next,r.next=n),e.interleaved=n,Ts(t,s)}function Ts(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ys=!1;function lf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function js(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ur(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Pe&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,Ts(t,n)}return r=s.interleaved,r===null?(e.next=e,af(s)):(e.next=r.next,r.next=e),s.interleaved=e,Ts(t,n)}function Gl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Wm(t,n)}}function ax(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?r=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?r=o=e:o=o.next=e}else r=o=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Sc(t,e,n,s){var r=t.updateQueue;Ys=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var u=l,d=u.next;u.next=null,a===null?o=d:a.next=d,a=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==a&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(o!==null){var m=r.baseState;a=0,h=d=u=null,l=o;do{var p=l.lane,x=l.eventTime;if((s&p)===p){h!==null&&(h=h.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=t,j=l;switch(p=e,x=n,j.tag){case 1:if(v=j.payload,typeof v=="function"){m=v.call(x,m,p);break e}m=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=j.payload,p=typeof v=="function"?v.call(x,m,p):v,p==null)break e;m=Qe({},m,p);break e;case 2:Ys=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=r.effects,p===null?r.effects=[l]:p.push(l))}else x={eventTime:x,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=x,u=m):h=h.next=x,a|=p;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;p=l,l=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(!0);if(h===null&&(u=m),r.baseState=u,r.firstBaseUpdate=d,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);Xr|=a,t.lanes=a,t.memoizedState=m}}function lx(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(J(191,r));r.call(s)}}}var Ga={},rs=Ir(Ga),Na=Ir(Ga),ja=Ir(Ga);function Ur(t){if(t===Ga)throw Error(J(174));return t}function cf(t,e){switch(De(ja,e),De(Na,t),De(rs,Ga),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_h(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=_h(e,t)}ze(rs),De(rs,e)}function Xi(){ze(rs),ze(Na),ze(ja)}function Zv(t){Ur(ja.current);var e=Ur(rs.current),n=_h(e,t.type);e!==n&&(De(Na,t),De(rs,n))}function uf(t){Na.current===t&&(ze(rs),ze(Na))}var Ke=Ir(0);function Ec(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Md=[];function df(){for(var t=0;t<Md.length;t++)Md[t]._workInProgressVersionPrimary=null;Md.length=0}var Ql=Ls.ReactCurrentDispatcher,Ld=Ls.ReactCurrentBatchConfig,Yr=0,Ge=null,ht=null,yt=null,Tc=!1,na=!1,ka=0,Sk=0;function Ct(){throw Error(J(321))}function hf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zn(t[n],e[n]))return!1;return!0}function mf(t,e,n,s,r,o){if(Yr=o,Ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ql.current=t===null||t.memoizedState===null?Ck:Pk,t=n(s,r),na){o=0;do{if(na=!1,ka=0,25<=o)throw Error(J(301));o+=1,yt=ht=null,e.updateQueue=null,Ql.current=Rk,t=n(s,r)}while(na)}if(Ql.current=Ac,e=ht!==null&&ht.next!==null,Yr=0,yt=ht=Ge=null,Tc=!1,e)throw Error(J(300));return t}function ff(){var t=ka!==0;return ka=0,t}function es(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?Ge.memoizedState=yt=t:yt=yt.next=t,yt}function An(){if(ht===null){var t=Ge.alternate;t=t!==null?t.memoizedState:null}else t=ht.next;var e=yt===null?Ge.memoizedState:yt.next;if(e!==null)yt=e,ht=t;else{if(t===null)throw Error(J(310));ht=t,t={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},yt===null?Ge.memoizedState=yt=t:yt=yt.next=t}return yt}function Ia(t,e){return typeof e=="function"?e(t):e}function Vd(t){var e=An(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var s=ht,r=s.baseQueue,o=n.pending;if(o!==null){if(r!==null){var a=r.next;r.next=o.next,o.next=a}s.baseQueue=r=o,n.pending=null}if(r!==null){o=r.next,s=s.baseState;var l=a=null,u=null,d=o;do{var h=d.lane;if((Yr&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=m,a=s):u=u.next=m,Ge.lanes|=h,Xr|=h}d=d.next}while(d!==null&&d!==o);u===null?a=s:u.next=l,zn(s,e.memoizedState)||(Zt=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=u,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do o=r.lane,Ge.lanes|=o,Xr|=o,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $d(t){var e=An(),n=e.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,o=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do o=t(o,a.action),a=a.next;while(a!==r);zn(o,e.memoizedState)||(Zt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,s]}function e_(){}function t_(t,e){var n=Ge,s=An(),r=e(),o=!zn(s.memoizedState,r);if(o&&(s.memoizedState=r,Zt=!0),s=s.queue,pf(r_.bind(null,n,s,t),[t]),s.getSnapshot!==e||o||yt!==null&&yt.memoizedState.tag&1){if(n.flags|=2048,Sa(9,s_.bind(null,n,s,r,e),void 0,null),vt===null)throw Error(J(349));Yr&30||n_(n,e,r)}return r}function n_(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function s_(t,e,n,s){e.value=n,e.getSnapshot=s,i_(e)&&o_(t)}function r_(t,e,n){return n(function(){i_(e)&&o_(t)})}function i_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zn(t,n)}catch{return!0}}function o_(t){var e=Ts(t,1);e!==null&&Un(e,t,1,-1)}function cx(t){var e=es();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:t},e.queue=t,t=t.dispatch=Ak.bind(null,Ge,t),[e.memoizedState,t]}function Sa(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function a_(){return An().memoizedState}function Jl(t,e,n,s){var r=es();Ge.flags|=t,r.memoizedState=Sa(1|e,n,void 0,s===void 0?null:s)}function pu(t,e,n,s){var r=An();s=s===void 0?null:s;var o=void 0;if(ht!==null){var a=ht.memoizedState;if(o=a.destroy,s!==null&&hf(s,a.deps)){r.memoizedState=Sa(e,n,o,s);return}}Ge.flags|=t,r.memoizedState=Sa(1|e,n,o,s)}function ux(t,e){return Jl(8390656,8,t,e)}function pf(t,e){return pu(2048,8,t,e)}function l_(t,e){return pu(4,2,t,e)}function c_(t,e){return pu(4,4,t,e)}function u_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function d_(t,e,n){return n=n!=null?n.concat([t]):null,pu(4,4,u_.bind(null,e,t),n)}function gf(){}function h_(t,e){var n=An();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&hf(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function m_(t,e){var n=An();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&hf(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function f_(t,e,n){return Yr&21?(zn(n,e)||(n=vv(),Ge.lanes|=n,Xr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Zt=!0),t.memoizedState=n)}function Ek(t,e){var n=Me;Me=n!==0&&4>n?n:4,t(!0);var s=Ld.transition;Ld.transition={};try{t(!1),e()}finally{Me=n,Ld.transition=s}}function p_(){return An().memoizedState}function Tk(t,e,n){var s=hr(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},g_(t))x_(e,n);else if(n=Yv(t,e,n,s),n!==null){var r=Ht();Un(n,t,s,r),y_(n,e,s)}}function Ak(t,e,n){var s=hr(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(g_(t))x_(e,r);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,l=o(a,n);if(r.hasEagerState=!0,r.eagerState=l,zn(l,a)){var u=e.interleaved;u===null?(r.next=r,af(e)):(r.next=u.next,u.next=r),e.interleaved=r;return}}catch{}finally{}n=Yv(t,e,r,s),n!==null&&(r=Ht(),Un(n,t,s,r),y_(n,e,s))}}function g_(t){var e=t.alternate;return t===Ge||e!==null&&e===Ge}function x_(t,e){na=Tc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function y_(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Wm(t,n)}}var Ac={readContext:Tn,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},Ck={readContext:Tn,useCallback:function(t,e){return es().memoizedState=[t,e===void 0?null:e],t},useContext:Tn,useEffect:ux,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Jl(4194308,4,u_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Jl(4194308,4,t,e)},useInsertionEffect:function(t,e){return Jl(4,2,t,e)},useMemo:function(t,e){var n=es();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=es();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=Tk.bind(null,Ge,t),[s.memoizedState,t]},useRef:function(t){var e=es();return t={current:t},e.memoizedState=t},useState:cx,useDebugValue:gf,useDeferredValue:function(t){return es().memoizedState=t},useTransition:function(){var t=cx(!1),e=t[0];return t=Ek.bind(null,t[1]),es().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Ge,r=es();if(He){if(n===void 0)throw Error(J(407));n=n()}else{if(n=e(),vt===null)throw Error(J(349));Yr&30||n_(s,e,n)}r.memoizedState=n;var o={value:n,getSnapshot:e};return r.queue=o,ux(r_.bind(null,s,o,t),[t]),s.flags|=2048,Sa(9,s_.bind(null,s,o,n,e),void 0,null),n},useId:function(){var t=es(),e=vt.identifierPrefix;if(He){var n=ws,s=_s;n=(s&~(1<<32-Dn(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=ka++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Sk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Pk={readContext:Tn,useCallback:h_,useContext:Tn,useEffect:pf,useImperativeHandle:d_,useInsertionEffect:l_,useLayoutEffect:c_,useMemo:m_,useReducer:Vd,useRef:a_,useState:function(){return Vd(Ia)},useDebugValue:gf,useDeferredValue:function(t){var e=An();return f_(e,ht.memoizedState,t)},useTransition:function(){var t=Vd(Ia)[0],e=An().memoizedState;return[t,e]},useMutableSource:e_,useSyncExternalStore:t_,useId:p_,unstable_isNewReconciler:!1},Rk={readContext:Tn,useCallback:h_,useContext:Tn,useEffect:pf,useImperativeHandle:d_,useInsertionEffect:l_,useLayoutEffect:c_,useMemo:m_,useReducer:$d,useRef:a_,useState:function(){return $d(Ia)},useDebugValue:gf,useDeferredValue:function(t){var e=An();return ht===null?e.memoizedState=t:f_(e,ht.memoizedState,t)},useTransition:function(){var t=$d(Ia)[0],e=An().memoizedState;return[t,e]},useMutableSource:e_,useSyncExternalStore:t_,useId:p_,unstable_isNewReconciler:!1};function Mn(t,e){if(t&&t.defaultProps){e=Qe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Uh(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Qe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var gu={isMounted:function(t){return(t=t._reactInternals)?li(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Ht(),r=hr(t),o=js(s,r);o.payload=e,n!=null&&(o.callback=n),e=ur(t,o,r),e!==null&&(Un(e,t,r,s),Gl(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Ht(),r=hr(t),o=js(s,r);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=ur(t,o,r),e!==null&&(Un(e,t,r,s),Gl(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ht(),s=hr(t),r=js(n,s);r.tag=2,e!=null&&(r.callback=e),e=ur(t,r,s),e!==null&&(Un(e,t,s,n),Gl(e,t,s))}};function dx(t,e,n,s,r,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,o,a):e.prototype&&e.prototype.isPureReactComponent?!va(n,s)||!va(r,o):!0}function v_(t,e,n){var s=!1,r=yr,o=e.contextType;return typeof o=="object"&&o!==null?o=Tn(o):(r=nn(e)?Qr:Ft.current,s=e.contextTypes,o=(s=s!=null)?Qi(t,r):yr),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=gu,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function hx(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&gu.enqueueReplaceState(e,e.state,null)}function Bh(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},lf(t);var o=e.contextType;typeof o=="object"&&o!==null?r.context=Tn(o):(o=nn(e)?Qr:Ft.current,r.context=Qi(t,o)),r.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Uh(t,e,o,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&gu.enqueueReplaceState(r,r.state,null),Sc(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Zi(t,e){try{var n="",s=e;do n+=a1(s),s=s.return;while(s);var r=n}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:r,digest:null}}function Fd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function zh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Ok=typeof WeakMap=="function"?WeakMap:Map;function __(t,e,n){n=js(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){Pc||(Pc=!0,Zh=s),zh(t,e)},n}function w_(t,e,n){n=js(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){zh(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){zh(t,e),typeof s!="function"&&(dr===null?dr=new Set([this]):dr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function mx(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new Ok;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=Gk.bind(null,t,e,n),e.then(t,t))}function fx(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function px(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=js(-1,1),e.tag=2,ur(n,e,1))),n.lanes|=1),t)}var Mk=Ls.ReactCurrentOwner,Zt=!1;function Bt(t,e,n,s){e.child=t===null?Jv(e,null,n,s):Yi(e,t.child,n,s)}function gx(t,e,n,s,r){n=n.render;var o=e.ref;return Bi(e,r),s=mf(t,e,n,s,o,r),n=ff(),t!==null&&!Zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,As(t,e,r)):(He&&n&&ef(e),e.flags|=1,Bt(t,e,s,r),e.child)}function xx(t,e,n,s,r){if(t===null){var o=n.type;return typeof o=="function"&&!jf(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,b_(t,e,o,s,r)):(t=ec(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&r)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:va,n(a,s)&&t.ref===e.ref)return As(t,e,r)}return e.flags|=1,t=mr(o,s),t.ref=e.ref,t.return=e,e.child=t}function b_(t,e,n,s,r){if(t!==null){var o=t.memoizedProps;if(va(o,s)&&t.ref===e.ref)if(Zt=!1,e.pendingProps=s=o,(t.lanes&r)!==0)t.flags&131072&&(Zt=!0);else return e.lanes=t.lanes,As(t,e,r)}return Hh(t,e,n,s,r)}function N_(t,e,n){var s=e.pendingProps,r=s.children,o=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(Li,ln),ln|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,De(Li,ln),ln|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:n,De(Li,ln),ln|=s}else o!==null?(s=o.baseLanes|n,e.memoizedState=null):s=n,De(Li,ln),ln|=s;return Bt(t,e,r,n),e.child}function j_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Hh(t,e,n,s,r){var o=nn(n)?Qr:Ft.current;return o=Qi(e,o),Bi(e,r),n=mf(t,e,n,s,o,r),s=ff(),t!==null&&!Zt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,As(t,e,r)):(He&&s&&ef(e),e.flags|=1,Bt(t,e,n,r),e.child)}function yx(t,e,n,s,r){if(nn(n)){var o=!0;bc(e)}else o=!1;if(Bi(e,r),e.stateNode===null)Yl(t,e),v_(e,n,s),Bh(e,n,s,r),s=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=Tn(d):(d=nn(n)?Qr:Ft.current,d=Qi(e,d));var h=n.getDerivedStateFromProps,m=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==s||u!==d)&&hx(e,a,s,d),Ys=!1;var p=e.memoizedState;a.state=p,Sc(e,s,a,r),u=e.memoizedState,l!==s||p!==u||tn.current||Ys?(typeof h=="function"&&(Uh(e,n,h,s),u=e.memoizedState),(l=Ys||dx(e,n,l,s,p,u,d))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=u),a.props=s,a.state=u,a.context=d,s=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,Xv(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Mn(e.type,l),a.props=d,m=e.pendingProps,p=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Tn(u):(u=nn(n)?Qr:Ft.current,u=Qi(e,u));var x=n.getDerivedStateFromProps;(h=typeof x=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==m||p!==u)&&hx(e,a,s,u),Ys=!1,p=e.memoizedState,a.state=p,Sc(e,s,a,r);var v=e.memoizedState;l!==m||p!==v||tn.current||Ys?(typeof x=="function"&&(Uh(e,n,x,s),v=e.memoizedState),(d=Ys||dx(e,n,d,s,p,v,u)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,v,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,v,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=v),a.props=s,a.state=v,a.context=u,s=d):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),s=!1)}return qh(t,e,n,s,o,r)}function qh(t,e,n,s,r,o){j_(t,e);var a=(e.flags&128)!==0;if(!s&&!a)return r&&sx(e,n,!1),As(t,e,o);s=e.stateNode,Mk.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&a?(e.child=Yi(e,t.child,null,o),e.child=Yi(e,null,l,o)):Bt(t,e,l,o),e.memoizedState=s.state,r&&sx(e,n,!0),e.child}function k_(t){var e=t.stateNode;e.pendingContext?nx(t,e.pendingContext,e.pendingContext!==e.context):e.context&&nx(t,e.context,!1),cf(t,e.containerInfo)}function vx(t,e,n,s,r){return Ji(),nf(r),e.flags|=256,Bt(t,e,n,s),e.child}var Wh={dehydrated:null,treeContext:null,retryLane:0};function Kh(t){return{baseLanes:t,cachePool:null,transitions:null}}function I_(t,e,n){var s=e.pendingProps,r=Ke.current,o=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(r&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),De(Ke,r&1),t===null)return Fh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,t=s.fallback,o?(s=e.mode,o=e.child,a={mode:"hidden",children:a},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=vu(a,s,0,null),t=Wr(t,s,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Kh(n),e.memoizedState=Wh,t):xf(e,a));if(r=t.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return Lk(t,e,a,s,l,r,n);if(o){o=s.fallback,a=e.mode,r=t.child,l=r.sibling;var u={mode:"hidden",children:s.children};return!(a&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=u,e.deletions=null):(s=mr(r,u),s.subtreeFlags=r.subtreeFlags&14680064),l!==null?o=mr(l,o):(o=Wr(o,a,n,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,s=o,o=e.child,a=t.child.memoizedState,a=a===null?Kh(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=Wh,s}return o=t.child,t=o.sibling,s=mr(o,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function xf(t,e){return e=vu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Al(t,e,n,s){return s!==null&&nf(s),Yi(e,t.child,null,n),t=xf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Lk(t,e,n,s,r,o,a){if(n)return e.flags&256?(e.flags&=-257,s=Fd(Error(J(422))),Al(t,e,a,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=s.fallback,r=e.mode,s=vu({mode:"visible",children:s.children},r,0,null),o=Wr(o,r,a,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,e.mode&1&&Yi(e,t.child,null,a),e.child.memoizedState=Kh(a),e.memoizedState=Wh,o);if(!(e.mode&1))return Al(t,e,a,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var l=s.dgst;return s=l,o=Error(J(419)),s=Fd(o,s,void 0),Al(t,e,a,s)}if(l=(a&t.childLanes)!==0,Zt||l){if(s=vt,s!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|a)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,Ts(t,r),Un(s,t,r,-1))}return Nf(),s=Fd(Error(J(421))),Al(t,e,a,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Qk.bind(null,t),r._reactRetry=e,null):(t=o.treeContext,cn=cr(r.nextSibling),dn=e,He=!0,Vn=null,t!==null&&(bn[Nn++]=_s,bn[Nn++]=ws,bn[Nn++]=Jr,_s=t.id,ws=t.overflow,Jr=e),e=xf(e,s.children),e.flags|=4096,e)}function _x(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Dh(t.return,e,n)}function Dd(t,e,n,s,r){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=n,o.tailMode=r)}function S_(t,e,n){var s=e.pendingProps,r=s.revealOrder,o=s.tail;if(Bt(t,e,s.children,n),s=Ke.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_x(t,n,e);else if(t.tag===19)_x(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(De(Ke,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Ec(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Dd(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Ec(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Dd(e,!0,n,null,o);break;case"together":Dd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Yl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function As(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Xr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(J(153));if(e.child!==null){for(t=e.child,n=mr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=mr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Vk(t,e,n){switch(e.tag){case 3:k_(e),Ji();break;case 5:Zv(e);break;case 1:nn(e.type)&&bc(e);break;case 4:cf(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;De(kc,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(De(Ke,Ke.current&1),e.flags|=128,null):n&e.child.childLanes?I_(t,e,n):(De(Ke,Ke.current&1),t=As(t,e,n),t!==null?t.sibling:null);De(Ke,Ke.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return S_(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),De(Ke,Ke.current),s)break;return null;case 22:case 23:return e.lanes=0,N_(t,e,n)}return As(t,e,n)}var E_,Gh,T_,A_;E_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Gh=function(){};T_=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Ur(rs.current);var o=null;switch(n){case"input":r=gh(t,r),s=gh(t,s),o=[];break;case"select":r=Qe({},r,{value:void 0}),s=Qe({},s,{value:void 0}),o=[];break;case"textarea":r=vh(t,r),s=vh(t,s),o=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=_c)}wh(n,s);var a;n=null;for(d in r)if(!s.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var l=r[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ha.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in s){var u=s[d];if(l=r!=null?r[d]:void 0,s.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(o||(o=[]),o.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(o=o||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ha.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Be("scroll",t),o||l===u||(o=[])):(o=o||[]).push(d,u))}n&&(o=o||[]).push("style",n);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};A_=function(t,e,n,s){n!==s&&(e.flags|=4)};function Fo(t,e){if(!He)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Pt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function $k(t,e,n){var s=e.pendingProps;switch(tf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pt(e),null;case 1:return nn(e.type)&&wc(),Pt(e),null;case 3:return s=e.stateNode,Xi(),ze(tn),ze(Ft),df(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(El(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Vn!==null&&(nm(Vn),Vn=null))),Gh(t,e),Pt(e),null;case 5:uf(e);var r=Ur(ja.current);if(n=e.type,t!==null&&e.stateNode!=null)T_(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(J(166));return Pt(e),null}if(t=Ur(rs.current),El(e)){s=e.stateNode,n=e.type;var o=e.memoizedProps;switch(s[ns]=e,s[ba]=o,t=(e.mode&1)!==0,n){case"dialog":Be("cancel",s),Be("close",s);break;case"iframe":case"object":case"embed":Be("load",s);break;case"video":case"audio":for(r=0;r<Ho.length;r++)Be(Ho[r],s);break;case"source":Be("error",s);break;case"img":case"image":case"link":Be("error",s),Be("load",s);break;case"details":Be("toggle",s);break;case"input":Tg(s,o),Be("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},Be("invalid",s);break;case"textarea":Cg(s,o),Be("invalid",s)}wh(n,o),r=null;for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="children"?typeof l=="string"?s.textContent!==l&&(o.suppressHydrationWarning!==!0&&Sl(s.textContent,l,t),r=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Sl(s.textContent,l,t),r=["children",""+l]):ha.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Be("scroll",s)}switch(n){case"input":vl(s),Ag(s,o,!0);break;case"textarea":vl(s),Pg(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=_c)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=a.createElement(n,{is:s.is}):(t=a.createElement(n),n==="select"&&(a=t,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):t=a.createElementNS(t,n),t[ns]=e,t[ba]=s,E_(t,e,!1,!1),e.stateNode=t;e:{switch(a=bh(n,s),n){case"dialog":Be("cancel",t),Be("close",t),r=s;break;case"iframe":case"object":case"embed":Be("load",t),r=s;break;case"video":case"audio":for(r=0;r<Ho.length;r++)Be(Ho[r],t);r=s;break;case"source":Be("error",t),r=s;break;case"img":case"image":case"link":Be("error",t),Be("load",t),r=s;break;case"details":Be("toggle",t),r=s;break;case"input":Tg(t,s),r=gh(t,s),Be("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Qe({},s,{value:void 0}),Be("invalid",t);break;case"textarea":Cg(t,s),r=vh(t,s),Be("invalid",t);break;default:r=s}wh(n,r),l=r;for(o in l)if(l.hasOwnProperty(o)){var u=l[o];o==="style"?av(t,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&iv(t,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ma(t,u):typeof u=="number"&&ma(t,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(ha.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Be("scroll",t):u!=null&&Dm(t,o,u,a))}switch(n){case"input":vl(t),Ag(t,s,!1);break;case"textarea":vl(t),Pg(t);break;case"option":s.value!=null&&t.setAttribute("value",""+xr(s.value));break;case"select":t.multiple=!!s.multiple,o=s.value,o!=null?$i(t,!!s.multiple,o,!1):s.defaultValue!=null&&$i(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=_c)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Pt(e),null;case 6:if(t&&e.stateNode!=null)A_(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(J(166));if(n=Ur(ja.current),Ur(rs.current),El(e)){if(s=e.stateNode,n=e.memoizedProps,s[ns]=e,(o=s.nodeValue!==n)&&(t=dn,t!==null))switch(t.tag){case 3:Sl(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Sl(s.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[ns]=e,e.stateNode=s}return Pt(e),null;case 13:if(ze(Ke),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(He&&cn!==null&&e.mode&1&&!(e.flags&128))Gv(),Ji(),e.flags|=98560,o=!1;else if(o=El(e),s!==null&&s.dehydrated!==null){if(t===null){if(!o)throw Error(J(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(J(317));o[ns]=e}else Ji(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Pt(e),o=!1}else Vn!==null&&(nm(Vn),Vn=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Ke.current&1?mt===0&&(mt=3):Nf())),e.updateQueue!==null&&(e.flags|=4),Pt(e),null);case 4:return Xi(),Gh(t,e),t===null&&_a(e.stateNode.containerInfo),Pt(e),null;case 10:return of(e.type._context),Pt(e),null;case 17:return nn(e.type)&&wc(),Pt(e),null;case 19:if(ze(Ke),o=e.memoizedState,o===null)return Pt(e),null;if(s=(e.flags&128)!==0,a=o.rendering,a===null)if(s)Fo(o,!1);else{if(mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Ec(t),a!==null){for(e.flags|=128,Fo(o,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)o=n,t=s,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return De(Ke,Ke.current&1|2),e.child}t=t.sibling}o.tail!==null&&st()>eo&&(e.flags|=128,s=!0,Fo(o,!1),e.lanes=4194304)}else{if(!s)if(t=Ec(a),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Fo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!He)return Pt(e),null}else 2*st()-o.renderingStartTime>eo&&n!==1073741824&&(e.flags|=128,s=!0,Fo(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=st(),e.sibling=null,n=Ke.current,De(Ke,s?n&1|2:n&1),e):(Pt(e),null);case 22:case 23:return bf(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?ln&1073741824&&(Pt(e),e.subtreeFlags&6&&(e.flags|=8192)):Pt(e),null;case 24:return null;case 25:return null}throw Error(J(156,e.tag))}function Fk(t,e){switch(tf(e),e.tag){case 1:return nn(e.type)&&wc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Xi(),ze(tn),ze(Ft),df(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return uf(e),null;case 13:if(ze(Ke),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(J(340));Ji()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ze(Ke),null;case 4:return Xi(),null;case 10:return of(e.type._context),null;case 22:case 23:return bf(),null;case 24:return null;default:return null}}var Cl=!1,Mt=!1,Dk=typeof WeakSet=="function"?WeakSet:Set,se=null;function Mi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Xe(t,e,s)}else n.current=null}function Qh(t,e,n){try{n()}catch(s){Xe(t,e,s)}}var wx=!1;function Uk(t,e){if(Ph=xc,t=Mv(),Zm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,d=0,h=0,m=t,p=null;t:for(;;){for(var x;m!==n||r!==0&&m.nodeType!==3||(l=a+r),m!==o||s!==0&&m.nodeType!==3||(u=a+s),m.nodeType===3&&(a+=m.nodeValue.length),(x=m.firstChild)!==null;)p=m,m=x;for(;;){if(m===t)break t;if(p===n&&++d===r&&(l=a),p===o&&++h===s&&(u=a),(x=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=x}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Rh={focusedElem:t,selectionRange:n},xc=!1,se=e;se!==null;)if(e=se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,se=t;else for(;se!==null;){e=se;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var j=v.memoizedProps,A=v.memoizedState,w=e.stateNode,y=w.getSnapshotBeforeUpdate(e.elementType===e.type?j:Mn(e.type,j),A);w.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(R){Xe(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,se=t;break}se=e.return}return v=wx,wx=!1,v}function sa(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,o!==void 0&&Qh(e,n,o)}r=r.next}while(r!==s)}}function xu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function Jh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function C_(t){var e=t.alternate;e!==null&&(t.alternate=null,C_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ns],delete e[ba],delete e[Lh],delete e[Nk],delete e[jk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function P_(t){return t.tag===5||t.tag===3||t.tag===4}function bx(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||P_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Yh(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=_c));else if(s!==4&&(t=t.child,t!==null))for(Yh(t,e,n),t=t.sibling;t!==null;)Yh(t,e,n),t=t.sibling}function Xh(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Xh(t,e,n),t=t.sibling;t!==null;)Xh(t,e,n),t=t.sibling}var _t=null,Ln=!1;function Gs(t,e,n){for(n=n.child;n!==null;)R_(t,e,n),n=n.sibling}function R_(t,e,n){if(ss&&typeof ss.onCommitFiberUnmount=="function")try{ss.onCommitFiberUnmount(cu,n)}catch{}switch(n.tag){case 5:Mt||Mi(n,e);case 6:var s=_t,r=Ln;_t=null,Gs(t,e,n),_t=s,Ln=r,_t!==null&&(Ln?(t=_t,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):_t.removeChild(n.stateNode));break;case 18:_t!==null&&(Ln?(t=_t,n=n.stateNode,t.nodeType===8?Rd(t.parentNode,n):t.nodeType===1&&Rd(t,n),xa(t)):Rd(_t,n.stateNode));break;case 4:s=_t,r=Ln,_t=n.stateNode.containerInfo,Ln=!0,Gs(t,e,n),_t=s,Ln=r;break;case 0:case 11:case 14:case 15:if(!Mt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var o=r,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Qh(n,e,a),r=r.next}while(r!==s)}Gs(t,e,n);break;case 1:if(!Mt&&(Mi(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(l){Xe(n,e,l)}Gs(t,e,n);break;case 21:Gs(t,e,n);break;case 22:n.mode&1?(Mt=(s=Mt)||n.memoizedState!==null,Gs(t,e,n),Mt=s):Gs(t,e,n);break;default:Gs(t,e,n)}}function Nx(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Dk),e.forEach(function(s){var r=Jk.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Rn(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var o=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:_t=l.stateNode,Ln=!1;break e;case 3:_t=l.stateNode.containerInfo,Ln=!0;break e;case 4:_t=l.stateNode.containerInfo,Ln=!0;break e}l=l.return}if(_t===null)throw Error(J(160));R_(o,a,r),_t=null,Ln=!1;var u=r.alternate;u!==null&&(u.return=null),r.return=null}catch(d){Xe(r,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)O_(e,t),e=e.sibling}function O_(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Rn(e,t),Xn(t),s&4){try{sa(3,t,t.return),xu(3,t)}catch(j){Xe(t,t.return,j)}try{sa(5,t,t.return)}catch(j){Xe(t,t.return,j)}}break;case 1:Rn(e,t),Xn(t),s&512&&n!==null&&Mi(n,n.return);break;case 5:if(Rn(e,t),Xn(t),s&512&&n!==null&&Mi(n,n.return),t.flags&32){var r=t.stateNode;try{ma(r,"")}catch(j){Xe(t,t.return,j)}}if(s&4&&(r=t.stateNode,r!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&nv(r,o),bh(l,a);var d=bh(l,o);for(a=0;a<u.length;a+=2){var h=u[a],m=u[a+1];h==="style"?av(r,m):h==="dangerouslySetInnerHTML"?iv(r,m):h==="children"?ma(r,m):Dm(r,h,m,d)}switch(l){case"input":xh(r,o);break;case"textarea":sv(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var x=o.value;x!=null?$i(r,!!o.multiple,x,!1):p!==!!o.multiple&&(o.defaultValue!=null?$i(r,!!o.multiple,o.defaultValue,!0):$i(r,!!o.multiple,o.multiple?[]:"",!1))}r[ba]=o}catch(j){Xe(t,t.return,j)}}break;case 6:if(Rn(e,t),Xn(t),s&4){if(t.stateNode===null)throw Error(J(162));r=t.stateNode,o=t.memoizedProps;try{r.nodeValue=o}catch(j){Xe(t,t.return,j)}}break;case 3:if(Rn(e,t),Xn(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{xa(e.containerInfo)}catch(j){Xe(t,t.return,j)}break;case 4:Rn(e,t),Xn(t);break;case 13:Rn(e,t),Xn(t),r=t.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(_f=st())),s&4&&Nx(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Mt=(d=Mt)||h,Rn(e,t),Mt=d):Rn(e,t),Xn(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(se=t,h=t.child;h!==null;){for(m=se=h;se!==null;){switch(p=se,x=p.child,p.tag){case 0:case 11:case 14:case 15:sa(4,p,p.return);break;case 1:Mi(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){s=p,n=p.return;try{e=s,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(j){Xe(s,n,j)}}break;case 5:Mi(p,p.return);break;case 22:if(p.memoizedState!==null){kx(m);continue}}x!==null?(x.return=p,se=x):kx(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{r=m.stateNode,d?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=m.stateNode,u=m.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=ov("display",a))}catch(j){Xe(t,t.return,j)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(j){Xe(t,t.return,j)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Rn(e,t),Xn(t),s&4&&Nx(t);break;case 21:break;default:Rn(e,t),Xn(t)}}function Xn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(P_(n)){var s=n;break e}n=n.return}throw Error(J(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(ma(r,""),s.flags&=-33);var o=bx(t);Xh(t,o,r);break;case 3:case 4:var a=s.stateNode.containerInfo,l=bx(t);Yh(t,l,a);break;default:throw Error(J(161))}}catch(u){Xe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Bk(t,e,n){se=t,M_(t)}function M_(t,e,n){for(var s=(t.mode&1)!==0;se!==null;){var r=se,o=r.child;if(r.tag===22&&s){var a=r.memoizedState!==null||Cl;if(!a){var l=r.alternate,u=l!==null&&l.memoizedState!==null||Mt;l=Cl;var d=Mt;if(Cl=a,(Mt=u)&&!d)for(se=r;se!==null;)a=se,u=a.child,a.tag===22&&a.memoizedState!==null?Ix(r):u!==null?(u.return=a,se=u):Ix(r);for(;o!==null;)se=o,M_(o),o=o.sibling;se=r,Cl=l,Mt=d}jx(t)}else r.subtreeFlags&8772&&o!==null?(o.return=r,se=o):jx(t)}}function jx(t){for(;se!==null;){var e=se;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Mt||xu(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Mt)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Mn(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&lx(e,o,s);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}lx(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&xa(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}Mt||e.flags&512&&Jh(e)}catch(p){Xe(e,e.return,p)}}if(e===t){se=null;break}if(n=e.sibling,n!==null){n.return=e.return,se=n;break}se=e.return}}function kx(t){for(;se!==null;){var e=se;if(e===t){se=null;break}var n=e.sibling;if(n!==null){n.return=e.return,se=n;break}se=e.return}}function Ix(t){for(;se!==null;){var e=se;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{xu(4,e)}catch(u){Xe(e,n,u)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(u){Xe(e,r,u)}}var o=e.return;try{Jh(e)}catch(u){Xe(e,o,u)}break;case 5:var a=e.return;try{Jh(e)}catch(u){Xe(e,a,u)}}}catch(u){Xe(e,e.return,u)}if(e===t){se=null;break}var l=e.sibling;if(l!==null){l.return=e.return,se=l;break}se=e.return}}var zk=Math.ceil,Cc=Ls.ReactCurrentDispatcher,yf=Ls.ReactCurrentOwner,In=Ls.ReactCurrentBatchConfig,Pe=0,vt=null,ot=null,jt=0,ln=0,Li=Ir(0),mt=0,Ea=null,Xr=0,yu=0,vf=0,ra=null,Yt=null,_f=0,eo=1/0,gs=null,Pc=!1,Zh=null,dr=null,Pl=!1,rr=null,Rc=0,ia=0,em=null,Xl=-1,Zl=0;function Ht(){return Pe&6?st():Xl!==-1?Xl:Xl=st()}function hr(t){return t.mode&1?Pe&2&&jt!==0?jt&-jt:Ik.transition!==null?(Zl===0&&(Zl=vv()),Zl):(t=Me,t!==0||(t=window.event,t=t===void 0?16:Iv(t.type)),t):1}function Un(t,e,n,s){if(50<ia)throw ia=0,em=null,Error(J(185));qa(t,n,s),(!(Pe&2)||t!==vt)&&(t===vt&&(!(Pe&2)&&(yu|=n),mt===4&&Zs(t,jt)),sn(t,s),n===1&&Pe===0&&!(e.mode&1)&&(eo=st()+500,fu&&Sr()))}function sn(t,e){var n=t.callbackNode;I1(t,e);var s=gc(t,t===vt?jt:0);if(s===0)n!==null&&Mg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&Mg(n),e===1)t.tag===0?kk(Sx.bind(null,t)):qv(Sx.bind(null,t)),wk(function(){!(Pe&6)&&Sr()}),n=null;else{switch(_v(s)){case 1:n=qm;break;case 4:n=xv;break;case 16:n=pc;break;case 536870912:n=yv;break;default:n=pc}n=z_(n,L_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function L_(t,e){if(Xl=-1,Zl=0,Pe&6)throw Error(J(327));var n=t.callbackNode;if(zi()&&t.callbackNode!==n)return null;var s=gc(t,t===vt?jt:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Oc(t,s);else{e=s;var r=Pe;Pe|=2;var o=$_();(vt!==t||jt!==e)&&(gs=null,eo=st()+500,qr(t,e));do try{Wk();break}catch(l){V_(t,l)}while(!0);rf(),Cc.current=o,Pe=r,ot!==null?e=0:(vt=null,jt=0,e=mt)}if(e!==0){if(e===2&&(r=Sh(t),r!==0&&(s=r,e=tm(t,r))),e===1)throw n=Ea,qr(t,0),Zs(t,s),sn(t,st()),n;if(e===6)Zs(t,s);else{if(r=t.current.alternate,!(s&30)&&!Hk(r)&&(e=Oc(t,s),e===2&&(o=Sh(t),o!==0&&(s=o,e=tm(t,o))),e===1))throw n=Ea,qr(t,0),Zs(t,s),sn(t,st()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(J(345));case 2:Lr(t,Yt,gs);break;case 3:if(Zs(t,s),(s&130023424)===s&&(e=_f+500-st(),10<e)){if(gc(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Ht(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Mh(Lr.bind(null,t,Yt,gs),e);break}Lr(t,Yt,gs);break;case 4:if(Zs(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var a=31-Dn(s);o=1<<a,a=e[a],a>r&&(r=a),s&=~o}if(s=r,s=st()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*zk(s/1960))-s,10<s){t.timeoutHandle=Mh(Lr.bind(null,t,Yt,gs),s);break}Lr(t,Yt,gs);break;case 5:Lr(t,Yt,gs);break;default:throw Error(J(329))}}}return sn(t,st()),t.callbackNode===n?L_.bind(null,t):null}function tm(t,e){var n=ra;return t.current.memoizedState.isDehydrated&&(qr(t,e).flags|=256),t=Oc(t,e),t!==2&&(e=Yt,Yt=n,e!==null&&nm(e)),t}function nm(t){Yt===null?Yt=t:Yt.push.apply(Yt,t)}function Hk(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],o=r.getSnapshot;r=r.value;try{if(!zn(o(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zs(t,e){for(e&=~vf,e&=~yu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Dn(e),s=1<<n;t[n]=-1,e&=~s}}function Sx(t){if(Pe&6)throw Error(J(327));zi();var e=gc(t,0);if(!(e&1))return sn(t,st()),null;var n=Oc(t,e);if(t.tag!==0&&n===2){var s=Sh(t);s!==0&&(e=s,n=tm(t,s))}if(n===1)throw n=Ea,qr(t,0),Zs(t,e),sn(t,st()),n;if(n===6)throw Error(J(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Lr(t,Yt,gs),sn(t,st()),null}function wf(t,e){var n=Pe;Pe|=1;try{return t(e)}finally{Pe=n,Pe===0&&(eo=st()+500,fu&&Sr())}}function Zr(t){rr!==null&&rr.tag===0&&!(Pe&6)&&zi();var e=Pe;Pe|=1;var n=In.transition,s=Me;try{if(In.transition=null,Me=1,t)return t()}finally{Me=s,In.transition=n,Pe=e,!(Pe&6)&&Sr()}}function bf(){ln=Li.current,ze(Li)}function qr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_k(n)),ot!==null)for(n=ot.return;n!==null;){var s=n;switch(tf(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&wc();break;case 3:Xi(),ze(tn),ze(Ft),df();break;case 5:uf(s);break;case 4:Xi();break;case 13:ze(Ke);break;case 19:ze(Ke);break;case 10:of(s.type._context);break;case 22:case 23:bf()}n=n.return}if(vt=t,ot=t=mr(t.current,null),jt=ln=e,mt=0,Ea=null,vf=yu=Xr=0,Yt=ra=null,Dr!==null){for(e=0;e<Dr.length;e++)if(n=Dr[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,o=n.pending;if(o!==null){var a=o.next;o.next=r,s.next=a}n.pending=s}Dr=null}return t}function V_(t,e){do{var n=ot;try{if(rf(),Ql.current=Ac,Tc){for(var s=Ge.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Tc=!1}if(Yr=0,yt=ht=Ge=null,na=!1,ka=0,yf.current=null,n===null||n.return===null){mt=1,Ea=e,ot=null;break}e:{var o=t,a=n.return,l=n,u=e;if(e=jt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=fx(a);if(x!==null){x.flags&=-257,px(x,a,l,o,e),x.mode&1&&mx(o,d,e),e=x,u=d;var v=e.updateQueue;if(v===null){var j=new Set;j.add(u),e.updateQueue=j}else v.add(u);break e}else{if(!(e&1)){mx(o,d,e),Nf();break e}u=Error(J(426))}}else if(He&&l.mode&1){var A=fx(a);if(A!==null){!(A.flags&65536)&&(A.flags|=256),px(A,a,l,o,e),nf(Zi(u,l));break e}}o=u=Zi(u,l),mt!==4&&(mt=2),ra===null?ra=[o]:ra.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var w=__(o,u,e);ax(o,w);break e;case 1:l=u;var y=o.type,E=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(dr===null||!dr.has(E)))){o.flags|=65536,e&=-e,o.lanes|=e;var R=w_(o,l,e);ax(o,R);break e}}o=o.return}while(o!==null)}D_(n)}catch($){e=$,ot===n&&n!==null&&(ot=n=n.return);continue}break}while(!0)}function $_(){var t=Cc.current;return Cc.current=Ac,t===null?Ac:t}function Nf(){(mt===0||mt===3||mt===2)&&(mt=4),vt===null||!(Xr&268435455)&&!(yu&268435455)||Zs(vt,jt)}function Oc(t,e){var n=Pe;Pe|=2;var s=$_();(vt!==t||jt!==e)&&(gs=null,qr(t,e));do try{qk();break}catch(r){V_(t,r)}while(!0);if(rf(),Pe=n,Cc.current=s,ot!==null)throw Error(J(261));return vt=null,jt=0,mt}function qk(){for(;ot!==null;)F_(ot)}function Wk(){for(;ot!==null&&!x1();)F_(ot)}function F_(t){var e=B_(t.alternate,t,ln);t.memoizedProps=t.pendingProps,e===null?D_(t):ot=e,yf.current=null}function D_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Fk(n,e),n!==null){n.flags&=32767,ot=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{mt=6,ot=null;return}}else if(n=$k(n,e,ln),n!==null){ot=n;return}if(e=e.sibling,e!==null){ot=e;return}ot=e=t}while(e!==null);mt===0&&(mt=5)}function Lr(t,e,n){var s=Me,r=In.transition;try{In.transition=null,Me=1,Kk(t,e,n,s)}finally{In.transition=r,Me=s}return null}function Kk(t,e,n,s){do zi();while(rr!==null);if(Pe&6)throw Error(J(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(J(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(S1(t,o),t===vt&&(ot=vt=null,jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Pl||(Pl=!0,z_(pc,function(){return zi(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=In.transition,In.transition=null;var a=Me;Me=1;var l=Pe;Pe|=4,yf.current=null,Uk(t,n),O_(n,t),mk(Rh),xc=!!Ph,Rh=Ph=null,t.current=n,Bk(n),y1(),Pe=l,Me=a,In.transition=o}else t.current=n;if(Pl&&(Pl=!1,rr=t,Rc=r),o=t.pendingLanes,o===0&&(dr=null),w1(n.stateNode),sn(t,st()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Pc)throw Pc=!1,t=Zh,Zh=null,t;return Rc&1&&t.tag!==0&&zi(),o=t.pendingLanes,o&1?t===em?ia++:(ia=0,em=t):ia=0,Sr(),null}function zi(){if(rr!==null){var t=_v(Rc),e=In.transition,n=Me;try{if(In.transition=null,Me=16>t?16:t,rr===null)var s=!1;else{if(t=rr,rr=null,Rc=0,Pe&6)throw Error(J(331));var r=Pe;for(Pe|=4,se=t.current;se!==null;){var o=se,a=o.child;if(se.flags&16){var l=o.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(se=d;se!==null;){var h=se;switch(h.tag){case 0:case 11:case 15:sa(8,h,o)}var m=h.child;if(m!==null)m.return=h,se=m;else for(;se!==null;){h=se;var p=h.sibling,x=h.return;if(C_(h),h===d){se=null;break}if(p!==null){p.return=x,se=p;break}se=x}}}var v=o.alternate;if(v!==null){var j=v.child;if(j!==null){v.child=null;do{var A=j.sibling;j.sibling=null,j=A}while(j!==null)}}se=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,se=a;else e:for(;se!==null;){if(o=se,o.flags&2048)switch(o.tag){case 0:case 11:case 15:sa(9,o,o.return)}var w=o.sibling;if(w!==null){w.return=o.return,se=w;break e}se=o.return}}var y=t.current;for(se=y;se!==null;){a=se;var E=a.child;if(a.subtreeFlags&2064&&E!==null)E.return=a,se=E;else e:for(a=y;se!==null;){if(l=se,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:xu(9,l)}}catch($){Xe(l,l.return,$)}if(l===a){se=null;break e}var R=l.sibling;if(R!==null){R.return=l.return,se=R;break e}se=l.return}}if(Pe=r,Sr(),ss&&typeof ss.onPostCommitFiberRoot=="function")try{ss.onPostCommitFiberRoot(cu,t)}catch{}s=!0}return s}finally{Me=n,In.transition=e}}return!1}function Ex(t,e,n){e=Zi(n,e),e=__(t,e,1),t=ur(t,e,1),e=Ht(),t!==null&&(qa(t,1,e),sn(t,e))}function Xe(t,e,n){if(t.tag===3)Ex(t,t,n);else for(;e!==null;){if(e.tag===3){Ex(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(dr===null||!dr.has(s))){t=Zi(n,t),t=w_(e,t,1),e=ur(e,t,1),t=Ht(),e!==null&&(qa(e,1,t),sn(e,t));break}}e=e.return}}function Gk(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Ht(),t.pingedLanes|=t.suspendedLanes&n,vt===t&&(jt&n)===n&&(mt===4||mt===3&&(jt&130023424)===jt&&500>st()-_f?qr(t,0):vf|=n),sn(t,e)}function U_(t,e){e===0&&(t.mode&1?(e=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):e=1);var n=Ht();t=Ts(t,e),t!==null&&(qa(t,e,n),sn(t,n))}function Qk(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),U_(t,n)}function Jk(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(J(314))}s!==null&&s.delete(e),U_(t,n)}var B_;B_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||tn.current)Zt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Zt=!1,Vk(t,e,n);Zt=!!(t.flags&131072)}else Zt=!1,He&&e.flags&1048576&&Wv(e,jc,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Yl(t,e),t=e.pendingProps;var r=Qi(e,Ft.current);Bi(e,n),r=mf(null,e,s,t,r,n);var o=ff();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,nn(s)?(o=!0,bc(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,lf(e),r.updater=gu,e.stateNode=r,r._reactInternals=e,Bh(e,s,t,n),e=qh(null,e,s,!0,o,n)):(e.tag=0,He&&o&&ef(e),Bt(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Yl(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=Xk(s),t=Mn(s,t),r){case 0:e=Hh(null,e,s,t,n);break e;case 1:e=yx(null,e,s,t,n);break e;case 11:e=gx(null,e,s,t,n);break e;case 14:e=xx(null,e,s,Mn(s.type,t),n);break e}throw Error(J(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Mn(s,r),Hh(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Mn(s,r),yx(t,e,s,r,n);case 3:e:{if(k_(e),t===null)throw Error(J(387));s=e.pendingProps,o=e.memoizedState,r=o.element,Xv(t,e),Sc(e,s,null,n);var a=e.memoizedState;if(s=a.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=Zi(Error(J(423)),e),e=vx(t,e,s,n,r);break e}else if(s!==r){r=Zi(Error(J(424)),e),e=vx(t,e,s,n,r);break e}else for(cn=cr(e.stateNode.containerInfo.firstChild),dn=e,He=!0,Vn=null,n=Jv(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ji(),s===r){e=As(t,e,n);break e}Bt(t,e,s,n)}e=e.child}return e;case 5:return Zv(e),t===null&&Fh(e),s=e.type,r=e.pendingProps,o=t!==null?t.memoizedProps:null,a=r.children,Oh(s,r)?a=null:o!==null&&Oh(s,o)&&(e.flags|=32),j_(t,e),Bt(t,e,a,n),e.child;case 6:return t===null&&Fh(e),null;case 13:return I_(t,e,n);case 4:return cf(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Yi(e,null,s,n):Bt(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Mn(s,r),gx(t,e,s,r,n);case 7:return Bt(t,e,e.pendingProps,n),e.child;case 8:return Bt(t,e,e.pendingProps.children,n),e.child;case 12:return Bt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,o=e.memoizedProps,a=r.value,De(kc,s._currentValue),s._currentValue=a,o!==null)if(zn(o.value,a)){if(o.children===r.children&&!tn.current){e=As(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){a=o.child;for(var u=l.firstContext;u!==null;){if(u.context===s){if(o.tag===1){u=js(-1,n&-n),u.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Dh(o.return,n,e),l.lanes|=n;break}u=u.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(J(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),Dh(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Bt(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Bi(e,n),r=Tn(r),s=s(r),e.flags|=1,Bt(t,e,s,n),e.child;case 14:return s=e.type,r=Mn(s,e.pendingProps),r=Mn(s.type,r),xx(t,e,s,r,n);case 15:return b_(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Mn(s,r),Yl(t,e),e.tag=1,nn(s)?(t=!0,bc(e)):t=!1,Bi(e,n),v_(e,s,r),Bh(e,s,r,n),qh(null,e,s,!0,t,n);case 19:return S_(t,e,n);case 22:return N_(t,e,n)}throw Error(J(156,e.tag))};function z_(t,e){return gv(t,e)}function Yk(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(t,e,n,s){return new Yk(t,e,n,s)}function jf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Xk(t){if(typeof t=="function")return jf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Bm)return 11;if(t===zm)return 14}return 2}function mr(t,e){var n=t.alternate;return n===null?(n=kn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ec(t,e,n,s,r,o){var a=2;if(s=t,typeof t=="function")jf(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ii:return Wr(n.children,r,o,e);case Um:a=8,r|=8;break;case hh:return t=kn(12,n,e,r|2),t.elementType=hh,t.lanes=o,t;case mh:return t=kn(13,n,e,r),t.elementType=mh,t.lanes=o,t;case fh:return t=kn(19,n,e,r),t.elementType=fh,t.lanes=o,t;case Zy:return vu(n,r,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Yy:a=10;break e;case Xy:a=9;break e;case Bm:a=11;break e;case zm:a=14;break e;case Js:a=16,s=null;break e}throw Error(J(130,t==null?t:typeof t,""))}return e=kn(a,n,e,r),e.elementType=t,e.type=s,e.lanes=o,e}function Wr(t,e,n,s){return t=kn(7,t,s,e),t.lanes=n,t}function vu(t,e,n,s){return t=kn(22,t,s,e),t.elementType=Zy,t.lanes=n,t.stateNode={isHidden:!1},t}function Ud(t,e,n){return t=kn(6,t,null,e),t.lanes=n,t}function Bd(t,e,n){return e=kn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Zk(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bd(0),this.expirationTimes=bd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bd(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function kf(t,e,n,s,r,o,a,l,u){return t=new Zk(t,e,n,l,u),e===1?(e=1,o===!0&&(e|=8)):e=0,o=kn(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},lf(o),t}function eI(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ki,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function H_(t){if(!t)return yr;t=t._reactInternals;e:{if(li(t)!==t||t.tag!==1)throw Error(J(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(nn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(J(171))}if(t.tag===1){var n=t.type;if(nn(n))return Hv(t,n,e)}return e}function q_(t,e,n,s,r,o,a,l,u){return t=kf(n,s,!0,t,r,o,a,l,u),t.context=H_(null),n=t.current,s=Ht(),r=hr(n),o=js(s,r),o.callback=e??null,ur(n,o,r),t.current.lanes=r,qa(t,r,s),sn(t,s),t}function _u(t,e,n,s){var r=e.current,o=Ht(),a=hr(r);return n=H_(n),e.context===null?e.context=n:e.pendingContext=n,e=js(o,a),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=ur(r,e,a),t!==null&&(Un(t,r,a,o),Gl(t,r,a)),a}function Mc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Tx(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function If(t,e){Tx(t,e),(t=t.alternate)&&Tx(t,e)}function tI(){return null}var W_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Sf(t){this._internalRoot=t}wu.prototype.render=Sf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(J(409));_u(t,e,null,null)};wu.prototype.unmount=Sf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zr(function(){_u(null,t,null,null)}),e[Es]=null}};function wu(t){this._internalRoot=t}wu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Nv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Xs.length&&e!==0&&e<Xs[n].priority;n++);Xs.splice(n,0,t),n===0&&kv(t)}};function Ef(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function bu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ax(){}function nI(t,e,n,s,r){if(r){if(typeof s=="function"){var o=s;s=function(){var d=Mc(a);o.call(d)}}var a=q_(e,s,t,0,null,!1,!1,"",Ax);return t._reactRootContainer=a,t[Es]=a.current,_a(t.nodeType===8?t.parentNode:t),Zr(),a}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var l=s;s=function(){var d=Mc(u);l.call(d)}}var u=kf(t,0,!1,null,null,!1,!1,"",Ax);return t._reactRootContainer=u,t[Es]=u.current,_a(t.nodeType===8?t.parentNode:t),Zr(function(){_u(e,u,n,s)}),u}function Nu(t,e,n,s,r){var o=n._reactRootContainer;if(o){var a=o;if(typeof r=="function"){var l=r;r=function(){var u=Mc(a);l.call(u)}}_u(e,a,t,r)}else a=nI(n,e,t,r,s);return Mc(a)}wv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=zo(e.pendingLanes);n!==0&&(Wm(e,n|1),sn(e,st()),!(Pe&6)&&(eo=st()+500,Sr()))}break;case 13:Zr(function(){var s=Ts(t,1);if(s!==null){var r=Ht();Un(s,t,1,r)}}),If(t,1)}};Km=function(t){if(t.tag===13){var e=Ts(t,134217728);if(e!==null){var n=Ht();Un(e,t,134217728,n)}If(t,134217728)}};bv=function(t){if(t.tag===13){var e=hr(t),n=Ts(t,e);if(n!==null){var s=Ht();Un(n,t,e,s)}If(t,e)}};Nv=function(){return Me};jv=function(t,e){var n=Me;try{return Me=t,e()}finally{Me=n}};jh=function(t,e,n){switch(e){case"input":if(xh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=mu(s);if(!r)throw Error(J(90));tv(s),xh(s,r)}}}break;case"textarea":sv(t,n);break;case"select":e=n.value,e!=null&&$i(t,!!n.multiple,e,!1)}};uv=wf;dv=Zr;var sI={usingClientEntryPoint:!1,Events:[Ka,Ai,mu,lv,cv,wf]},Do={findFiberByHostInstance:Fr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rI={bundleType:Do.bundleType,version:Do.version,rendererPackageName:Do.rendererPackageName,rendererConfig:Do.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ls.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=fv(t),t===null?null:t.stateNode},findFiberByHostInstance:Do.findFiberByHostInstance||tI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rl.isDisabled&&Rl.supportsFiber)try{cu=Rl.inject(rI),ss=Rl}catch{}}pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sI;pn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ef(e))throw Error(J(200));return eI(t,e,null,n)};pn.createRoot=function(t,e){if(!Ef(t))throw Error(J(299));var n=!1,s="",r=W_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=kf(t,1,!1,null,null,n,!1,s,r),t[Es]=e.current,_a(t.nodeType===8?t.parentNode:t),new Sf(e)};pn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(J(188)):(t=Object.keys(t).join(","),Error(J(268,t)));return t=fv(e),t=t===null?null:t.stateNode,t};pn.flushSync=function(t){return Zr(t)};pn.hydrate=function(t,e,n){if(!bu(e))throw Error(J(200));return Nu(null,t,e,!0,n)};pn.hydrateRoot=function(t,e,n){if(!Ef(t))throw Error(J(405));var s=n!=null&&n.hydratedSources||null,r=!1,o="",a=W_;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=q_(e,null,t,1,n??null,r,!1,o,a),t[Es]=e.current,_a(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new wu(e)};pn.render=function(t,e,n){if(!bu(e))throw Error(J(200));return Nu(null,t,e,!1,n)};pn.unmountComponentAtNode=function(t){if(!bu(t))throw Error(J(40));return t._reactRootContainer?(Zr(function(){Nu(null,null,t,!1,function(){t._reactRootContainer=null,t[Es]=null})}),!0):!1};pn.unstable_batchedUpdates=wf;pn.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!bu(n))throw Error(J(200));if(t==null||t._reactInternals===void 0)throw Error(J(38));return Nu(t,e,n,!1,s)};pn.version="18.3.1-next-f1338f8080-20240426";function K_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(K_)}catch(t){console.error(t)}}K_(),Ky.exports=pn;var iI=Ky.exports,Cx=iI;uh.createRoot=Cx.createRoot,uh.hydrateRoot=Cx.hydrateRoot;const ci=`
   AI   "PetMedical.AI"   .
     .

-   , ()  .
-  ,        .
-      "" ,    .
-   ,    .
-    JSON  .     .
`,qt=t=>({dog:"",cat:"",rabbit:"",hamster:"",bird:"",hedgehog:"",reptile:"",etc:" ",other:" "})[t]||t||"",Vt={GEMINI:"gemini",OPENAI:"openai",ANTHROPIC:"anthropic"},xn=t=>{switch(t){case Vt.GEMINI:return null;case Vt.OPENAI:return null;case Vt.ANTHROPIC:return null;default:return null}},oI=async(t,e)=>{var r;const n=xn(Vt.GEMINI);if(!n)throw new Error("Gemini API   .  > API   .");const s=`${ci}

 "CS Agent ( )".

[]
-   /   .
- ,  ,       .
-    1 . (,    Medical Agent Triage Engine )
-       .

[  ]
- pet_profile:   
- user_description:      

 :
- : ${t.petName}
- : ${qt(t.species)}
- : ${t.breed||""}
- : ${t.age||""}
${t.weight?`- : ${t.weight}kg`:""}

  :
${e.symptomText||"  "}

${((r=e.images)==null?void 0:r.length)>0?` ${e.images.length} .`:""}

[  - JSON ONLY]
  :

{
  "summary_kor": "      (, 3~5)",
  "key_symptoms": ["  1", "  2"],
  "onset": "      (: 3 ,   )",
  "duration": "   (: 3 ,   )",
  "suspected_body_parts": ["", "", "", "", "", "/"    ],
  "first_urgency_assessment": "low | moderate | high | emergency  ",
  "missing_information": ["    1", "    2"],
  "next_step_brief": " ,     "
}

:
-   ,   'moderate' .
-   JSON  .`;try{const o=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:s}]}]})});if(!o.ok)throw new Error(`Gemini API : ${o.status}`);const u=(await o.json()).candidates[0].content.parts[0].text.match(/\{[\s\S]*\}/);if(u){const d=JSON.parse(u[0]);return{json:d,message:`, ${t.petName} .

 .

 :
 : ${t.petName}
 : ${qt(t.species)}
 : ${t.breed||""}

: ${d.summary_kor}

   .`}}throw new Error("JSON  ")}catch(o){return console.error("CS Agent :",o),{json:{summary_kor:`${t.petName}   .`,key_symptoms:[],onset:"  ",duration:"  ",suspected_body_parts:[],first_urgency_assessment:"moderate",missing_information:[],next_step_brief:"AI      ."},message:`, ${t.petName} .

 .

   .`}}},aI=async(t,e,n)=>{var u;const s=(e.symptomText||"").toLowerCase(),r=[],o=[],a=[];(s.includes("")||s.includes(""))&&(r.push(" "),o.push(""),a.push("")),(s.includes("")||s.includes("")||s.includes(""))&&(r.push(" "),o.push(""),a.push("")),(s.includes("")||s.includes("")||s.includes(""))&&(r.push(" "),o.push(""),a.push("")),(s.includes("")||s.includes(""))&&(r.push(" "),o.push(""),a.push(""));const l=(n==null?void 0:n.first_urgency_assessment)==="emergency"||(n==null?void 0:n.first_urgency_assessment)==="high"?"high":(n==null?void 0:n.first_urgency_assessment)==="moderate"?"medium":"low";return{json:{symptom_keywords:r.length>0?r:[" "],body_part_focus:o.length>0?o:[""],severity_hint:l,possible_categories:a.length>0?a:[" "],related_past_cases_summary:"",notes_for_medical_agent:`   . ${r.join(", ")}   . Medical Agent   .`},message:`   .

${((u=e.images)==null?void 0:u.length)>0?`    .
`:""}   .
    .

    .`}},lI=()=>{};var Px={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},cI=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const o=t[n++];e[s++]=String.fromCharCode((r&31)<<6|o&63)}else if(r>239&&r<365){const o=t[n++],a=t[n++],l=t[n++],u=((r&7)<<18|(o&63)<<12|(a&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(u>>10)),e[s++]=String.fromCharCode(56320+(u&1023))}else{const o=t[n++],a=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(o&63)<<6|a&63)}}return e.join("")},Q_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const o=t[r],a=r+1<t.length,l=a?t[r+1]:0,u=r+2<t.length,d=u?t[r+2]:0,h=o>>2,m=(o&3)<<4|l>>4;let p=(l&15)<<2|d>>6,x=d&63;u||(x=64,a||(p=64)),s.push(n[h],n[m],n[p],n[x])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(G_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):cI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const o=n[t.charAt(r++)],l=r<t.length?n[t.charAt(r)]:0;++r;const d=r<t.length?n[t.charAt(r)]:64;++r;const m=r<t.length?n[t.charAt(r)]:64;if(++r,o==null||l==null||d==null||m==null)throw new uI;const p=o<<2|l>>4;if(s.push(p),d!==64){const x=l<<4&240|d>>2;if(s.push(x),m!==64){const v=d<<6&192|m;s.push(v)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class uI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const dI=function(t){const e=G_(t);return Q_.encodeByteArray(e,!0)},Lc=function(t){return dI(t).replace(/\./g,"")},J_=function(t){try{return Q_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI=()=>hI().__FIREBASE_DEFAULTS__,fI=()=>{if(typeof process>"u"||typeof Px>"u")return;const t=Px.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},pI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&J_(t[1]);return e&&JSON.parse(e)},ju=()=>{try{return lI()||mI()||fI()||pI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Y_=t=>{var e,n;return(n=(e=ju())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},X_=t=>{const e=Y_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Z_=()=>{var t;return(t=ju())==null?void 0:t.config},ew=t=>{var e;return(e=ju())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Tf(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Lc(JSON.stringify(n)),Lc(JSON.stringify(a)),""].join(".")}const oa={};function xI(){const t={prod:[],emulator:[]};for(const e of Object.keys(oa))oa[e]?t.emulator.push(e):t.prod.push(e);return t}function yI(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Rx=!1;function Af(t,e){if(typeof window>"u"||typeof document>"u"||!ui(window.location.host)||oa[t]===e||oa[t]||Rx)return;oa[t]=e;function n(p){return`__firebase__banner__${p}`}const s="__firebase__banner",o=xI().prod.length>0;function a(){const p=document.getElementById(s);p&&p.remove()}function l(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function u(p,x){p.setAttribute("width","24"),p.setAttribute("id",x),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Rx=!0,a()},p}function h(p,x){p.setAttribute("id",x),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function m(){const p=yI(s),x=n("text"),v=document.getElementById(x)||document.createElement("span"),j=n("learnmore"),A=document.getElementById(j)||document.createElement("a"),w=n("preprendIcon"),y=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const E=p.element;l(E),h(A,j);const R=d();u(y,w),E.append(y,v,A,R),document.body.appendChild(E)}o?(v.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dt())}function _I(){var e;const t=(e=ju())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function bI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function NI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jI(){const t=Dt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function kI(){return!_I()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nw(){try{return typeof indexedDB=="object"}catch{return!1}}function sw(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var o;e(((o=r.error)==null?void 0:o.message)||"")}}catch(n){e(n)}})}function II(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI="FirebaseError";class Kn extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=SI,Object.setPrototypeOf(this,Kn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,di.prototype.create)}}class di{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,o=this.errors[e],a=o?EI(o,s):"Error",l=`${this.serviceName}: ${a} (${r}).`;return new Kn(r,l,s)}}function EI(t,e){return t.replace(TI,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const TI=/\{\$([^}]+)}/g;function AI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ei(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const o=t[r],a=e[r];if(Ox(o)&&Ox(a)){if(!ei(o,a))return!1}else if(o!==a)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function Ox(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qa(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function qo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,o]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function Wo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function CI(t,e){const n=new PI(t,e);return n.subscribe.bind(n)}class PI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");RI(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=zd),r.error===void 0&&(r.error=zd),r.complete===void 0&&(r.complete=zd);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function RI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function zd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(t){return t&&t._delegate?t._delegate:t}class Cn{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new gI;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(LI(e))try{this.getOrInitializeService({instanceIdentifier:Vr})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:r});s.resolve(o)}catch{}}}}clearInstance(e=Vr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vr){return this.instances.has(e)}getOptions(e=Vr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[o,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);s===l&&a.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const o=this.instances.get(s);return o&&e(o,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:MI(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Vr){return this.component?this.component.multipleInstances?e:Vr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function MI(t){return t===Vr?void 0:t}function LI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new OI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ie||(Ie={}));const $I={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},FI=Ie.INFO,DI={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},UI=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=DI[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Cf{constructor(e){this.name=e,this._logLevel=FI,this._logHandler=UI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$I[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const BI=(t,e)=>e.some(n=>t instanceof n);let Mx,Lx;function zI(){return Mx||(Mx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HI(){return Lx||(Lx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const rw=new WeakMap,sm=new WeakMap,iw=new WeakMap,Hd=new WeakMap,Pf=new WeakMap;function qI(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",o),t.removeEventListener("error",a)},o=()=>{n(ks(t.result)),r()},a=()=>{s(t.error),r()};t.addEventListener("success",o),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&rw.set(n,t)}).catch(()=>{}),Pf.set(e,t),e}function WI(t){if(sm.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",a),t.removeEventListener("abort",a)},o=()=>{n(),r()},a=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",o),t.addEventListener("error",a),t.addEventListener("abort",a)});sm.set(t,e)}let rm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return sm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||iw.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ks(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function KI(t){rm=t(rm)}function GI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(qd(this),e,...n);return iw.set(s,e.sort?e.sort():[e]),ks(s)}:HI().includes(t)?function(...e){return t.apply(qd(this),e),ks(rw.get(this))}:function(...e){return ks(t.apply(qd(this),e))}}function QI(t){return typeof t=="function"?GI(t):(t instanceof IDBTransaction&&WI(t),BI(t,zI())?new Proxy(t,rm):t)}function ks(t){if(t instanceof IDBRequest)return qI(t);if(Hd.has(t))return Hd.get(t);const e=QI(t);return e!==t&&(Hd.set(t,e),Pf.set(e,t)),e}const qd=t=>Pf.get(t);function ku(t,e,{blocked:n,upgrade:s,blocking:r,terminated:o}={}){const a=indexedDB.open(t,e),l=ks(a);return s&&a.addEventListener("upgradeneeded",u=>{s(ks(a.result),u.oldVersion,u.newVersion,ks(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{o&&u.addEventListener("close",()=>o()),r&&u.addEventListener("versionchange",d=>r(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}function Wd(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",s=>e(s.oldVersion,s)),ks(n).then(()=>{})}const JI=["get","getKey","getAll","getAllKeys","count"],YI=["put","add","delete","clear"],Kd=new Map;function Vx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Kd.get(e))return Kd.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=YI.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||JI.includes(n)))return;const o=async function(a,...l){const u=this.transaction(a,r?"readwrite":"readonly");let d=u.store;return s&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),r&&u.done]))[0]};return Kd.set(e,o),o}KI(t=>({...t,get:(e,n,s)=>Vx(e,n)||t.get(e,n,s),has:(e,n)=>!!Vx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(ZI(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function ZI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const im="@firebase/app",$x="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=new Cf("@firebase/app"),eS="@firebase/app-compat",tS="@firebase/analytics-compat",nS="@firebase/analytics",sS="@firebase/app-check-compat",rS="@firebase/app-check",iS="@firebase/auth",oS="@firebase/auth-compat",aS="@firebase/database",lS="@firebase/data-connect",cS="@firebase/database-compat",uS="@firebase/functions",dS="@firebase/functions-compat",hS="@firebase/installations",mS="@firebase/installations-compat",fS="@firebase/messaging",pS="@firebase/messaging-compat",gS="@firebase/performance",xS="@firebase/performance-compat",yS="@firebase/remote-config",vS="@firebase/remote-config-compat",_S="@firebase/storage",wS="@firebase/storage-compat",bS="@firebase/firestore",NS="@firebase/ai",jS="@firebase/firestore-compat",kS="firebase",IS="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="[DEFAULT]",SS={[im]:"fire-core",[eS]:"fire-core-compat",[nS]:"fire-analytics",[tS]:"fire-analytics-compat",[rS]:"fire-app-check",[sS]:"fire-app-check-compat",[iS]:"fire-auth",[oS]:"fire-auth-compat",[aS]:"fire-rtdb",[lS]:"fire-data-connect",[cS]:"fire-rtdb-compat",[uS]:"fire-fn",[dS]:"fire-fn-compat",[hS]:"fire-iid",[mS]:"fire-iid-compat",[fS]:"fire-fcm",[pS]:"fire-fcm-compat",[gS]:"fire-perf",[xS]:"fire-perf-compat",[yS]:"fire-rc",[vS]:"fire-rc-compat",[_S]:"fire-gcs",[wS]:"fire-gcs-compat",[bS]:"fire-fst",[jS]:"fire-fst-compat",[NS]:"fire-vertex","fire-js":"fire-js",[kS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc=new Map,ES=new Map,am=new Map;function Fx(t,e){try{t.container.addComponent(e)}catch(n){Cs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Hn(t){const e=t.name;if(am.has(e))return Cs.debug(`There were multiple attempts to register component ${e}.`),!1;am.set(e,t);for(const n of Vc.values())Fx(n,t);for(const n of ES.values())Fx(n,t);return!0}function hi(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function zt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fr=new di("app","Firebase",TS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Cn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi=IS;function ow(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:om,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw fr.create("bad-app-name",{appName:String(r)});if(n||(n=Z_()),!n)throw fr.create("no-options");const o=Vc.get(r);if(o){if(ei(n,o.options)&&ei(s,o.config))return o;throw fr.create("duplicate-app",{appName:r})}const a=new VI(r);for(const u of am.values())a.addComponent(u);const l=new AS(n,s,a);return Vc.set(r,l),l}function Iu(t=om){const e=Vc.get(t);if(!e&&t===om&&Z_())return ow();if(!e)throw fr.create("no-app",{appName:t});return e}function rn(t,e,n){let s=SS[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${s}" with version "${e}":`];r&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cs.warn(a.join(" "));return}Hn(new Cn(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="firebase-heartbeat-database",PS=1,Ta="firebase-heartbeat-store";let Gd=null;function aw(){return Gd||(Gd=ku(CS,PS,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ta)}catch(n){console.warn(n)}}}}).catch(t=>{throw fr.create("idb-open",{originalErrorMessage:t.message})})),Gd}async function RS(t){try{const n=(await aw()).transaction(Ta),s=await n.objectStore(Ta).get(lw(t));return await n.done,s}catch(e){if(e instanceof Kn)Cs.warn(e.message);else{const n=fr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Cs.warn(n.message)}}}async function Dx(t,e){try{const s=(await aw()).transaction(Ta,"readwrite");await s.objectStore(Ta).put(e,lw(t)),await s.done}catch(n){if(n instanceof Kn)Cs.warn(n.message);else{const s=fr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Cs.warn(s.message)}}}function lw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=1024,MS=30;class LS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new $S(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Ux();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:r}),this._heartbeatsCache.heartbeats.length>MS){const a=FS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Cs.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ux(),{heartbeatsToSend:s,unsentEntries:r}=VS(this._heartbeatsCache.heartbeats),o=Lc(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Cs.warn(n),""}}}function Ux(){return new Date().toISOString().substring(0,10)}function VS(t,e=OS){const n=[];let s=t.slice();for(const r of t){const o=n.find(a=>a.agent===r.agent);if(o){if(o.dates.push(r.date),Bx(n)>e){o.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Bx(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class $S{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nw()?sw().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await RS(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Dx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Dx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Bx(t){return Lc(JSON.stringify({version:2,heartbeats:t})).length}function FS(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(t){Hn(new Cn("platform-logger",e=>new XI(e),"PRIVATE")),Hn(new Cn("heartbeat",e=>new LS(e),"PRIVATE")),rn(im,$x,t),rn(im,$x,"esm2020"),rn("fire-js","")}DS("");var US="firebase",BS="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rn(US,BS,"app");var zx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var pr,cw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(_,b){function S(){}S.prototype=b.prototype,_.F=b.prototype,_.prototype=new S,_.prototype.constructor=_,_.D=function(I,C,P){for(var N=Array(arguments.length-2),O=2;O<arguments.length;O++)N[O-2]=arguments[O];return b.prototype[C].apply(I,N)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,n),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(_,b,S){S||(S=0);const I=Array(16);if(typeof b=="string")for(var C=0;C<16;++C)I[C]=b.charCodeAt(S++)|b.charCodeAt(S++)<<8|b.charCodeAt(S++)<<16|b.charCodeAt(S++)<<24;else for(C=0;C<16;++C)I[C]=b[S++]|b[S++]<<8|b[S++]<<16|b[S++]<<24;b=_.g[0],S=_.g[1],C=_.g[2];let P=_.g[3],N;N=b+(P^S&(C^P))+I[0]+3614090360&4294967295,b=S+(N<<7&4294967295|N>>>25),N=P+(C^b&(S^C))+I[1]+3905402710&4294967295,P=b+(N<<12&4294967295|N>>>20),N=C+(S^P&(b^S))+I[2]+606105819&4294967295,C=P+(N<<17&4294967295|N>>>15),N=S+(b^C&(P^b))+I[3]+3250441966&4294967295,S=C+(N<<22&4294967295|N>>>10),N=b+(P^S&(C^P))+I[4]+4118548399&4294967295,b=S+(N<<7&4294967295|N>>>25),N=P+(C^b&(S^C))+I[5]+1200080426&4294967295,P=b+(N<<12&4294967295|N>>>20),N=C+(S^P&(b^S))+I[6]+2821735955&4294967295,C=P+(N<<17&4294967295|N>>>15),N=S+(b^C&(P^b))+I[7]+4249261313&4294967295,S=C+(N<<22&4294967295|N>>>10),N=b+(P^S&(C^P))+I[8]+1770035416&4294967295,b=S+(N<<7&4294967295|N>>>25),N=P+(C^b&(S^C))+I[9]+2336552879&4294967295,P=b+(N<<12&4294967295|N>>>20),N=C+(S^P&(b^S))+I[10]+4294925233&4294967295,C=P+(N<<17&4294967295|N>>>15),N=S+(b^C&(P^b))+I[11]+2304563134&4294967295,S=C+(N<<22&4294967295|N>>>10),N=b+(P^S&(C^P))+I[12]+1804603682&4294967295,b=S+(N<<7&4294967295|N>>>25),N=P+(C^b&(S^C))+I[13]+4254626195&4294967295,P=b+(N<<12&4294967295|N>>>20),N=C+(S^P&(b^S))+I[14]+2792965006&4294967295,C=P+(N<<17&4294967295|N>>>15),N=S+(b^C&(P^b))+I[15]+1236535329&4294967295,S=C+(N<<22&4294967295|N>>>10),N=b+(C^P&(S^C))+I[1]+4129170786&4294967295,b=S+(N<<5&4294967295|N>>>27),N=P+(S^C&(b^S))+I[6]+3225465664&4294967295,P=b+(N<<9&4294967295|N>>>23),N=C+(b^S&(P^b))+I[11]+643717713&4294967295,C=P+(N<<14&4294967295|N>>>18),N=S+(P^b&(C^P))+I[0]+3921069994&4294967295,S=C+(N<<20&4294967295|N>>>12),N=b+(C^P&(S^C))+I[5]+3593408605&4294967295,b=S+(N<<5&4294967295|N>>>27),N=P+(S^C&(b^S))+I[10]+38016083&4294967295,P=b+(N<<9&4294967295|N>>>23),N=C+(b^S&(P^b))+I[15]+3634488961&4294967295,C=P+(N<<14&4294967295|N>>>18),N=S+(P^b&(C^P))+I[4]+3889429448&4294967295,S=C+(N<<20&4294967295|N>>>12),N=b+(C^P&(S^C))+I[9]+568446438&4294967295,b=S+(N<<5&4294967295|N>>>27),N=P+(S^C&(b^S))+I[14]+3275163606&4294967295,P=b+(N<<9&4294967295|N>>>23),N=C+(b^S&(P^b))+I[3]+4107603335&4294967295,C=P+(N<<14&4294967295|N>>>18),N=S+(P^b&(C^P))+I[8]+1163531501&4294967295,S=C+(N<<20&4294967295|N>>>12),N=b+(C^P&(S^C))+I[13]+2850285829&4294967295,b=S+(N<<5&4294967295|N>>>27),N=P+(S^C&(b^S))+I[2]+4243563512&4294967295,P=b+(N<<9&4294967295|N>>>23),N=C+(b^S&(P^b))+I[7]+1735328473&4294967295,C=P+(N<<14&4294967295|N>>>18),N=S+(P^b&(C^P))+I[12]+2368359562&4294967295,S=C+(N<<20&4294967295|N>>>12),N=b+(S^C^P)+I[5]+4294588738&4294967295,b=S+(N<<4&4294967295|N>>>28),N=P+(b^S^C)+I[8]+2272392833&4294967295,P=b+(N<<11&4294967295|N>>>21),N=C+(P^b^S)+I[11]+1839030562&4294967295,C=P+(N<<16&4294967295|N>>>16),N=S+(C^P^b)+I[14]+4259657740&4294967295,S=C+(N<<23&4294967295|N>>>9),N=b+(S^C^P)+I[1]+2763975236&4294967295,b=S+(N<<4&4294967295|N>>>28),N=P+(b^S^C)+I[4]+1272893353&4294967295,P=b+(N<<11&4294967295|N>>>21),N=C+(P^b^S)+I[7]+4139469664&4294967295,C=P+(N<<16&4294967295|N>>>16),N=S+(C^P^b)+I[10]+3200236656&4294967295,S=C+(N<<23&4294967295|N>>>9),N=b+(S^C^P)+I[13]+681279174&4294967295,b=S+(N<<4&4294967295|N>>>28),N=P+(b^S^C)+I[0]+3936430074&4294967295,P=b+(N<<11&4294967295|N>>>21),N=C+(P^b^S)+I[3]+3572445317&4294967295,C=P+(N<<16&4294967295|N>>>16),N=S+(C^P^b)+I[6]+76029189&4294967295,S=C+(N<<23&4294967295|N>>>9),N=b+(S^C^P)+I[9]+3654602809&4294967295,b=S+(N<<4&4294967295|N>>>28),N=P+(b^S^C)+I[12]+3873151461&4294967295,P=b+(N<<11&4294967295|N>>>21),N=C+(P^b^S)+I[15]+530742520&4294967295,C=P+(N<<16&4294967295|N>>>16),N=S+(C^P^b)+I[2]+3299628645&4294967295,S=C+(N<<23&4294967295|N>>>9),N=b+(C^(S|~P))+I[0]+4096336452&4294967295,b=S+(N<<6&4294967295|N>>>26),N=P+(S^(b|~C))+I[7]+1126891415&4294967295,P=b+(N<<10&4294967295|N>>>22),N=C+(b^(P|~S))+I[14]+2878612391&4294967295,C=P+(N<<15&4294967295|N>>>17),N=S+(P^(C|~b))+I[5]+4237533241&4294967295,S=C+(N<<21&4294967295|N>>>11),N=b+(C^(S|~P))+I[12]+1700485571&4294967295,b=S+(N<<6&4294967295|N>>>26),N=P+(S^(b|~C))+I[3]+2399980690&4294967295,P=b+(N<<10&4294967295|N>>>22),N=C+(b^(P|~S))+I[10]+4293915773&4294967295,C=P+(N<<15&4294967295|N>>>17),N=S+(P^(C|~b))+I[1]+2240044497&4294967295,S=C+(N<<21&4294967295|N>>>11),N=b+(C^(S|~P))+I[8]+1873313359&4294967295,b=S+(N<<6&4294967295|N>>>26),N=P+(S^(b|~C))+I[15]+4264355552&4294967295,P=b+(N<<10&4294967295|N>>>22),N=C+(b^(P|~S))+I[6]+2734768916&4294967295,C=P+(N<<15&4294967295|N>>>17),N=S+(P^(C|~b))+I[13]+1309151649&4294967295,S=C+(N<<21&4294967295|N>>>11),N=b+(C^(S|~P))+I[4]+4149444226&4294967295,b=S+(N<<6&4294967295|N>>>26),N=P+(S^(b|~C))+I[11]+3174756917&4294967295,P=b+(N<<10&4294967295|N>>>22),N=C+(b^(P|~S))+I[2]+718787259&4294967295,C=P+(N<<15&4294967295|N>>>17),N=S+(P^(C|~b))+I[9]+3951481745&4294967295,_.g[0]=_.g[0]+b&4294967295,_.g[1]=_.g[1]+(C+(N<<21&4294967295|N>>>11))&4294967295,_.g[2]=_.g[2]+C&4294967295,_.g[3]=_.g[3]+P&4294967295}s.prototype.v=function(_,b){b===void 0&&(b=_.length);const S=b-this.blockSize,I=this.C;let C=this.h,P=0;for(;P<b;){if(C==0)for(;P<=S;)r(this,_,P),P+=this.blockSize;if(typeof _=="string"){for(;P<b;)if(I[C++]=_.charCodeAt(P++),C==this.blockSize){r(this,I),C=0;break}}else for(;P<b;)if(I[C++]=_[P++],C==this.blockSize){r(this,I),C=0;break}}this.h=C,this.o+=b},s.prototype.A=function(){var _=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);_[0]=128;for(var b=1;b<_.length-8;++b)_[b]=0;b=this.o*8;for(var S=_.length-8;S<_.length;++S)_[S]=b&255,b/=256;for(this.v(_),_=Array(16),b=0,S=0;S<4;++S)for(let I=0;I<32;I+=8)_[b++]=this.g[S]>>>I&255;return _};function o(_,b){var S=l;return Object.prototype.hasOwnProperty.call(S,_)?S[_]:S[_]=b(_)}function a(_,b){this.h=b;const S=[];let I=!0;for(let C=_.length-1;C>=0;C--){const P=_[C]|0;I&&P==b||(S[C]=P,I=!1)}this.g=S}var l={};function u(_){return-128<=_&&_<128?o(_,function(b){return new a([b|0],b<0?-1:0)}):new a([_|0],_<0?-1:0)}function d(_){if(isNaN(_)||!isFinite(_))return m;if(_<0)return A(d(-_));const b=[];let S=1;for(let I=0;_>=S;I++)b[I]=_/S|0,S*=4294967296;return new a(b,0)}function h(_,b){if(_.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(_.charAt(0)=="-")return A(h(_.substring(1),b));if(_.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=d(Math.pow(b,8));let I=m;for(let P=0;P<_.length;P+=8){var C=Math.min(8,_.length-P);const N=parseInt(_.substring(P,P+C),b);C<8?(C=d(Math.pow(b,C)),I=I.j(C).add(d(N))):(I=I.j(S),I=I.add(d(N)))}return I}var m=u(0),p=u(1),x=u(16777216);t=a.prototype,t.m=function(){if(j(this))return-A(this).m();let _=0,b=1;for(let S=0;S<this.g.length;S++){const I=this.i(S);_+=(I>=0?I:4294967296+I)*b,b*=4294967296}return _},t.toString=function(_){if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(v(this))return"0";if(j(this))return"-"+A(this).toString(_);const b=d(Math.pow(_,6));var S=this;let I="";for(;;){const C=R(S,b).g;S=w(S,C.j(b));let P=((S.g.length>0?S.g[0]:S.h)>>>0).toString(_);if(S=C,v(S))return P+I;for(;P.length<6;)P="0"+P;I=P+I}},t.i=function(_){return _<0?0:_<this.g.length?this.g[_]:this.h};function v(_){if(_.h!=0)return!1;for(let b=0;b<_.g.length;b++)if(_.g[b]!=0)return!1;return!0}function j(_){return _.h==-1}t.l=function(_){return _=w(this,_),j(_)?-1:v(_)?0:1};function A(_){const b=_.g.length,S=[];for(let I=0;I<b;I++)S[I]=~_.g[I];return new a(S,~_.h).add(p)}t.abs=function(){return j(this)?A(this):this},t.add=function(_){const b=Math.max(this.g.length,_.g.length),S=[];let I=0;for(let C=0;C<=b;C++){let P=I+(this.i(C)&65535)+(_.i(C)&65535),N=(P>>>16)+(this.i(C)>>>16)+(_.i(C)>>>16);I=N>>>16,P&=65535,N&=65535,S[C]=N<<16|P}return new a(S,S[S.length-1]&-2147483648?-1:0)};function w(_,b){return _.add(A(b))}t.j=function(_){if(v(this)||v(_))return m;if(j(this))return j(_)?A(this).j(A(_)):A(A(this).j(_));if(j(_))return A(this.j(A(_)));if(this.l(x)<0&&_.l(x)<0)return d(this.m()*_.m());const b=this.g.length+_.g.length,S=[];for(var I=0;I<2*b;I++)S[I]=0;for(I=0;I<this.g.length;I++)for(let C=0;C<_.g.length;C++){const P=this.i(I)>>>16,N=this.i(I)&65535,O=_.i(C)>>>16,M=_.i(C)&65535;S[2*I+2*C]+=N*M,y(S,2*I+2*C),S[2*I+2*C+1]+=P*M,y(S,2*I+2*C+1),S[2*I+2*C+1]+=N*O,y(S,2*I+2*C+1),S[2*I+2*C+2]+=P*O,y(S,2*I+2*C+2)}for(_=0;_<b;_++)S[_]=S[2*_+1]<<16|S[2*_];for(_=b;_<2*b;_++)S[_]=0;return new a(S,0)};function y(_,b){for(;(_[b]&65535)!=_[b];)_[b+1]+=_[b]>>>16,_[b]&=65535,b++}function E(_,b){this.g=_,this.h=b}function R(_,b){if(v(b))throw Error("division by zero");if(v(_))return new E(m,m);if(j(_))return b=R(A(_),b),new E(A(b.g),A(b.h));if(j(b))return b=R(_,A(b)),new E(A(b.g),b.h);if(_.g.length>30){if(j(_)||j(b))throw Error("slowDivide_ only works with positive integers.");for(var S=p,I=b;I.l(_)<=0;)S=$(S),I=$(I);var C=D(S,1),P=D(I,1);for(I=D(I,2),S=D(S,2);!v(I);){var N=P.add(I);N.l(_)<=0&&(C=C.add(S),P=N),I=D(I,1),S=D(S,1)}return b=w(_,C.j(b)),new E(C,b)}for(C=m;_.l(b)>=0;){for(S=Math.max(1,Math.floor(_.m()/b.m())),I=Math.ceil(Math.log(S)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),P=d(S),N=P.j(b);j(N)||N.l(_)>0;)S-=I,P=d(S),N=P.j(b);v(P)&&(P=p),C=C.add(P),_=w(_,N)}return new E(C,_)}t.B=function(_){return R(this,_).h},t.and=function(_){const b=Math.max(this.g.length,_.g.length),S=[];for(let I=0;I<b;I++)S[I]=this.i(I)&_.i(I);return new a(S,this.h&_.h)},t.or=function(_){const b=Math.max(this.g.length,_.g.length),S=[];for(let I=0;I<b;I++)S[I]=this.i(I)|_.i(I);return new a(S,this.h|_.h)},t.xor=function(_){const b=Math.max(this.g.length,_.g.length),S=[];for(let I=0;I<b;I++)S[I]=this.i(I)^_.i(I);return new a(S,this.h^_.h)};function $(_){const b=_.g.length+1,S=[];for(let I=0;I<b;I++)S[I]=_.i(I)<<1|_.i(I-1)>>>31;return new a(S,_.h)}function D(_,b){const S=b>>5;b%=32;const I=_.g.length-S,C=[];for(let P=0;P<I;P++)C[P]=b>0?_.i(P+S)>>>b|_.i(P+S+1)<<32-b:_.i(P+S);return new a(C,_.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,cw=s,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.B,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=h,pr=a}).apply(typeof zx<"u"?zx:typeof self<"u"?self:typeof window<"u"?window:{});var Ol=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var uw,Ko,dw,tc,lm,hw,mw,fw;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ol=="object"&&Ol];for(var f=0;f<c.length;++f){var g=c[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=n(this);function r(c,f){if(f)e:{var g=s;c=c.split(".");for(var k=0;k<c.length-1;k++){var F=c[k];if(!(F in g))break e;g=g[F]}c=c[c.length-1],k=g[c],f=f(k),f!=k&&f!=null&&e(g,c,{configurable:!0,writable:!0,value:f})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(f){var g=[],k;for(k in f)Object.prototype.hasOwnProperty.call(f,k)&&g.push([k,f[k]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function u(c,f,g){return c.call.apply(c.bind,arguments)}function d(c,f,g){return d=u,d.apply(null,arguments)}function h(c,f){var g=Array.prototype.slice.call(arguments,1);return function(){var k=g.slice();return k.push.apply(k,arguments),c.apply(this,k)}}function m(c,f){function g(){}g.prototype=f.prototype,c.Z=f.prototype,c.prototype=new g,c.prototype.constructor=c,c.Ob=function(k,F,U){for(var X=Array(arguments.length-2),we=2;we<arguments.length;we++)X[we-2]=arguments[we];return f.prototype[F].apply(k,X)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function x(c){const f=c.length;if(f>0){const g=Array(f);for(let k=0;k<f;k++)g[k]=c[k];return g}return[]}function v(c,f){for(let k=1;k<arguments.length;k++){const F=arguments[k];var g=typeof F;if(g=g!="object"?g:F?Array.isArray(F)?"array":g:"null",g=="array"||g=="object"&&typeof F.length=="number"){g=c.length||0;const U=F.length||0;c.length=g+U;for(let X=0;X<U;X++)c[g+X]=F[X]}else c.push(F)}}class j{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function A(c){a.setTimeout(()=>{throw c},0)}function w(){var c=_;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class y{constructor(){this.h=this.g=null}add(f,g){const k=E.get();k.set(f,g),this.h?this.h.next=k:this.g=k,this.h=k}}var E=new j(()=>new R,c=>c.reset());class R{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let $,D=!1,_=new y,b=()=>{const c=Promise.resolve(void 0);$=()=>{c.then(S)}};function S(){for(var c;c=w();){try{c.h.call(c.g)}catch(g){A(g)}var f=E;f.j(c),f.h<100&&(f.h++,c.next=f.g,f.g=c)}D=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};a.addEventListener("test",g,f),a.removeEventListener("test",g,f)}catch{}return c}();function N(c){return/^[\s\xa0]*$/.test(c)}function O(c,f){C.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,f)}m(O,C),O.prototype.init=function(c,f){const g=this.type=c.type,k=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget,f||(g=="mouseover"?f=c.fromElement:g=="mouseout"&&(f=c.toElement)),this.relatedTarget=f,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&O.Z.h.call(this)},O.prototype.h=function(){O.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var M="closure_listenable_"+(Math.random()*1e6|0),ie=0;function Ae(c,f,g,k,F){this.listener=c,this.proxy=null,this.src=f,this.type=g,this.capture=!!k,this.ha=F,this.key=++ie,this.da=this.fa=!1}function Q(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function V(c,f,g){for(const k in c)f.call(g,c[k],k,c)}function Y(c,f){for(const g in c)f.call(void 0,c[g],g,c)}function T(c){const f={};for(const g in c)f[g]=c[g];return f}const B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function G(c,f){let g,k;for(let F=1;F<arguments.length;F++){k=arguments[F];for(g in k)c[g]=k[g];for(let U=0;U<B.length;U++)g=B[U],Object.prototype.hasOwnProperty.call(k,g)&&(c[g]=k[g])}}function K(c){this.src=c,this.g={},this.h=0}K.prototype.add=function(c,f,g,k,F){const U=c.toString();c=this.g[U],c||(c=this.g[U]=[],this.h++);const X=le(c,f,k,F);return X>-1?(f=c[X],g||(f.fa=!1)):(f=new Ae(f,this.src,U,!!k,F),f.fa=g,c.push(f)),f};function te(c,f){const g=f.type;if(g in c.g){var k=c.g[g],F=Array.prototype.indexOf.call(k,f,void 0),U;(U=F>=0)&&Array.prototype.splice.call(k,F,1),U&&(Q(f),c.g[g].length==0&&(delete c.g[g],c.h--))}}function le(c,f,g,k){for(let F=0;F<c.length;++F){const U=c[F];if(!U.da&&U.listener==f&&U.capture==!!g&&U.ha==k)return F}return-1}var W="closure_lm_"+(Math.random()*1e6|0),ne={};function oe(c,f,g,k,F){if(Array.isArray(f)){for(let U=0;U<f.length;U++)oe(c,f[U],g,k,F);return null}return g=Fs(g),c&&c[M]?c.J(f,g,l(k)?!!k.capture:!1,F):xe(c,f,g,!1,k,F)}function xe(c,f,g,k,F,U){if(!f)throw Error("Invalid event type");const X=l(F)?!!F.capture:!!F;let we=St(c);if(we||(c[W]=we=new K(c)),g=we.add(f,g,k,X,U),g.proxy)return g;if(k=ce(),g.proxy=k,k.src=c,k.listener=g,c.addEventListener)P||(F=X),F===void 0&&(F=!1),c.addEventListener(f.toString(),k,F);else if(c.attachEvent)c.attachEvent(je(f.toString()),k);else if(c.addListener&&c.removeListener)c.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return g}function ce(){function c(g){return f.call(c.src,c.listener,g)}const f=ut;return c}function de(c,f,g,k,F){if(Array.isArray(f))for(var U=0;U<f.length;U++)de(c,f[U],g,k,F);else k=l(k)?!!k.capture:!!k,g=Fs(g),c&&c[M]?(c=c.i,U=String(f).toString(),U in c.g&&(f=c.g[U],g=le(f,g,k,F),g>-1&&(Q(f[g]),Array.prototype.splice.call(f,g,1),f.length==0&&(delete c.g[U],c.h--)))):c&&(c=St(c))&&(f=c.g[f.toString()],c=-1,f&&(c=le(f,g,k,F)),(g=c>-1?f[c]:null)&&he(g))}function he(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[M])te(f.i,c);else{var g=c.type,k=c.proxy;f.removeEventListener?f.removeEventListener(g,k,c.capture):f.detachEvent?f.detachEvent(je(g),k):f.addListener&&f.removeListener&&f.removeListener(k),(g=St(f))?(te(g,c),g.h==0&&(g.src=null,f[W]=null)):Q(c)}}}function je(c){return c in ne?ne[c]:ne[c]="on"+c}function ut(c,f){if(c.da)c=!0;else{f=new O(f,this);const g=c.listener,k=c.ha||c.src;c.fa&&he(c),c=g.call(k,f)}return c}function St(c){return c=c[W],c instanceof K?c:null}var Et="__closure_events_fn_"+(Math.random()*1e9>>>0);function Fs(c){return typeof c=="function"?c:(c[Et]||(c[Et]=function(f){return c.handleEvent(f)}),c[Et])}function et(){I.call(this),this.i=new K(this),this.M=this,this.G=null}m(et,I),et.prototype[M]=!0,et.prototype.removeEventListener=function(c,f,g,k){de(this,c,f,g,k)};function rt(c,f){var g,k=c.G;if(k)for(g=[];k;k=k.G)g.push(k);if(c=c.M,k=f.type||f,typeof f=="string")f=new C(f,c);else if(f instanceof C)f.target=f.target||c;else{var F=f;f=new C(k,c),G(f,F)}F=!0;let U,X;if(g)for(X=g.length-1;X>=0;X--)U=f.g=g[X],F=Tt(U,k,!0,f)&&F;if(U=f.g=c,F=Tt(U,k,!0,f)&&F,F=Tt(U,k,!1,f)&&F,g)for(X=0;X<g.length;X++)U=f.g=g[X],F=Tt(U,k,!1,f)&&F}et.prototype.N=function(){if(et.Z.N.call(this),this.i){var c=this.i;for(const f in c.g){const g=c.g[f];for(let k=0;k<g.length;k++)Q(g[k]);delete c.g[f],c.h--}}this.G=null},et.prototype.J=function(c,f,g,k){return this.i.add(String(c),f,!1,g,k)},et.prototype.K=function(c,f,g,k){return this.i.add(String(c),f,!0,g,k)};function Tt(c,f,g,k){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();let F=!0;for(let U=0;U<f.length;++U){const X=f[U];if(X&&!X.da&&X.capture==g){const we=X.listener,dt=X.ha||X.src;X.fa&&te(c.i,X),F=we.call(dt,k)!==!1&&F}}return F&&!k.defaultPrevented}function gi(c,f){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=d(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:a.setTimeout(c,f||0)}function yn(c){c.g=gi(()=>{c.g=null,c.i&&(c.i=!1,yn(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class Ds extends I{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:yn(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vn(c){I.call(this),this.h=c,this.g={}}m(vn,I);var z=[];function _e(c){V(c.g,function(f,g){this.g.hasOwnProperty(g)&&he(f)},c),c.g={}}vn.prototype.N=function(){vn.Z.N.call(this),_e(this)},vn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ue=a.JSON.stringify,ke=a.JSON.parse,At=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Ve(){}function be(){}var tt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Qn(){C.call(this,"d")}m(Qn,C);function yo(){C.call(this,"c")}m(yo,C);var _n={},Us=null;function Ar(){return Us=Us||new et}_n.Ia="serverreachability";function Mp(c){C.call(this,_n.Ia,c)}m(Mp,C);function vo(c){const f=Ar();rt(f,new Mp(f))}_n.STAT_EVENT="statevent";function Lp(c,f){C.call(this,_n.STAT_EVENT,c),this.stat=f}m(Lp,C);function Ut(c){const f=Ar();rt(f,new Lp(f,c))}_n.Ja="timingevent";function Vp(c,f){C.call(this,_n.Ja,c),this.size=f}m(Vp,C);function _o(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},f)}function wo(){this.g=!0}wo.prototype.ua=function(){this.g=!1};function uj(c,f,g,k,F,U){c.info(function(){if(c.g)if(U){var X="",we=U.split("&");for(let Le=0;Le<we.length;Le++){var dt=we[Le].split("=");if(dt.length>1){const pt=dt[0];dt=dt[1];const Yn=pt.split("_");X=Yn.length>=2&&Yn[1]=="type"?X+(pt+"="+dt+"&"):X+(pt+"=redacted&")}}}else X=null;else X=U;return"XMLHTTP REQ ("+k+") [attempt "+F+"]: "+f+`
`+g+`
`+X})}function dj(c,f,g,k,F,U,X){c.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+F+"]: "+f+`
`+g+`
`+U+" "+X})}function xi(c,f,g,k){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+mj(c,g)+(k?" "+k:"")})}function hj(c,f){c.info(function(){return"TIMEOUT: "+f})}wo.prototype.info=function(){};function mj(c,f){if(!c.g)return f;if(!f)return null;try{const U=JSON.parse(f);if(U){for(c=0;c<U.length;c++)if(Array.isArray(U[c])){var g=U[c];if(!(g.length<2)){var k=g[1];if(Array.isArray(k)&&!(k.length<1)){var F=k[0];if(F!="noop"&&F!="stop"&&F!="close")for(let X=1;X<k.length;X++)k[X]=""}}}}return ue(U)}catch{return f}}var al={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},$p={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Fp;function sd(){}m(sd,Ve),sd.prototype.g=function(){return new XMLHttpRequest},Fp=new sd;function bo(c){return encodeURIComponent(String(c))}function fj(c){var f=1;c=c.split(":");const g=[];for(;f>0&&c.length;)g.push(c.shift()),f--;return c.length&&g.push(c.join(":")),g}function Bs(c,f,g,k){this.j=c,this.i=f,this.l=g,this.S=k||1,this.V=new vn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Dp}function Dp(){this.i=null,this.g="",this.h=!1}var Up={},rd={};function id(c,f,g){c.M=1,c.A=cl(Jn(f)),c.u=g,c.R=!0,Bp(c,null)}function Bp(c,f){c.F=Date.now(),ll(c),c.B=Jn(c.A);var g=c.B,k=c.S;Array.isArray(k)||(k=[String(k)]),tg(g.i,"t",k),c.C=0,g=c.j.L,c.h=new Dp,c.g=vg(c.j,g?f:null,!c.u),c.P>0&&(c.O=new Ds(d(c.Y,c,c.g),c.P)),f=c.V,g=c.g,k=c.ba;var F="readystatechange";Array.isArray(F)||(F&&(z[0]=F.toString()),F=z);for(let U=0;U<F.length;U++){const X=oe(g,F[U],k||f.handleEvent,!1,f.h||f);if(!X)break;f.g[X.key]=X}f=c.J?T(c.J):{},c.u?(c.v||(c.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,f)):(c.v="GET",c.g.ea(c.B,c.v,null,f)),vo(),uj(c.i,c.v,c.B,c.l,c.S,c.u)}Bs.prototype.ba=function(c){c=c.target;const f=this.O;f&&qs(c)==3?f.j():this.Y(c)},Bs.prototype.Y=function(c){try{if(c==this.g)e:{const we=qs(this.g),dt=this.g.ya(),Le=this.g.ca();if(!(we<3)&&(we!=3||this.g&&(this.h.h||this.g.la()||lg(this.g)))){this.K||we!=4||dt==7||(dt==8||Le<=0?vo(3):vo(2)),od(this);var f=this.g.ca();this.X=f;var g=pj(this);if(this.o=f==200,dj(this.i,this.v,this.B,this.l,this.S,we,f),this.o){if(this.U&&!this.L){t:{if(this.g){var k,F=this.g;if((k=F.g?F.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(k)){var U=k;break t}}U=null}if(c=U)xi(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ad(this,c);else{this.o=!1,this.m=3,Ut(12),Cr(this),No(this);break e}}if(this.R){c=!0;let pt;for(;!this.K&&this.C<g.length;)if(pt=gj(this,g),pt==rd){we==4&&(this.m=4,Ut(14),c=!1),xi(this.i,this.l,null,"[Incomplete Response]");break}else if(pt==Up){this.m=4,Ut(15),xi(this.i,this.l,g,"[Invalid Chunk]"),c=!1;break}else xi(this.i,this.l,pt,null),ad(this,pt);if(zp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),we!=4||g.length!=0||this.h.h||(this.m=1,Ut(16),c=!1),this.o=this.o&&c,!c)xi(this.i,this.l,g,"[Invalid Chunked Response]"),Cr(this),No(this);else if(g.length>0&&!this.W){this.W=!0;var X=this.j;X.g==this&&X.aa&&!X.P&&(X.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),pd(X),X.P=!0,Ut(11))}}else xi(this.i,this.l,g,null),ad(this,g);we==4&&Cr(this),this.o&&!this.K&&(we==4?pg(this.j,this):(this.o=!1,ll(this)))}else Aj(this.g),f==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ut(12)):(this.m=0,Ut(13)),Cr(this),No(this)}}}catch{}finally{}};function pj(c){if(!zp(c))return c.g.la();const f=lg(c.g);if(f==="")return"";let g="";const k=f.length,F=qs(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return Cr(c),No(c),"";c.h.i=new a.TextDecoder}for(let U=0;U<k;U++)c.h.h=!0,g+=c.h.i.decode(f[U],{stream:!(F&&U==k-1)});return f.length=0,c.h.g+=g,c.C=0,c.h.g}function zp(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function gj(c,f){var g=c.C,k=f.indexOf(`
`,g);return k==-1?rd:(g=Number(f.substring(g,k)),isNaN(g)?Up:(k+=1,k+g>f.length?rd:(f=f.slice(k,k+g),c.C=k+g,f)))}Bs.prototype.cancel=function(){this.K=!0,Cr(this)};function ll(c){c.T=Date.now()+c.H,Hp(c,c.H)}function Hp(c,f){if(c.D!=null)throw Error("WatchDog timer not null");c.D=_o(d(c.aa,c),f)}function od(c){c.D&&(a.clearTimeout(c.D),c.D=null)}Bs.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(hj(this.i,this.B),this.M!=2&&(vo(),Ut(17)),Cr(this),this.m=2,No(this)):Hp(this,this.T-c)};function No(c){c.j.I==0||c.K||pg(c.j,c)}function Cr(c){od(c);var f=c.O;f&&typeof f.dispose=="function"&&f.dispose(),c.O=null,_e(c.V),c.g&&(f=c.g,c.g=null,f.abort(),f.dispose())}function ad(c,f){try{var g=c.j;if(g.I!=0&&(g.g==c||ld(g.h,c))){if(!c.L&&ld(g.h,c)&&g.I==3){try{var k=g.Ba.g.parse(f)}catch{k=null}if(Array.isArray(k)&&k.length==3){var F=k;if(F[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<c.F)fl(g),hl(g);else break e;fd(g),Ut(18)}}else g.xa=F[1],0<g.xa-g.K&&F[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=_o(d(g.Va,g),6e3));Kp(g.h)<=1&&g.ta&&(g.ta=void 0)}else Rr(g,11)}else if((c.L||g.g==c)&&fl(g),!N(f))for(F=g.Ba.g.parse(f),f=0;f<F.length;f++){let Le=F[f];const pt=Le[0];if(!(pt<=g.K))if(g.K=pt,Le=Le[1],g.I==2)if(Le[0]=="c"){g.M=Le[1],g.ba=Le[2];const Yn=Le[3];Yn!=null&&(g.ka=Yn,g.j.info("VER="+g.ka));const Or=Le[4];Or!=null&&(g.za=Or,g.j.info("SVER="+g.za));const Ws=Le[5];Ws!=null&&typeof Ws=="number"&&Ws>0&&(k=1.5*Ws,g.O=k,g.j.info("backChannelRequestTimeoutMs_="+k)),k=g;const Ks=c.g;if(Ks){const gl=Ks.g?Ks.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gl){var U=k.h;U.g||gl.indexOf("spdy")==-1&&gl.indexOf("quic")==-1&&gl.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(cd(U,U.h),U.h=null))}if(k.G){const gd=Ks.g?Ks.g.getResponseHeader("X-HTTP-Session-Id"):null;gd&&(k.wa=gd,Ue(k.J,k.G,gd))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-c.F,g.j.info("Handshake RTT: "+g.T+"ms")),k=g;var X=c;if(k.na=yg(k,k.L?k.ba:null,k.W),X.L){Gp(k.h,X);var we=X,dt=k.O;dt&&(we.H=dt),we.D&&(od(we),ll(we)),k.g=X}else mg(k);g.i.length>0&&ml(g)}else Le[0]!="stop"&&Le[0]!="close"||Rr(g,7);else g.I==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?Rr(g,7):md(g):Le[0]!="noop"&&g.l&&g.l.qa(Le),g.A=0)}}vo(4)}catch{}}var xj=class{constructor(c,f){this.g=c,this.map=f}};function qp(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Wp(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Kp(c){return c.h?1:c.g?c.g.size:0}function ld(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function cd(c,f){c.g?c.g.add(f):c.h=f}function Gp(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}qp.prototype.cancel=function(){if(this.i=Qp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Qp(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const g of c.g.values())f=f.concat(g.G);return f}return x(c.i)}var Jp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yj(c,f){if(c){c=c.split("&");for(let g=0;g<c.length;g++){const k=c[g].indexOf("=");let F,U=null;k>=0?(F=c[g].substring(0,k),U=c[g].substring(k+1)):F=c[g],f(F,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function zs(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;c instanceof zs?(this.l=c.l,jo(this,c.j),this.o=c.o,this.g=c.g,ko(this,c.u),this.h=c.h,ud(this,ng(c.i)),this.m=c.m):c&&(f=String(c).match(Jp))?(this.l=!1,jo(this,f[1]||"",!0),this.o=Io(f[2]||""),this.g=Io(f[3]||"",!0),ko(this,f[4]),this.h=Io(f[5]||"",!0),ud(this,f[6]||"",!0),this.m=Io(f[7]||"")):(this.l=!1,this.i=new Eo(null,this.l))}zs.prototype.toString=function(){const c=[];var f=this.j;f&&c.push(So(f,Yp,!0),":");var g=this.g;return(g||f=="file")&&(c.push("//"),(f=this.o)&&c.push(So(f,Yp,!0),"@"),c.push(bo(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&c.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(So(g,g.charAt(0)=="/"?wj:_j,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",So(g,Nj)),c.join("")},zs.prototype.resolve=function(c){const f=Jn(this);let g=!!c.j;g?jo(f,c.j):g=!!c.o,g?f.o=c.o:g=!!c.g,g?f.g=c.g:g=c.u!=null;var k=c.h;if(g)ko(f,c.u);else if(g=!!c.h){if(k.charAt(0)!="/")if(this.g&&!this.h)k="/"+k;else{var F=f.h.lastIndexOf("/");F!=-1&&(k=f.h.slice(0,F+1)+k)}if(F=k,F==".."||F==".")k="";else if(F.indexOf("./")!=-1||F.indexOf("/.")!=-1){k=F.lastIndexOf("/",0)==0,F=F.split("/");const U=[];for(let X=0;X<F.length;){const we=F[X++];we=="."?k&&X==F.length&&U.push(""):we==".."?((U.length>1||U.length==1&&U[0]!="")&&U.pop(),k&&X==F.length&&U.push("")):(U.push(we),k=!0)}k=U.join("/")}else k=F}return g?f.h=k:g=c.i.toString()!=="",g?ud(f,ng(c.i)):g=!!c.m,g&&(f.m=c.m),f};function Jn(c){return new zs(c)}function jo(c,f,g){c.j=g?Io(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function ko(c,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);c.u=f}else c.u=null}function ud(c,f,g){f instanceof Eo?(c.i=f,jj(c.i,c.l)):(g||(f=So(f,bj)),c.i=new Eo(f,c.l))}function Ue(c,f,g){c.i.set(f,g)}function cl(c){return Ue(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Io(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function So(c,f,g){return typeof c=="string"?(c=encodeURI(c).replace(f,vj),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function vj(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Yp=/[#\/\?@]/g,_j=/[#\?:]/g,wj=/[#\?]/g,bj=/[#\?@]/g,Nj=/#/g;function Eo(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function Pr(c){c.g||(c.g=new Map,c.h=0,c.i&&yj(c.i,function(f,g){c.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=Eo.prototype,t.add=function(c,f){Pr(this),this.i=null,c=yi(this,c);let g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(f),this.h+=1,this};function Xp(c,f){Pr(c),f=yi(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function Zp(c,f){return Pr(c),f=yi(c,f),c.g.has(f)}t.forEach=function(c,f){Pr(this),this.g.forEach(function(g,k){g.forEach(function(F){c.call(f,F,k,this)},this)},this)};function eg(c,f){Pr(c);let g=[];if(typeof f=="string")Zp(c,f)&&(g=g.concat(c.g.get(yi(c,f))));else for(c=Array.from(c.g.values()),f=0;f<c.length;f++)g=g.concat(c[f]);return g}t.set=function(c,f){return Pr(this),this.i=null,c=yi(this,c),Zp(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},t.get=function(c,f){return c?(c=eg(this,c),c.length>0?String(c[0]):f):f};function tg(c,f,g){Xp(c,f),g.length>0&&(c.i=null,c.g.set(yi(c,f),x(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(let k=0;k<f.length;k++){var g=f[k];const F=bo(g);g=eg(this,g);for(let U=0;U<g.length;U++){let X=F;g[U]!==""&&(X+="="+bo(g[U])),c.push(X)}}return this.i=c.join("&")};function ng(c){const f=new Eo;return f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),f}function yi(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function jj(c,f){f&&!c.j&&(Pr(c),c.i=null,c.g.forEach(function(g,k){const F=k.toLowerCase();k!=F&&(Xp(this,k),tg(this,F,g))},c)),c.j=f}function kj(c,f){const g=new wo;if(a.Image){const k=new Image;k.onload=h(Hs,g,"TestLoadImage: loaded",!0,f,k),k.onerror=h(Hs,g,"TestLoadImage: error",!1,f,k),k.onabort=h(Hs,g,"TestLoadImage: abort",!1,f,k),k.ontimeout=h(Hs,g,"TestLoadImage: timeout",!1,f,k),a.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=c}else f(!1)}function Ij(c,f){const g=new wo,k=new AbortController,F=setTimeout(()=>{k.abort(),Hs(g,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:k.signal}).then(U=>{clearTimeout(F),U.ok?Hs(g,"TestPingServer: ok",!0,f):Hs(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(F),Hs(g,"TestPingServer: error",!1,f)})}function Hs(c,f,g,k,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),k(g)}catch{}}function Sj(){this.g=new At}function dd(c){this.i=c.Sb||null,this.h=c.ab||!1}m(dd,Ve),dd.prototype.g=function(){return new ul(this.i,this.h)};function ul(c,f){et.call(this),this.H=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(ul,et),t=ul.prototype,t.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=f,this.readyState=1,Ao(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(f.body=c),(this.H||a).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,To(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Ao(this)),this.g&&(this.readyState=3,Ao(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;sg(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function sg(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?To(this):Ao(this),this.readyState==3&&sg(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,To(this))},t.Na=function(c){this.g&&(this.response=c,To(this))},t.ga=function(){this.g&&To(this)};function To(c){c.readyState=4,c.l=null,c.j=null,c.B=null,Ao(c)}t.setRequestHeader=function(c,f){this.A.append(c,f)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=f.next();return c.join(`\r
`)};function Ao(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ul.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function rg(c){let f="";return V(c,function(g,k){f+=k,f+=":",f+=g,f+=`\r
`}),f}function hd(c,f,g){e:{for(k in g){var k=!1;break e}k=!0}k||(g=rg(g),typeof c=="string"?g!=null&&bo(g):Ue(c,f,g))}function Ye(c){et.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(Ye,et);var Ej=/^https?$/i,Tj=["POST","PUT"];t=Ye.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,f,g,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Fp.g(),this.g.onreadystatechange=p(d(this.Ca,this));try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(U){ig(this,U);return}if(c=g||"",g=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var F in k)g.set(F,k[F]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const U of k.keys())g.set(U,k.get(U));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(g.keys()).find(U=>U.toLowerCase()=="content-type"),F=a.FormData&&c instanceof a.FormData,!(Array.prototype.indexOf.call(Tj,f,void 0)>=0)||k||F||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,X]of g)this.g.setRequestHeader(U,X);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(U){ig(this,U)}};function ig(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.o=5,og(c),dl(c)}function og(c){c.A||(c.A=!0,rt(c,"complete"),rt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,rt(this,"complete"),rt(this,"abort"),dl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),dl(this,!0)),Ye.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ag(this):this.Xa())},t.Xa=function(){ag(this)};function ag(c){if(c.h&&typeof o<"u"){if(c.v&&qs(c)==4)setTimeout(c.Ca.bind(c),0);else if(rt(c,"readystatechange"),qs(c)==4){c.h=!1;try{const U=c.ca();e:switch(U){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var k;if(k=U===0){let X=String(c.D).match(Jp)[1]||null;!X&&a.self&&a.self.location&&(X=a.self.location.protocol.slice(0,-1)),k=!Ej.test(X?X.toLowerCase():"")}g=k}if(g)rt(c,"complete"),rt(c,"success");else{c.o=6;try{var F=qs(c)>2?c.g.statusText:""}catch{F=""}c.l=F+" ["+c.ca()+"]",og(c)}}finally{dl(c)}}}}function dl(c,f){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const g=c.g;c.g=null,f||rt(c,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function qs(c){return c.g?c.g.readyState:0}t.ca=function(){try{return qs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),ke(f)}};function lg(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Aj(c){const f={};c=(c.g&&qs(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<c.length;k++){if(N(c[k]))continue;var g=fj(c[k]);const F=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const U=f[F]||[];f[F]=U,U.push(g)}Y(f,function(k){return k.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Co(c,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||f}function cg(c){this.za=0,this.i=[],this.j=new wo,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Co("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Co("baseRetryDelayMs",5e3,c),this.Za=Co("retryDelaySeedMs",1e4,c),this.Ta=Co("forwardChannelMaxRetries",2,c),this.va=Co("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new qp(c&&c.concurrentRequestLimit),this.Ba=new Sj,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=cg.prototype,t.ka=8,t.I=1,t.connect=function(c,f,g,k){Ut(0),this.W=c,this.H=f||{},g&&k!==void 0&&(this.H.OSID=g,this.H.OAID=k),this.F=this.X,this.J=yg(this,null,this.W),ml(this)};function md(c){if(ug(c),c.I==3){var f=c.V++,g=Jn(c.J);if(Ue(g,"SID",c.M),Ue(g,"RID",f),Ue(g,"TYPE","terminate"),Po(c,g),f=new Bs(c,c.j,f),f.M=2,f.A=cl(Jn(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(f.A.toString(),"")}catch{}!g&&a.Image&&(new Image().src=f.A,g=!0),g||(f.g=vg(f.j,null),f.g.ea(f.A)),f.F=Date.now(),ll(f)}xg(c)}function hl(c){c.g&&(pd(c),c.g.cancel(),c.g=null)}function ug(c){hl(c),c.v&&(a.clearTimeout(c.v),c.v=null),fl(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&a.clearTimeout(c.m),c.m=null)}function ml(c){if(!Wp(c.h)&&!c.m){c.m=!0;var f=c.Ea;$||b(),D||($(),D=!0),_.add(f,c),c.D=0}}function Cj(c,f){return Kp(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=f.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=_o(d(c.Ea,c,f),gg(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const F=new Bs(this,this.j,c);let U=this.o;if(this.U&&(U?(U=T(U),G(U,this.U)):U=this.U),this.u!==null||this.R||(F.J=U,U=null),this.S)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var k=this.i[g];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(f+=k,f>4096){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=hg(this,F,f),g=Jn(this.J),Ue(g,"RID",c),Ue(g,"CVER",22),this.G&&Ue(g,"X-HTTP-Session-Id",this.G),Po(this,g),U&&(this.R?f="headers="+bo(rg(U))+"&"+f:this.u&&hd(g,this.u,U)),cd(this.h,F),this.Ra&&Ue(g,"TYPE","init"),this.S?(Ue(g,"$req",f),Ue(g,"SID","null"),F.U=!0,id(F,g,null)):id(F,g,f),this.I=2}}else this.I==3&&(c?dg(this,c):this.i.length==0||Wp(this.h)||dg(this))};function dg(c,f){var g;f?g=f.l:g=c.V++;const k=Jn(c.J);Ue(k,"SID",c.M),Ue(k,"RID",g),Ue(k,"AID",c.K),Po(c,k),c.u&&c.o&&hd(k,c.u,c.o),g=new Bs(c,c.j,g,c.D+1),c.u===null&&(g.J=c.o),f&&(c.i=f.G.concat(c.i)),f=hg(c,g,1e3),g.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),cd(c.h,g),id(g,k,f)}function Po(c,f){c.H&&V(c.H,function(g,k){Ue(f,k,g)}),c.l&&V({},function(g,k){Ue(f,k,g)})}function hg(c,f,g){g=Math.min(c.i.length,g);const k=c.l?d(c.l.Ka,c.l,c):null;e:{var F=c.i;let we=-1;for(;;){const dt=["count="+g];we==-1?g>0?(we=F[0].g,dt.push("ofs="+we)):we=0:dt.push("ofs="+we);let Le=!0;for(let pt=0;pt<g;pt++){var U=F[pt].g;const Yn=F[pt].map;if(U-=we,U<0)we=Math.max(0,F[pt].g-100),Le=!1;else try{U="req"+U+"_"||"";try{var X=Yn instanceof Map?Yn:Object.entries(Yn);for(const[Or,Ws]of X){let Ks=Ws;l(Ws)&&(Ks=ue(Ws)),dt.push(U+Or+"="+encodeURIComponent(Ks))}}catch(Or){throw dt.push(U+"type="+encodeURIComponent("_badmap")),Or}}catch{k&&k(Yn)}}if(Le){X=dt.join("&");break e}}X=void 0}return c=c.i.splice(0,g),f.G=c,X}function mg(c){if(!c.g&&!c.v){c.Y=1;var f=c.Da;$||b(),D||($(),D=!0),_.add(f,c),c.A=0}}function fd(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=_o(d(c.Da,c),gg(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,fg(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=_o(d(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ut(10),hl(this),fg(this))};function pd(c){c.B!=null&&(a.clearTimeout(c.B),c.B=null)}function fg(c){c.g=new Bs(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var f=Jn(c.na);Ue(f,"RID","rpc"),Ue(f,"SID",c.M),Ue(f,"AID",c.K),Ue(f,"CI",c.F?"0":"1"),!c.F&&c.ia&&Ue(f,"TO",c.ia),Ue(f,"TYPE","xmlhttp"),Po(c,f),c.u&&c.o&&hd(f,c.u,c.o),c.O&&(c.g.H=c.O);var g=c.g;c=c.ba,g.M=1,g.A=cl(Jn(f)),g.u=null,g.R=!0,Bp(g,c)}t.Va=function(){this.C!=null&&(this.C=null,hl(this),fd(this),Ut(19))};function fl(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function pg(c,f){var g=null;if(c.g==f){fl(c),pd(c),c.g=null;var k=2}else if(ld(c.h,f))g=f.G,Gp(c.h,f),k=1;else return;if(c.I!=0){if(f.o)if(k==1){g=f.u?f.u.length:0,f=Date.now()-f.F;var F=c.D;k=Ar(),rt(k,new Vp(k,g)),ml(c)}else mg(c);else if(F=f.m,F==3||F==0&&f.X>0||!(k==1&&Cj(c,f)||k==2&&fd(c)))switch(g&&g.length>0&&(f=c.h,f.i=f.i.concat(g)),F){case 1:Rr(c,5);break;case 4:Rr(c,10);break;case 3:Rr(c,6);break;default:Rr(c,2)}}}function gg(c,f){let g=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(g*=2),g*f}function Rr(c,f){if(c.j.info("Error code "+f),f==2){var g=d(c.bb,c),k=c.Ua;const F=!k;k=new zs(k||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||jo(k,"https"),cl(k),F?kj(k.toString(),g):Ij(k.toString(),g)}else Ut(2);c.I=0,c.l&&c.l.pa(f),xg(c),ug(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),Ut(2)):(this.j.info("Failed to ping google.com"),Ut(1))};function xg(c){if(c.I=0,c.ja=[],c.l){const f=Qp(c.h);(f.length!=0||c.i.length!=0)&&(v(c.ja,f),v(c.ja,c.i),c.h.i.length=0,x(c.i),c.i.length=0),c.l.oa()}}function yg(c,f,g){var k=g instanceof zs?Jn(g):new zs(g);if(k.g!="")f&&(k.g=f+"."+k.g),ko(k,k.u);else{var F=a.location;k=F.protocol,f=f?f+"."+F.hostname:F.hostname,F=+F.port;const U=new zs(null);k&&jo(U,k),f&&(U.g=f),F&&ko(U,F),g&&(U.h=g),k=U}return g=c.G,f=c.wa,g&&f&&Ue(k,g,f),Ue(k,"VER",c.ka),Po(c,k),k}function vg(c,f,g){if(f&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Aa&&!c.ma?new Ye(new dd({ab:g})):new Ye(c.ma),f.Fa(c.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function _g(){}t=_g.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function pl(){}pl.prototype.g=function(c,f){return new an(c,f)};function an(c,f){et.call(this),this.g=new cg(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(c?c["X-WebChannel-Client-Profile"]=f.sa:c={"X-WebChannel-Client-Profile":f.sa}),this.g.U=c,(c=f&&f.Qb)&&!N(c)&&(this.g.u=c),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!N(f)&&(this.g.G=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new vi(this)}m(an,et),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){md(this.g)},an.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.v&&(g={},g.__data__=ue(c),c=g);f.i.push(new xj(f.Ya++,c)),f.I==3&&ml(f)},an.prototype.N=function(){this.g.l=null,delete this.j,md(this.g),delete this.g,an.Z.N.call(this)};function wg(c){Qn.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const g in f){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}m(wg,Qn);function bg(){yo.call(this),this.status=1}m(bg,yo);function vi(c){this.g=c}m(vi,_g),vi.prototype.ra=function(){rt(this.g,"a")},vi.prototype.qa=function(c){rt(this.g,new wg(c))},vi.prototype.pa=function(c){rt(this.g,new bg)},vi.prototype.oa=function(){rt(this.g,"b")},pl.prototype.createWebChannel=pl.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,fw=function(){return new pl},mw=function(){return Ar()},hw=_n,lm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},al.NO_ERROR=0,al.TIMEOUT=8,al.HTTP_ERROR=6,tc=al,$p.COMPLETE="complete",dw=$p,be.EventType=tt,tt.OPEN="a",tt.CLOSE="b",tt.ERROR="c",tt.MESSAGE="d",et.prototype.listen=et.prototype.J,Ko=be,Ye.prototype.listenOnce=Ye.prototype.K,Ye.prototype.getLastError=Ye.prototype.Ha,Ye.prototype.getLastErrorCode=Ye.prototype.ya,Ye.prototype.getStatus=Ye.prototype.ca,Ye.prototype.getResponseJson=Ye.prototype.La,Ye.prototype.getResponseText=Ye.prototype.la,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Fa,uw=Ye}).apply(typeof Ol<"u"?Ol:typeof self<"u"?self:typeof window<"u"?window:{});const Hx="@firebase/firestore",qx="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ot.UNAUTHENTICATED=new Ot(null),Ot.GOOGLE_CREDENTIALS=new Ot("google-credentials-uid"),Ot.FIRST_PARTY=new Ot("first-party-uid"),Ot.MOCK_USER=new Ot("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ho="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=new Cf("@firebase/firestore");function wi(){return ti.logLevel}function ee(t,...e){if(ti.logLevel<=Ie.DEBUG){const n=e.map(Rf);ti.debug(`Firestore (${ho}): ${t}`,...n)}}function Ps(t,...e){if(ti.logLevel<=Ie.ERROR){const n=e.map(Rf);ti.error(`Firestore (${ho}): ${t}`,...n)}}function to(t,...e){if(ti.logLevel<=Ie.WARN){const n=e.map(Rf);ti.warn(`Firestore (${ho}): ${t}`,...n)}}function Rf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,pw(t,s,n)}function pw(t,e,n){let s=`FIRESTORE (${ho}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw Ps(s),new Error(s)}function Oe(t,e,n,s){let r="Unexpected state";typeof n=="string"?r=n:s=n,t||pw(e,r,s)}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Z extends Kn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class zS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ot.UNAUTHENTICATED))}shutdown(){}}class HS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class qS{constructor(e){this.t=e,this.currentUser=Ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Oe(this.o===void 0,42304);let s=this.i;const r=u=>this.i!==s?(s=this.i,n(u)):Promise.resolve();let o=new Is;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Is,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},l=u=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Is)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Oe(typeof s.accessToken=="string",31837,{l:s}),new gw(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Oe(e===null||typeof e=="string",2055,{h:e}),new Ot(e)}}class WS{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=Ot.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class KS{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new WS(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Wx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class GS{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Oe(this.o===void 0,3512);const s=o=>{o.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,ee("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>s(o))};const r=o=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?r(o):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Wx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Oe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Wx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=QS(40);for(let o=0;o<r.length;++o)s.length<20&&r[o]<n&&(s+=e.charAt(r[o]%62))}return s}}function Se(t,e){return t<e?-1:t>e?1:0}function cm(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const r=t.charAt(s),o=e.charAt(s);if(r!==o)return Qd(r)===Qd(o)?Se(r,o):Qd(r)?1:-1}return Se(t.length,e.length)}const JS=55296,YS=57343;function Qd(t){const e=t.charCodeAt(0);return e>=JS&&e<=YS}function no(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kx="__name__";class ts{constructor(e,n,s){n===void 0?n=0:n>e.length&&pe(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&pe(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return ts.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ts?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const o=ts.compareSegments(e.get(r),n.get(r));if(o!==0)return o}return Se(e.length,n.length)}static compareSegments(e,n){const s=ts.isNumericId(e),r=ts.isNumericId(n);return s&&!r?-1:!s&&r?1:s&&r?ts.extractNumericId(e).compare(ts.extractNumericId(n)):cm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return pr.fromString(e.substring(4,e.length-2))}}class $e extends ts{construct(e,n,s){return new $e(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new Z(H.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new $e(n)}static emptyPath(){return new $e([])}}const XS=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nt extends ts{construct(e,n,s){return new Nt(e,n,s)}static isValidIdentifier(e){return XS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Kx}static keyField(){return new Nt([Kx])}static fromServerFormat(e){const n=[];let s="",r=0;const o=()=>{if(s.length===0)throw new Z(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let a=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new Z(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Z(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=u,r+=2}else l==="`"?(a=!a,r++):l!=="."||a?(s+=l,r++):(o(),r++)}if(o(),a)throw new Z(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nt(n)}static emptyPath(){return new Nt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae($e.fromString(e))}static fromName(e){return new ae($e.fromString(e).popFirst(5))}static empty(){return new ae($e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return $e.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new $e(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xw(t,e,n){if(!n)throw new Z(H.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ZS(t,e,n,s){if(e===!0&&s===!0)throw new Z(H.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Gx(t){if(!ae.isDocumentKey(t))throw new Z(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Qx(t){if(ae.isDocumentKey(t))throw new Z(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function yw(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Su(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":pe(12329,{type:typeof t})}function on(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Z(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Su(t);throw new Z(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function eE(t,e){if(e<=0)throw new Z(H.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Ja(t,e){if(!yw(t))throw new Z(H.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const r=e[s].typeString,o="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const a=t[s];if(r&&typeof a!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(o!==void 0&&a!==o.value){n=`Expected '${s}' field to equal '${o.value}'`;break}}if(n)throw new Z(H.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx=-62135596800,Yx=1e6;class Fe{static now(){return Fe.fromMillis(Date.now())}static fromDate(e){return Fe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*Yx);return new Fe(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Z(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Z(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Jx)throw new Z(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Z(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Yx}_compareTo(e){return this.seconds===e.seconds?Se(this.nanoseconds,e.nanoseconds):Se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Fe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ja(e,Fe._jsonSchema))return new Fe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Jx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Fe._jsonSchemaVersion="firestore/timestamp/1.0",Fe._jsonSchema={type:lt("string",Fe._jsonSchemaVersion),seconds:lt("number"),nanoseconds:lt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{static fromTimestamp(e){return new ye(e)}static min(){return new ye(new Fe(0,0))}static max(){return new ye(new Fe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa=-1;function tE(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=ye.fromTimestamp(s===1e9?new Fe(n+1,0):new Fe(n,s));return new vr(r,ae.empty(),e)}function nE(t){return new vr(t.readTime,t.key,Aa)}class vr{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new vr(ye.min(),ae.empty(),Aa)}static max(){return new vr(ye.max(),ae.empty(),Aa)}}function sE(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ae.comparator(t.documentKey,e.documentKey),n!==0?n:Se(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class iE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mo(t){if(t.code!==H.FAILED_PRECONDITION||t.message!==rE)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((s,r)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(s,r)},this.catchCallback=o=>{this.wrapFailure(n,o).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,s)=>{n(e)})}static reject(e){return new q((n,s)=>{s(e)})}static waitFor(e){return new q((n,s)=>{let r=0,o=0,a=!1;e.forEach(l=>{++r,l.next(()=>{++o,a&&o===r&&n()},u=>s(u))}),a=!0,o===r&&n()})}static or(e){let n=q.resolve(!1);for(const s of e)n=n.next(r=>r?q.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,o)=>{s.push(n.call(this,r,o))}),this.waitFor(s)}static mapArray(e,n){return new q((s,r)=>{const o=e.length,a=new Array(o);let l=0;for(let u=0;u<o;u++){const d=u;n(e[d]).next(h=>{a[d]=h,++l,l===o&&s(a)},h=>r(h))}})}static doWhile(e,n){return new q((s,r)=>{const o=()=>{e()===!0?n().next(()=>{o()},r):s()};o()})}}function oE(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function fo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Eu.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf=-1;function Tu(t){return t==null}function $c(t){return t===0&&1/t==-1/0}function aE(t){return typeof t=="number"&&Number.isInteger(t)&&!$c(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw="";function lE(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Xx(e)),e=cE(t.get(n),e);return Xx(e)}function cE(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const o=t.charAt(r);switch(o){case"\0":n+="";break;case vw:n+="";break;default:n+=o}}return n}function Xx(t){return t+vw+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Er(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function _w(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e,n){this.comparator=e,this.root=n||wt.EMPTY}insert(e,n){return new Je(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,wt.BLACK,null,null))}remove(e){return new Je(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ml(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ml(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ml(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ml(this.root,e,this.comparator,!0)}}class Ml{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?s(e.key,n):1,n&&r&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wt{constructor(e,n,s,r,o){this.key=e,this.value=n,this.color=s??wt.RED,this.left=r??wt.EMPTY,this.right=o??wt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,o){return new wt(e??this.key,n??this.value,s??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const o=s(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,n,s),null):o===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return wt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return wt.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw pe(27949);return e+(this.isRed()?0:1)}}wt.EMPTY=null,wt.RED=!0,wt.BLACK=!1;wt.EMPTY=new class{constructor(){this.size=0}get key(){throw pe(57766)}get value(){throw pe(16141)}get color(){throw pe(16727)}get left(){throw pe(29726)}get right(){throw pe(36894)}copy(e,n,s,r,o){return this}insert(e,n,s){return new wt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.comparator=e,this.data=new Je(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new e0(this.data.getIterator())}getIteratorFrom(e){return new e0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof ft)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,o=s.getNext().key;if(this.comparator(r,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ft(this.comparator);return n.data=e,n}}class e0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.fields=e,e.sort(Nt.comparator)}static empty(){return new un([])}unionWith(e){let n=new ft(Nt.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new un(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return no(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new ww("Invalid base64 string: "+o):o}}(e);return new It(n)}static fromUint8Array(e){const n=function(r){let o="";for(let a=0;a<r.length;++a)o+=String.fromCharCode(r[a]);return o}(e);return new It(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}It.EMPTY_BYTE_STRING=new It("");const uE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _r(t){if(Oe(!!t,39018),typeof t=="string"){let e=0;const n=uE.exec(t);if(Oe(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function wr(t){return typeof t=="string"?It.fromBase64String(t):It.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw="server_timestamp",Nw="__type__",jw="__previous_value__",kw="__local_write_time__";function Lf(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Nw])==null?void 0:s.stringValue)===bw}function Au(t){const e=t.mapValue.fields[jw];return Lf(e)?Au(e):e}function Ca(t){const e=_r(t.mapValue.fields[kw].timestampValue);return new Fe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e,n,s,r,o,a,l,u,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const Fc="(default)";class Pa{constructor(e,n){this.projectId=e,this.database=n||Fc}static empty(){return new Pa("","")}get isDefaultDatabase(){return this.database===Fc}isEqual(e){return e instanceof Pa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="__type__",hE="__max__",Ll={mapValue:{}},Sw="__vector__",Dc="value";function br(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Lf(t)?4:fE(t)?9007199254740991:mE(t)?10:11:pe(28295,{value:t})}function ds(t,e){if(t===e)return!0;const n=br(t);if(n!==br(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ca(t).isEqual(Ca(e));case 3:return function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const a=_r(r.timestampValue),l=_r(o.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,o){return wr(r.bytesValue).isEqual(wr(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,o){return nt(r.geoPointValue.latitude)===nt(o.geoPointValue.latitude)&&nt(r.geoPointValue.longitude)===nt(o.geoPointValue.longitude)}(t,e);case 2:return function(r,o){if("integerValue"in r&&"integerValue"in o)return nt(r.integerValue)===nt(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const a=nt(r.doubleValue),l=nt(o.doubleValue);return a===l?$c(a)===$c(l):isNaN(a)&&isNaN(l)}return!1}(t,e);case 9:return no(t.arrayValue.values||[],e.arrayValue.values||[],ds);case 10:case 11:return function(r,o){const a=r.mapValue.fields||{},l=o.mapValue.fields||{};if(Zx(a)!==Zx(l))return!1;for(const u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!ds(a[u],l[u])))return!1;return!0}(t,e);default:return pe(52216,{left:t})}}function Ra(t,e){return(t.values||[]).find(n=>ds(n,e))!==void 0}function so(t,e){if(t===e)return 0;const n=br(t),s=br(e);if(n!==s)return Se(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Se(t.booleanValue,e.booleanValue);case 2:return function(o,a){const l=nt(o.integerValue||o.doubleValue),u=nt(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return t0(t.timestampValue,e.timestampValue);case 4:return t0(Ca(t),Ca(e));case 5:return cm(t.stringValue,e.stringValue);case 6:return function(o,a){const l=wr(o),u=wr(a);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(o,a){const l=o.split("/"),u=a.split("/");for(let d=0;d<l.length&&d<u.length;d++){const h=Se(l[d],u[d]);if(h!==0)return h}return Se(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,a){const l=Se(nt(o.latitude),nt(a.latitude));return l!==0?l:Se(nt(o.longitude),nt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return n0(t.arrayValue,e.arrayValue);case 10:return function(o,a){var p,x,v,j;const l=o.fields||{},u=a.fields||{},d=(p=l[Dc])==null?void 0:p.arrayValue,h=(x=u[Dc])==null?void 0:x.arrayValue,m=Se(((v=d==null?void 0:d.values)==null?void 0:v.length)||0,((j=h==null?void 0:h.values)==null?void 0:j.length)||0);return m!==0?m:n0(d,h)}(t.mapValue,e.mapValue);case 11:return function(o,a){if(o===Ll.mapValue&&a===Ll.mapValue)return 0;if(o===Ll.mapValue)return 1;if(a===Ll.mapValue)return-1;const l=o.fields||{},u=Object.keys(l),d=a.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let m=0;m<u.length&&m<h.length;++m){const p=cm(u[m],h[m]);if(p!==0)return p;const x=so(l[u[m]],d[h[m]]);if(x!==0)return x}return Se(u.length,h.length)}(t.mapValue,e.mapValue);default:throw pe(23264,{he:n})}}function t0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Se(t,e);const n=_r(t),s=_r(e),r=Se(n.seconds,s.seconds);return r!==0?r:Se(n.nanos,s.nanos)}function n0(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const o=so(n[r],s[r]);if(o)return o}return Se(n.length,s.length)}function ro(t){return um(t)}function um(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=_r(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return wr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ae.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",r=!0;for(const o of n.values||[])r?r=!1:s+=",",s+=um(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let r="{",o=!0;for(const a of s)o?o=!1:r+=",",r+=`${a}:${um(n.fields[a])}`;return r+"}"}(t.mapValue):pe(61005,{value:t})}function nc(t){switch(br(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Au(t);return e?16+nc(e):16;case 5:return 2*t.stringValue.length;case 6:return wr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,o)=>r+nc(o),0)}(t.arrayValue);case 10:case 11:return function(s){let r=0;return Er(s.fields,(o,a)=>{r+=o.length+nc(a)}),r}(t.mapValue);default:throw pe(13486,{value:t})}}function s0(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function dm(t){return!!t&&"integerValue"in t}function Vf(t){return!!t&&"arrayValue"in t}function r0(t){return!!t&&"nullValue"in t}function i0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function sc(t){return!!t&&"mapValue"in t}function mE(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Iw])==null?void 0:s.stringValue)===Sw}function aa(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Er(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=aa(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=aa(t.arrayValue.values[n]);return e}return{...t}}function fE(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===hE}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.value=e}static empty(){return new Xt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!sc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=aa(n)}setAll(e){let n=Nt.emptyPath(),s={},r=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,s,r),s={},r=[],n=l.popLast()}a?s[l.lastSegment()]=aa(a):r.push(l.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,s,r)}delete(e){const n=this.field(e.popLast());sc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ds(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];sc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Er(n,(r,o)=>e[r]=o);for(const r of s)delete e[r]}clone(){return new Xt(aa(this.value))}}function Ew(t){const e=[];return Er(t.fields,(n,s)=>{const r=new Nt([n]);if(sc(s)){const o=Ew(s.mapValue).fields;if(o.length===0)e.push(r);else for(const a of o)e.push(r.child(a))}else e.push(r)}),new un(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e,n,s,r,o,a,l){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=o,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Lt(e,0,ye.min(),ye.min(),ye.min(),Xt.empty(),0)}static newFoundDocument(e,n,s,r){return new Lt(e,1,n,ye.min(),s,r,0)}static newNoDocument(e,n){return new Lt(e,2,n,ye.min(),ye.min(),Xt.empty(),0)}static newUnknownDocument(e,n){return new Lt(e,3,n,ye.min(),ye.min(),Xt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Lt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Lt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,n){this.position=e,this.inclusive=n}}function o0(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const o=e[r],a=t.position[r];if(o.field.isKeyField()?s=ae.comparator(ae.fromName(a.referenceValue),n.key):s=so(a,n.data.field(o.field)),o.dir==="desc"&&(s*=-1),s!==0)break}return s}function a0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ds(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,n="asc"){this.field=e,this.dir=n}}function pE(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tw{}class at extends Tw{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new xE(e,n,s):n==="array-contains"?new _E(e,s):n==="in"?new wE(e,s):n==="not-in"?new bE(e,s):n==="array-contains-any"?new NE(e,s):new at(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new yE(e,s):new vE(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(so(n,this.value)):n!==null&&br(this.value)===br(n)&&this.matchesComparison(so(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qn extends Tw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new qn(e,n)}matches(e){return Aw(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Aw(t){return t.op==="and"}function Cw(t){return gE(t)&&Aw(t)}function gE(t){for(const e of t.filters)if(e instanceof qn)return!1;return!0}function hm(t){if(t instanceof at)return t.field.canonicalString()+t.op.toString()+ro(t.value);if(Cw(t))return t.filters.map(e=>hm(e)).join(",");{const e=t.filters.map(n=>hm(n)).join(",");return`${t.op}(${e})`}}function Pw(t,e){return t instanceof at?function(s,r){return r instanceof at&&s.op===r.op&&s.field.isEqual(r.field)&&ds(s.value,r.value)}(t,e):t instanceof qn?function(s,r){return r instanceof qn&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((o,a,l)=>o&&Pw(a,r.filters[l]),!0):!1}(t,e):void pe(19439)}function Rw(t){return t instanceof at?function(n){return`${n.field.canonicalString()} ${n.op} ${ro(n.value)}`}(t):t instanceof qn?function(n){return n.op.toString()+" {"+n.getFilters().map(Rw).join(" ,")+"}"}(t):"Filter"}class xE extends at{constructor(e,n,s){super(e,n,s),this.key=ae.fromName(s.referenceValue)}matches(e){const n=ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class yE extends at{constructor(e,n){super(e,"in",n),this.keys=Ow("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class vE extends at{constructor(e,n){super(e,"not-in",n),this.keys=Ow("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Ow(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(s=>ae.fromName(s.referenceValue))}class _E extends at{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Vf(n)&&Ra(n.arrayValue,this.value)}}class wE extends at{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ra(this.value.arrayValue,n)}}class bE extends at{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ra(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Ra(this.value.arrayValue,n)}}class NE extends at{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Vf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>Ra(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,n=null,s=[],r=[],o=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=o,this.startAt=a,this.endAt=l,this.Te=null}}function l0(t,e=null,n=[],s=[],r=null,o=null,a=null){return new jE(t,e,n,s,r,o,a)}function $f(t){const e=ve(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>hm(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(o){return o.field.canonicalString()+o.dir}(s)).join(","),Tu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>ro(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>ro(s)).join(",")),e.Te=n}return e.Te}function Ff(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!pE(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Pw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!a0(t.startAt,e.startAt)&&a0(t.endAt,e.endAt)}function mm(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,n=null,s=[],r=[],o=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=o,this.limitType=a,this.startAt=l,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function kE(t,e,n,s,r,o,a,l){return new po(t,e,n,s,r,o,a,l)}function Cu(t){return new po(t)}function c0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Mw(t){return t.collectionGroup!==null}function la(t){const e=ve(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),n.add(o.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new ft(Nt.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Oa(o,s))}),n.has(Nt.keyField().canonicalString())||e.Ie.push(new Oa(Nt.keyField(),s))}return e.Ie}function is(t){const e=ve(t);return e.Ee||(e.Ee=IE(e,la(t))),e.Ee}function IE(t,e){if(t.limitType==="F")return l0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const o=r.dir==="desc"?"asc":"desc";return new Oa(r.field,o)});const n=t.endAt?new Uc(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new Uc(t.startAt.position,t.startAt.inclusive):null;return l0(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function fm(t,e){const n=t.filters.concat([e]);return new po(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Bc(t,e,n){return new po(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Pu(t,e){return Ff(is(t),is(e))&&t.limitType===e.limitType}function Lw(t){return`${$f(is(t))}|lt:${t.limitType}`}function bi(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(r=>Rw(r)).join(", ")}]`),Tu(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(r=>ro(r)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(r=>ro(r)).join(",")),`Target(${s})`}(is(t))}; limitType=${t.limitType})`}function Ru(t,e){return e.isFoundDocument()&&function(s,r){const o=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(o):ae.isDocumentKey(s.path)?s.path.isEqual(o):s.path.isImmediateParentOf(o)}(t,e)&&function(s,r){for(const o of la(s))if(!o.field.isKeyField()&&r.data.field(o.field)===null)return!1;return!0}(t,e)&&function(s,r){for(const o of s.filters)if(!o.matches(r))return!1;return!0}(t,e)&&function(s,r){return!(s.startAt&&!function(a,l,u){const d=o0(a,l,u);return a.inclusive?d<=0:d<0}(s.startAt,la(s),r)||s.endAt&&!function(a,l,u){const d=o0(a,l,u);return a.inclusive?d>=0:d>0}(s.endAt,la(s),r))}(t,e)}function SE(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Vw(t){return(e,n)=>{let s=!1;for(const r of la(t)){const o=EE(r,e,n);if(o!==0)return o;s=s||r.field.isKeyField()}return 0}}function EE(t,e,n){const s=t.field.isKeyField()?ae.comparator(e.key,n.key):function(o,a,l){const u=a.data.field(o),d=l.data.field(o);return u!==null&&d!==null?so(u,d):pe(42886)}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return pe(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,o]of s)if(this.equalsFn(r,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return void(r[o]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Er(this.inner,(n,s)=>{for(const[r,o]of s)e(r,o)})}isEmpty(){return _w(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE=new Je(ae.comparator);function Rs(){return TE}const $w=new Je(ae.comparator);function Go(...t){let e=$w;for(const n of t)e=e.insert(n.key,n);return e}function Fw(t){let e=$w;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Br(){return ca()}function Dw(){return ca()}function ca(){return new fi(t=>t.toString(),(t,e)=>t.isEqual(e))}const AE=new Je(ae.comparator),CE=new ft(ae.comparator);function Ee(...t){let e=CE;for(const n of t)e=e.add(n);return e}const PE=new ft(Se);function RE(){return PE}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$c(e)?"-0":e}}function Uw(t){return{integerValue:""+t}}function OE(t,e){return aE(e)?Uw(e):Df(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(){this._=void 0}}function ME(t,e,n){return t instanceof Ma?function(r,o){const a={fields:{[Nw]:{stringValue:bw},[kw]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&Lf(o)&&(o=Au(o)),o&&(a.fields[jw]=o),{mapValue:a}}(n,e):t instanceof La?zw(t,e):t instanceof Va?Hw(t,e):function(r,o){const a=Bw(r,o),l=u0(a)+u0(r.Ae);return dm(a)&&dm(r.Ae)?Uw(l):Df(r.serializer,l)}(t,e)}function LE(t,e,n){return t instanceof La?zw(t,e):t instanceof Va?Hw(t,e):n}function Bw(t,e){return t instanceof zc?function(s){return dm(s)||function(o){return!!o&&"doubleValue"in o}(s)}(e)?e:{integerValue:0}:null}class Ma extends Ou{}class La extends Ou{constructor(e){super(),this.elements=e}}function zw(t,e){const n=qw(e);for(const s of t.elements)n.some(r=>ds(r,s))||n.push(s);return{arrayValue:{values:n}}}class Va extends Ou{constructor(e){super(),this.elements=e}}function Hw(t,e){let n=qw(e);for(const s of t.elements)n=n.filter(r=>!ds(r,s));return{arrayValue:{values:n}}}class zc extends Ou{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function u0(t){return nt(t.integerValue||t.doubleValue)}function qw(t){return Vf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e,n){this.field=e,this.transform=n}}function $E(t,e){return t.field.isEqual(e.field)&&function(s,r){return s instanceof La&&r instanceof La||s instanceof Va&&r instanceof Va?no(s.elements,r.elements,ds):s instanceof zc&&r instanceof zc?ds(s.Ae,r.Ae):s instanceof Ma&&r instanceof Ma}(t.transform,e.transform)}class FE{constructor(e,n){this.version=e,this.transformResults=n}}class Sn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Sn}static exists(e){return new Sn(void 0,e)}static updateTime(e){return new Sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Mu{}function Ww(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Uf(t.key,Sn.none()):new Ya(t.key,t.data,Sn.none());{const n=t.data,s=Xt.empty();let r=new ft(Nt.comparator);for(let o of e.fields)if(!r.has(o)){let a=n.field(o);a===null&&o.length>1&&(o=o.popLast(),a=n.field(o)),a===null?s.delete(o):s.set(o,a),r=r.add(o)}return new Tr(t.key,s,new un(r.toArray()),Sn.none())}}function DE(t,e,n){t instanceof Ya?function(r,o,a){const l=r.value.clone(),u=h0(r.fieldTransforms,o,a.transformResults);l.setAll(u),o.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Tr?function(r,o,a){if(!rc(r.precondition,o))return void o.convertToUnknownDocument(a.version);const l=h0(r.fieldTransforms,o,a.transformResults),u=o.data;u.setAll(Kw(r)),u.setAll(l),o.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(t,e,n):function(r,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,n)}function ua(t,e,n,s){return t instanceof Ya?function(o,a,l,u){if(!rc(o.precondition,a))return l;const d=o.value.clone(),h=m0(o.fieldTransforms,u,a);return d.setAll(h),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(t,e,n,s):t instanceof Tr?function(o,a,l,u){if(!rc(o.precondition,a))return l;const d=m0(o.fieldTransforms,u,a),h=a.data;return h.setAll(Kw(o)),h.setAll(d),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(m=>m.field))}(t,e,n,s):function(o,a,l){return rc(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(t,e,n)}function UE(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),o=Bw(s.transform,r||null);o!=null&&(n===null&&(n=Xt.empty()),n.set(s.field,o))}return n||null}function d0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&no(s,r,(o,a)=>$E(o,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ya extends Mu{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Tr extends Mu{constructor(e,n,s,r,o=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Kw(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function h0(t,e,n){const s=new Map;Oe(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const o=t[r],a=o.transform,l=e.data.field(o.field);s.set(o.field,LE(a,l,n[r]))}return s}function m0(t,e,n){const s=new Map;for(const r of t){const o=r.transform,a=n.data.field(r.field);s.set(r.field,ME(o,a,e))}return s}class Uf extends Mu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BE extends Mu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const o=this.mutations[r];o.key.isEqual(e.key)&&DE(o,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=ua(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=ua(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=Dw();return this.mutations.forEach(r=>{const o=e.get(r.key),a=o.overlayedDocument;let l=this.applyToLocalView(a,o.mutatedFields);l=n.has(r.key)?null:l;const u=Ww(a,l);u!==null&&s.set(r.key,u),a.isValidDocument()||a.convertToNoDocument(ye.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ee())}isEqual(e){return this.batchId===e.batchId&&no(this.mutations,e.mutations,(n,s)=>d0(n,s))&&no(this.baseMutations,e.baseMutations,(n,s)=>d0(n,s))}}class Bf{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){Oe(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return AE}();const o=e.mutations;for(let a=0;a<o.length;a++)r=r.insert(o[a].key,s[a].version);return new Bf(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it,Ce;function WE(t){switch(t){case H.OK:return pe(64938);case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0;default:return pe(15467,{code:t})}}function Gw(t){if(t===void 0)return Ps("GRPC error has no .code"),H.UNKNOWN;switch(t){case it.OK:return H.OK;case it.CANCELLED:return H.CANCELLED;case it.UNKNOWN:return H.UNKNOWN;case it.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case it.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case it.INTERNAL:return H.INTERNAL;case it.UNAVAILABLE:return H.UNAVAILABLE;case it.UNAUTHENTICATED:return H.UNAUTHENTICATED;case it.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case it.NOT_FOUND:return H.NOT_FOUND;case it.ALREADY_EXISTS:return H.ALREADY_EXISTS;case it.PERMISSION_DENIED:return H.PERMISSION_DENIED;case it.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case it.ABORTED:return H.ABORTED;case it.OUT_OF_RANGE:return H.OUT_OF_RANGE;case it.UNIMPLEMENTED:return H.UNIMPLEMENTED;case it.DATA_LOSS:return H.DATA_LOSS;default:return pe(39323,{code:t})}}(Ce=it||(it={}))[Ce.OK=0]="OK",Ce[Ce.CANCELLED=1]="CANCELLED",Ce[Ce.UNKNOWN=2]="UNKNOWN",Ce[Ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ce[Ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ce[Ce.NOT_FOUND=5]="NOT_FOUND",Ce[Ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ce[Ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ce[Ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ce[Ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ce[Ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ce[Ce.ABORTED=10]="ABORTED",Ce[Ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ce[Ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ce[Ce.INTERNAL=13]="INTERNAL",Ce[Ce.UNAVAILABLE=14]="UNAVAILABLE",Ce[Ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE=new pr([4294967295,4294967295],0);function f0(t){const e=KE().encode(t),n=new cw;return n.update(e),new Uint8Array(n.digest())}function p0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new pr([n,s],0),new pr([r,o],0)]}class zf{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new Qo(`Invalid padding: ${n}`);if(s<0)throw new Qo(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Qo(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new Qo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=pr.fromNumber(this.ge)}ye(e,n,s){let r=e.add(n.multiply(pr.fromNumber(s)));return r.compare(GE)===1&&(r=new pr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=f0(e),[s,r]=p0(n);for(let o=0;o<this.hashCount;o++){const a=this.ye(s,r,o);if(!this.we(a))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new zf(o,r,n);return s.forEach(l=>a.insert(l)),a}insert(e){if(this.ge===0)return;const n=f0(e),[s,r]=p0(n);for(let o=0;o<this.hashCount;o++){const a=this.ye(s,r,o);this.Se(a)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class Qo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,n,s,r,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,Xa.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new Lu(ye.min(),r,new Je(Se),Rs(),Ee())}}class Xa{constructor(e,n,s,r,o){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new Xa(s,n,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n,s,r){this.be=e,this.removedTargetIds=n,this.key=s,this.De=r}}class Qw{constructor(e,n){this.targetId=e,this.Ce=n}}class Jw{constructor(e,n,s=It.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class g0{constructor(){this.ve=0,this.Fe=x0(),this.Me=It.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ee(),n=Ee(),s=Ee();return this.Fe.forEach((r,o)=>{switch(o){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:pe(38017,{changeType:o})}}),new Xa(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=x0()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Oe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class QE{constructor(e){this.Ge=e,this.ze=new Map,this.je=Rs(),this.Je=Vl(),this.He=Vl(),this.Ye=new Je(Se)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:pe(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((s,r)=>{this.rt(r)&&n(r)})}st(e){const n=e.targetId,s=e.Ce.count,r=this.ot(n);if(r){const o=r.target;if(mm(o))if(s===0){const a=new ae(o.path);this.et(n,a,Lt.newNoDocument(a,ye.min()))}else Oe(s===1,20013,{expectedCount:s});else{const a=this._t(n);if(a!==s){const l=this.ut(e),u=l?this.ct(l,e,a):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:o=0}=n;let a,l;try{a=wr(s).toUint8Array()}catch(u){if(u instanceof ww)return to("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new zf(a,r,o)}catch(u){return to(u instanceof Qo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.ge===0?null:l}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let r=0;return s.forEach(o=>{const a=this.Ge.ht(),l=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.et(n,o,null),r++)}),r}Tt(e){const n=new Map;this.ze.forEach((o,a)=>{const l=this.ot(a);if(l){if(o.current&&mm(l.target)){const u=new ae(l.target.path);this.It(u).has(a)||this.Et(a,u)||this.et(a,u,Lt.newNoDocument(u,e))}o.Be&&(n.set(a,o.ke()),o.qe())}});let s=Ee();this.He.forEach((o,a)=>{let l=!0;a.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(o))}),this.je.forEach((o,a)=>a.setReadTime(e));const r=new Lu(e,n,this.Ye,this.je,s);return this.je=Rs(),this.Je=Vl(),this.He=Vl(),this.Ye=new Je(Se),r}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new g0,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new ft(Se),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new ft(Se),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new g0),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Vl(){return new Je(ae.comparator)}function x0(){return new Je(ae.comparator)}const JE={asc:"ASCENDING",desc:"DESCENDING"},YE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XE={and:"AND",or:"OR"};class ZE{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function pm(t,e){return t.useProto3Json||Tu(e)?e:{value:e}}function Hc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function eT(t,e){return Hc(t,e.toTimestamp())}function os(t){return Oe(!!t,49232),ye.fromTimestamp(function(n){const s=_r(n);return new Fe(s.seconds,s.nanos)}(t))}function Hf(t,e){return gm(t,e).canonicalString()}function gm(t,e){const n=function(r){return new $e(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Xw(t){const e=$e.fromString(t);return Oe(sb(e),10190,{key:e.toString()}),e}function xm(t,e){return Hf(t.databaseId,e.path)}function Jd(t,e){const n=Xw(e);if(n.get(1)!==t.databaseId.projectId)throw new Z(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Z(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ae(eb(n))}function Zw(t,e){return Hf(t.databaseId,e)}function tT(t){const e=Xw(t);return e.length===4?$e.emptyPath():eb(e)}function ym(t){return new $e(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function eb(t){return Oe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function y0(t,e,n){return{name:xm(t,e),fields:n.value.mapValue.fields}}function nT(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:pe(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],o=function(d,h){return d.useProto3Json?(Oe(h===void 0||typeof h=="string",58123),It.fromBase64String(h||"")):(Oe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),It.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(d){const h=d.code===void 0?H.UNKNOWN:Gw(d.code);return new Z(h,d.message||"")}(a);n=new Jw(s,r,o,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Jd(t,s.document.name),o=os(s.document.updateTime),a=s.document.createTime?os(s.document.createTime):ye.min(),l=new Xt({mapValue:{fields:s.document.fields}}),u=Lt.newFoundDocument(r,o,a,l),d=s.targetIds||[],h=s.removedTargetIds||[];n=new ic(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Jd(t,s.document),o=s.readTime?os(s.readTime):ye.min(),a=Lt.newNoDocument(r,o),l=s.removedTargetIds||[];n=new ic([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Jd(t,s.document),o=s.removedTargetIds||[];n=new ic([],o,r,null)}else{if(!("filter"in e))return pe(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:o}=s,a=new qE(r,o),l=s.targetId;n=new Qw(l,a)}}return n}function sT(t,e){let n;if(e instanceof Ya)n={update:y0(t,e.key,e.value)};else if(e instanceof Uf)n={delete:xm(t,e.key)};else if(e instanceof Tr)n={update:y0(t,e.key,e.data),updateMask:hT(e.fieldMask)};else{if(!(e instanceof BE))return pe(16599,{Vt:e.type});n={verify:xm(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(o,a){const l=a.transform;if(l instanceof Ma)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof La)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Va)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof zc)return{fieldPath:a.field.canonicalString(),increment:l.Ae};throw pe(20930,{transform:a.transform})}(0,s))),e.precondition.isNone||(n.currentDocument=function(r,o){return o.updateTime!==void 0?{updateTime:eT(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:pe(27497)}(t,e.precondition)),n}function rT(t,e){return t&&t.length>0?(Oe(e!==void 0,14353),t.map(n=>function(r,o){let a=r.updateTime?os(r.updateTime):os(o);return a.isEqual(ye.min())&&(a=os(o)),new FE(a,r.transformResults||[])}(n,e))):[]}function iT(t,e){return{documents:[Zw(t,e.path)]}}function oT(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=Zw(t,r);const o=function(d){if(d.length!==0)return nb(qn.create(d,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const a=function(d){if(d.length!==0)return d.map(h=>function(p){return{field:Ni(p.field),direction:cT(p.dir)}}(h))}(e.orderBy);a&&(n.structuredQuery.orderBy=a);const l=pm(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:r}}function aT(t){let e=tT(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){Oe(s===1,65062);const h=n.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let o=[];n.where&&(o=function(m){const p=tb(m);return p instanceof qn&&Cw(p)?p.getFilters():[p]}(n.where));let a=[];n.orderBy&&(a=function(m){return m.map(p=>function(v){return new Oa(ji(v.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(p))}(n.orderBy));let l=null;n.limit&&(l=function(m){let p;return p=typeof m=="object"?m.value:m,Tu(p)?null:p}(n.limit));let u=null;n.startAt&&(u=function(m){const p=!!m.before,x=m.values||[];return new Uc(x,p)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const p=!m.before,x=m.values||[];return new Uc(x,p)}(n.endAt)),kE(e,r,a,o,l,"F",u,d)}function lT(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pe(28987,{purpose:r})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function tb(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=ji(n.unaryFilter.field);return at.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=ji(n.unaryFilter.field);return at.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ji(n.unaryFilter.field);return at.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ji(n.unaryFilter.field);return at.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return pe(61313);default:return pe(60726)}}(t):t.fieldFilter!==void 0?function(n){return at.create(ji(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return pe(58110);default:return pe(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return qn.create(n.compositeFilter.filters.map(s=>tb(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return pe(1026)}}(n.compositeFilter.op))}(t):pe(30097,{filter:t})}function cT(t){return JE[t]}function uT(t){return YE[t]}function dT(t){return XE[t]}function Ni(t){return{fieldPath:t.canonicalString()}}function ji(t){return Nt.fromServerFormat(t.fieldPath)}function nb(t){return t instanceof at?function(n){if(n.op==="=="){if(i0(n.value))return{unaryFilter:{field:Ni(n.field),op:"IS_NAN"}};if(r0(n.value))return{unaryFilter:{field:Ni(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(i0(n.value))return{unaryFilter:{field:Ni(n.field),op:"IS_NOT_NAN"}};if(r0(n.value))return{unaryFilter:{field:Ni(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ni(n.field),op:uT(n.op),value:n.value}}}(t):t instanceof qn?function(n){const s=n.getFilters().map(r=>nb(r));return s.length===1?s[0]:{compositeFilter:{op:dT(n.op),filters:s}}}(t):pe(54877,{filter:t})}function hT(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sb(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e,n,s,r,o=ye.min(),a=ye.min(),l=It.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new ir(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(e){this.yt=e}}function fT(t){const e=aT({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Bc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(){this.Cn=new gT}addToCollectionParentIndex(e,n){return this.Cn.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(vr.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(vr.min())}updateCollectionGroup(e,n,s){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class gT{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new ft($e.comparator),o=!r.has(s);return this.index[n]=r.add(s),o}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new ft($e.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rb=41943040;class Jt{static withCacheSize(e){return new Jt(e,Jt.DEFAULT_COLLECTION_PERCENTILE,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Jt.DEFAULT_COLLECTION_PERCENTILE=10,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jt.DEFAULT=new Jt(rb,Jt.DEFAULT_COLLECTION_PERCENTILE,Jt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jt.DISABLED=new Jt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new io(0)}static cr(){return new io(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0="LruGarbageCollector",xT=1048576;function w0([t,e],[n,s]){const r=Se(t,n);return r===0?Se(e,s):r}class yT{constructor(e){this.Ir=e,this.buffer=new ft(w0),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();w0(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class vT{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(_0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){fo(n)?ee(_0,"Ignoring IndexedDB error during garbage collection: ",n):await mo(n)}await this.Vr(3e5)})}}class _T{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return q.resolve(Eu.ce);const s=new yT(n);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(v0)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),v0):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,r,o,a,l,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,a=Date.now(),this.nthSequenceNumber(e,r))).next(m=>(s=m,l=Date.now(),this.removeTargets(e,s,n))).next(m=>(o=m,u=Date.now(),this.removeOrphanedDocuments(e,s))).next(m=>(d=Date.now(),wi()<=Ie.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${r} in `+(l-a)+`ms
	Removed ${o} targets in `+(u-l)+`ms
	Removed ${m} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:m})))}}function wT(t,e){return new _T(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(){this.changes=new fi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Lt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?q.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&ua(s.mutation,r,un.empty(),Fe.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,Ee()).next(()=>s))}getLocalViewOfDocuments(e,n,s=Ee()){const r=Br();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(o=>{let a=Go();return o.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const s=Br();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,Ee()))}populateOverlays(e,n,s){const r=[];return s.forEach(o=>{n.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(e,r).next(o=>{o.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,s,r){let o=Rs();const a=ca(),l=function(){return ca()}();return n.forEach((u,d)=>{const h=s.get(d.key);r.has(d.key)&&(h===void 0||h.mutation instanceof Tr)?o=o.insert(d.key,d):h!==void 0?(a.set(d.key,h.mutation.getFieldMask()),ua(h.mutation,d,h.mutation.getFieldMask(),Fe.now())):a.set(d.key,un.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((d,h)=>a.set(d,h)),n.forEach((d,h)=>l.set(d,new NT(h,a.get(d)??null))),l))}recalculateAndSaveOverlays(e,n){const s=ca();let r=new Je((a,l)=>a-l),o=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let h=s.get(u)||un.empty();h=l.applyToLocalView(d,h),s.set(u,h);const m=(r.get(l.batchId)||Ee()).add(u);r=r.insert(l.batchId,m)})}).next(()=>{const a=[],l=r.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,h=u.value,m=Dw();h.forEach(p=>{if(!o.has(p)){const x=Ww(n.get(p),s.get(p));x!==null&&m.set(p,x),o=o.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,m))}return q.waitFor(a)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,r){return function(a){return ae.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Mw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(o=>{const a=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-o.size):q.resolve(Br());let l=Aa,u=o;return a.next(d=>q.forEach(d,(h,m)=>(l<m.largestBatchId&&(l=m.largestBatchId),o.get(h)?q.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{u=u.insert(h,p)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,u,d,Ee())).next(h=>({batchId:l,changes:Fw(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ae(n)).next(s=>{let r=Go();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const o=n.collectionGroup;let a=Go();return this.indexManager.getCollectionParents(e,o).next(l=>q.forEach(l,u=>{const d=function(m,p){return new po(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,s,r).next(h=>{h.forEach((m,p)=>{a=a.insert(m,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,n,s,r){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,o,r))).next(a=>{o.forEach((u,d)=>{const h=d.getKey();a.get(h)===null&&(a=a.insert(h,Lt.newInvalidDocument(h)))});let l=Go();return a.forEach((u,d)=>{const h=o.get(u);h!==void 0&&ua(h.mutation,d,un.empty(),Fe.now()),Ru(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return q.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:os(r.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(r){return{name:r.name,query:fT(r.bundledQuery),readTime:os(r.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(){this.overlays=new Je(ae.comparator),this.qr=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Br();return q.forEach(n,r=>this.getOverlay(e,r).next(o=>{o!==null&&s.set(r,o)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,o)=>{this.St(e,n,o)}),q.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.qr.delete(s)),q.resolve()}getOverlaysForCollection(e,n,s){const r=Br(),o=n.length+1,a=new ae(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===o&&u.largestBatchId>s&&r.set(u.getKey(),u)}return q.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let o=new Je((d,h)=>d-h);const a=this.overlays.getIterator();for(;a.hasNext();){const d=a.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>s){let h=o.get(d.largestBatchId);h===null&&(h=Br(),o=o.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=Br(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=r)););return q.resolve(l)}St(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const a=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(s.key,new HE(n,s));let o=this.qr.get(n);o===void 0&&(o=Ee(),this.qr.set(n,o)),this.qr.set(n,o.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(){this.sessionToken=It.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(){this.Qr=new ft(gt.$r),this.Ur=new ft(gt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new gt(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Gr(new gt(e,n))}zr(e,n){e.forEach(s=>this.removeReference(s,n))}jr(e){const n=new ae(new $e([])),s=new gt(n,e),r=new gt(n,e+1),o=[];return this.Ur.forEachInRange([s,r],a=>{this.Gr(a),o.push(a.key)}),o}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ae(new $e([])),s=new gt(n,e),r=new gt(n,e+1);let o=Ee();return this.Ur.forEachInRange([s,r],a=>{o=o.add(a.key)}),o}containsKey(e){const n=new gt(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class gt{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ae.comparator(e.key,n.key)||Se(e.Yr,n.Yr)}static Kr(e,n){return Se(e.Yr,n.Yr)||ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new ft(gt.$r)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new zE(o,n,s,r);this.mutationQueue.push(a);for(const l of r)this.Zr=this.Zr.add(new gt(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return q.resolve(a)}lookupMutationBatch(e,n){return q.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ei(s),o=r<0?0:r;return q.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?Mf:this.tr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new gt(n,0),r=new gt(n,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([s,r],a=>{const l=this.Xr(a.Yr);o.push(l)}),q.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new ft(Se);return n.forEach(r=>{const o=new gt(r,0),a=new gt(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,a],l=>{s=s.add(l.Yr)})}),q.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let o=s;ae.isDocumentKey(o)||(o=o.child(""));const a=new gt(new ae(o),0);let l=new ft(Se);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!s.isPrefixOf(d)&&(d.length===r&&(l=l.add(u.Yr)),!0)},a),q.resolve(this.ti(l))}ti(e){const n=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){Oe(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return q.forEach(n.mutations,r=>{const o=new gt(r.key,n.batchId);return s=s.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,n){const s=new gt(n,0),r=this.Zr.firstAfterOrEqual(s);return q.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e){this.ri=e,this.docs=function(){return new Je(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),o=r?r.size:0,a=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return q.resolve(s?s.document.mutableCopy():Lt.newInvalidDocument(n))}getEntries(e,n){let s=Rs();return n.forEach(r=>{const o=this.docs.get(r);s=s.insert(r,o?o.document.mutableCopy():Lt.newInvalidDocument(r))}),q.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let o=Rs();const a=n.path,l=new ae(a.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||sE(nE(h),s)<=0||(r.has(h.key)||Ru(n,h))&&(o=o.insert(h.key,h.mutableCopy()))}return q.resolve(o)}getAllFromCollectionGroup(e,n,s,r){pe(9500)}ii(e,n){return q.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new AT(this)}getSize(e){return q.resolve(this.size)}}class AT extends bT{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),q.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e){this.persistence=e,this.si=new fi(n=>$f(n),Ff),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.oi=0,this._i=new qf,this.targetCount=0,this.ai=io.ur()}forEachTarget(e,n){return this.si.forEach((s,r)=>n(r)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),q.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new io(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.Pr(n),q.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,s){let r=0;const o=[];return this.si.forEach((a,l)=>{l.sequenceNumber<=n&&s.get(l.targetId)===null&&(this.si.delete(a),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),q.waitFor(o).next(()=>r)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return q.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),q.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const r=this.persistence.referenceDelegate,o=[];return r&&n.forEach(a=>{o.push(r.markPotentiallyOrphaned(e,a))}),q.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return q.resolve(s)}containsKey(e,n){return q.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e,n){this.ui={},this.overlays={},this.ci=new Eu(0),this.li=!1,this.li=!0,this.hi=new ST,this.referenceDelegate=e(this),this.Pi=new CT(this),this.indexManager=new pT,this.remoteDocumentCache=function(r){return new TT(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new mT(n),this.Ii=new kT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new IT,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new ET(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){ee("MemoryPersistence","Starting transaction:",e);const r=new PT(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(o=>this.referenceDelegate.di(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Ai(e,n){return q.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,n)))}}class PT extends iE{constructor(e){super(),this.currentSequenceNumber=e}}class Wf{constructor(e){this.persistence=e,this.Ri=new qf,this.Vi=null}static mi(e){return new Wf(e)}get fi(){if(this.Vi)return this.Vi;throw pe(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),q.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),q.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(o=>this.fi.add(o.toString()))}).next(()=>s.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,s=>{const r=ae.fromPath(s);return this.gi(e,r).next(o=>{o||n.removeEntry(r,ye.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return q.or([()=>q.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class qc{constructor(e,n){this.persistence=e,this.pi=new fi(s=>lE(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=wT(this,n)}static mi(e,n){return new qc(e,n)}Ei(){}di(e){return q.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}wr(e){let n=0;return this.pr(e,s=>{n++}).next(()=>n)}pr(e,n){return q.forEach(this.pi,(s,r)=>this.br(e,s,r).next(o=>o?q.resolve():n(r)))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const r=this.persistence.getRemoteDocumentCache(),o=r.newChangeBuffer();return r.ii(e,a=>this.br(e,a,n).next(l=>{l||(s++,o.removeEntry(a,ye.min()))})).next(()=>o.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),q.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=nc(e.data.value)),n}br(e,n,s){return q.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return q.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=r}static As(e,n){let s=Ee(),r=Ee();for(const o of n.docChanges)switch(o.type){case 0:s=s.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new Kf(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RT{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return kI()?8:oE(Dt())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,r){const o={result:null};return this.ys(e,n).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.ws(e,n,r,s).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new RT;return this.Ss(e,n,a).next(l=>{if(o.result=l,this.Vs)return this.bs(e,n,a,l.size)})}).next(()=>o.result)}bs(e,n,s,r){return s.documentReadCount<this.fs?(wi()<=Ie.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",bi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(wi()<=Ie.DEBUG&&ee("QueryEngine","Query:",bi(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(wi()<=Ie.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",bi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,is(n))):q.resolve())}ys(e,n){if(c0(n))return q.resolve(null);let s=is(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=Bc(n,null,"F"),s=is(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(o=>{const a=Ee(...o);return this.ps.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,s).next(u=>{const d=this.Ds(n,l);return this.Cs(n,d,a,u.readTime)?this.ys(e,Bc(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,s,r){return c0(n)||r.isEqual(ye.min())?q.resolve(null):this.ps.getDocuments(e,s).next(o=>{const a=this.Ds(n,o);return this.Cs(n,a,s,r)?q.resolve(null):(wi()<=Ie.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),bi(n)),this.vs(e,a,n,tE(r,Aa)).next(l=>l))})}Ds(e,n){let s=new ft(Vw(e));return n.forEach((r,o)=>{Ru(e,o)&&(s=s.add(o))}),s}Cs(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}Ss(e,n,s){return wi()<=Ie.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",bi(n)),this.ps.getDocumentsMatchingQuery(e,n,vr.min(),s)}vs(e,n,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(o=>(n.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf="LocalStore",MT=3e8;class LT{constructor(e,n,s,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new Je(Se),this.xs=new fi(o=>$f(o),Ff),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jT(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function VT(t,e,n,s){return new LT(t,e,n,s)}async function ob(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(o=>(r=o,n.Bs(e),n.mutationQueue.getAllMutationBatches(s))).next(o=>{const a=[],l=[];let u=Ee();for(const d of r){a.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of o){l.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(s,u).next(d=>({Ls:d,removedBatchIds:a,addedBatchIds:l}))})})}function $T(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),o=n.Ns.newChangeBuffer({trackRemovals:!0});return function(l,u,d,h){const m=d.batch,p=m.keys();let x=q.resolve();return p.forEach(v=>{x=x.next(()=>h.getEntry(u,v)).next(j=>{const A=d.docVersions.get(v);Oe(A!==null,48541),j.version.compareTo(A)<0&&(m.applyToRemoteDocument(j,d),j.isValidDocument()&&(j.setReadTime(d.commitVersion),h.addEntry(j)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(u,m))}(n,s,e,o).next(()=>o.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let u=Ee();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function ab(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function FT(t,e){const n=ve(t),s=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const l=[];e.targetChanges.forEach((h,m)=>{const p=r.get(m);if(!p)return;l.push(n.Pi.removeMatchingKeys(o,h.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(o,h.addedDocuments,m)));let x=p.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(m)!==null?x=x.withResumeToken(It.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):h.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(h.resumeToken,s)),r=r.insert(m,x),function(j,A,w){return j.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=MT?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(p,x,h)&&l.push(n.Pi.updateTargetData(o,x))});let u=Rs(),d=Ee();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(o,h))}),l.push(DT(o,a,e.documentUpdates).next(h=>{u=h.ks,d=h.qs})),!s.isEqual(ye.min())){const h=n.Pi.getLastRemoteSnapshotVersion(o).next(m=>n.Pi.setTargetsMetadata(o,o.currentSequenceNumber,s));l.push(h)}return q.waitFor(l).next(()=>a.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,u,d)).next(()=>u)}).then(o=>(n.Ms=r,o))}function DT(t,e,n){let s=Ee(),r=Ee();return n.forEach(o=>s=s.add(o)),e.getEntries(t,s).next(o=>{let a=Rs();return n.forEach((l,u)=>{const d=o.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(r=r.add(l)),u.isNoDocument()&&u.version.isEqual(ye.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):ee(Gf,"Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{ks:a,qs:r}})}function UT(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=Mf),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function BT(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Pi.getTargetData(s,e).next(o=>o?(r=o,q.resolve(r)):n.Pi.allocateTargetId(s).next(a=>(r=new ir(e,a,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s})}async function vm(t,e,n){const s=ve(t),r=s.Ms.get(e),o=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",o,a=>s.persistence.referenceDelegate.removeTarget(a,r))}catch(a){if(!fo(a))throw a;ee(Gf,`Failed to update sequence numbers for target ${e}: ${a}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function b0(t,e,n){const s=ve(t);let r=ye.min(),o=Ee();return s.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,h){const m=ve(u),p=m.xs.get(h);return p!==void 0?q.resolve(m.Ms.get(p)):m.Pi.getTargetData(d,h)}(s,a,is(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(a,l.targetId).next(u=>{o=u})}).next(()=>s.Fs.getDocumentsMatchingQuery(a,e,n?r:ye.min(),n?o:Ee())).next(l=>(zT(s,SE(e),l),{documents:l,Qs:o})))}function zT(t,e,n){let s=t.Os.get(e)||ye.min();n.forEach((r,o)=>{o.readTime.compareTo(s)>0&&(s=o.readTime)}),t.Os.set(e,s)}class N0{constructor(){this.activeTargetIds=RE()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class HT{constructor(){this.Mo=new N0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new N0,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0="ConnectivityMonitor";class k0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee(j0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee(j0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $l=null;function _m(){return $l===null?$l=function(){return 268435456+Math.round(2147483648*Math.random())}():$l++,"0x"+$l.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="RestConnection",WT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class KT{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===Fc?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,n,s,r,o){const a=_m(),l=this.zo(e,n.toUriEncodedString());ee(Yd,`Sending RPC '${e}' ${a}:`,l,s);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,r,o);const{host:d}=new URL(l),h=ui(d);return this.Jo(e,l,u,s,h).then(m=>(ee(Yd,`Received RPC '${e}' ${a}: `,m),m),m=>{throw to(Yd,`RPC '${e}' ${a} failed with error: `,m,"url: ",l,"request:",s),m})}Ho(e,n,s,r,o,a){return this.Go(e,n,s,r,o)}jo(e,n,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ho}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,o)=>e[o]=r),s&&s.headers.forEach((r,o)=>e[o]=r)}zo(e,n){const s=WT[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rt="WebChannelConnection";class QT extends KT{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,r,o){const a=_m();return new Promise((l,u)=>{const d=new uw;d.setWithCredentials(!0),d.listenOnce(dw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case tc.NO_ERROR:const m=d.getResponseJson();ee(Rt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),l(m);break;case tc.TIMEOUT:ee(Rt,`RPC '${e}' ${a} timed out`),u(new Z(H.DEADLINE_EXCEEDED,"Request time out"));break;case tc.HTTP_ERROR:const p=d.getStatus();if(ee(Rt,`RPC '${e}' ${a} failed with status:`,p,"response text:",d.getResponseText()),p>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const v=x==null?void 0:x.error;if(v&&v.status&&v.message){const j=function(w){const y=w.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(y)>=0?y:H.UNKNOWN}(v.status);u(new Z(j,v.message))}else u(new Z(H.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new Z(H.UNAVAILABLE,"Connection failed."));break;default:pe(9055,{l_:e,streamId:a,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ee(Rt,`RPC '${e}' ${a} completed.`)}});const h=JSON.stringify(r);ee(Rt,`RPC '${e}' ${a} sending request:`,r),d.send(n,"POST",h,s,15)})}T_(e,n,s){const r=_m(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=fw(),l=mw(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,s),u.encodeInitMessageHeaders=!0;const h=o.join("");ee(Rt,`Creating RPC '${e}' stream ${r}: ${h}`,u);const m=a.createWebChannel(h,u);this.I_(m);let p=!1,x=!1;const v=new GT({Yo:A=>{x?ee(Rt,`Not sending because RPC '${e}' stream ${r} is closed:`,A):(p||(ee(Rt,`Opening RPC '${e}' stream ${r} transport.`),m.open(),p=!0),ee(Rt,`RPC '${e}' stream ${r} sending:`,A),m.send(A))},Zo:()=>m.close()}),j=(A,w,y)=>{A.listen(w,E=>{try{y(E)}catch(R){setTimeout(()=>{throw R},0)}})};return j(m,Ko.EventType.OPEN,()=>{x||(ee(Rt,`RPC '${e}' stream ${r} transport opened.`),v.o_())}),j(m,Ko.EventType.CLOSE,()=>{x||(x=!0,ee(Rt,`RPC '${e}' stream ${r} transport closed`),v.a_(),this.E_(m))}),j(m,Ko.EventType.ERROR,A=>{x||(x=!0,to(Rt,`RPC '${e}' stream ${r} transport errored. Name:`,A.name,"Message:",A.message),v.a_(new Z(H.UNAVAILABLE,"The operation could not be completed")))}),j(m,Ko.EventType.MESSAGE,A=>{var w;if(!x){const y=A.data[0];Oe(!!y,16349);const E=y,R=(E==null?void 0:E.error)||((w=E[0])==null?void 0:w.error);if(R){ee(Rt,`RPC '${e}' stream ${r} received error:`,R);const $=R.status;let D=function(S){const I=it[S];if(I!==void 0)return Gw(I)}($),_=R.message;D===void 0&&(D=H.INTERNAL,_="Unknown error status: "+$+" with message "+R.message),x=!0,v.a_(new Z(D,_)),m.close()}else ee(Rt,`RPC '${e}' stream ${r} received:`,y),v.u_(y)}}),j(l,hw.STAT_EVENT,A=>{A.stat===lm.PROXY?ee(Rt,`RPC '${e}' stream ${r} detected buffering proxy`):A.stat===lm.NOPROXY&&ee(Rt,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{v.__()},0),v}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Xd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(t){return new ZE(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(e,n,s=1e3,r=1.5,o=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=r,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-s);r>0&&ee("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0="PersistentStream";class cb{constructor(e,n,s,r,o,a,l,u){this.Mi=e,this.S_=s,this.b_=r,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new lb(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===H.RESOURCE_EXHAUSTED?(Ps(n.toString()),Ps("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===n&&this.G_(s,r)},s=>{e(()=>{const r=new Z(H.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(I0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(I0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class JT extends cb{constructor(e,n,s,r,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,a),this.serializer=o}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=nT(this.serializer,e),s=function(o){if(!("targetChange"in o))return ye.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?ye.min():a.readTime?os(a.readTime):ye.min()}(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=ym(this.serializer),n.addTarget=function(o,a){let l;const u=a.target;if(l=mm(u)?{documents:iT(o,u)}:{query:oT(o,u).ft},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Yw(o,a.resumeToken);const d=pm(o,a.expectedCount);d!==null&&(l.expectedCount=d)}else if(a.snapshotVersion.compareTo(ye.min())>0){l.readTime=Hc(o,a.snapshotVersion.toTimestamp());const d=pm(o,a.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const s=lT(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=ym(this.serializer),n.removeTarget=e,this.q_(n)}}class YT extends cb{constructor(e,n,s,r,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,a),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=rT(e.writeResults,e.commitTime),s=os(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=ym(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>sT(this.serializer,s))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{}class ZT extends XT{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Z(H.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Go(e,gm(n,s),r,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Z(H.UNKNOWN,o.toString())})}Ho(e,n,s,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Ho(e,gm(n,s),r,a,l,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Z(H.UNKNOWN,a.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class e2{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ps(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ni="RemoteStore";class t2{constructor(e,n,s,r,o){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo(a=>{s.enqueueAndForget(async()=>{pi(this)&&(ee(ni,"Restarting streams for network reachability change."),await async function(u){const d=ve(u);d.Ea.add(4),await Za(d),d.Ra.set("Unknown"),d.Ea.delete(4),await $u(d)}(this))})}),this.Ra=new e2(s,r)}}async function $u(t){if(pi(t))for(const e of t.da)await e(!0)}async function Za(t){for(const e of t.da)await e(!1)}function ub(t,e){const n=ve(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Xf(n)?Yf(n):go(n).O_()&&Jf(n,e))}function Qf(t,e){const n=ve(t),s=go(n);n.Ia.delete(e),s.O_()&&db(n,e),n.Ia.size===0&&(s.O_()?s.L_():pi(n)&&n.Ra.set("Unknown"))}function Jf(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ye.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}go(t).Y_(e)}function db(t,e){t.Va.Ue(e),go(t).Z_(e)}function Yf(t){t.Va=new QE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),go(t).start(),t.Ra.ua()}function Xf(t){return pi(t)&&!go(t).x_()&&t.Ia.size>0}function pi(t){return ve(t).Ea.size===0}function hb(t){t.Va=void 0}async function n2(t){t.Ra.set("Online")}async function s2(t){t.Ia.forEach((e,n)=>{Jf(t,e)})}async function r2(t,e){hb(t),Xf(t)?(t.Ra.ha(e),Yf(t)):t.Ra.set("Unknown")}async function i2(t,e,n){if(t.Ra.set("Online"),e instanceof Jw&&e.state===2&&e.cause)try{await async function(r,o){const a=o.cause;for(const l of o.targetIds)r.Ia.has(l)&&(await r.remoteSyncer.rejectListen(l,a),r.Ia.delete(l),r.Va.removeTarget(l))}(t,e)}catch(s){ee(ni,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Wc(t,s)}else if(e instanceof ic?t.Va.Ze(e):e instanceof Qw?t.Va.st(e):t.Va.tt(e),!n.isEqual(ye.min()))try{const s=await ab(t.localStore);n.compareTo(s)>=0&&await function(o,a){const l=o.Va.Tt(a);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=o.Ia.get(d);h&&o.Ia.set(d,h.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,d)=>{const h=o.Ia.get(u);if(!h)return;o.Ia.set(u,h.withResumeToken(It.EMPTY_BYTE_STRING,h.snapshotVersion)),db(o,u);const m=new ir(h.target,u,d,h.sequenceNumber);Jf(o,m)}),o.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(s){ee(ni,"Failed to raise snapshot:",s),await Wc(t,s)}}async function Wc(t,e,n){if(!fo(e))throw e;t.Ea.add(1),await Za(t),t.Ra.set("Offline"),n||(n=()=>ab(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(ni,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await $u(t)})}function mb(t,e){return e().catch(n=>Wc(t,n,e))}async function Fu(t){const e=ve(t),n=Nr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Mf;for(;o2(e);)try{const r=await UT(e.localStore,s);if(r===null){e.Ta.length===0&&n.L_();break}s=r.batchId,a2(e,r)}catch(r){await Wc(e,r)}fb(e)&&pb(e)}function o2(t){return pi(t)&&t.Ta.length<10}function a2(t,e){t.Ta.push(e);const n=Nr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function fb(t){return pi(t)&&!Nr(t).x_()&&t.Ta.length>0}function pb(t){Nr(t).start()}async function l2(t){Nr(t).ra()}async function c2(t){const e=Nr(t);for(const n of t.Ta)e.ea(n.mutations)}async function u2(t,e,n){const s=t.Ta.shift(),r=Bf.from(s,e,n);await mb(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await Fu(t)}async function d2(t,e){e&&Nr(t).X_&&await async function(s,r){if(function(a){return WE(a)&&a!==H.ABORTED}(r.code)){const o=s.Ta.shift();Nr(s).B_(),await mb(s,()=>s.remoteSyncer.rejectFailedWrite(o.batchId,r)),await Fu(s)}}(t,e),fb(t)&&pb(t)}async function S0(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),ee(ni,"RemoteStore received new credentials");const s=pi(n);n.Ea.add(3),await Za(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await $u(n)}async function h2(t,e){const n=ve(t);e?(n.Ea.delete(2),await $u(n)):e||(n.Ea.add(2),await Za(n),n.Ra.set("Unknown"))}function go(t){return t.ma||(t.ma=function(n,s,r){const o=ve(n);return o.sa(),new JT(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(t.datastore,t.asyncQueue,{Xo:n2.bind(null,t),t_:s2.bind(null,t),r_:r2.bind(null,t),H_:i2.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Xf(t)?Yf(t):t.Ra.set("Unknown")):(await t.ma.stop(),hb(t))})),t.ma}function Nr(t){return t.fa||(t.fa=function(n,s,r){const o=ve(n);return o.sa(),new YT(s,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:l2.bind(null,t),r_:d2.bind(null,t),ta:c2.bind(null,t),na:u2.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Fu(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(ni,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(e,n,s,r,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=o,this.deferred=new Is,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,o){const a=Date.now()+s,l=new Zf(e,n,a,r,o);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Z(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ep(t,e){if(Ps("AsyncQueue",`${e}: ${t}`),fo(t))return new Z(H.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{static emptySet(e){return new Hi(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||ae.comparator(n.key,s.key):(n,s)=>ae.comparator(n.key,s.key),this.keyedMap=Go(),this.sortedSet=new Je(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Hi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,o=s.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Hi;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(){this.ga=new Je(ae.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):pe(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,s)=>{e.push(s)}),e}}class oo{constructor(e,n,s,r,o,a,l,u,d){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,s,r,o){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new oo(e,n,Hi.emptySet(n),a,s,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class f2{constructor(){this.queries=T0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const r=ve(n),o=r.queries;r.queries=T0(),o.forEach((a,l)=>{for(const u of l.Sa)u.onError(s)})})(this,new Z(H.ABORTED,"Firestore shutting down"))}}function T0(){return new fi(t=>Lw(t),Pu)}async function tp(t,e){const n=ve(t);let s=3;const r=e.query;let o=n.queries.get(r);o?!o.ba()&&e.Da()&&(s=2):(o=new m2,s=e.Da()?0:1);try{switch(s){case 0:o.wa=await n.onListen(r,!0);break;case 1:o.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(a){const l=ep(a,`Initialization of query '${bi(e.query)}' failed`);return void e.onError(l)}n.queries.set(r,o),o.Sa.push(e),e.va(n.onlineState),o.wa&&e.Fa(o.wa)&&sp(n)}async function np(t,e){const n=ve(t),s=e.query;let r=3;const o=n.queries.get(s);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?r=e.Da()?0:1:!o.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function p2(t,e){const n=ve(t);let s=!1;for(const r of e){const o=r.query,a=n.queries.get(o);if(a){for(const l of a.Sa)l.Fa(r)&&(s=!0);a.wa=r}}s&&sp(n)}function g2(t,e,n){const s=ve(t),r=s.queries.get(e);if(r)for(const o of r.Sa)o.onError(n);s.queries.delete(e)}function sp(t){t.Ca.forEach(e=>{e.next()})}var wm,A0;(A0=wm||(wm={})).Ma="default",A0.Cache="cache";class rp{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new oo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=oo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==wm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(e){this.key=e}}class xb{constructor(e){this.key=e}}class x2{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ee(),this.mutatedKeys=Ee(),this.eu=Vw(e),this.tu=new Hi(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new E0,r=n?n.tu:this.tu;let o=n?n.mutatedKeys:this.mutatedKeys,a=r,l=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,d=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((h,m)=>{const p=r.get(h),x=Ru(this.query,m)?m:null,v=!!p&&this.mutatedKeys.has(p.key),j=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let A=!1;p&&x?p.data.isEqual(x.data)?v!==j&&(s.track({type:3,doc:x}),A=!0):this.su(p,x)||(s.track({type:2,doc:x}),A=!0,(u&&this.eu(x,u)>0||d&&this.eu(x,d)<0)&&(l=!0)):!p&&x?(s.track({type:0,doc:x}),A=!0):p&&!x&&(s.track({type:1,doc:p}),A=!0,(u||d)&&(l=!0)),A&&(x?(a=a.add(x),o=j?o.add(h):o.delete(h)):(a=a.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),s.track({type:1,doc:h})}return{tu:a,iu:s,Cs:l,mutatedKeys:o}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((h,m)=>function(x,v){const j=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe(20277,{Rt:A})}};return j(x)-j(v)}(h.type,m.type)||this.eu(h.doc,m.doc)),this.ou(s),r=r??!1;const l=n&&!r?this._u():[],u=this.Xa.size===0&&this.current&&!r?1:0,d=u!==this.Za;return this.Za=u,a.length!==0||d?{snapshot:new oo(this.query,e.tu,o,a,e.mutatedKeys,u===0,d,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new E0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ee(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const n=[];return e.forEach(s=>{this.Xa.has(s)||n.push(new xb(s))}),this.Xa.forEach(s=>{e.has(s)||n.push(new gb(s))}),n}cu(e){this.Ya=e.Qs,this.Xa=Ee();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return oo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ip="SyncEngine";class y2{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class v2{constructor(e){this.key=e,this.hu=!1}}class _2{constructor(e,n,s,r,o,a){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new fi(l=>Lw(l),Pu),this.Iu=new Map,this.Eu=new Set,this.du=new Je(ae.comparator),this.Au=new Map,this.Ru=new qf,this.Vu={},this.mu=new Map,this.fu=io.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function w2(t,e,n=!0){const s=Nb(t);let r;const o=s.Tu.get(e);return o?(s.sharedClientState.addLocalQueryTarget(o.targetId),r=o.view.lu()):r=await yb(s,e,n,!0),r}async function b2(t,e){const n=Nb(t);await yb(n,e,!0,!1)}async function yb(t,e,n,s){const r=await BT(t.localStore,is(e)),o=r.targetId,a=t.sharedClientState.addLocalQueryTarget(o,n);let l;return s&&(l=await N2(t,e,o,a==="current",r.resumeToken)),t.isPrimaryClient&&n&&ub(t.remoteStore,r),l}async function N2(t,e,n,s,r){t.pu=(m,p,x)=>async function(j,A,w,y){let E=A.view.ru(w);E.Cs&&(E=await b0(j.localStore,A.query,!1).then(({documents:_})=>A.view.ru(_,E)));const R=y&&y.targetChanges.get(A.targetId),$=y&&y.targetMismatches.get(A.targetId)!=null,D=A.view.applyChanges(E,j.isPrimaryClient,R,$);return P0(j,A.targetId,D.au),D.snapshot}(t,m,p,x);const o=await b0(t.localStore,e,!0),a=new x2(e,o.Qs),l=a.ru(o.documents),u=Xa.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),d=a.applyChanges(l,t.isPrimaryClient,u);P0(t,n,d.au);const h=new y2(e,n,a);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function j2(t,e,n){const s=ve(t),r=s.Tu.get(e),o=s.Iu.get(r.targetId);if(o.length>1)return s.Iu.set(r.targetId,o.filter(a=>!Pu(a,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await vm(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&Qf(s.remoteStore,r.targetId),bm(s,r.targetId)}).catch(mo)):(bm(s,r.targetId),await vm(s.localStore,r.targetId,!0))}async function k2(t,e){const n=ve(t),s=n.Tu.get(e),r=n.Iu.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),Qf(n.remoteStore,s.targetId))}async function I2(t,e,n){const s=R2(t);try{const r=await function(a,l){const u=ve(a),d=Fe.now(),h=l.reduce((x,v)=>x.add(v.key),Ee());let m,p;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let v=Rs(),j=Ee();return u.Ns.getEntries(x,h).next(A=>{v=A,v.forEach((w,y)=>{y.isValidDocument()||(j=j.add(w))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,v)).next(A=>{m=A;const w=[];for(const y of l){const E=UE(y,m.get(y.key).overlayedDocument);E!=null&&w.push(new Tr(y.key,E,Ew(E.value.mapValue),Sn.exists(!0)))}return u.mutationQueue.addMutationBatch(x,d,w,l)}).next(A=>{p=A;const w=A.applyToLocalDocumentSet(m,j);return u.documentOverlayCache.saveOverlays(x,A.batchId,w)})}).then(()=>({batchId:p.batchId,changes:Fw(m)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(a,l,u){let d=a.Vu[a.currentUser.toKey()];d||(d=new Je(Se)),d=d.insert(l,u),a.Vu[a.currentUser.toKey()]=d}(s,r.batchId,n),await el(s,r.changes),await Fu(s.remoteStore)}catch(r){const o=ep(r,"Failed to persist write");n.reject(o)}}async function vb(t,e){const n=ve(t);try{const s=await FT(n.localStore,e);e.targetChanges.forEach((r,o)=>{const a=n.Au.get(o);a&&(Oe(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?a.hu=!0:r.modifiedDocuments.size>0?Oe(a.hu,14607):r.removedDocuments.size>0&&(Oe(a.hu,42227),a.hu=!1))}),await el(n,s,e)}catch(s){await mo(s)}}function C0(t,e,n){const s=ve(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Tu.forEach((o,a)=>{const l=a.view.va(e);l.snapshot&&r.push(l.snapshot)}),function(a,l){const u=ve(a);u.onlineState=l;let d=!1;u.queries.forEach((h,m)=>{for(const p of m.Sa)p.va(l)&&(d=!0)}),d&&sp(u)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function S2(t,e,n){const s=ve(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Au.get(e),o=r&&r.key;if(o){let a=new Je(ae.comparator);a=a.insert(o,Lt.newNoDocument(o,ye.min()));const l=Ee().add(o),u=new Lu(ye.min(),new Map,new Je(Se),a,l);await vb(s,u),s.du=s.du.remove(o),s.Au.delete(e),op(s)}else await vm(s.localStore,e,!1).then(()=>bm(s,e,n)).catch(mo)}async function E2(t,e){const n=ve(t),s=e.batch.batchId;try{const r=await $T(n.localStore,e);wb(n,s,null),_b(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await el(n,r)}catch(r){await mo(r)}}async function T2(t,e,n){const s=ve(t);try{const r=await function(a,l){const u=ve(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return u.mutationQueue.lookupMutationBatch(d,l).next(m=>(Oe(m!==null,37113),h=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>u.localDocuments.getDocuments(d,h))})}(s.localStore,e);wb(s,e,n),_b(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await el(s,r)}catch(r){await mo(r)}}function _b(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function wb(t,e,n){const s=ve(t);let r=s.Vu[s.currentUser.toKey()];if(r){const o=r.get(e);o&&(n?o.reject(n):o.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function bm(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(s=>{t.Ru.containsKey(s)||bb(t,s)})}function bb(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Qf(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),op(t))}function P0(t,e,n){for(const s of n)s instanceof gb?(t.Ru.addReference(s.key,e),A2(t,s)):s instanceof xb?(ee(ip,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||bb(t,s.key)):pe(19791,{wu:s})}function A2(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(ee(ip,"New document in limbo: "+n),t.Eu.add(s),op(t))}function op(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ae($e.fromString(e)),s=t.fu.next();t.Au.set(s,new v2(n)),t.du=t.du.insert(n,s),ub(t.remoteStore,new ir(is(Cu(n.path)),s,"TargetPurposeLimboResolution",Eu.ce))}}async function el(t,e,n){const s=ve(t),r=[],o=[],a=[];s.Tu.isEmpty()||(s.Tu.forEach((l,u)=>{a.push(s.pu(u,e,n).then(d=>{var h;if((d||n)&&s.isPrimaryClient){const m=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:h.current;s.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){r.push(d);const m=Kf.As(u.targetId,d);o.push(m)}}))}),await Promise.all(a),s.Pu.H_(r),await async function(u,d){const h=ve(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>q.forEach(d,p=>q.forEach(p.Es,x=>h.persistence.referenceDelegate.addReference(m,p.targetId,x)).next(()=>q.forEach(p.ds,x=>h.persistence.referenceDelegate.removeReference(m,p.targetId,x)))))}catch(m){if(!fo(m))throw m;ee(Gf,"Failed to update sequence numbers: "+m)}for(const m of d){const p=m.targetId;if(!m.fromCache){const x=h.Ms.get(p),v=x.snapshotVersion,j=x.withLastLimboFreeSnapshotVersion(v);h.Ms=h.Ms.insert(p,j)}}}(s.localStore,o))}async function C2(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){ee(ip,"User change. New user:",e.toKey());const s=await ob(n.localStore,e);n.currentUser=e,function(o,a){o.mu.forEach(l=>{l.forEach(u=>{u.reject(new Z(H.CANCELLED,a))})}),o.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await el(n,s.Ls)}}function P2(t,e){const n=ve(t),s=n.Au.get(e);if(s&&s.hu)return Ee().add(s.key);{let r=Ee();const o=n.Iu.get(e);if(!o)return r;for(const a of o){const l=n.Tu.get(a);r=r.unionWith(l.view.nu)}return r}}function Nb(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=vb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=P2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=S2.bind(null,e),e.Pu.H_=p2.bind(null,e.eventManager),e.Pu.yu=g2.bind(null,e.eventManager),e}function R2(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=E2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=T2.bind(null,e),e}class Kc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return VT(this.persistence,new OT,e.initialUser,this.serializer)}Cu(e){return new ib(Wf.mi,this.serializer)}Du(e){return new HT}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Kc.provider={build:()=>new Kc};class O2 extends Kc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Oe(this.persistence.referenceDelegate instanceof qc,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new vT(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Jt.withCacheSize(this.cacheSizeBytes):Jt.DEFAULT;return new ib(s=>qc.mi(s,n),this.serializer)}}class Nm{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>C0(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=C2.bind(null,this.syncEngine),await h2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new f2}()}createDatastore(e){const n=Vu(e.databaseInfo.databaseId),s=function(o){return new QT(o)}(e.databaseInfo);return function(o,a,l,u){return new ZT(o,a,l,u)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,r,o,a,l){return new t2(s,r,o,a,l)}(this.localStore,this.datastore,e.asyncQueue,n=>C0(this.syncEngine,n,0),function(){return k0.v()?new k0:new qT}())}createSyncEngine(e,n){return function(r,o,a,l,u,d,h){const m=new _2(r,o,a,l,u,d);return h&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const o=ve(r);ee(ni,"RemoteStore shutting down."),o.Ea.add(5),await Za(o),o.Aa.shutdown(),o.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Nm.provider={build:()=>new Nm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ps("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jr="FirestoreClient";class M2{constructor(e,n,s,r,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=Ot.UNAUTHENTICATED,this.clientId=Of.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(s,async a=>{ee(jr,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(s,a=>(ee(jr,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Is;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=ep(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function Zd(t,e){t.asyncQueue.verifyOperationInProgress(),ee(jr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await ob(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function R0(t,e){t.asyncQueue.verifyOperationInProgress();const n=await L2(t);ee(jr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>S0(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>S0(e.remoteStore,r)),t._onlineComponents=e}async function L2(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(jr,"Using user provided OfflineComponentProvider");try{await Zd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===H.FAILED_PRECONDITION||r.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;to("Error using user provided cache. Falling back to memory cache: "+n),await Zd(t,new Kc)}}else ee(jr,"Using default OfflineComponentProvider"),await Zd(t,new O2(void 0));return t._offlineComponents}async function jb(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(jr,"Using user provided OnlineComponentProvider"),await R0(t,t._uninitializedComponentsProvider._online)):(ee(jr,"Using default OnlineComponentProvider"),await R0(t,new Nm))),t._onlineComponents}function V2(t){return jb(t).then(e=>e.syncEngine)}async function Gc(t){const e=await jb(t),n=e.eventManager;return n.onListen=w2.bind(null,e.syncEngine),n.onUnlisten=j2.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=b2.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=k2.bind(null,e.syncEngine),n}function $2(t,e,n={}){const s=new Is;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,l,u,d){const h=new ap({next:p=>{h.Nu(),a.enqueueAndForget(()=>np(o,m));const x=p.docs.has(l);!x&&p.fromCache?d.reject(new Z(H.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&p.fromCache&&u&&u.source==="server"?d.reject(new Z(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new rp(Cu(l.path),h,{includeMetadataChanges:!0,qa:!0});return tp(o,m)}(await Gc(t),t.asyncQueue,e,n,s)),s.promise}function F2(t,e,n={}){const s=new Is;return t.asyncQueue.enqueueAndForget(async()=>function(o,a,l,u,d){const h=new ap({next:p=>{h.Nu(),a.enqueueAndForget(()=>np(o,m)),p.fromCache&&u.source==="server"?d.reject(new Z(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new rp(l,h,{includeMetadataChanges:!0,qa:!0});return tp(o,m)}(await Gc(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kb(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib="firestore.googleapis.com",M0=!0;class L0{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Z(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ib,this.ssl=M0}else this.host=e.host,this.ssl=e.ssl??M0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<xT)throw new Z(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ZS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kb(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Z(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Z(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Z(H.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Du{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new L0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Z(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Z(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new L0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new zS;switch(s.type){case"firstParty":return new KS(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Z(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=O0.get(n);s&&(ee("ComponentProvider","Removing Datastore"),O0.delete(n),s.terminate())}(this),Promise.resolve()}}function D2(t,e,n,s={}){var d;t=on(t,Du);const r=ui(e),o=t._getSettings(),a={...o,emulatorOptions:t._getEmulatorOptions()},l=`${e}:${n}`;r&&(Tf(`https://${l}`),Af("Firestore",!0)),o.host!==Ib&&o.host!==l&&to("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...o,host:l,ssl:r,emulatorOptions:s};if(!ei(u,a)&&(t._setSettings(u),s.mockUserToken)){let h,m;if(typeof s.mockUserToken=="string")h=s.mockUserToken,m=Ot.MOCK_USER;else{h=tw(s.mockUserToken,(d=t._app)==null?void 0:d.options.projectId);const p=s.mockUserToken.sub||s.mockUserToken.user_id;if(!p)throw new Z(H.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Ot(p)}t._authCredentials=new HS(new gw(h,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Vs(this.firestore,e,this._query)}}class Ze{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new gr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ze(this.firestore,e,this._key)}toJSON(){return{type:Ze._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(Ja(n,Ze._jsonSchema))return new Ze(e,s||null,new ae($e.fromString(n.referencePath)))}}Ze._jsonSchemaVersion="firestore/documentReference/1.0",Ze._jsonSchema={type:lt("string",Ze._jsonSchemaVersion),referencePath:lt("string")};class gr extends Vs{constructor(e,n,s){super(e,n,Cu(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ze(this.firestore,null,new ae(e))}withConverter(e){return new gr(this.firestore,e,this._path)}}function ge(t,e,...n){if(t=qe(t),xw("collection","path",e),t instanceof Du){const s=$e.fromString(e,...n);return Qx(s),new gr(t,null,s)}{if(!(t instanceof Ze||t instanceof gr))throw new Z(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child($e.fromString(e,...n));return Qx(s),new gr(t.firestore,null,s)}}function ct(t,e,...n){if(t=qe(t),arguments.length===1&&(e=Of.newId()),xw("doc","path",e),t instanceof Du){const s=$e.fromString(e,...n);return Gx(s),new Ze(t,null,new ae(s))}{if(!(t instanceof Ze||t instanceof gr))throw new Z(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child($e.fromString(e,...n));return Gx(s),new Ze(t.firestore,t instanceof gr?t.converter:null,new ae(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0="AsyncQueue";class $0{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new lb(this,"async_queue_retry"),this._c=()=>{const s=Xd();s&&ee(V0,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=Xd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Xd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Is;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!fo(e))throw e;ee(V0,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,Ps("INTERNAL UNHANDLED ERROR: ",F0(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=Zf.createAndSchedule(this,e,n,s,o=>this.hc(o));return this.tc.push(r),r}uc(){this.nc&&pe(47125,{Pc:F0(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function F0(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D0(t){return function(n,s){if(typeof n!="object"||n===null)return!1;const r=n;for(const o of s)if(o in r&&typeof r[o]=="function")return!0;return!1}(t,["next","error","complete"])}class Os extends Du{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new $0,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $0(e),this._firestoreClient=void 0,await e}}}function U2(t,e){const n=typeof t=="object"?t:Iu(),s=typeof t=="string"?t:Fc,r=hi(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const o=X_("firestore");o&&D2(r,...o)}return r}function Uu(t){if(t._terminated)throw new Z(H.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||B2(t),t._firestoreClient}function B2(t){var s,r,o;const e=t._freezeSettings(),n=function(l,u,d,h){return new dE(l,u,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,kb(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((s=t._app)==null?void 0:s.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new M2(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jn(It.fromBase64String(e))}catch(n){throw new Z(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new jn(It.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:jn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ja(e,jn._jsonSchema))return jn.fromBase64String(e.bytes)}}jn._jsonSchemaVersion="firestore/bytes/1.0",jn._jsonSchema={type:lt("string",jn._jsonSchemaVersion),bytes:lt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Z(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Z(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Z(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Se(this._lat,e._lat)||Se(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:as._jsonSchemaVersion}}static fromJSON(e){if(Ja(e,as._jsonSchema))return new as(e.latitude,e.longitude)}}as._jsonSchemaVersion="firestore/geoPoint/1.0",as._jsonSchema={type:lt("string",as._jsonSchemaVersion),latitude:lt("number"),longitude:lt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let o=0;o<s.length;++o)if(s[o]!==r[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ls._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ja(e,ls._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new ls(e.vectorValues);throw new Z(H.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ls._jsonSchemaVersion="firestore/vectorValue/1.0",ls._jsonSchema={type:lt("string",ls._jsonSchemaVersion),vectorValues:lt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2=/^__.*__$/;class H2{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new Tr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ya(e,this.data,n,this.fieldTransforms)}}class Sb{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new Tr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Eb(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe(40011,{Ac:t})}}class lp{constructor(e,n,s,r,o,a){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new lp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Qc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Eb(this.Ac)&&z2.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class q2{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||Vu(e)}Cc(e,n,s,r=!1){return new lp({Ac:e,methodName:n,Dc:s,path:Nt.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hu(t){const e=t._freezeSettings(),n=Vu(t._databaseId);return new q2(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Tb(t,e,n,s,r,o={}){const a=t.Cc(o.merge||o.mergeFields?2:0,e,n,r);up("Data must be an object, but it was:",a,s);const l=Ab(s,a);let u,d;if(o.merge)u=new un(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){const h=[];for(const m of o.mergeFields){const p=jm(e,m,n);if(!a.contains(p))throw new Z(H.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);Pb(h,p)||h.push(p)}u=new un(h),d=a.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=a.fieldTransforms;return new H2(new Xt(l),u,d)}class qu extends zu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qu}}class cp extends zu{_toFieldTransform(e){return new VE(e.path,new Ma)}isEqual(e){return e instanceof cp}}function W2(t,e,n,s){const r=t.Cc(1,e,n);up("Data must be an object, but it was:",r,s);const o=[],a=Xt.empty();Er(s,(u,d)=>{const h=dp(e,u,n);d=qe(d);const m=r.yc(h);if(d instanceof qu)o.push(h);else{const p=tl(d,m);p!=null&&(o.push(h),a.set(h,p))}});const l=new un(o);return new Sb(a,l,r.fieldTransforms)}function K2(t,e,n,s,r,o){const a=t.Cc(1,e,n),l=[jm(e,s,n)],u=[r];if(o.length%2!=0)throw new Z(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<o.length;p+=2)l.push(jm(e,o[p])),u.push(o[p+1]);const d=[],h=Xt.empty();for(let p=l.length-1;p>=0;--p)if(!Pb(d,l[p])){const x=l[p];let v=u[p];v=qe(v);const j=a.yc(x);if(v instanceof qu)d.push(x);else{const A=tl(v,j);A!=null&&(d.push(x),h.set(x,A))}}const m=new un(d);return new Sb(h,m,a.fieldTransforms)}function G2(t,e,n,s=!1){return tl(n,t.Cc(s?4:3,e))}function tl(t,e){if(Cb(t=qe(t)))return up("Unsupported field value:",e,t),Ab(t,e);if(t instanceof zu)return function(s,r){if(!Eb(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const o=s._toFieldTransform(r);o&&r.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const o=[];let a=0;for(const l of s){let u=tl(l,r.wc(a));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),a++}return{arrayValue:{values:o}}}(t,e)}return function(s,r){if((s=qe(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return OE(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const o=Fe.fromDate(s);return{timestampValue:Hc(r.serializer,o)}}if(s instanceof Fe){const o=new Fe(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Hc(r.serializer,o)}}if(s instanceof as)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof jn)return{bytesValue:Yw(r.serializer,s._byteString)};if(s instanceof Ze){const o=r.databaseId,a=s.firestore._databaseId;if(!a.isEqual(o))throw r.Sc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Hf(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof ls)return function(a,l){return{mapValue:{fields:{[Iw]:{stringValue:Sw},[Dc]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw l.Sc("VectorValues must only contain numeric values.");return Df(l.serializer,d)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${Su(s)}`)}(t,e)}function Ab(t,e){const n={};return _w(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Er(t,(s,r)=>{const o=tl(r,e.mc(s));o!=null&&(n[s]=o)}),{mapValue:{fields:n}}}function Cb(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Fe||t instanceof as||t instanceof jn||t instanceof Ze||t instanceof zu||t instanceof ls)}function up(t,e,n){if(!Cb(n)||!yw(n)){const s=Su(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function jm(t,e,n){if((e=qe(e))instanceof Bu)return e._internalPath;if(typeof e=="string")return dp(t,e);throw Qc("Field path arguments must be of type string or ",t,!1,void 0,n)}const Q2=new RegExp("[~\\*/\\[\\]]");function dp(t,e,n){if(e.search(Q2)>=0)throw Qc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Bu(...e.split("."))._internalPath}catch{throw Qc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Qc(t,e,n,s,r){const o=s&&!s.isEmpty(),a=r!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(o||a)&&(u+=" (found",o&&(u+=` in field ${s}`),a&&(u+=` in document ${r}`),u+=")"),new Z(H.INVALID_ARGUMENT,l+t+u)}function Pb(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(e,n,s,r,o){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new J2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Wu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class J2 extends Rb{data(){return super.data()}}function Wu(t,e){return typeof e=="string"?dp(t,e):e instanceof Bu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ob(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Z(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hp{}class mp extends hp{}function Te(t,e,...n){let s=[];e instanceof hp&&s.push(e),s=s.concat(n),function(o){const a=o.filter(u=>u instanceof fp).length,l=o.filter(u=>u instanceof Ku).length;if(a>1||a>0&&l>0)throw new Z(H.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)t=r._apply(t);return t}class Ku extends mp{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new Ku(e,n,s)}_apply(e){const n=this._parse(e);return Mb(e._query,n),new Vs(e.firestore,e.converter,fm(e._query,n))}_parse(e){const n=Hu(e.firestore);return function(o,a,l,u,d,h,m){let p;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Z(H.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){B0(m,h);const v=[];for(const j of m)v.push(U0(u,o,j));p={arrayValue:{values:v}}}else p=U0(u,o,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||B0(m,h),p=G2(l,a,m,h==="in"||h==="not-in");return at.create(d,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function me(t,e,n){const s=e,r=Wu("where",t);return Ku._create(r,s,n)}class fp extends hp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new fp(e,n)}_parse(e){const n=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return n.length===1?n[0]:qn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,o){let a=r;const l=o.getFlattenedFilters();for(const u of l)Mb(a,u),a=fm(a,u)}(e._query,n),new Vs(e.firestore,e.converter,fm(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class pp extends mp{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new pp(e,n)}_apply(e){const n=function(r,o,a){if(r.startAt!==null)throw new Z(H.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Z(H.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Oa(o,a)}(e._query,this._field,this._direction);return new Vs(e.firestore,e.converter,function(r,o){const a=r.explicitOrderBy.concat([o]);return new po(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function Wt(t,e="asc"){const n=e,s=Wu("orderBy",t);return pp._create(s,n)}class gp extends mp{constructor(e,n,s){super(),this.type=e,this._limit=n,this._limitType=s}static _create(e,n,s){return new gp(e,n,s)}_apply(e){return new Vs(e.firestore,e.converter,Bc(e._query,this._limit,this._limitType))}}function Wn(t){return eE("limit",t),gp._create("limit",t,"F")}function U0(t,e,n){if(typeof(n=qe(n))=="string"){if(n==="")throw new Z(H.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mw(e)&&n.indexOf("/")!==-1)throw new Z(H.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child($e.fromString(n));if(!ae.isDocumentKey(s))throw new Z(H.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return s0(t,new ae(s))}if(n instanceof Ze)return s0(t,n._key);throw new Z(H.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Su(n)}.`)}function B0(t,e){if(!Array.isArray(t)||t.length===0)throw new Z(H.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Mb(t,e){const n=function(r,o){for(const a of r)for(const l of a.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Z(H.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Z(H.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Y2{convertValue(e,n="none"){switch(br(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(wr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw pe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Er(e,(r,o)=>{s[r]=this.convertValue(o,n)}),s}convertVectorValue(e){var s,r,o;const n=(o=(r=(s=e.fields)==null?void 0:s[Dc].arrayValue)==null?void 0:r.values)==null?void 0:o.map(a=>nt(a.doubleValue));return new ls(n)}convertGeoPoint(e){return new as(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=Au(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Ca(e));default:return null}}convertTimestamp(e){const n=_r(e);return new Fe(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=$e.fromString(e);Oe(sb(s),9688,{name:e});const r=new Pa(s.get(1),s.get(3)),o=new ae(s.popFirst(5));return r.isEqual(n)||Ps(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class Jo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Kr extends Rb{constructor(e,n,s,r,o,a){super(e,n,s,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new oc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Wu("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(H.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Kr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Kr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Kr._jsonSchema={type:lt("string",Kr._jsonSchemaVersion),bundleSource:lt("string","DocumentSnapshot"),bundleName:lt("string"),bundle:lt("string")};class oc extends Kr{data(e={}){return super.data(e)}}class Gr{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Jo(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new oc(this._firestore,this._userDataWriter,s.key,s,new Jo(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Z(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,o){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>{const u=new oc(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Jo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{const u=new oc(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Jo(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let d=-1,h=-1;return l.type!==0&&(d=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),h=a.indexOf(l.doc.key)),{type:X2(l.type),doc:u,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Z(H.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Gr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Of.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],r=[];return this.docs.forEach(o=>{o._document!==null&&(n.push(o._document),s.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),r.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function X2(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(t){t=on(t,Ze);const e=on(t.firestore,Os);return $2(Uu(e),t._key).then(n=>Vb(e,t,n))}Gr._jsonSchemaVersion="firestore/querySnapshot/1.0",Gr._jsonSchema={type:lt("string",Gr._jsonSchemaVersion),bundleSource:lt("string","QuerySnapshot"),bundleName:lt("string"),bundle:lt("string")};class xp extends Y2{constructor(e){super(),this.firestore=e}convertBytes(e){return new jn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ze(this.firestore,null,n)}}function Re(t){t=on(t,Vs);const e=on(t.firestore,Os),n=Uu(e),s=new xp(e);return Ob(t._query),F2(n,t._query).then(r=>new Gr(e,s,t,r))}function Z2(t,e,n){t=on(t,Ze);const s=on(t.firestore,Os),r=Lb(t.converter,e,n);return Gu(s,[Tb(Hu(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,Sn.none())])}function nl(t,e,n,...s){t=on(t,Ze);const r=on(t.firestore,Os),o=Hu(r);let a;return a=typeof(e=qe(e))=="string"||e instanceof Bu?K2(o,"updateDoc",t._key,e,n,s):W2(o,"updateDoc",t._key,e),Gu(r,[a.toMutation(t._key,Sn.exists(!0))])}function eA(t){return Gu(on(t.firestore,Os),[new Uf(t._key,Sn.none())])}function en(t,e){const n=on(t.firestore,Os),s=ct(t),r=Lb(t.converter,e);return Gu(n,[Tb(Hu(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,Sn.exists(!1))]).then(()=>s)}function km(t,...e){var u,d,h;t=qe(t);let n={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||D0(e[s])||(n=e[s++]);const r={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(D0(e[s])){const m=e[s];e[s]=(u=m.next)==null?void 0:u.bind(m),e[s+1]=(d=m.error)==null?void 0:d.bind(m),e[s+2]=(h=m.complete)==null?void 0:h.bind(m)}let o,a,l;if(t instanceof Ze)a=on(t.firestore,Os),l=Cu(t._key.path),o={next:m=>{e[s]&&e[s](Vb(a,t,m))},error:e[s+1],complete:e[s+2]};else{const m=on(t,Vs);a=on(m.firestore,Os),l=m._query;const p=new xp(a);o={next:x=>{e[s]&&e[s](new Gr(a,p,m,x))},error:e[s+1],complete:e[s+2]},Ob(t._query)}return function(p,x,v,j){const A=new ap(j),w=new rp(x,A,v);return p.asyncQueue.enqueueAndForget(async()=>tp(await Gc(p),w)),()=>{A.Nu(),p.asyncQueue.enqueueAndForget(async()=>np(await Gc(p),w))}}(Uu(a),l,r,o)}function Gu(t,e){return function(s,r){const o=new Is;return s.asyncQueue.enqueueAndForget(async()=>I2(await V2(s),r,o)),o.promise}(Uu(t),e)}function Vb(t,e,n){const s=n.docs.get(e._key),r=new xp(t);return new Kr(t,r,e._key,s,new Jo(n.hasPendingWrites,n.fromCache),e.converter)}function hn(){return new cp("serverTimestamp")}(function(e,n=!0){(function(r){ho=r})(mi),Hn(new Cn("firestore",(s,{instanceIdentifier:r,options:o})=>{const a=s.getProvider("app").getImmediate(),l=new Os(new qS(s.getProvider("auth-internal")),new GS(a,s.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Z(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pa(d.options.projectId,h)}(a,r),a);return o={useFetchStreams:n,...o},l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),rn(Hx,qx,e),rn(Hx,qx,"esm2020")})();function $b(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tA=$b,Fb=new di("auth","Firebase",$b());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=new Cf("@firebase/auth");function nA(t,...e){Jc.logLevel<=Ie.WARN&&Jc.warn(`Auth (${mi}): ${t}`,...e)}function ac(t,...e){Jc.logLevel<=Ie.ERROR&&Jc.error(`Auth (${mi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(t,...e){throw vp(t,...e)}function Bn(t,...e){return vp(t,...e)}function yp(t,e,n){const s={...tA(),[e]:n};return new di("auth","Firebase",s).create(e,{appName:t.name})}function cs(t){return yp(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Db(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&Pn(t,"argument-error"),yp(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function vp(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return Fb.create(t,...e)}function fe(t,e,...n){if(!t)throw vp(e,...n)}function bs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ac(e),new Error(e)}function Ms(t,e){t||bs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Im(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function sA(){return z0()==="http:"||z0()==="https:"}function z0(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sA()||bI()||"connection"in navigator)?navigator.onLine:!0}function iA(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ms(n>e,"Short delay should be less than long delay!"),this.isMobile=vI()||NI()}get(){return rA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(t,e){Ms(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],lA=new sl(3e4,6e4);function $s(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ms(t,e,n,s,r={}){return Bb(t,r,async()=>{let o={},a={};s&&(e==="GET"?a=s:o={body:JSON.stringify(s)});const l=Qa({key:t.config.apiKey,...a}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...o};return wI()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ui(t.emulatorConfig.host)&&(d.credentials="include"),Ub.fetch()(await zb(t,t.config.apiHost,n,l),d)})}async function Bb(t,e,n){t._canInitEmulator=!1;const s={...oA,...e};try{const r=new uA(t),o=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw Fl(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const l=o.ok?a.errorMessage:a.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fl(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Fl(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Fl(t,"user-disabled",a);const h=s[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw yp(t,h,d);Pn(t,h)}}catch(r){if(r instanceof Kn)throw r;Pn(t,"network-request-failed",{message:String(r)})}}async function rl(t,e,n,s,r={}){const o=await ms(t,e,n,s,r);return"mfaPendingCredential"in o&&Pn(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function zb(t,e,n,s){const r=`${e}${n}?${s}`,o=t,a=o.config.emulator?_p(t.config,r):`${t.config.apiScheme}://${r}`;return aA.includes(n)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}function cA(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class uA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Bn(this.auth,"network-request-failed")),lA.get())})}}function Fl(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=Bn(t,e,s);return r.customData._tokenResponse=n,r}function H0(t){return t!==void 0&&t.enterprise!==void 0}class dA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return cA(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function hA(t,e){return ms(t,"GET","/v2/recaptchaConfig",$s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mA(t,e){return ms(t,"POST","/v1/accounts:delete",e)}async function Yc(t,e){return ms(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function da(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function fA(t,e=!1){const n=qe(t),s=await n.getIdToken(e),r=wp(s);fe(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const o=typeof r.firebase=="object"?r.firebase:void 0,a=o==null?void 0:o.sign_in_provider;return{claims:r,token:s,authTime:da(eh(r.auth_time)),issuedAtTime:da(eh(r.iat)),expirationTime:da(eh(r.exp)),signInProvider:a||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function eh(t){return Number(t)*1e3}function wp(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return ac("JWT malformed, contained fewer than 3 sections"),null;try{const r=J_(n);return r?JSON.parse(r):(ac("Failed to decode base64 JWT payload"),null)}catch(r){return ac("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function q0(t){const e=wp(t);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ao(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Kn&&pA(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function pA({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=da(this.lastLoginAt),this.creationTime=da(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xc(t){var m;const e=t.auth,n=await t.getIdToken(),s=await ao(t,Yc(e,{idToken:n}));fe(s==null?void 0:s.users.length,e,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const o=(m=r.providerUserInfo)!=null&&m.length?Hb(r.providerUserInfo):[],a=yA(t.providerData,o),l=t.isAnonymous,u=!(t.email&&r.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Sm(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function xA(t){const e=qe(t);await Xc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yA(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function Hb(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vA(t,e){const n=await Bb(t,{},async()=>{const s=Qa({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:o}=t.config,a=await zb(t,r,"/v1/token",`key=${o}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:s};return t.emulatorConfig&&ui(t.emulatorConfig.host)&&(u.credentials="include"),Ub.fetch()(a,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function _A(t,e){return ms(t,"POST","/v2/accounts:revokeToken",$s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):q0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const n=q0(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:o}=await vA(e,n);this.updateTokensAndExpiration(s,r,Number(o))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:o}=n,a=new qi;return s&&(fe(typeof s=="string","internal-error",{appName:e}),a.refreshToken=s),r&&(fe(typeof r=="string","internal-error",{appName:e}),a.accessToken=r),o&&(fe(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new qi,this.toJSON())}_performRefresh(){return bs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qs(t,e){fe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class $n{constructor({uid:e,auth:n,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new gA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Sm(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await ao(this,this.stsTokenManager.getToken(this.auth,e));return fe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return fA(this,e)}reload(){return xA(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new $n({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Xc(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zt(this.auth.app))return Promise.reject(cs(this.auth));const e=await this.getIdToken();return await ao(this,mA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,r=n.email??void 0,o=n.phoneNumber??void 0,a=n.photoURL??void 0,l=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:m,emailVerified:p,isAnonymous:x,providerData:v,stsTokenManager:j}=n;fe(m&&j,e,"internal-error");const A=qi.fromJSON(this.name,j);fe(typeof m=="string",e,"internal-error"),Qs(s,e.name),Qs(r,e.name),fe(typeof p=="boolean",e,"internal-error"),fe(typeof x=="boolean",e,"internal-error"),Qs(o,e.name),Qs(a,e.name),Qs(l,e.name),Qs(u,e.name),Qs(d,e.name),Qs(h,e.name);const w=new $n({uid:m,auth:e,email:r,emailVerified:p,displayName:s,isAnonymous:x,photoURL:a,phoneNumber:o,tenantId:l,stsTokenManager:A,createdAt:d,lastLoginAt:h});return v&&Array.isArray(v)&&(w.providerData=v.map(y=>({...y}))),u&&(w._redirectEventId=u),w}static async _fromIdTokenResponse(e,n,s=!1){const r=new qi;r.updateFromServerResponse(n);const o=new $n({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Xc(o),o}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];fe(r.localId!==void 0,"internal-error");const o=r.providerUserInfo!==void 0?Hb(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!(o!=null&&o.length),l=new qi;l.updateFromIdToken(s);const u=new $n({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:a}),d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Sm(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(o!=null&&o.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0=new Map;function Ns(t){Ms(t instanceof Function,"Expected a class definition");let e=W0.get(t);return e?(Ms(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,W0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}qb.type="NONE";const K0=qb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lc(t,e,n){return`firebase:${t}:${e}:${n}`}class Wi{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:o}=this.auth;this.fullUserKey=lc(this.userKey,r.apiKey,o),this.fullPersistenceKey=lc("persistence",r.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Yc(this.auth,{idToken:e}).catch(()=>{});return n?$n._fromGetAccountInfoResponse(this.auth,n,e):null}return $n._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new Wi(Ns(K0),e,s);const r=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=r[0]||Ns(K0);const a=lc(s,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(a);if(h){let m;if(typeof h=="string"){const p=await Yc(e,{idToken:h}).catch(()=>{});if(!p)break;m=await $n._fromGetAccountInfoResponse(e,p,h)}else m=$n._fromJSON(e,h);d!==o&&(l=m),o=d;break}}catch{}const u=r.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new Wi(o,e,s):(o=u[0],l&&await o._set(a,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==o)try{await d._remove(a)}catch{}})),new Wi(o,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Qb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Wb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Yb(e))return"Blackberry";if(Xb(e))return"Webos";if(Kb(e))return"Safari";if((e.includes("chrome/")||Gb(e))&&!e.includes("edge/"))return"Chrome";if(Jb(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function Wb(t=Dt()){return/firefox\//i.test(t)}function Kb(t=Dt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Gb(t=Dt()){return/crios\//i.test(t)}function Qb(t=Dt()){return/iemobile/i.test(t)}function Jb(t=Dt()){return/android/i.test(t)}function Yb(t=Dt()){return/blackberry/i.test(t)}function Xb(t=Dt()){return/webos/i.test(t)}function bp(t=Dt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function wA(t=Dt()){var e;return bp(t)&&!!((e=window.navigator)!=null&&e.standalone)}function bA(){return jI()&&document.documentMode===10}function Zb(t=Dt()){return bp(t)||Jb(t)||Xb(t)||Yb(t)||/windows phone/i.test(t)||Qb(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eN(t,e=[]){let n;switch(t){case"Browser":n=G0(Dt());break;case"Worker":n=`${G0(Dt())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${mi}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=o=>new Promise((a,l)=>{try{const u=e(o);a(u)}catch(u){l(u)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jA(t,e={}){return ms(t,"GET","/v2/passwordPolicy",$s(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA=6;class IA{constructor(e){var s;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??kA,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((s=e.allowedNonAlphanumericCharacters)==null?void 0:s.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Q0(this),this.idTokenSubscription=new Q0(this),this.beforeStateQueue=new NA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Fb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ns(n)),this._initializationPromise=this.queue(async()=>{var s,r,o;if(!this._deleted&&(this.persistenceManager=await Wi.create(this,e),(s=this._resolvePersistenceManagerAvailable)==null||s.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Yc(this,{idToken:e}),s=await $n._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(zt(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(o=this.redirectUser)==null?void 0:o._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===l)&&(u!=null&&u.user)&&(s=u.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Xc(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=iA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zt(this.app))return Promise.reject(cs(this));const n=e?qe(e):null;return n&&fe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zt(this.app)?Promise.reject(cs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zt(this.app)?Promise.reject(cs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ns(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await jA(this),n=new IA(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new di("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await _A(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ns(e)||this._popupRedirectResolver;fe(n,this,"argument-error"),this.redirectPersistenceManager=await Wi.create(this,[Ns(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)==null?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(l,this,"internal-error"),l.then(()=>{a||o(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,s,r);return()=>{a=!0,u()}}else{const u=e.addObserver(n);return()=>{a=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=eN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var n;if(zt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&nA(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Gn(t){return qe(t)}class Q0{constructor(e){this.auth=e,this.observer=null,this.addObserver=CI(n=>this.observer=n)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EA(t){Qu=t}function tN(t){return Qu.loadJS(t)}function TA(){return Qu.recaptchaEnterpriseScript}function AA(){return Qu.gapiScript}function CA(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class PA{constructor(){this.enterprise=new RA}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class RA{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const OA="recaptcha-enterprise",nN="NO_RECAPTCHA";class MA{constructor(e){this.type=OA,this.auth=Gn(e)}async verify(e="verify",n=!1){async function s(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,l)=>{hA(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new dA(u);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,a(d.siteKey)}}).catch(u=>{l(u)})})}function r(o,a,l){const u=window.grecaptcha;H0(u)?u.enterprise.ready(()=>{u.enterprise.execute(o,{action:e}).then(d=>{a(d)}).catch(()=>{a(nN)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new PA().execute("siteKey",{action:"verify"}):new Promise((o,a)=>{s(this.auth).then(l=>{if(!n&&H0(window.grecaptcha))r(l,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let u=TA();u.length!==0&&(u+=l),tN(u).then(()=>{r(l,o,a)}).catch(d=>{a(d)})}}).catch(l=>{a(l)})})}}async function J0(t,e,n,s=!1,r=!1){const o=new MA(t);let a;if(r)a=nN;else try{a=await o.verify(n)}catch{a=await o.verify(n,!0)}const l={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,d=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return s?Object.assign(l,{captchaResp:a}):Object.assign(l,{captchaResponse:a}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Zc(t,e,n,s,r){var o;if((o=t._getRecaptchaConfig())!=null&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await J0(t,e,n,n==="getOobCode");return s(t,a)}else return s(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await J0(t,e,n,n==="getOobCode");return s(t,l)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LA(t,e){const n=hi(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),o=n.getOptions();if(ei(o,e??{}))return r;Pn(r,"already-initialized")}return n.initialize({options:e})}function VA(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(Ns);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function $A(t,e,n){const s=Gn(t);fe(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,o=sN(e),{host:a,port:l}=FA(e),u=l===null?"":`:${l}`,d={url:`${o}//${a}${u}/`},h=Object.freeze({host:a,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){fe(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),fe(ei(d,s.config.emulator)&&ei(h,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=d,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,ui(a)?(Tf(`${o}//${a}${u}`),Af("Auth",!0)):DA()}function sN(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function FA(t){const e=sN(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const o=r[1];return{host:o,port:Y0(s.substr(o.length+1))}}else{const[o,a]=s.split(":");return{host:o,port:Y0(a)}}}function Y0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function DA(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return bs("not implemented")}_getIdTokenResponse(e){return bs("not implemented")}_linkToIdToken(e,n){return bs("not implemented")}_getReauthenticationResolver(e){return bs("not implemented")}}async function UA(t,e){return ms(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BA(t,e){return rl(t,"POST","/v1/accounts:signInWithPassword",$s(t,e))}async function zA(t,e){return ms(t,"POST","/v1/accounts:sendOobCode",$s(t,e))}async function HA(t,e){return zA(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qA(t,e){return rl(t,"POST","/v1/accounts:signInWithEmailLink",$s(t,e))}async function WA(t,e){return rl(t,"POST","/v1/accounts:signInWithEmailLink",$s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a extends Np{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new $a(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new $a(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zc(e,n,"signInWithPassword",BA);case"emailLink":return qA(e,{email:this._email,oobCode:this._password});default:Pn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zc(e,s,"signUpPassword",UA);case"emailLink":return WA(e,{idToken:n,email:this._email,oobCode:this._password});default:Pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ki(t,e){return rl(t,"POST","/v1/accounts:signInWithIdp",$s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KA="http://localhost";class si extends Np{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new si(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Pn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...o}=n;if(!s||!r)return null;const a=new si(s,r);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Ki(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,Ki(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ki(e,n)}buildRequest(){const e={requestUri:KA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Qa(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function QA(t){const e=qo(Wo(t)).link,n=e?qo(Wo(e)).deep_link_id:null,s=qo(Wo(t)).deep_link_id;return(s?qo(Wo(s)).link:null)||s||n||e||t}class jp{constructor(e){const n=qo(Wo(e)),s=n.apiKey??null,r=n.oobCode??null,o=GA(n.mode??null);fe(s&&r&&o,"argument-error"),this.apiKey=s,this.operation=o,this.code=r,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=QA(e);try{return new jp(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(){this.providerId=xo.PROVIDER_ID}static credential(e,n){return $a._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=jp.parseLink(n);return fe(s,"argument-error"),$a._fromEmailAndCode(e,s.code,s.tenantId)}}xo.PROVIDER_ID="password";xo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";xo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il extends Ju{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er extends il{constructor(){super("facebook.com")}static credential(e){return si._fromParams({providerId:er.PROVIDER_ID,signInMethod:er.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return er.credentialFromTaggedObject(e)}static credentialFromError(e){return er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return er.credential(e.oauthAccessToken)}catch{return null}}}er.FACEBOOK_SIGN_IN_METHOD="facebook.com";er.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends il{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return si._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return vs.credential(n,s)}catch{return null}}}vs.GOOGLE_SIGN_IN_METHOD="google.com";vs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends il{constructor(){super("github.com")}static credential(e){return si._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return tr.credential(e.oauthAccessToken)}catch{return null}}}tr.GITHUB_SIGN_IN_METHOD="github.com";tr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr extends il{constructor(){super("twitter.com")}static credential(e,n){return si._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return nr.credential(n,s)}catch{return null}}}nr.TWITTER_SIGN_IN_METHOD="twitter.com";nr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JA(t,e){return rl(t,"POST","/v1/accounts:signUp",$s(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const o=await $n._fromIdTokenResponse(e,s,r),a=X0(s);return new ri({user:o,providerId:a,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=X0(s);return new ri({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function X0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu extends Kn{constructor(e,n,s,r){super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,eu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new eu(e,n,s,r)}}function rN(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?eu._fromErrorAndOperation(t,o,e,s):o})}async function YA(t,e,n=!1){const s=await ao(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ri._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XA(t,e,n=!1){const{auth:s}=t;if(zt(s.app))return Promise.reject(cs(s));const r="reauthenticate";try{const o=await ao(t,rN(s,r,e,t),n);fe(o.idToken,s,"internal-error");const a=wp(o.idToken);fe(a,s,"internal-error");const{sub:l}=a;return fe(t.uid===l,s,"user-mismatch"),ri._forOperation(t,r,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&Pn(s,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iN(t,e,n=!1){if(zt(t.app))return Promise.reject(cs(t));const s="signIn",r=await rN(t,s,e),o=await ri._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(o.user),o}async function ZA(t,e){return iN(Gn(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oN(t){const e=Gn(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function eC(t,e,n){const s=Gn(t);await Zc(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",HA)}async function tC(t,e,n){if(zt(t.app))return Promise.reject(cs(t));const s=Gn(t),a=await Zc(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",JA).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&oN(t),u}),l=await ri._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(l.user),l}function nC(t,e,n){return zt(t.app)?Promise.reject(cs(t)):ZA(qe(t),xo.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&oN(t),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sC(t,e){return ms(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rC(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const s=qe(t),o={idToken:await s.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},a=await ao(s,sC(s.auth,o));s.displayName=a.displayName||null,s.photoURL=a.photoUrl||null;const l=s.providerData.find(({providerId:u})=>u==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),await s._updateTokensIfNecessary(a)}function iC(t,e,n,s){return qe(t).onIdTokenChanged(e,n,s)}function oC(t,e,n){return qe(t).beforeAuthStateChanged(e,n)}function aC(t,e,n,s){return qe(t).onAuthStateChanged(e,n,s)}function lC(t){return qe(t).signOut()}const tu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(tu,"1"),this.storage.removeItem(tu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC=1e3,uC=10;class lN extends aN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Zb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,u)=>{this.notifyListeners(a,u)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const a=this.storage.getItem(s);!n&&this.localCache[s]===a||this.notifyListeners(s,a)},o=this.storage.getItem(s);bA()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,uC):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},cC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}lN.type="LOCAL";const dC=lN;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN extends aN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}cN.type="SESSION";const uN=cN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new Yu(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:o}=n.data,a=this.handlersMap[r];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const l=Array.from(a).map(async d=>d(n.origin,o)),u=await hC(l);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let o,a;return new Promise((l,u)=>{const d=kp("",20);r.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},s);a={messageChannel:r,onMessage(m){const p=m;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(p.data.response);break;default:clearTimeout(h),clearTimeout(o),u(new Error("invalid_response"));break}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(){return window}function fC(t){us().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dN(){return typeof us().WorkerGlobalScope<"u"&&typeof us().importScripts=="function"}async function pC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function gC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function xC(){return dN()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN="firebaseLocalStorageDb",yC=1,nu="firebaseLocalStorage",mN="fbase_key";class ol{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Xu(t,e){return t.transaction([nu],e?"readwrite":"readonly").objectStore(nu)}function vC(){const t=indexedDB.deleteDatabase(hN);return new ol(t).toPromise()}function Em(){const t=indexedDB.open(hN,yC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(nu,{keyPath:mN})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(nu)?e(s):(s.close(),await vC(),e(await Em()))})})}async function Z0(t,e,n){const s=Xu(t,!0).put({[mN]:e,value:n});return new ol(s).toPromise()}async function _C(t,e){const n=Xu(t,!1).get(e),s=await new ol(n).toPromise();return s===void 0?null:s.value}function ey(t,e){const n=Xu(t,!0).delete(e);return new ol(n).toPromise()}const wC=800,bC=3;class fN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Em(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>bC)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yu._getInstance(xC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,s;if(this.activeServiceWorker=await pC(),!this.activeServiceWorker)return;this.sender=new mC(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(s=e[0])!=null&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||gC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Em();return await Z0(e,tu,"1"),await ey(e,tu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>Z0(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>_C(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ey(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const o=Xu(r,!1).getAll();return new ol(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:o}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(o)&&(this.notifyListeners(r,o),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}fN.type="LOCAL";const NC=fN;new sl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(t,e){return e?Ns(e):(fe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp extends Np{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ki(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ki(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ki(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function jC(t){return iN(t.auth,new Sp(t),t.bypassAuthState)}function kC(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),XA(n,new Sp(t),t.bypassAuthState)}async function IC(t){const{auth:e,user:n}=t;return fe(n,e,"internal-error"),YA(n,new Sp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(e,n,s,r,o=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:o,error:a,type:l}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:s,tenantId:o||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jC;case"linkViaPopup":case"linkViaRedirect":return IC;case"reauthViaPopup":case"reauthViaRedirect":return kC;default:Pn(this.auth,"internal-error")}}resolve(e){Ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC=new sl(2e3,1e4);async function EC(t,e,n){if(zt(t.app))return Promise.reject(Bn(t,"operation-not-supported-in-this-environment"));const s=Gn(t);Db(t,e,Ju);const r=Ip(s,n);return new zr(s,"signInViaPopup",e,r).executeNotNull()}class zr extends pN{constructor(e,n,s,r,o){super(e,n,r,o),this.provider=s,this.authWindow=null,this.pollId=null,zr.currentPopupAction&&zr.currentPopupAction.cancel(),zr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){Ms(this.filter.length===1,"Popup operations only handle one event");const e=kp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Bn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Bn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if((s=(n=this.authWindow)==null?void 0:n.window)!=null&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Bn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,SC.get())};e()}}zr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC="pendingRedirect",cc=new Map;class AC extends pN{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=cc.get(this.auth._key());if(!e){try{const s=await CC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}cc.set(this.auth._key(),e)}return this.bypassAuthState||cc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CC(t,e){const n=xN(e),s=gN(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}async function PC(t,e){return gN(t)._set(xN(e),"true")}function RC(t,e){cc.set(t._key(),e)}function gN(t){return Ns(t._redirectPersistence)}function xN(t){return lc(TC,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OC(t,e,n){return MC(t,e,n)}async function MC(t,e,n){if(zt(t.app))return Promise.reject(cs(t));const s=Gn(t);Db(t,e,Ju),await s._initializationPromise;const r=Ip(s,n);return await PC(r,s),r._openRedirect(s,e,"signInViaRedirect")}async function LC(t,e){return await Gn(t)._initializationPromise,yN(t,e,!1)}async function yN(t,e,n=!1){if(zt(t.app))return Promise.reject(cs(t));const s=Gn(t),r=Ip(s,e),a=await new AC(s,r,n).execute();return a&&!n&&(delete a.user._redirectEventId,await s._persistUserIfCurrent(a.user),await s._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VC=10*60*1e3;class $C{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!FC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!vN(e)){const r=((s=e.error.code)==null?void 0:s.split("auth/")[1])||"internal-error";n.onError(Bn(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=VC&&this.cachedEventUids.clear(),this.cachedEventUids.has(ty(e))}saveEventToCache(e){this.cachedEventUids.add(ty(e)),this.lastProcessedEventTime=Date.now()}}function ty(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function vN({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function FC(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vN(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DC(t,e={}){return ms(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,BC=/^https?/;async function zC(t){if(t.config.emulator)return;const{authorizedDomains:e}=await DC(t);for(const n of e)try{if(HC(n))return}catch{}Pn(t,"unauthorized-domain")}function HC(t){const e=Im(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===s}if(!BC.test(n))return!1;if(UC.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qC=new sl(3e4,6e4);function ny(){const t=us().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function WC(t){return new Promise((e,n)=>{var r,o,a;function s(){ny(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ny(),n(Bn(t,"network-request-failed"))},timeout:qC.get()})}if((o=(r=us().gapi)==null?void 0:r.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((a=us().gapi)!=null&&a.load)s();else{const l=CA("iframefcb");return us()[l]=()=>{gapi.load?s():n(Bn(t,"network-request-failed"))},tN(`${AA()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw uc=null,e})}let uc=null;function KC(t){return uc=uc||WC(t),uc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC=new sl(5e3,15e3),QC="__/auth/iframe",JC="emulator/auth/iframe",YC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},XC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZC(t){const e=t.config;fe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?_p(e,JC):`https://${t.config.authDomain}/${QC}`,s={apiKey:e.apiKey,appName:t.name,v:mi},r=XC.get(t.config.apiHost);r&&(s.eid=r);const o=t._getFrameworks();return o.length&&(s.fw=o.join(",")),`${n}?${Qa(s).slice(1)}`}async function eP(t){const e=await KC(t),n=us().gapi;return fe(n,t,"internal-error"),e.open({where:document.body,url:ZC(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YC,dontclear:!0},s=>new Promise(async(r,o)=>{await s.restyle({setHideOnLeave:!1});const a=Bn(t,"network-request-failed"),l=us().setTimeout(()=>{o(a)},GC.get());function u(){us().clearTimeout(l),r(s)}s.ping(u).then(u,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nP=500,sP=600,rP="_blank",iP="http://localhost";class sy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oP(t,e,n,s=nP,r=sP){const o=Math.max((window.screen.availHeight-r)/2,0).toString(),a=Math.max((window.screen.availWidth-s)/2,0).toString();let l="";const u={...tP,width:s.toString(),height:r.toString(),top:o,left:a},d=Dt().toLowerCase();n&&(l=Gb(d)?rP:n),Wb(d)&&(e=e||iP,u.scrollbars="yes");const h=Object.entries(u).reduce((p,[x,v])=>`${p}${x}=${v},`,"");if(wA(d)&&l!=="_self")return aP(e||"",l),new sy(null);const m=window.open(e||"",l,h);fe(m,t,"popup-blocked");try{m.focus()}catch{}return new sy(m)}function aP(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lP="__/auth/handler",cP="emulator/auth/handler",uP=encodeURIComponent("fac");async function ry(t,e,n,s,r,o){fe(t.config.authDomain,t,"auth-domain-config-required"),fe(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:mi,eventId:r};if(e instanceof Ju){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",AI(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries({}))a[h]=m}if(e instanceof il){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(a.scopes=h.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const u=await t._getAppCheckToken(),d=u?`#${uP}=${encodeURIComponent(u)}`:"";return`${dP(t)}?${Qa(l).slice(1)}${d}`}function dP({config:t}){return t.emulator?_p(t,cP):`https://${t.authDomain}/${lP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th="webStorageSupport";class hP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uN,this._completeRedirectFn=yN,this._overrideRedirectResult=RC}async _openPopup(e,n,s,r){var a;Ms((a=this.eventManagers[e._key()])==null?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await ry(e,n,s,Im(),r);return oP(e,o,kp())}async _openRedirect(e,n,s,r){await this._originValidation(e);const o=await ry(e,n,s,Im(),r);return fC(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:o}=this.eventManagers[n];return r?Promise.resolve(r):(Ms(o,"If manager is not set, promise should be"),o)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await eP(e),s=new $C(e);return n.register("authEvent",r=>(fe(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(th,{type:th},r=>{var a;const o=(a=r==null?void 0:r[0])==null?void 0:a[th];o!==void 0&&n(!!o),Pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=zC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Zb()||Kb()||bp()}}const mP=hP;var iy="@firebase/auth",oy="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pP(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function gP(t){Hn(new Cn("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=s.options;fe(a&&!a.includes(":"),"invalid-api-key",{appName:s.name});const u={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:eN(t)},d=new SA(s,r,o,u);return VA(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Hn(new Cn("auth-internal",e=>{const n=Gn(e.getProvider("auth").getImmediate());return(s=>new fP(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),rn(iy,oy,pP(t)),rn(iy,oy,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP=5*60,yP=ew("authIdTokenMaxAge")||xP;let ay=null;const vP=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>yP)return;const r=n==null?void 0:n.token;ay!==r&&(ay=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function _P(t=Iu()){const e=hi(t,"auth");if(e.isInitialized())return e.getImmediate();const n=LA(t,{popupRedirectResolver:mP,persistence:[NC,dC,uN]}),s=ew("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(s,location.origin);if(location.origin===o.origin){const a=vP(o.toString());oC(n,a,()=>a(n.currentUser)),iC(n,l=>a(l))}}const r=Y_("auth");return r&&$A(n,`http://${r}`),n}function wP(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}EA({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const o=Bn("internal-error");o.customData=r,n(o)},s.type="text/javascript",s.charset="UTF-8",wP().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});gP("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N="firebasestorage.googleapis.com",bP="storageBucket",NP=2*60*1e3,jP=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs extends Kn{constructor(e,n,s=0){super(nh(e),`Firebase Storage: ${n} (${nh(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,fs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return nh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var hs;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(hs||(hs={}));function nh(t){return"storage/"+t}function kP(){const t="An unknown error occurred, please check the error payload for server response.";return new fs(hs.UNKNOWN,t)}function IP(){return new fs(hs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function SP(){return new fs(hs.CANCELED,"User canceled the upload/download.")}function EP(t){return new fs(hs.INVALID_URL,"Invalid URL '"+t+"'.")}function TP(t){return new fs(hs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function ly(t){return new fs(hs.INVALID_ARGUMENT,t)}function wN(){return new fs(hs.APP_DELETED,"The Firebase app was deleted.")}function AP(t){return new fs(hs.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=Fn.makeFromUrl(e,n)}catch{return new Fn(e,"")}if(s.path==="")return s;throw TP(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function o(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const a="(/(.*))?$",l=new RegExp("^gs://"+r+a,"i"),u={bucket:1,path:3};function d(R){R.path_=decodeURIComponent(R.path)}const h="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",x=new RegExp(`^https?://${m}/${h}/b/${r}/o${p}`,"i"),v={bucket:1,path:3},j=n===_N?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",w=new RegExp(`^https?://${j}/${r}/${A}`,"i"),E=[{regex:l,indices:u,postModify:o},{regex:x,indices:v,postModify:d},{regex:w,indices:{bucket:1,path:2},postModify:d}];for(let R=0;R<E.length;R++){const $=E[R],D=$.regex.exec(e);if(D){const _=D[$.indices.bucket];let b=D[$.indices.path];b||(b=""),s=new Fn(_,b),$.postModify(s);break}}if(s==null)throw EP(e);return s}}class CP{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(t,e,n){let s=1,r=null,o=null,a=!1,l=0;function u(){return l===2}let d=!1;function h(...A){d||(d=!0,e.apply(null,A))}function m(A){r=setTimeout(()=>{r=null,t(x,u())},A)}function p(){o&&clearTimeout(o)}function x(A,...w){if(d){p();return}if(A){p(),h.call(null,A,...w);return}if(u()||a){p(),h.call(null,A,...w);return}s<64&&(s*=2);let E;l===1?(l=2,E=0):E=(s+Math.random())*1e3,m(E)}let v=!1;function j(A){v||(v=!0,p(),!d&&(r!==null?(A||(l=2),clearTimeout(r),m(0)):A||(l=1)))}return m(0),o=setTimeout(()=>{a=!0,j(!0)},n),j}function RP(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(t){return t!==void 0}function cy(t,e,n,s){if(s<e)throw ly(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw ly(`Invalid value for '${t}'. Expected ${n} or less.`)}function MP(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}var su;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(su||(su={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LP(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||r||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,n,s,r,o,a,l,u,d,h,m,p=!0,x=!1){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=m,this.retry=p,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,j)=>{this.resolve_=v,this.reject_=j,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Dl(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const a=l=>{const u=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(a),this.pendingConnection_=null;const l=o.getErrorCode()===su.NO_ERROR,u=o.getStatus();if(!l||LP(u,this.additionalRetryCodes_)&&this.retry){const h=o.getErrorCode()===su.ABORT;s(!1,new Dl(!1,null,h));return}const d=this.successCodes_.indexOf(u)!==-1;s(!0,new Dl(d,o))})},n=(s,r)=>{const o=this.resolve_,a=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());OP(u)?o(u):o()}catch(u){a(u)}else if(l!==null){const u=kP();u.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,u)):a(u)}else if(r.canceled){const u=this.appDelete_?wN():SP();a(u)}else{const u=IP();a(u)}};this.canceled_?n(!1,new Dl(!1,null,!0)):this.backoffId_=PP(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&RP(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Dl{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function $P(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function FP(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function DP(t,e){e&&(t["X-Firebase-GMPID"]=e)}function UP(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function BP(t,e,n,s,r,o,a=!0,l=!1){const u=MP(t.urlParams),d=t.url+u,h=Object.assign({},t.headers);return DP(h,e),$P(h,n),FP(h,o),UP(h,s),new VP(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,a,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zP(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function HP(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,n){this._service=e,n instanceof Fn?this._location=n:this._location=Fn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ru(e,n)}get root(){const e=new Fn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return HP(this._location.path)}get storage(){return this._service}get parent(){const e=zP(this._location.path);if(e===null)return null;const n=new Fn(this._location.bucket,e);return new ru(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw AP(e)}}function uy(t,e){const n=e==null?void 0:e[bP];return n==null?null:Fn.makeFromBucketSpec(n,t)}function qP(t,e,n,s={}){t.host=`${e}:${n}`;const r=ui(e);r&&(Tf(`https://${t.host}/b`),Af("Storage",!0)),t._isUsingEmulator=!0,t._protocol=r?"https":"http";const{mockUserToken:o}=s;o&&(t._overrideAuthToken=typeof o=="string"?o:tw(o,t.app.options.projectId))}class WP{constructor(e,n,s,r,o,a=!1){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=o,this._isUsingEmulator=a,this._bucket=null,this._host=_N,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=NP,this._maxUploadRetryTime=jP,this._requests=new Set,r!=null?this._bucket=Fn.makeFromBucketSpec(r,this._host):this._bucket=uy(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Fn.makeFromBucketSpec(this._url,e):this._bucket=uy(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){cy("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){cy("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(zt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ru(this,e)}_makeRequest(e,n,s,r,o=!0){if(this._deleted)return new CP(wN());{const a=BP(e,this._appId,s,r,n,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const dy="@firebase/storage",hy="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN="storage";function KP(t=Iu(),e){t=qe(t);const s=hi(t,bN).getImmediate({identifier:e}),r=X_("storage");return r&&GP(s,...r),s}function GP(t,e,n,s={}){qP(t,e,n,s)}function QP(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new WP(n,s,r,e,mi)}function JP(){Hn(new Cn(bN,QP,"PUBLIC").setMultipleInstances(!0)),rn(dy,hy,""),rn(dy,hy,"esm2020")}JP();const NN="@firebase/installations",Ep="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN=1e4,kN=`w:${Ep}`,IN="FIS_v2",YP="https://firebaseinstallations.googleapis.com/v1",XP=60*60*1e3,ZP="installations",eR="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ii=new di(ZP,eR,tR);function SN(t){return t instanceof Kn&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN({projectId:t}){return`${YP}/projects/${t}/installations`}function TN(t){return{token:t.token,requestStatus:2,expiresIn:sR(t.expiresIn),creationTime:Date.now()}}async function AN(t,e){const s=(await e.json()).error;return ii.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function CN({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function nR(t,{refreshToken:e}){const n=CN(t);return n.append("Authorization",rR(e)),n}async function PN(t){const e=await t();return e.status>=500&&e.status<600?t():e}function sR(t){return Number(t.replace("s","000"))}function rR(t){return`${IN} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iR({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=EN(t),r=CN(t),o=e.getImmediate({optional:!0});if(o){const d=await o.getHeartbeatsHeader();d&&r.append("x-firebase-client",d)}const a={fid:n,authVersion:IN,appId:t.appId,sdkVersion:kN},l={method:"POST",headers:r,body:JSON.stringify(a)},u=await PN(()=>fetch(s,l));if(u.ok){const d=await u.json();return{fid:d.fid||n,registrationStatus:2,refreshToken:d.refreshToken,authToken:TN(d.authToken)}}else throw await AN("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RN(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oR(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR=/^[cdef][\w-]{21}$/,Tm="";function lR(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=cR(t);return aR.test(n)?n:Tm}catch{return Tm}}function cR(t){return oR(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zu(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON=new Map;function MN(t,e){const n=Zu(t);LN(n,e),uR(n,e)}function LN(t,e){const n=ON.get(t);if(n)for(const s of n)s(e)}function uR(t,e){const n=dR();n&&n.postMessage({key:t,fid:e}),hR()}let Hr=null;function dR(){return!Hr&&"BroadcastChannel"in self&&(Hr=new BroadcastChannel("[Firebase] FID Change"),Hr.onmessage=t=>{LN(t.data.key,t.data.fid)}),Hr}function hR(){ON.size===0&&Hr&&(Hr.close(),Hr=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR="firebase-installations-database",fR=1,oi="firebase-installations-store";let sh=null;function Tp(){return sh||(sh=ku(mR,fR,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(oi)}}})),sh}async function iu(t,e){const n=Zu(t),r=(await Tp()).transaction(oi,"readwrite"),o=r.objectStore(oi),a=await o.get(n);return await o.put(e,n),await r.done,(!a||a.fid!==e.fid)&&MN(t,e.fid),e}async function VN(t){const e=Zu(t),s=(await Tp()).transaction(oi,"readwrite");await s.objectStore(oi).delete(e),await s.done}async function ed(t,e){const n=Zu(t),r=(await Tp()).transaction(oi,"readwrite"),o=r.objectStore(oi),a=await o.get(n),l=e(a);return l===void 0?await o.delete(n):await o.put(l,n),await r.done,l&&(!a||a.fid!==l.fid)&&MN(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ap(t){let e;const n=await ed(t.appConfig,s=>{const r=pR(s),o=gR(t,r);return e=o.registrationPromise,o.installationEntry});return n.fid===Tm?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function pR(t){const e=t||{fid:lR(),registrationStatus:0};return $N(e)}function gR(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(ii.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=xR(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:yR(t)}:{installationEntry:e}}async function xR(t,e){try{const n=await iR(t,e);return iu(t.appConfig,n)}catch(n){throw SN(n)&&n.customData.serverCode===409?await VN(t.appConfig):await iu(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function yR(t){let e=await my(t.appConfig);for(;e.registrationStatus===1;)await RN(100),e=await my(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await Ap(t);return s||n}return e}function my(t){return ed(t,e=>{if(!e)throw ii.create("installation-not-found");return $N(e)})}function $N(t){return vR(t)?{fid:t.fid,registrationStatus:0}:t}function vR(t){return t.registrationStatus===1&&t.registrationTime+jN<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _R({appConfig:t,heartbeatServiceProvider:e},n){const s=wR(t,n),r=nR(t,n),o=e.getImmediate({optional:!0});if(o){const d=await o.getHeartbeatsHeader();d&&r.append("x-firebase-client",d)}const a={installation:{sdkVersion:kN,appId:t.appId}},l={method:"POST",headers:r,body:JSON.stringify(a)},u=await PN(()=>fetch(s,l));if(u.ok){const d=await u.json();return TN(d)}else throw await AN("Generate Auth Token",u)}function wR(t,{fid:e}){return`${EN(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cp(t,e=!1){let n;const s=await ed(t.appConfig,o=>{if(!FN(o))throw ii.create("not-registered");const a=o.authToken;if(!e&&jR(a))return o;if(a.requestStatus===1)return n=bR(t,e),o;{if(!navigator.onLine)throw ii.create("app-offline");const l=IR(o);return n=NR(t,l),l}});return n?await n:s.authToken}async function bR(t,e){let n=await fy(t.appConfig);for(;n.authToken.requestStatus===1;)await RN(100),n=await fy(t.appConfig);const s=n.authToken;return s.requestStatus===0?Cp(t,e):s}function fy(t){return ed(t,e=>{if(!FN(e))throw ii.create("not-registered");const n=e.authToken;return SR(n)?{...e,authToken:{requestStatus:0}}:e})}async function NR(t,e){try{const n=await _R(t,e),s={...e,authToken:n};return await iu(t.appConfig,s),n}catch(n){if(SN(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await VN(t.appConfig);else{const s={...e,authToken:{requestStatus:0}};await iu(t.appConfig,s)}throw n}}function FN(t){return t!==void 0&&t.registrationStatus===2}function jR(t){return t.requestStatus===2&&!kR(t)}function kR(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+XP}function IR(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function SR(t){return t.requestStatus===1&&t.requestTime+jN<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ER(t){const e=t,{installationEntry:n,registrationPromise:s}=await Ap(e);return s?s.catch(console.error):Cp(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TR(t,e=!1){const n=t;return await AR(n),(await Cp(n,e)).token}async function AR(t){const{registrationPromise:e}=await Ap(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CR(t){if(!t||!t.options)throw rh("App Configuration");if(!t.name)throw rh("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw rh(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function rh(t){return ii.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN="installations",PR="installations-internal",RR=t=>{const e=t.getProvider("app").getImmediate(),n=CR(e),s=hi(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},OR=t=>{const e=t.getProvider("app").getImmediate(),n=hi(e,DN).getImmediate();return{getId:()=>ER(n),getToken:r=>TR(n,r)}};function MR(){Hn(new Cn(DN,RR,"PUBLIC")),Hn(new Cn(PR,OR,"PRIVATE"))}MR();rn(NN,Ep);rn(NN,Ep,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR="/firebase-messaging-sw.js",VR="/firebase-cloud-messaging-push-scope",UN="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",$R="https://fcmregistrations.googleapis.com/v1",BN="google.c.a.c_id",FR="google.c.a.c_l",DR="google.c.a.ts",UR="google.c.a.e",py=1e4;var gy;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(gy||(gy={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Fa;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Fa||(Fa={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xs(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function BR(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(n),r=new Uint8Array(s.length);for(let o=0;o<s.length;++o)r[o]=s.charCodeAt(o);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ih="fcm_token_details_db",zR=5,xy="fcm_token_object_Store";async function HR(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(o=>o.name).includes(ih))return null;let e=null;return(await ku(ih,zR,{upgrade:async(s,r,o,a)=>{if(r<2||!s.objectStoreNames.contains(xy))return;const l=a.objectStore(xy),u=await l.index("fcmSenderId").get(t);if(await l.clear(),!!u){if(r===2){const d=u;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:d.createTime??Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:typeof d.vapidKey=="string"?d.vapidKey:xs(d.vapidKey)}}}else if(r===3){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:xs(d.auth),p256dh:xs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:xs(d.vapidKey)}}}else if(r===4){const d=u;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:xs(d.auth),p256dh:xs(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:xs(d.vapidKey)}}}}}})).close(),await Wd(ih),await Wd("fcm_vapid_details_db"),await Wd("undefined"),qR(e)?e:null}function qR(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR="firebase-messaging-database",KR=1,Da="firebase-messaging-store";let oh=null;function zN(){return oh||(oh=ku(WR,KR,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Da)}}})),oh}async function GR(t){const e=HN(t),s=await(await zN()).transaction(Da).objectStore(Da).get(e);if(s)return s;{const r=await HR(t.appConfig.senderId);if(r)return await Pp(t,r),r}}async function Pp(t,e){const n=HN(t),r=(await zN()).transaction(Da,"readwrite");return await r.objectStore(Da).put(e,n),await r.done,e}function HN({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},$t=new di("messaging","Messaging",QR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JR(t,e){const n=await Op(t),s=qN(e),r={method:"POST",headers:n,body:JSON.stringify(s)};let o;try{o=await(await fetch(Rp(t.appConfig),r)).json()}catch(a){throw $t.create("token-subscribe-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw $t.create("token-subscribe-failed",{errorInfo:a})}if(!o.token)throw $t.create("token-subscribe-no-token");return o.token}async function YR(t,e){const n=await Op(t),s=qN(e.subscriptionOptions),r={method:"PATCH",headers:n,body:JSON.stringify(s)};let o;try{o=await(await fetch(`${Rp(t.appConfig)}/${e.token}`,r)).json()}catch(a){throw $t.create("token-update-failed",{errorInfo:a==null?void 0:a.toString()})}if(o.error){const a=o.error.message;throw $t.create("token-update-failed",{errorInfo:a})}if(!o.token)throw $t.create("token-update-no-token");return o.token}async function XR(t,e){const s={method:"DELETE",headers:await Op(t)};try{const o=await(await fetch(`${Rp(t.appConfig)}/${e}`,s)).json();if(o.error){const a=o.error.message;throw $t.create("token-unsubscribe-failed",{errorInfo:a})}}catch(r){throw $t.create("token-unsubscribe-failed",{errorInfo:r==null?void 0:r.toString()})}}function Rp({projectId:t}){return`${$R}/projects/${t}/registrations`}async function Op({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function qN({p256dh:t,auth:e,endpoint:n,vapidKey:s}){const r={web:{endpoint:n,auth:e,p256dh:t}};return s!==UN&&(r.web.applicationPubKey=s),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=7*24*60*60*1e3;async function e4(t){const e=await n4(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:xs(e.getKey("auth")),p256dh:xs(e.getKey("p256dh"))},s=await GR(t.firebaseDependencies);if(s){if(s4(s.subscriptionOptions,n))return Date.now()>=s.createTime+ZR?t4(t,{token:s.token,createTime:Date.now(),subscriptionOptions:n}):s.token;try{await XR(t.firebaseDependencies,s.token)}catch(r){console.warn(r)}return yy(t.firebaseDependencies,n)}else return yy(t.firebaseDependencies,n)}async function t4(t,e){try{const n=await YR(t.firebaseDependencies,e),s={...e,token:n,createTime:Date.now()};return await Pp(t.firebaseDependencies,s),n}catch(n){throw n}}async function yy(t,e){const s={token:await JR(t,e),createTime:Date.now(),subscriptionOptions:e};return await Pp(t,s),s.token}async function n4(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:BR(e)})}function s4(t,e){const n=e.vapidKey===t.vapidKey,s=e.endpoint===t.endpoint,r=e.auth===t.auth,o=e.p256dh===t.p256dh;return n&&s&&r&&o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return r4(e,t),i4(e,t),o4(e,t),e}function r4(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const s=e.notification.body;s&&(t.notification.body=s);const r=e.notification.image;r&&(t.notification.image=r);const o=e.notification.icon;o&&(t.notification.icon=o)}function i4(t,e){e.data&&(t.data=e.data)}function o4(t,e){var r,o,a,l;if(!e.fcmOptions&&!((r=e.notification)!=null&&r.click_action))return;t.fcmOptions={};const n=((o=e.fcmOptions)==null?void 0:o.link)??((a=e.notification)==null?void 0:a.click_action);n&&(t.fcmOptions.link=n);const s=(l=e.fcmOptions)==null?void 0:l.analytics_label;s&&(t.fcmOptions.analyticsLabel=s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a4(t){return typeof t=="object"&&!!t&&BN in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(t){if(!t||!t.options)throw ah("App Configuration Object");if(!t.name)throw ah("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const s of e)if(!n[s])throw ah(s);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function ah(t){return $t.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(e,n,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=l4(e);this.firebaseDependencies={app:e,appConfig:r,installations:n,analyticsProvider:s}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u4(t){try{t.swRegistration=await navigator.serviceWorker.register(LR,{scope:VR}),t.swRegistration.update().catch(()=>{}),await d4(t.swRegistration)}catch(e){throw $t.create("failed-service-worker-registration",{browserErrorMessage:e==null?void 0:e.message})}}async function d4(t){return new Promise((e,n)=>{const s=setTimeout(()=>n(new Error(`Service worker not registered after ${py} ms`)),py),r=t.installing||t.waiting;t.active?(clearTimeout(s),e()):r?r.onstatechange=o=>{var a;((a=o.target)==null?void 0:a.state)==="activated"&&(r.onstatechange=null,clearTimeout(s),e())}:(clearTimeout(s),n(new Error("No incoming service worker found.")))})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function h4(t,e){if(!e&&!t.swRegistration&&await u4(t),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw $t.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m4(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=UN)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WN(t,e){if(!navigator)throw $t.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw $t.create("permission-blocked");return await m4(t,e==null?void 0:e.vapidKey),await h4(t,e==null?void 0:e.serviceWorkerRegistration),e4(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f4(t,e,n){const s=p4(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(s,{message_id:n[BN],message_name:n[FR],message_time:n[DR],message_device_time:Math.floor(Date.now()/1e3)})}function p4(t){switch(t){case Fa.NOTIFICATION_CLICKED:return"notification_open";case Fa.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g4(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===Fa.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(vy(n)):t.onMessageHandler.next(vy(n)));const s=n.data;a4(s)&&s[UR]==="1"&&await f4(t,n.messageType,s)}const _y="@firebase/messaging",wy="0.12.23";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=t=>{const e=new c4(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>g4(e,n)),e},y4=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:s=>WN(e,s)}};function v4(){Hn(new Cn("messaging",x4,"PUBLIC")),Hn(new Cn("messaging-internal",y4,"PRIVATE")),rn(_y,wy),rn(_y,wy,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KN(){try{await sw()}catch{return!1}return typeof window<"u"&&nw()&&II()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(t,e){if(!navigator)throw $t.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w4(t=Iu()){return KN().then(e=>{if(!e)throw $t.create("unsupported-browser")},e=>{throw $t.create("indexed-db-unsupported")}),hi(qe(t),"messaging").getImmediate()}async function b4(t,e){return t=qe(t),WN(t,e)}function N4(t,e){return t=qe(t),_4(t,e)}v4();const j4={apiKey:"AIzaSyAMubJk9qXmaz_V3uHiCGs0hRe6FSu9ji4",authDomain:"ai-factory-c6d58.firebaseapp.com",projectId:"ai-factory-c6d58",storageBucket:"ai-factory-c6d58.firebasestorage.app",messagingSenderId:"213197152130",appId:"1:213197152130:web:7c19f9c3c88bea7cc1399b",measurementId:"G-4D82WS9H7K"},td=ow(j4),re=U2(td),Zn=_P(td);KP(td);let Ua=null;typeof window<"u"&&KN().then(t=>{t&&(Ua=w4(td))});async function k4(t="dog",e=""){try{const n=ge(re,"owner_faq"),s=Te(n,me("species_code","in",[t,"all"]),Wn(20)),o=(await Re(s)).docs.map(a=>({id:a.id,...a.data()}));if(e){const a=e.toLowerCase().split(/[\s,]+/);return o.map(u=>{let d=0;const h=`${u.question_ko||""} ${u.answer_ko||""} ${(u.keywords||[]).join(" ")}`.toLowerCase();return a.forEach(m=>{m&&h.includes(m)&&(d+=1)}),{...u,relevanceScore:d}}).filter(u=>u.relevanceScore>0).sort((u,d)=>d.relevanceScore-u.relevanceScore).slice(0,5)}return o.slice(0,5)}catch(n){return console.error("FAQ  :",n),[]}}async function I4(t){if(!t)return[];try{const e=ge(re,"diagnoses"),n=Te(e,me("petId","==",t),Wn(10));return(await Re(n)).docs.map(o=>({id:o.id,...o.data()})).sort((o,a)=>{var d,h,m,p;const l=((h=(d=o.createdAt)==null?void 0:d.toDate)==null?void 0:h.call(d))||new Date(o.created_at||0);return(((p=(m=a.createdAt)==null?void 0:m.toDate)==null?void 0:p.call(m))||new Date(a.created_at||0))-l}).slice(0,5)}catch(e){return console.error("    :",e),[]}}async function S4(t,e){try{const n=ge(re,"diagnoses"),s=Te(n,Wt("createdAt","desc"),Wn(30)),o=(await Re(s)).docs.map(u=>({id:u.id,...u.data()})),a=(e||"").toLowerCase().split(/[\s,]+/).filter(Boolean);return o.filter(u=>{if(u.species&&u.species!==t)return!1;const d=`${u.symptom||""} ${u.diagnosis||""} ${u.description||""}`.toLowerCase();return a.some(h=>h&&d.includes(h))}).slice(0,5).map(u=>({diagnosis:u.diagnosis,symptom:u.symptom,triage_score:u.triage_score,actions:u.actions,hospitalVisit:u.hospitalVisit}))}catch(n){return console.error("   :",n),[]}}async function E4(t,e=7){if(!t)return[];try{const n=ge(re,"pets",t,"careLogs"),s=Te(n,Wt("date","desc"),Wn(e));return(await Re(s)).docs.map(o=>({id:o.id,...o.data()}))}catch(n){return console.error("   :",n),[]}}function T4(t){if(!t||t.length===0)return"";const e=[...t].sort((r,o)=>r.date<o.date?1:-1).slice(0,7);let n=["[ 7   ]"],s=[];for(const r of e){const o={happy:"",normal:"",tired:"",anxious:""}[r.mood]||r.mood,a=`- ${r.date}:  ${r.mealCount??"-"},  ${r.waterCount??"-"},  ${r.walkCount??"-"},  ${r.poopCount??"-"},  ${r.weightKg??""}kg,  ${o}`;n.push(a),typeof r.weightKg=="number"&&s.push(r.weightKg)}if(s.length>=2){const r=s[s.length-1],o=s[0],a=+(o-r).toFixed(1),l=a>.3?"  .":a<-.3?"  .":"   .";n.push(`  : ${r}kg  ${o}kg (${a>0?"+":""}${a}kg). ${l}`)}return n.join(`
`)}async function A4(t,e){const n=(t==null?void 0:t.species)||"dog",s=(e==null?void 0:e.symptomText)||(e==null?void 0:e.description)||"",r=((e==null?void 0:e.selectedSymptoms)||[]).join(", "),o=`${s} ${r}`,[a,l,u,d]=await Promise.all([k4(n,o),I4(t==null?void 0:t.id),S4(n,o),E4(t==null?void 0:t.id,7)]);let h="";l.length>0&&(h+=`

[    ]
`,l.forEach((p,x)=>{var j,A;const v=((A=(j=p.createdAt)==null?void 0:j.toDate)==null?void 0:A.call(j))||new Date(p.created_at);h+=`${x+1}. ${v.toLocaleDateString("ko-KR")} - ${p.diagnosis||""}
`,h+=`   : ${p.symptom||" "}
`,p.triage_score&&(h+=`   : ${p.triage_score}/5
`)})),u.length>0&&(h+=`

[     ]
`,u.forEach((p,x)=>{h+=`${x+1}. : ${p.diagnosis}
`,h+=`   : ${p.symptom}
`,p.triage_score&&(h+=`   : ${p.triage_score}/5
`),p.hospitalVisit&&(h+=`     : 
`)})),a.length>0&&(h+=`

[ FAQ  ]
`,a.forEach((p,x)=>{h+=`${x+1}. Q: ${p.question_ko}
`,h+=`   A: ${p.answer_ko}
`}));const m=T4(d);return m&&(h+=`

`+m),h}const C4=async(t,e,n,s,r="")=>{var d;const o=xn(Vt.ANTHROPIC);if(!o)throw new Error("Claude API   .  > API   .");const a="claude-sonnet-4-20250514",l=`${ci}

 "Medical Agent ( )".
 10  ,    .

[]
- CS Agent + Information Agent     .
-   () 1~3  .
-     '  ' reasoning .
-     .
-       .      .

[  - JSON ONLY]
  JSON  .    .

{
  "primary_assessment_kor": "      ()",
  "possible_diseases": [
    {
      "name_kor": "  ()",
      "name_en": "  (  )",
      "probability": 0.0,
      "reasoning_kor": "    (, , / )",
      "body_part": " |  |  |  |  | / |   "
    }
  ],
  "risk_level": "low | moderate | high | emergency",
  "need_hospital_visit": true,
  "hospital_visit_timing": " ( ) |   | 24~48  |   |   ",
  "suggested_tests": ["    :   , , X-ray "],
  "caution_notes_for_owner": ["     1", "    1"]
}`,u=` :
- : ${t.petName}
- : ${qt(t.species)}
- : ${t.breed||""}
- : ${t.age||""}
${t.weight?`- : ${t.weight}kg`:""}

CS Agent :
${JSON.stringify(n,null,2)}

Information Agent :
${JSON.stringify(s,null,2)}

  :
${e.symptomText||"  "}
${e.guardianResponsesSummary?`

    ():
${e.guardianResponsesSummary}
`:""}
${r?`
===   (Firestore DB) ===
${r}
=================================
      FAQ.   ,      .
`:""}

:
- 'emergency'      .
-      , ' //'  , JSON probability(0~1)  .
-      , 1~3  .
-   JSON .

 -  vs    :
- risk_level 'low' :      . need_hospital_visit false.
- risk_level 'moderate' :   , 24-48        .
-       :
  *  ,  (1-2),  
  *   ,   
  *   ,   
  * ,   
-      :
  *  (3 ), /
  * 48   ,  
  * , , 
  *  , , `;try{const h=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":o,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:a,max_tokens:2048,system:l,messages:[{role:"user",content:u}]})});if(!h.ok){const v=await h.json().catch(()=>({}));throw new Error(`Claude API : ${h.status} - ${((d=v.error)==null?void 0:d.message)||"   "}`)}const p=(await h.json()).content[0].text;let x;try{const v=p.match(/\{[\s\S]*\}/);x=JSON.parse(v?v[0]:p)}catch(v){throw console.error("JSON  :",v),new Error("  ")}return{json:x,message:`   ...

   :
${x.primary_assessment_kor}

  :
${x.possible_diseases.map(v=>` ${v.name_kor} ( ${Math.round(v.probability*100)}%)`).join(`
`)}

 : ${x.risk_level==="low"?"":x.risk_level==="moderate"?"":x.risk_level==="high"?"":""}
 : ${x.hospital_visit_timing}

 Triage Engine,   .`}}catch(h){return console.error("Medical Agent :",h),{json:{primary_assessment_kor:"   .",possible_diseases:[{name_kor:"  ",name_en:"",probability:.6,reasoning_kor:"  ",body_part:""}],risk_level:"moderate",need_hospital_visit:!1,hospital_visit_timing:" ",suggested_tests:[],caution_notes_for_owner:["  ","  "]},message:`   ...

    .

  :
    ( 60%)

 : Moderate
 :  

 Triage Engine,   .`}}},P4=async(t,e,n,s,r,o)=>{var h;const a=xn(Vt.ANTHROPIC);if(!a)throw new Error("Claude API   .  > API   .");const l="claude-sonnet-4-20250514",u=`${ci}

 "Ops Agent ( )".

[]
- CS / Information / Medical / Triage  ,     .
-     "  (pre-visit packet)" .
- JSON   ,    .

[  - JSON ONLY]
  JSON  .    .

{
  "medical_log": {
    "pet_id": "${t.id}",
    "created_at": "${new Date().toISOString()}",
    "summary_kor": "       ",
    "triage_score": 0,
    "triage_level": "green | yellow | orange | red",
    "risk_level": "low | moderate | high | emergency",
    "need_hospital_visit": true,
    "hospital_visit_timing": "  |   | 24~48  |    |  ",
    "health_flags": {
      "earIssue": false,
      "digestionIssue": false,
      "skinIssue": false,
      "fever": false,
      "energyLevel": 0.8
    },
    "possible_diseases": [
      {
        "name_kor": " ",
        "probability": 0.7,
        "body_part": " |  |  |  |  | / | ",
        "reasoning_kor": "  "
      }
    ],
    "caution_notes_for_owner": ["      1", " 2"],
    "suggested_tests": ["  1", "  2"]
  },
  "owner_friendly_diagnosis_sheet": {
    "title": "  (: '${t.petName}   AI  ')",
    "intro": "       (, 2~3)",
    "problem_summary": "     ",
    "risk_explanation": "/     ",
    "what_to_watch": ["    ", "     "],
    "immediate_home_actions": ["       1", "     1"]
  },
  "hospital_previsit_packet": {
    "packet_title": " AI   ",
    "for_vet_summary": " 10        (, 3~5)",
    "pet_profile_brief": {
      "name": "${t.petName}",
      "species": "${t.species}",
      "breed": "${t.breed||""}",
      "age_info": ":  ${t.age||"?"} , ${qt(t.species)}",
      "sex_neutered": ": ${t.sex==="M"?"":""}"
    },
    "visit_reason": "        ",
    "symptom_timeline": " ,     ",
    "ai_differential_diagnosis": [
      {
        "name_kor": " ",
        "probability": 0.7,
        "note_for_vet": "    ( ,   )"
      }
    ],
    "triage_and_risk": {
      "triage_score": 0,
      "triage_level": "green | yellow | orange | red",
      "risk_level": "low | moderate | high | emergency",
      "urgency_comment": "   "
    },
    "requested_actions_for_hospital": ["       ."]
  }
}

:
- JSON   ,   .
- (owner_friendly_diagnosis_sheet) (hospital_previsit_packet)    .
  - :  
  - :   ,  `,d=`[]
- pet_profile:  
- cs_summary: CS Agent JSON
- info_summary: Information Agent JSON
- medical_result: Medical Agent JSON
- triage_result: Triage Engine JSON

 :
- : ${t.petName}
- : ${qt(t.species)}
- : ${t.breed||""}

CS Agent :
${JSON.stringify(r,null,2)}

Information Agent :
${JSON.stringify(o,null,2)}

Medical Agent :
${JSON.stringify(n,null,2)}

Triage Engine :
${JSON.stringify(s,null,2)}

  JSON .`;try{const m=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":a,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:l,max_tokens:4096,system:u,messages:[{role:"user",content:d}]})});if(!m.ok){const j=await m.json().catch(()=>({}));throw new Error(`Claude API : ${m.status} - ${((h=j.error)==null?void 0:h.message)||"   "}`)}const x=(await m.json()).content[0].text;let v;try{const j=x.match(/\{[\s\S]*\}/);v=JSON.parse(j?j[0]:x)}catch(j){throw console.error("JSON  :",j),new Error("  ")}return{json:v,message:`   .
   ...
  .

   !`}}catch(m){console.error("Ops Agent :",m);const p=(s==null?void 0:s.health_flags)||{earIssue:!1,digestionIssue:!1,skinIssue:!1,fever:!1,energyLevel:.7};return{json:{medical_log:{pet_id:t.id,created_at:new Date().toISOString(),summary_kor:`${t.petName}   AI  .`,triage_score:(s==null?void 0:s.triage_score)||2,triage_level:(s==null?void 0:s.triage_level)||"yellow",risk_level:(n==null?void 0:n.risk_level)||"moderate",need_hospital_visit:(n==null?void 0:n.need_hospital_visit)||!1,hospital_visit_timing:(n==null?void 0:n.hospital_visit_timing)||"  ",health_flags:p,possible_diseases:(n==null?void 0:n.possible_diseases)||[],caution_notes_for_owner:(n==null?void 0:n.caution_notes_for_owner)||[],suggested_tests:(n==null?void 0:n.suggested_tests)||[]},owner_friendly_diagnosis_sheet:{title:`${t.petName} AI  `,intro:"AI  .",problem_summary:"   .",risk_explanation:"  .",what_to_watch:["  "],immediate_home_actions:["  "]},hospital_previsit_packet:{packet_title:" AI   ",for_vet_summary:"AI    .",pet_profile_brief:{name:t.petName,species:t.species,breed:t.breed||"",age_info:`${t.age||"?"}`,sex_neutered:t.sex==="M"?"":""},visit_reason:"   ",symptom_timeline:"  ",ai_differential_diagnosis:[],triage_and_risk:{triage_score:(s==null?void 0:s.triage_score)||2,triage_level:(s==null?void 0:s.triage_level)||"yellow",risk_level:(n==null?void 0:n.risk_level)||"moderate",urgency_comment:"  "},requested_actions_for_hospital:[]}},message:`   .
   ...
  .

   !`}}},R4=async(t,e,n,s)=>{const r=xn(Vt.GEMINI);if(!r)throw new Error("Gemini API   .  > API   .");const o="gemini-2.0-flash",a=`${ci}

 "Care Agent ( )".

[]
- Medical / Triage / Ops  ,        .
-    ' '    .
-  /   .
-  ,    .

[]
- pet_profile:  
- medical_result: Medical Agent JSON
- triage_result: Triage Engine JSON
- ops_medical_log: Ops Agent medical_log

 :
- : ${t.petName}
- : ${qt(t.species)}
- : ${t.breed||""}

Medical Agent :
${JSON.stringify(n,null,2)}

Triage Engine :
${JSON.stringify(s,null,2)}

Ops Agent  :
${JSON.stringify((e==null?void 0:e.medical_log)||{},null,2)}

[  - JSON ONLY]

{
  "immediate_home_care": [
    "        1",
    "     2",
    "   (:   ,   )"
  ],
  "things_to_avoid": [
    "  // 1",
    "   2"
  ],
  "monitoring_guide": [
    "     1",
    "       "
  ],
  "long_term_prevention": [
    " 1~3       ",
    "//  "
  ],
  "follow_up_guide": {
    "need_follow_up": true,
    "timing": "24~48  | 3  | 1  |   ",
    "condition_for_hospital": "     ",
    "home_care_duration": "   (: 2~3 )"
  },
  "care_tone_message": "   /  ( 1~2)",
  "hospital_needed": false
}

:
- triage_score 0~2 (green/yellow) :       . hospital_needed false.
- triage_score 3 :   , 24~48      . hospital_needed  true.
- triage_result red  emergency : immediate_home_care   '  '  . hospital_needed true.
-         .
- follow_up_guide /    .
-   "   "   .
-   JSON .`;try{const l=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${o}:generateContent?key=${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:a}]}]})});if(!l.ok)throw new Error(`Gemini API : ${l.status}`);const h=(await l.json()).candidates[0].content.parts[0].text.match(/\{[\s\S]*\}/);if(h){const m=JSON.parse(h[0]),p=m.follow_up_guide?`
[/ ]
 : ${m.follow_up_guide.timing||"  "}
  : ${m.follow_up_guide.home_care_duration||"2~3 "}
    : ${m.follow_up_guide.condition_for_hospital||"     "}
`:"",x=m.hospital_needed?`
   .`:`
     .`,v=`
${m.care_tone_message}
${x}

[  ]
${m.immediate_home_care.map(j=>` ${j}`).join(`
`)}

[  ]
${m.things_to_avoid.map(j=>` ${j}`).join(`
`)}

[ ]
${m.monitoring_guide.map(j=>` ${j}`).join(`
`)}
${p}
[ ]
${m.long_term_prevention.map(j=>` ${j}`).join(`
`)}
      `.trim();return{json:m,message:`${t.petName}    !

${m.care_tone_message}`,fullGuide:v}}throw new Error("JSON  ")}catch(l){console.error("Care Agent :",l);const u=(s==null?void 0:s.triage_level)==="red"||(s==null?void 0:s.triage_score)>=4,d=(s==null?void 0:s.triage_score)<=2,h={immediate_home_care:u?["   .   ."]:d?["  ","   ","      ","   "]:["  ","  ","  "],things_to_avoid:[" ","  ","  "],monitoring_guide:["  ","    ","  "],long_term_prevention:["  ","  "],follow_up_guide:{need_follow_up:!d,timing:u?"":d?"  ":"24~48 ",condition_for_hospital:"   (, ,  )  ",home_care_duration:d?"2~3 ":"24 "},care_tone_message:d?`${t.petName}   .    !`:`${t.petName}   .`,hospital_needed:u},m=d?`     .

[ ]
${h.immediate_home_care.map(p=>` ${p}`).join(`
`)}

[ ]
 ${h.follow_up_guide.timing} .`:"  ";return{json:h,message:d?`${t.petName}   !

  .

 :
   
   

   .`:`${t.petName}   !

 :
   
   `,fullGuide:m}}},O4=async(t,e,n,s)=>{var u;const r=xn(Vt.ANTHROPIC);if(!r)throw new Error("Claude API   .  > API   .");const o="claude-sonnet-4-20250514",a=`${ci}

 "Triage Engine".

[]
- Medical Agent       .
- 0~5  triage_score . (0=  , 5=  )
- health_flags     ,     .
-   ( )      .

[  - JSON ONLY]
  JSON  .    .

{
  "triage_score": 0,
  "triage_level": "green | yellow | orange | red",
  "emergency_summary_kor": "    ",
  "recommended_action_window": "  |   | 24~48  |    |  ",
  "health_flags": {
    "earIssue": false,
    "digestionIssue": false,
    "skinIssue": false,
    "fever": false,
    "energyLevel": 0.8
  }
}

 :
- triage_score:
  - 0~1:      ,   
  - 2: ,      ,    
  - 3:    24~48      
  - 4:  ,    
  - 5: ,    

- triage_level:
  - green: 0~1  " .  ."
  - yellow: 2  " .     ."
  - orange: 3~4  "24    ."
  - red: 5  "   ."

- recommended_action_window  :
  - " ": green ,    
  - "  ": yellow ,    
  - "24~48 ": orange ,   
  - " ": orange 
  - " ": red , 

- health_flags:
  - Medical Agent possible_diseases body_part, risk_level   
  - energyLevel: 0~1   (0= , 1=   )

:  ( ,  ,   ,   ) triage_score 0~2    .      .`,l=` :
- : ${t.petName}
- : ${qt(t.species)}
- : ${t.age||""}

: ${(e==null?void 0:e.symptomText)||"  "}
${e!=null&&e.guardianResponsesSummary?`
     (  -    ) 
${e.guardianResponsesSummary}

:        triage_score  :
-    " " +1
-  "  "  "  " +1
-  "  " +1
-   "", ""  +2
`:""}

 :
${JSON.stringify(n,null,2)}

CS Agent :
${JSON.stringify(s,null,2)}

  JSON .`;try{const d=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":r,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:o,max_tokens:1024,system:a,messages:[{role:"user",content:l}]})});if(!d.ok){const x=await d.json().catch(()=>({}));throw new Error(`Claude API : ${d.status} - ${((u=x.error)==null?void 0:u.message)||"   "}`)}const m=(await d.json()).content[0].text;let p;try{const x=m.match(/\{[\s\S]*\}/);p=JSON.parse(x?x[0]:m)}catch(x){throw console.error("JSON  :",x),new Error("  ")}return p}catch(d){console.error("Triage Engine :",d);const h=(n==null?void 0:n.risk_level)||(n==null?void 0:n.riskLevel)||"moderate";let m=2,p="yellow",x="24~48 ";h==="emergency"||h==="Emergency"?(m=5,p="red",x=" "):h==="high"||h==="High"?(m=4,p="orange",x=" "):h==="low"||h==="Low"?(m=1,p="green",x=" "):(m=3,p="orange",x="24~48 ");const v=(n==null?void 0:n.possible_diseases)||[],j={earIssue:v.some(A=>A.body_part===""),digestionIssue:v.some(A=>A.body_part===""),skinIssue:v.some(A=>A.body_part===""),fever:!1,energyLevel:m<=2?.8:m<=3?.6:.4};return{triage_score:m,triage_level:p,emergency_summary_kor:`${x}   .`,recommended_action_window:x,health_flags:j}}};function M4(t){const e={earIssue:!1,digestionIssue:!1,skinIssue:!1,energyLevel:.8,fever:!1},s=`
    ${t.summary||""}
    ${t.description||""}
    ${t.diagnosis||""}
    ${(t.possibleDiseases||[]).map(o=>o.name||o).join(" ")}
    ${(t.differentialDiagnosis||[]).join(" ")}
    ${t.reasoning||""}
  `.toLowerCase();(s.includes("")||s.includes("")||s.includes("ear")||s.includes("otitis"))&&(e.earIssue=!0),(s.includes("")||s.includes("")||s.includes("")||s.includes("")||s.includes("diarrhea")||s.includes("vomit")||s.includes("digestion"))&&(e.digestionIssue=!0),(s.includes("")||s.includes("")||s.includes("")||s.includes("skin")||s.includes("rash")||s.includes("itch"))&&(e.skinIssue=!0),(s.includes("")||s.includes("")||s.includes("")||s.includes("fever")||s.includes("temperature"))&&(e.fever=!0);const r=t.riskLevel||t.emergency||"low";return r==="high"||r==="High"||r==="Emergency"?e.energyLevel=.2:r==="medium"||r==="Moderate"?e.energyLevel=.5:e.energyLevel=.8,t.triage_score!==void 0&&(e.energyLevel=Math.max(.1,1-t.triage_score/5)),e}function Am(t){return t?{earIssue:t.ear_issue||t.earIssue||!1,digestionIssue:t.digestion_issue||t.digestionIssue||!1,skinIssue:t.skin_issue||t.skinIssue||!1,energyLevel:t.energy_level!==void 0?t.energy_level:t.energyLevel!==void 0?t.energyLevel:.8,fever:t.fever||!1}:{}}const L4=(t,e)=>{const n=[],s=t.risk_level||"moderate",r=e.triage_level||"yellow";({low:["green","yellow"],moderate:["yellow","orange"],high:["orange","red"],emergency:["red"]}[s]||["yellow"]).includes(r)||n.push({type:"risk_level_mismatch",severity:"high",medical_assessment:s,triage_assessment:r,description:`Medical Agent ${s} , Triage Engine ${r} .`});const l=e.triage_score||2;(s==="emergency"||s==="high")&&l<3&&n.push({type:"emergency_score_mismatch",severity:"critical",medical_assessment:s,triage_score:l,description:`Medical Agent   , Triage (${l}) .`});const d=t.need_hospital_visit||!1,h=l>=3||r==="red";return d!==h&&n.push({type:"hospital_visit_mismatch",severity:"medium",medical_recommendation:d,triage_recommendation:h,description:`     . Medical: ${d}, Triage: ${h}`}),{has_discrepancies:n.length>0,discrepancy_count:n.length,discrepancies:n,critical_count:n.filter(m=>m.severity==="critical").length,needs_review:n.some(m=>m.severity==="critical"||m.severity==="high")}},V4=async(t,e,n,s,r)=>{const o=xn(Vt.ANTHROPIC);if(!o)return console.warn("Claude API     ."),null;const a=`${ci}

 "Senior Veterinarian Reviewer (  )".

[]
- Medical Agent Triage Agent    .
-    ,       .
-       .
-      .

[]
-   :    
-    
-         `,l=`
 :
- : ${t.petName}
- : ${qt(t.species)}
- : ${t.breed||""}
- : ${t.age||""}
- : ${t.weight||""}

:
${e.symptomText}
${e.guardianResponsesSummary?`
     ( ) 
${e.guardianResponsesSummary}
`:""}

Information Agent :
${JSON.stringify(r,null,2)}

Medical Agent :
${JSON.stringify(n,null,2)}

Triage Engine :
${JSON.stringify(s,null,2)}

[ ]
      :

{
  "agreement_level": "full_agreement | partial_agreement | significant_disagreement",
  "primary_concern": "   ()",
  "medical_agent_assessment": "Medical Agent    (//)",
  "triage_agent_assessment": "Triage Agent    (//)",
  "recommended_risk_level": "low | moderate | high | emergency",
  "recommended_triage_score": 0-5,
  "recommended_hospital_visit": true/false,
  "reasoning": "  ( 3-4)",
  "additional_concerns": ["   "],
  "final_recommendation": "  ( 2-3)"
}`;try{const u=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":o,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:2048,temperature:.3,system:a,messages:[{role:"user",content:l}]})});if(!u.ok)throw new Error(`Claude API : ${u.status}`);const m=(await u.json()).content[0].text.match(/\{[\s\S]*\}/);if(m)return JSON.parse(m[0])}catch(u){console.error("  :",u)}return null},$4=async(t,e,n,s,r)=>{const o=xn(Vt.OPENAI);if(!o)return console.warn("OpenAI API   2  ."),null;const a=`${ci}

 "Second Opinion Specialist (2  )".

[]
-  AI     2 .
- Claude       .
-      .`,l=`
: ${t.petName} (${qt(t.species)}, ${t.breed||""})
: ${e.symptomText}
${e.guardianResponsesSummary?`
   : ${e.guardianResponsesSummary}
`:""}

1  (Medical Agent - Claude):
${JSON.stringify(n,null,2)}

  (Triage Engine - Claude):
${JSON.stringify(s,null,2)}

  (Senior Reviewer - Claude):
${r?JSON.stringify(r,null,2):""}

[2  ]
    :

{
  "agreement_with_diagnosis": true/false,
  "alternative_diagnosis": ["   "],
  "risk_assessment": "low | moderate | high | emergency",
  "key_observations": ["GPT-4o    "],
  "dissenting_opinion": " AI    ()",
  "confidence_level": " |  | ",
  "recommendation": "  ()"
}`;try{const u=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({model:"gpt-4o",messages:[{role:"system",content:a},{role:"user",content:l}],temperature:.3,max_tokens:1500})});if(!u.ok)throw new Error(`OpenAI API : ${u.status}`);const m=(await u.json()).choices[0].message.content.match(/\{[\s\S]*\}/);if(m)return JSON.parse(m[0])}catch(u){console.error("2  :",u)}return null},F4=(t,e,n,s,r)=>{var A,w;const o=[t.risk_level,e.triage_level,n==null?void 0:n.recommended_risk_level,s==null?void 0:s.risk_assessment].filter(Boolean),a=y=>({green:"low",yellow:"low",orange:"moderate",red:"high",emergency:"emergency",low:"low",moderate:"moderate",high:"high"})[y]||"moderate",l=o.map(a),d=["emergency","high","moderate","low"].find(y=>l.includes(y))||"moderate",h=[e.triage_score,n==null?void 0:n.recommended_triage_score].filter(y=>y!=null);let m=h.length>0?Math.round(h.reduce((y,E)=>y+E,0)/h.length):2;r.critical_count>0&&(m=Math.min(5,m+1));const p=[t.need_hospital_visit,m>=3,n==null?void 0:n.recommended_hospital_visit,(s==null?void 0:s.risk_assessment)==="high"||(s==null?void 0:s.risk_assessment)==="emergency"].filter(y=>y===!0||y===!1),x=p.filter(y=>y===!0).length>=p.length/2,v=r.has_discrepancies?.7:.95,j=(n==null?void 0:n.confidence_level)===""?.9:(n==null?void 0:n.confidence_level)===""?.75:.6;return{consensus_reached:!r.needs_review,final_risk_level:d,final_triage_score:m,final_hospital_visit:x,confidence_score:Math.min(v,j),voting_summary:{risk_votes:l,triage_scores:h,hospital_votes:p},collaborative_notes:{medical_diagnosis:t.primary_assessment_kor||((w=(A=t.possible_diseases)==null?void 0:A[0])==null?void 0:w.name_kor),reviewer_opinion:n==null?void 0:n.final_recommendation,second_opinion:s==null?void 0:s.recommendation,key_concerns:[...(n==null?void 0:n.additional_concerns)||[],...(s==null?void 0:s.key_observations)||[]]},discrepancy_resolution:r.has_discrepancies?`${r.discrepancy_count}   ,     .`:"    ."}},D4=async(t,e,n,s,r)=>{console.log("   ...");const o=L4(n,s);console.log(" :",o);const a=await V4(t,e,n,s,r);console.log(" :",a);let l=null;(o.needs_review||n.risk_level==="high"||n.risk_level==="emergency")&&(l=await $4(t,e,n,s,a),console.log("2 :",l));const u=F4(n,s,a,l,o);return console.log(" :",u),{discrepancy_analysis:o,review_result:a,second_opinion:l,consensus:u,collaboration_summary:`${o.has_discrepancies?" ":" "} : ${u.consensus_reached?"  ":"  "} (: ${(u.confidence_score*100).toFixed(0)}%)`}},U4=async(t,e,n,s=null)=>{var x,v,j,A;const r=[];let o=null,a=null,l=null,u=null,d=null,h=null;const m={...t,petName:t.petName||t.name||"",name:t.name||t.petName||"",species:t.species||"dog",breed:t.breed||"",age:t.age||"",weight:t.weight||null},p={...e,symptomText:(e==null?void 0:e.symptomText)||(e==null?void 0:e.description)||(e==null?void 0:e.userDescription)||"  ",selectedSymptoms:(e==null?void 0:e.selectedSymptoms)||[],department:(e==null?void 0:e.department)||"",images:(e==null?void 0:e.images)||[]};try{n({agent:"CS Agent",role:"   ",icon:"",type:"cs",content:", .   .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1500)),o=await oI(m,p),r.push({agent:"CS Agent",role:"   ",icon:"",type:"cs",content:o.message,timestamp:Date.now()}),n(r[r.length-1]),await new Promise(M=>setTimeout(M,2e3)),n({agent:"CS Agent",role:"   ",icon:"",type:"cs",content:"   .    .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1200)),n({agent:"Information Agent",role:"  ",icon:"",type:"info",content:",  .    .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1500)),a=await aI(m,p,o.json),r.push({agent:"Information Agent",role:"  ",icon:"",type:"info",content:a.message,timestamp:Date.now()}),n(r[r.length-1]),await new Promise(M=>setTimeout(M,2e3)),n({agent:"Information Agent",role:"  ",icon:"",type:"info",content:"       .    :",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1e3));const w=[{id:"symptom_start",question:"  ?",options:["","","2-3 "," "],type:"single"},{id:"appetite",question:" ?",options:[" "," ","  ","  "],type:"single"},{id:"activity",question:"   ?",options:[" "," "," ","  "],type:"single"},{id:"other_symptoms",question:"   ? (  )",options:["","","","","","",""],type:"multiple"}];let y={};if(s)n({agent:"Information Agent",role:"  ",icon:"",type:"info",content:"",isQuestionPhase:!0,questions:w,timestamp:Date.now()}),y=await s(w),n({agent:"Information Agent",role:"  ",icon:"",type:"info",content:"  .     .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,800));else{for(const M of w)n({agent:"Information Agent",role:"  ",icon:"",type:"info",content:M.question,isQuestion:!0,questionData:M,timestamp:Date.now()}),await new Promise(ie=>setTimeout(ie,800));await new Promise(M=>setTimeout(M,1200))}const E={...p,guardianResponses:y,guardianResponsesSummary:Object.entries(y).map(([M,ie])=>{const Ae=w.find(Q=>Q.id===M);return`${(Ae==null?void 0:Ae.question)||M}: ${Array.isArray(ie)?ie.join(", "):ie}`}).join(`
`)};n({agent:"Information Agent",role:"  ",icon:"",type:"info",content:"  .        .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1200)),n({agent:"Veterinarian Agent",role:" ",icon:"",type:"medical",content:",   .   .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1500));let R="";try{R=await A4(m,E),R&&console.log("AI   :",R.length,"")}catch(M){console.warn("AI    (  ):",M)}l=await C4(m,E,o.json,a.json,R),r.push({agent:"Veterinarian Agent",role:" ",icon:"",type:"medical",content:l.message,timestamp:Date.now()}),n(r[r.length-1]),await new Promise(M=>setTimeout(M,2e3)),n({agent:"Veterinarian Agent",role:" ",icon:"",type:"medical",content:" .    .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1200)),n({agent:"Triage Engine",role:" ",icon:"",type:"triage",content:",   .   .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1500));try{u=await O4(m,E,l.json,o.json),r.push({agent:"Triage Engine",role:" ",icon:"",type:"triage",content:`  .

 Triage Score: ${u.triage_score}/5
  : ${u.triage_level}
  : ${u.recommended_action_window}

${u.emergency_summary_kor}`,timestamp:Date.now()}),n(r[r.length-1])}catch(M){console.error("Triage  :",M)}await new Promise(M=>setTimeout(M,2e3)),n({agent:"Collaborative System",role:" ",icon:"",type:"collaboration",content:" AI     ...",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1e3));let $=null;try{$=await D4(m,p,l.json,u,a.json);const M=$.consensus.consensus_reached?"  AI    .":` ${$.discrepancy_analysis.discrepancy_count}    .`;r.push({agent:"Collaborative System",role:" ",icon:"",type:"collaboration",content:`${$.collaboration_summary}

${M}

  : ${$.consensus.final_risk_level}
 : ${($.consensus.confidence_score*100).toFixed(0)}%

${$.consensus.collaborative_notes.reviewer_opinion||""}`,timestamp:Date.now()}),n(r[r.length-1]),$.consensus&&(u.triage_score=$.consensus.final_triage_score,u.triage_level=$.consensus.final_risk_level==="low"?"yellow":$.consensus.final_risk_level==="moderate"?"orange":($.consensus.final_risk_level==="high","red"),l.json.risk_level=$.consensus.final_risk_level,l.json.need_hospital_visit=$.consensus.final_hospital_visit)}catch(M){console.error("  :",M),n({agent:"Collaborative System",role:" ",icon:"",type:"collaboration",content:"     .   .",timestamp:Date.now()})}await new Promise(M=>setTimeout(M,800)),n({agent:"Collaborative System",role:" ",icon:"",type:"collaboration",content:"  .     .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,600)),n({agent:"Data Agent",role:"  ",icon:"",type:"data",content:"   .     .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1500)),d=await P4(m,p,l.json,u,o.json,a.json),r.push({agent:"Data Agent",role:"  ",icon:"",type:"data",content:d.message,timestamp:Date.now()}),n(r[r.length-1]),await new Promise(M=>setTimeout(M,2e3)),n({agent:"Data Agent",role:"  ",icon:"",type:"data",content:`  
  .   .`,timestamp:Date.now()}),await new Promise(M=>setTimeout(M,1200)),h=await R4(m,d.json,l.json,u);const D=null;let _=h.message;r.push({agent:"Care Agent",role:"   ",icon:"",type:"care",content:_,medicationGuidance:D,timestamp:Date.now()}),n(r[r.length-1]),await new Promise(M=>setTimeout(M,2e3)),n({agent:"Care Agent",role:"   ",icon:"",type:"care",content:"  .",timestamp:Date.now()}),await new Promise(M=>setTimeout(M,800));const b=getRecommendedFAQs(l.json,E,m.species),S=formatFAQsForUI(b);let I=[];if(s&&b.length>0){n({agent:"FAQ Assistant",role:"   ",icon:"",type:"faq",content:"",isFAQPhase:!0,faqData:S,timestamp:Date.now()});const M=await s(S,"faq");if(M&&M.length>0&&!M.includes("skip")&&(I=generateMultipleFAQAnswers(M,b,l.json,m),I.length>0)){const ie=formatFAQAnswersMessage(I);n({agent:"FAQ Assistant",role:"   ",icon:"",type:"faq_answer",content:ie,faqAnswers:I,timestamp:Date.now()}),await new Promise(Ae=>setTimeout(Ae,1500))}}await new Promise(M=>setTimeout(M,800)),n({agent:"summary",role:"   ",icon:"",type:"summary",content:`  .    .

      !`,timestamp:Date.now()});const C=d.json.medical_log,P=d.json.owner_friendly_diagnosis_sheet,N=Am((u==null?void 0:u.health_flags)||C.health_flags||{}),O={id:Date.now().toString(),created_at:Date.now(),petId:m.id,petName:m.petName,diagnosis:((v=(x=C.possible_diseases)==null?void 0:x[0])==null?void 0:v.name_kor)||"  ",probability:((A=(j=C.possible_diseases)==null?void 0:j[0])==null?void 0:A.probability)||.6,riskLevel:C.risk_level||"moderate",emergency:C.risk_level==="emergency"||C.risk_level==="high"?"high":C.risk_level==="moderate"?"medium":"low",actions:P.immediate_home_actions||[],hospitalVisit:C.need_hospital_visit||!1,hospitalVisitTime:C.hospital_visit_timing||"  ",description:l.json.primary_assessment_kor||"  ",careGuide:h.fullGuide,conversationHistory:[],triage_score:C.triage_score||(u==null?void 0:u.triage_score)||2,triage_level:C.triage_level||(u==null?void 0:u.triage_level)||"yellow",healthFlags:N,ownerSheet:P,hospitalPacket:d.json.hospital_previsit_packet,carePlan:h.json,medicationGuidance:D,faqAnswers:I,recommendedFAQs:b,collaboration:$?{consensus_reached:$.consensus.consensus_reached,confidence_score:$.consensus.confidence_score,discrepancies_found:$.discrepancy_analysis.discrepancy_count,models_consulted:["Claude Sonnet (Medical Agent)","Claude Sonnet (Triage Engine)","Claude Sonnet (Senior Reviewer)",$.second_opinion?"GPT-4o (Second Opinion)":null].filter(Boolean),final_recommendation:$.consensus.collaborative_notes.reviewer_opinion,resolution_notes:$.consensus.discrepancy_resolution}:null};return{logs:r,finalDiagnosis:O}}catch(w){throw console.error("  :",w),w}},xt="/ai-factory/",by={dog:`${xt}icon/main-image/dog_main-removebg-preview.png`,cat:`${xt}icon/main-image/Cat_main-removebg-preview.png`,rabbit:`${xt}icon/main-image/rabbit_main-removebg-preview.png`,hamster:`${xt}icon/main-image/hamster_main-removebg-preview.png`,bird:`${xt}icon/main-image/bird_main-removebg-preview.png`,hedgehog:`${xt}icon/main-image/hedgehog_main-removebg-preview.png`,reptile:`${xt}icon/main-image/reptile_main-removebg-preview.png`,etc:`${xt}icon/main-image/etc_main-removebg-preview.png`,other:`${xt}icon/main-image/etc_main-removebg-preview.png`},Ny={dog:`${xt}icon/profile_background_less/dog-removebg-preview.png`,cat:`${xt}icon/profile_background_less/cat-removebg-preview.png`,rabbit:`${xt}icon/profile_background_less/rabbit-removebg-preview.png`,hamster:`${xt}icon/profile_background_less/hamster-removebg-preview.png`,bird:`${xt}icon/profile_background_less/bird-removebg-preview.png`,hedgehog:`${xt}icon/profile_background_less/hedgehog-removebg-preview.png`,reptile:`${xt}icon/profile_background_less/reptile-removebg-preview.png`,etc:`${xt}icon/profile_background_less/etc-removebg-preview.png`,other:`${xt}icon/profile_background_less/etc-removebg-preview.png`};function Vi(t="dog"){return by[t]||by.other}function jy(t="dog"){return Ny[t]||Ny.other}function mn(t,e=!1){if(!t)return e?Vi():jy();if(t.profileImage)return t.profileImage;const n=t.species||"dog";return e?Vi(n):jy(n)}const B4="petMedical_diagnoses",GN="petMedical_pets",QN="petMedical_bookings",JN=t=>`petMedical_pets_${t}`,z4=t=>`petMedical_diagnoses_${t}`,YN=t=>`petMedical_bookings_${t}`,H4=t=>{if(!t)return[];try{const e=localStorage.getItem(JN(t));return e?JSON.parse(e):[]}catch{return[]}},ky=(t,e)=>{if(t)try{localStorage.setItem(JN(t),JSON.stringify(e))}catch(n){console.error("Failed to save pets:",n)}},q4=t=>{if(!t)return[];try{const e=localStorage.getItem(z4(t));return e?JSON.parse(e):[]}catch{return[]}},W4=t=>{if(!t)return[];try{const e=localStorage.getItem(YN(t));return e?JSON.parse(e):[]}catch{return[]}},K4=(t,e)=>{if(t)try{localStorage.setItem(YN(t),JSON.stringify(e))}catch(n){console.error("Failed to save bookings:",n)}},G4=()=>{try{const t=localStorage.getItem(B4);return t?JSON.parse(t):[]}catch{return[]}},Q4=()=>{try{const t=localStorage.getItem(GN);return t?JSON.parse(t):[]}catch{return[]}},Iy=t=>{try{localStorage.setItem(GN,JSON.stringify(t))}catch(e){console.error("Failed to save pets:",e)}},J4=()=>{try{const t=localStorage.getItem(QN);return t?JSON.parse(t):[]}catch{return[]}},Y4=t=>{try{localStorage.setItem(QN,JSON.stringify(t))}catch(e){console.error("Failed to save bookings:",e)}};function Sy({onBack:t,onSelectPet:e,onViewDiagnosis:n,onAddPet:s,onClinicMode:r,onHome:o,userId:a}){const[l,u]=L.useState("pets"),[d,h]=L.useState([]),[m,p]=L.useState([]),[x,v]=L.useState([]),[j,A]=L.useState(null),[w,y]=L.useState(null);L.useEffect(()=>{a?(h(H4(a)),p(q4(a)),v(W4(a))):(h(Q4()),p(G4()),v(J4()))},[a]);const E=O=>new Date(O).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),R=O=>{switch(O){case"Emergency":case"high":return"#f44336";case"High":return"#ff9800";case"Moderate":case"medium":return"#ff9800";case"Low":case"low":return"#4caf50";default:return"#666"}},$=O=>{switch(O){case"Emergency":case"high":return" ";case"High":return" ";case"Moderate":case"medium":return" ";case"Low":case"low":return" ";default:return O}},D=O=>{A(O.id),y({...O})},_=()=>{if(!w)return;const O=d.map(M=>M.id===j?{...w}:M);h(O),a?ky(a,O):Iy(O),A(null),y(null)},b=()=>{A(null),y(null)},S=O=>{if(window.confirm(" ?")){const M=d.filter(ie=>ie.id!==O);h(M),a?ky(a,M):Iy(M)}},I=(O,M)=>{y(ie=>({...ie,[O]:M}))},C=O=>{switch(O){case"confirmed":return{label:" ",color:"bg-green-100 text-green-700",icon:"check_circle"};case"cancelled":return{label:" ",color:"bg-red-100 text-red-700",icon:"cancel"};case"completed":return{label:" ",color:"bg-slate-100 text-slate-700",icon:"task_alt"};default:return{label:" ",color:"bg-amber-100 text-amber-700",icon:"schedule"}}},P=O=>{if(window.confirm(" ?")){const M=x.map(ie=>ie.id===O?{...ie,status:"cancelled"}:ie);v(M),a?K4(a,M):Y4(M)}},N=O=>new Date(O).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"});return i.jsxs("div",{className:"min-h-screen bg-background-light",children:[i.jsxs("div",{className:"flex items-center bg-background-light/80 p-4 pb-2 justify-between sticky top-0 z-10 backdrop-blur-sm",children:[i.jsx("div",{className:"flex size-12 shrink-0 items-center text-slate-800",children:i.jsx("button",{onClick:t,className:"p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-full",children:i.jsx("span",{className:"material-symbols-outlined text-3xl",children:"arrow_back_ios_new"})})}),i.jsx("h2",{className:"text-slate-800 text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center font-display",children:""}),i.jsx("div",{className:"flex shrink-0 items-center justify-end gap-1",children:o&&i.jsx("button",{onClick:o,className:"p-2 text-slate-600 hover:bg-slate-100 rounded-full",title:"",children:i.jsx("span",{className:"material-symbols-outlined text-2xl",children:"home"})})})]}),i.jsxs("div",{className:"flex items-center gap-2 px-4 pt-2 pb-2 bg-background-light border-b border-slate-200 overflow-x-auto",children:[i.jsx("button",{onClick:()=>u("pets"),className:`flex-1 py-3 px-3 rounded-lg font-medium text-sm transition-colors whitespace-nowrap ${l==="pets"?"bg-primary text-white":"bg-surface-light text-slate-600"}`,children:" "}),i.jsxs("button",{onClick:()=>u("bookings"),className:`flex-1 py-3 px-3 rounded-lg font-medium text-sm transition-colors whitespace-nowrap relative ${l==="bookings"?"bg-primary text-white":"bg-surface-light text-slate-600"}`,children:[" ",x.filter(O=>O.status==="pending").length>0&&i.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:x.filter(O=>O.status==="pending").length})]}),i.jsx("button",{onClick:()=>u("records"),className:`flex-1 py-3 px-3 rounded-lg font-medium text-sm transition-colors whitespace-nowrap ${l==="records"?"bg-primary text-white":"bg-surface-light text-slate-600"}`,children:" "})]}),l==="pets"&&i.jsx("div",{className:"px-4 pt-4 pb-40",children:d.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("p",{className:"text-slate-500 mb-4",children:"  "}),i.jsx("button",{onClick:()=>s&&s(),className:"bg-primary text-white px-6 py-3 rounded-lg font-bold hover:bg-primary/90 transition-colors",children:" "})]}):i.jsxs("div",{className:"space-y-4",children:[d.map(O=>i.jsx("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft",children:j===O.id?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:" "}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-20 h-20 rounded-full bg-primary/20 flex items-center justify-center text-4xl overflow-hidden",children:w!=null&&w.profileImage?i.jsx("img",{src:w.profileImage,alt:"",className:"w-full h-full object-cover"}):(w==null?void 0:w.species)==="dog"?"":""}),i.jsxs("div",{className:"flex-1",children:[i.jsx("input",{type:"file",accept:"image/*",id:`profileImage-${O.id}`,className:"hidden",onChange:M=>{const ie=M.target.files[0];if(ie){if(ie.size>5*1024*1024){alert("  5MB  .");return}const Ae=new FileReader;Ae.onload=Q=>{I("profileImage",Q.target.result)},Ae.readAsDataURL(ie)}}}),i.jsxs("label",{htmlFor:`profileImage-${O.id}`,className:"inline-block px-4 py-2 bg-primary/10 text-primary rounded-lg font-medium cursor-pointer hover:bg-primary/20 transition-colors",children:[i.jsx("span",{className:"material-symbols-outlined text-sm align-middle mr-1",children:"photo_camera"})," "]}),(w==null?void 0:w.profileImage)&&i.jsx("button",{onClick:()=>I("profileImage",null),className:"ml-2 px-3 py-2 text-red-500 text-sm hover:bg-red-50 rounded-lg transition-colors",children:""})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),i.jsx("input",{type:"text",value:(w==null?void 0:w.petName)||"",onChange:M=>I("petName",M.target.value),className:"w-full p-2 rounded-lg border border-slate-300 bg-white text-slate-900 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),i.jsx("input",{type:"text",value:(w==null?void 0:w.breed)||"",onChange:M=>I("breed",M.target.value),className:"w-full p-2 rounded-lg border border-slate-300 bg-white text-slate-900 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),i.jsx("input",{type:"date",value:(w==null?void 0:w.birthDate)||"",onChange:M=>I("birthDate",M.target.value),className:"w-full p-2 rounded-lg border border-slate-300 bg-white text-slate-900 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:_,className:"flex-1 bg-primary text-white py-2 rounded-lg font-medium hover:bg-primary/90 transition-colors",children:""}),i.jsx("button",{onClick:b,className:"flex-1 bg-slate-200 text-slate-700 py-2 rounded-lg font-medium hover:bg-slate-300 transition-colors",children:""})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[i.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/20 overflow-hidden",children:i.jsx("img",{src:mn(O,!1),alt:O.petName,className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-slate-900 font-bold text-lg mb-1 font-display",children:O.petName}),i.jsxs("p",{className:"text-slate-500 text-sm",children:[O.breed||" ","  ",O.birthDate?(()=>{const M=new Date(O.birthDate);return`${new Date().getFullYear()-M.getFullYear()}`})():" "]}),O.sido&&i.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[O.sido," ",O.sigungu]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>e&&e(O),className:"flex-1 bg-primary text-white py-2 rounded-lg font-medium hover:bg-primary/90 transition-colors",children:""}),i.jsx("button",{onClick:()=>D(O),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg font-medium hover:bg-slate-300 transition-colors",children:i.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),i.jsx("button",{onClick:()=>S(O.id),className:"px-4 py-2 bg-red-100 text-red-600 rounded-lg font-medium hover:bg-red-200 transition-colors",children:i.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]})},O.id)),i.jsxs("button",{onClick:()=>s&&s(),className:"w-full bg-primary/10 text-primary py-4 rounded-lg font-bold hover:bg-primary/20 transition-colors flex items-center justify-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined",children:"add"})," "]})]})}),l==="bookings"&&i.jsx("div",{className:"px-4 pt-4 pb-40",children:x.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("p",{className:"text-slate-500 mb-2",children:"  "}),i.jsx("p",{className:"text-slate-400 text-sm",children:"      "})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[i.jsxs("div",{className:"bg-amber-50 rounded-lg p-3 text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-amber-600",children:x.filter(O=>O.status==="pending").length}),i.jsx("p",{className:"text-xs text-amber-700",children:""})]}),i.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-green-600",children:x.filter(O=>O.status==="confirmed").length}),i.jsx("p",{className:"text-xs text-green-700",children:""})]}),i.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-slate-600",children:x.filter(O=>O.status==="completed").length}),i.jsx("p",{className:"text-xs text-slate-700",children:""})]})]}),x.sort((O,M)=>new Date(M.createdAt)-new Date(O.createdAt)).map(O=>{var ie,Ae,Q,V;const M=C(O.status);return i.jsxs("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-primary",children:"local_hospital"}),i.jsx("h3",{className:"text-slate-900 font-bold font-display",children:((ie=O.hospital)==null?void 0:ie.name)||""})]}),i.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${M.color}`,children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:M.icon}),M.label]})]}),i.jsxs("div",{className:"space-y-2 mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[i.jsx("span",{className:"material-symbols-outlined text-sm text-slate-400",children:"calendar_today"}),i.jsx("span",{children:N(O.date)}),i.jsx("span",{className:"text-slate-400",children:"|"}),i.jsx("span",{className:"material-symbols-outlined text-sm text-slate-400",children:"schedule"}),i.jsx("span",{children:O.time})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[i.jsx("span",{className:"material-symbols-outlined text-sm text-slate-400",children:"pets"}),i.jsx("span",{children:O.petName||""})]}),((Ae=O.hospital)==null?void 0:Ae.address)&&i.jsxs("div",{className:"flex items-start gap-2 text-sm text-slate-500",children:[i.jsx("span",{className:"material-symbols-outlined text-sm text-slate-400",children:"location_on"}),i.jsx("span",{children:O.hospital.address})]})]}),O.message&&i.jsxs("div",{className:"bg-slate-50 rounded-lg p-2 mb-3 text-sm text-slate-600",children:[" ",O.message]}),O.status==="pending"&&i.jsxs("div",{className:"flex gap-2",children:[((Q=O.hospital)==null?void 0:Q.phone)&&i.jsx("a",{href:`tel:${O.hospital.phone}`,className:"flex-1 py-2 text-center border border-slate-200 rounded-lg text-sm font-medium text-slate-600 hover:bg-slate-50 transition-colors",children:" "}),i.jsx("button",{onClick:()=>P(O.id),className:"flex-1 py-2 text-center bg-red-50 text-red-600 rounded-lg text-sm font-medium hover:bg-red-100 transition-colors",children:" "})]}),O.status==="confirmed"&&((V=O.hospital)==null?void 0:V.phone)&&i.jsx("a",{href:`tel:${O.hospital.phone}`,className:"block w-full py-2 text-center bg-primary text-white rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors",children:"  "})]},O.id)})]})}),l==="records"&&i.jsx("div",{className:"px-4 pt-4 pb-40",children:m.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("p",{className:"text-slate-500 mb-2",children:"   "}),i.jsx("p",{className:"text-slate-400 text-sm",children:"AI    "})]}):i.jsx("div",{className:"space-y-4",children:m.map(O=>{var M,ie;return i.jsxs("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft cursor-pointer hover:shadow-md transition-all",onClick:()=>n&&n(O),children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-slate-500 text-sm mb-1",children:E(O.created_at||O.date)}),i.jsx("h3",{className:"text-slate-900 font-bold text-base mb-1 font-display",children:O.petName||""})]}),i.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-bold text-white",style:{backgroundColor:R(O.riskLevel||O.emergency)},children:$(O.riskLevel||O.emergency)})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("strong",{className:"text-slate-700",children:":"})," ",i.jsx("span",{className:"text-slate-600",children:O.diagnosis||((ie=(M=O.suspectedConditions)==null?void 0:M[0])==null?void 0:ie.name)||"  "})]}),O.symptom&&i.jsxs("div",{className:"mb-3",children:[i.jsx("strong",{className:"text-slate-700",children:":"})," ",i.jsx("span",{className:"text-slate-600",children:O.symptom})]}),i.jsxs("button",{onClick:Ae=>{Ae.stopPropagation(),n&&n(O)},className:"text-primary text-sm font-medium flex items-center gap-1",children:[" ",i.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_forward_ios"})]})]},O.id)})})})]})}function X4({variant:t="default"}){return i.jsxs("div",{className:`floating-background ${t}`,children:[i.jsx("div",{className:"bg-shape shape-1"}),i.jsx("div",{className:"bg-shape shape-2"}),i.jsx("div",{className:"bg-shape shape-3"}),i.jsx("div",{className:"bg-shape shape-4"}),i.jsx("div",{className:"bg-shape shape-5"}),i.jsxs("div",{className:"paw-particles",children:[i.jsx("span",{className:"paw-particle",children:""}),i.jsx("span",{className:"paw-particle",children:""}),i.jsx("span",{className:"paw-particle",children:""}),i.jsx("span",{className:"paw-particle",children:""}),i.jsx("span",{className:"paw-particle",children:""})]})]})}const Z4="petMedical_dailyLogs",e5=t=>{try{return JSON.parse(localStorage.getItem(Z4)||"{}")[t]||[]}catch{return[]}};function t5(t,e){const n=`carelog_${t}`,s=JSON.parse(localStorage.getItem(n)||"{}");s[e.date]=e,localStorage.setItem(n,JSON.stringify(s))}function n5(t){const e=`carelog_${t}`;return JSON.parse(localStorage.getItem(e)||"{}")}function XN(t,e=7){const n=n5(t);return Object.keys(n).sort().slice(-e).map(o=>n[o]).filter(o=>o&&o.date)}const s5=async(t,e)=>{const n=xn(Vt.GEMINI);if(!n)throw new Error("Gemini API   .  > API   .");const s=e.slice(-7);if(s.length<3)return{patterns:[],predictions:[],health_flags:{energy_level:.8,ear_issue:!1,digestion_issue:!1,skin_issue:!1},recommendations:["   ."]};const r=`     .

 :
- : ${t.petName}
- : ${qt(t.species)}
- : ${t.breed||""}

 7  :
${JSON.stringify(s,null,2)}

 JSON    :
{
  "patterns": [
    "  1",
    "  2"
  ],
  "predictions": [
    "   1",
    "   2"
  ],
  "health_flags": {
    "energy_level": 0.0-1.0,
    "ear_issue": true/false,
    "digestion_issue": true/false,
    "skin_issue": true/false
  },
  "recommendations": [
    "  1",
    "  2"
  ]
}

 .`;try{const o=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:r}]}]})});if(!o.ok)throw new Error(`Gemini API : ${o.status}`);const u=(await o.json()).candidates[0].content.parts[0].text.match(/\{[\s\S]*\}/);if(u)return JSON.parse(u[0]);throw new Error("JSON  ")}catch(o){console.error("  :",o);const a=s.reduce((m,p)=>m+(p.food_count||0),0)/s.length,l=s.reduce((m,p)=>m+(p.activity_level||5),0)/s.length,u=[],d=[],h={energy_level:Math.min(1,l/10),ear_issue:!1,digestion_issue:a<2,skin_issue:!1};return a<2&&(u.push("    ."),d.push("    .")),l<5&&(u.push("  ."),d.push("  .")),{patterns:u,predictions:d,health_flags:h,recommendations:["   ."]}}},Cm=async(t,e,n,s="")=>{var a,l,u,d,h;if(e.hospitalPacket){const m=e.hospitalPacket,p=m.requested_actions_for_hospital||[],x=s?s.trim():"";return{packet_text:`
=== ${m.packet_title} ===

[ ]
: ${m.pet_profile_brief.name}
/: ${qt(m.pet_profile_brief.species)} / ${m.pet_profile_brief.breed}
${m.pet_profile_brief.age_info?`: ${m.pet_profile_brief.age_info}`:""}
${m.pet_profile_brief.sex_neutered?`: ${m.pet_profile_brief.sex_neutered}`:""}

[ ]
${m.for_vet_summary}

[ ]
${m.visit_reason}

[ ]
${m.symptom_timeline}

[AI  ]
${m.ai_differential_diagnosis.map((j,A)=>`${A+1}. ${j.name_kor} (: ${Math.round(j.probability*100)}%)
   ${j.note_for_vet||""}`).join(`

`)}

[ ]
Triage Score: ${m.triage_and_risk.triage_score}/5
: ${m.triage_and_risk.triage_level}
: ${m.triage_and_risk.risk_level}
: ${m.triage_and_risk.urgency_comment}

[AI  /]
${p.length>0?p.map(j=>`- ${j}`).join(`
`):"-    "}

[ ]
${x||"- "}
    `.trim(),packet_json:{...m,owner_request_note:x}}}const r=xn(Vt.GEMINI);if(!r)throw new Error("Gemini API   .  > API   .");s&&s.trim();const o=`       .

           .

 :
- : ${t.petName}
- : ${qt(t.species)}
- : ${t.breed||""}
- : ${t.age||""}
${t.weight?`- : ${t.weight}kg`:""}

:
${(n==null?void 0:n.symptomText)||"  "}
${((a=n==null?void 0:n.images)==null?void 0:a.length)>0?`
 ${n.images.length} `:""}

AI  :
${JSON.stringify(e,null,2)}

     :

=== AI    ===

[ ]
: ${t.petName}
/: ${qt(t.species)} / ${t.breed||""}
/: ${t.age||""} / ${t.weight||""}kg

[ ]
${(n==null?void 0:n.symptomText)||"  "}

[AI   Top 3]
1. ${e.diagnosis||"  "} (: ${e.probability||60}%)
2. [  ]
3. [  ]

[ ]
${e.riskLevel||"Moderate"} - ${e.emergency||"medium"}

[  ]
- [ 1]
- [ 2]

[/]
${((l=n==null?void 0:n.images)==null?void 0:l.length)>0?`  ${n.images.length} `:""}

[  ]
${((u=e.conversationHistory)==null?void 0:u.length)>0?e.conversationHistory.join(`
`):""}

[  ]
${((d=e.actions)==null?void 0:d.map(m=>`- ${m}`).join(`
`))||"-   "}

   .`;try{const m=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":r,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:"claude-3-5-sonnet-20241022",max_tokens:2e3,messages:[{role:"user",content:o}]})});if(!m.ok)throw new Error(`Anthropic API : ${m.status}`);return{packet_text:(await m.json()).content[0].text,packet_json:{pet_name:t.petName,species:t.species,breed:t.breed,diagnosis:e.diagnosis,risk_level:e.riskLevel,symptoms:n==null?void 0:n.symptomText,images_count:((h=n==null?void 0:n.images)==null?void 0:h.length)||0,created_at:new Date().toISOString()}}}catch(m){return console.error("   :",m),{packet_text:`=== AI    ===

: ${t.petName}
: ${(n==null?void 0:n.symptomText)||"  "}
: ${e.diagnosis||"  "}
: ${e.riskLevel||"Moderate"}`,packet_json:{pet_name:t.petName,diagnosis:e.diagnosis,risk_level:e.riskLevel}}}};let Ul=!1,Bl=null;function nd(){return Ul?Promise.resolve(window.kakao):Bl||(Bl=new Promise((t,e)=>{if(window.kakao&&window.kakao.maps){Ul=!0,t(window.kakao);return}const n=setInterval(()=>{window.kakao&&window.kakao.maps&&(clearInterval(n),Ul=!0,t(window.kakao))},100);setTimeout(()=>{clearInterval(n),Ul||e(new Error("Kakao Maps SDK  "))},1e4)}),Bl)}function Ey(){return new Promise(t=>{if(!navigator.geolocation){t({lat:37.4979,lng:127.0276,isReal:!1,error:"     ."});return}navigator.geolocation.getCurrentPosition(e=>{console.log("   :",e.coords.latitude,e.coords.longitude),t({lat:e.coords.latitude,lng:e.coords.longitude,isReal:!0})},e=>{let n="   .";switch(e.code){case e.PERMISSION_DENIED:n="  .     .";break;case e.POSITION_UNAVAILABLE:n="    .";break;case e.TIMEOUT:n="   .";break}console.warn("  :",n),t({lat:37.4979,lng:127.0276,isReal:!1,error:n})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})})}async function lh(t,e,n=5e3){console.log("[KakaoMap]   :",{lat:t,lng:e,radius:n});try{const s=await nd();return console.log("[KakaoMap] SDK  "),new Promise((r,o)=>{const a=new s.maps.services.Places,l=function(d,h){if(console.log("[KakaoMap]  :",{status:h,resultCount:d==null?void 0:d.length}),h===s.maps.services.Status.OK){const m=d.map(p=>({id:p.id,name:p.place_name,address:p.address_name,roadAddress:p.road_address_name,phone:p.phone,distance:parseInt(p.distance),lat:parseFloat(p.y),lng:parseFloat(p.x),category:p.category_name,url:p.place_url,is24Hours:p.place_name.includes("24")||p.place_name.includes("")})).sort((p,x)=>p.distance-x.distance);console.log("[KakaoMap]  :",m.length,"  "),r(m)}else h===s.maps.services.Status.ZERO_RESULT?(console.log("[KakaoMap]   "),r([])):(console.error("[KakaoMap]  :",h),o(new Error("   : "+h)))},u={location:new s.maps.LatLng(t,e),radius:n,sort:s.maps.services.SortBy.DISTANCE};console.log("[KakaoMap] keywordSearch "),a.keywordSearch("",l,u)})}catch(s){return console.error("[KakaoMap]   :",s),console.log("[KakaoMap] Mock  "),r5(t,e)}}function r5(t,e){return[{name:"24 SNC ",address:"   823-33",roadAddress:"   152",phone:"02-555-7582",baseLat:37.5012,baseLng:127.0396,is24Hours:!0},{name:"",address:"   118-17",roadAddress:"   317",phone:"02-511-7522",baseLat:37.5245,baseLng:127.0472,is24Hours:!1},{name:"",address:"   1303-22",roadAddress:"   254",phone:"02-525-6645",baseLat:37.4916,baseLng:127.0076,is24Hours:!0},{name:" ",address:"   184-21",roadAddress:"   135",phone:"02-421-7588",baseLat:37.5133,baseLng:127.1001,is24Hours:!1},{name:"VIP",address:"   827-2",roadAddress:"   385",phone:"02-2691-7500",baseLat:37.5509,baseLng:126.8495,is24Hours:!0},{name:"",address:"   546-4",roadAddress:"   478",phone:"02-447-7975",baseLat:37.5432,baseLng:127.0857,is24Hours:!1}].map((s,r)=>{const o=Math.round(Math.sqrt(Math.pow((s.baseLat-t)*111e3,2)+Math.pow((s.baseLng-e)*88e3,2)));return{id:`real_${r}`,name:s.name,address:s.address,roadAddress:s.roadAddress,phone:s.phone,distance:o,lat:s.baseLat,lng:s.baseLng,category:" > ",url:`https://map.kakao.com/link/search/${encodeURIComponent(s.name)}`,is24Hours:s.is24Hours,rating:(4+Math.random()*.9).toFixed(1),reviewCount:Math.floor(80+Math.random()*300),homepage:null,businessHours:s.is24Hours?"24 ":"09:00 - 21:00"}}).sort((s,r)=>s.distance-r.distance)}async function i5(t,e,n){const s=await nd(),r=document.getElementById(t);if(!r)throw new Error("    .");const o={center:new s.maps.LatLng(e,n),level:5};return new s.maps.Map(r,o)}async function o5(t,e,n,s,r=!1){const o=await nd(),a=r?"https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_red.png":"https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker.png",l=new o.maps.Size(24,35),u={offset:new o.maps.Point(12,35)},d=new o.maps.MarkerImage(a,l,u),h=new o.maps.LatLng(e,n),m=new o.maps.Marker({position:h,image:d,title:s});m.setMap(t);const p=new o.maps.InfoWindow({content:`<div style="padding:5px;font-size:12px;">${s}</div>`});return o.maps.event.addListener(m,"click",function(){p.open(t,m)}),m}function a5(t,e,n,s){const o=h=>h*Math.PI/180,a=o(n-t),l=o(s-e),u=Math.sin(a/2)**2+Math.cos(o(t))*Math.cos(o(n))*Math.sin(l/2)**2;return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}async function ch(t,e,n=5){try{console.log("[Firestore]    :",{userLat:t,userLng:e,radiusKm:n});const s=n/111,r=Te(ge(re,"animal_hospitals"),me("location.lat",">=",t-s),me("location.lat","<=",t+s),Wn(500)),o=await Re(r);console.log("[Firestore]  :",o.size,"");const a=[];return o.forEach(l=>{const u=l.data();if(!u.location||u.location.lat==null||u.location.lng==null)return;const d=a5(t,e,u.location.lat,u.location.lng);if(d<=n){const h=u.name||u.||" ";a.push({id:l.id,name:h,phone:u.phone||u.||null,address:u.address_jibun||u.||null,roadAddress:u.address_road||u.||null,lat:u.location.lat,lng:u.location.lng,distance:Math.round(d*1e3),distanceKm:Number(d.toFixed(2)),category:"",url:`https://map.kakao.com/link/search/${encodeURIComponent(h)}`,businessStatus:u.||"",is24Hours:h.includes("24")||h.includes("24")||h.includes("")})}}),a.sort((l,u)=>(l.distance||0)-(u.distance||0)),console.log("[Firestore]   :",a.length,""),a}catch(s){throw console.error("[Firestore]   :",s),s}}async function l5(t,e=50){try{console.log("[Firestore]  :",t);const n=Te(ge(re,"animal_hospitals"),Wn(2e3)),s=await Re(n);console.log("[Firestore]  :",s.size,"");const r=[],o=t.toLowerCase().trim();return s.forEach(a=>{var m,p;const l=a.data(),u=(l.address_jibun||l.||"").toLowerCase(),d=(l.address_road||l.||"").toLowerCase(),h=(l.name||l.||"").toLowerCase();if(u.includes(o)||d.includes(o)||h.includes(o)){const x=l.name||l.||" ";r.push({id:a.id,name:x,phone:l.phone||l.||null,address:l.address_jibun||l.||null,roadAddress:l.address_road||l.||null,lat:((m=l.location)==null?void 0:m.lat)||null,lng:((p=l.location)==null?void 0:p.lng)||null,distance:null,category:"",url:`https://map.kakao.com/link/search/${encodeURIComponent(x)}`,businessStatus:l.||"",is24Hours:x.includes("24")||x.includes("24")||x.includes("")})}}),console.log("[Firestore]   :",r.length,""),r.slice(0,e)}catch(n){throw console.error("[Firestore]   :",n),n}}const bt={USERS:"users",PETS:"pets",DIAGNOSES:"diagnoses",BOOKINGS:"bookings",CLINIC_RESULTS:"clinicResults",DAILY_LOGS:"dailyLogs",RECORDS:"records"},wn={async saveUser(t,e){var n;try{return await Z2(ct(re,bt.USERS,t),{...e,updatedAt:hn()},{merge:!0}),{success:!0}}catch(s){return s.code==="permission-denied"||(n=s.message)!=null&&n.includes("Missing or insufficient permissions")?(console.warn("     (Firestore    ):",s.message),{success:!0,warning:"    ( )"}):(console.error("  :",s),{success:!1,error:s})}},async getUser(t){var e;try{const n=await En(ct(re,bt.USERS,t));return n.exists()?{success:!0,data:{id:n.id,...n.data()}}:{success:!1,data:null}}catch(n){return n.code==="permission-denied"||(e=n.message)!=null&&e.includes("Missing or insufficient permissions")?(console.warn("     (Firestore    ):",n.message),{success:!1,data:null,warning:"    ( )"}):(console.error("  :",n),{success:!1,error:n})}},async findUserByEmail(t){try{const e=Te(ge(re,bt.USERS),me("email","==",t)),n=await Re(e);if(!n.empty){const s=n.docs[0];return{success:!0,data:{id:s.id,...s.data()}}}return{success:!1,data:null}}catch(e){return console.error("  :",e),{success:!1,error:e}}}},c5={async addPet(t,e){try{return{success:!0,id:(await en(ge(re,bt.PETS),{...e,userId:t,createdAt:hn(),updatedAt:hn()})).id}}catch(n){return console.error("  :",n),{success:!1,error:n}}},async getPetsByUser(t){try{const e=Te(ge(re,bt.PETS),me("userId","==",t),Wt("createdAt","desc"));return{success:!0,data:(await Re(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return console.error("   :",e),{success:!1,error:e,data:[]}}},async updatePet(t,e){try{return await nl(ct(re,bt.PETS,t),{...e,updatedAt:hn()}),{success:!0}}catch(n){return console.error("  :",n),{success:!1,error:n}}},async deletePet(t){try{return await eA(ct(re,bt.PETS,t)),{success:!0}}catch(e){return console.error("  :",e),{success:!1,error:e}}}},u5={async saveDiagnosis(t){try{return{success:!0,id:(await en(ge(re,bt.DIAGNOSES),{...t,createdAt:hn()})).id}}catch(e){return console.error("  :",e),{success:!1,error:e}}},async getDiagnosesByPet(t){try{const e=Te(ge(re,bt.DIAGNOSES),me("petId","==",t),Wt("createdAt","desc"));return{success:!0,data:(await Re(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return console.error("   :",e),{success:!1,error:e,data:[]}}},async getDiagnosesByUser(t){try{const e=Te(ge(re,bt.DIAGNOSES),me("userId","==",t),Wt("createdAt","desc"));return{success:!0,data:(await Re(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return console.error("   :",e),{success:!1,error:e,data:[]}}},async getLatestDiagnosis(t){try{const e=Te(ge(re,bt.DIAGNOSES),me("petId","==",t),Wt("createdAt","desc"),Wn(1)),n=await Re(e);if(!n.empty){const s=n.docs[0];return{success:!0,data:{id:s.id,...s.data()}}}return{success:!0,data:null}}catch(e){return console.error("   :",e),{success:!1,error:e}}}},d5={async createBooking(t){try{const e={...t,status:t.status||"pending",createdAt:hn(),updatedAt:hn(),createdAtISO:new Date().toISOString(),updatedAtISO:new Date().toISOString()};console.log("[ ] Firestore  :",{clinicId:e.clinicId,clinicName:e.clinicName,date:e.date,time:e.time});const n=await en(ge(re,bt.BOOKINGS),e);return console.log("[ ]  Firestore  :",n.id),{success:!0,id:n.id}}catch(e){return console.error("[ ]  Firestore  :",e),console.error("[ ]  :",{message:e.message,code:e.code,bookingData:{clinicId:t.clinicId,clinicName:t.clinicName,date:t.date}}),{success:!1,error:e.message||e}}},async updateBookingStatus(t,e){try{return await nl(ct(re,bt.BOOKINGS,t),{status:e,updatedAt:hn()}),{success:!0}}catch(n){return console.error("   :",n),{success:!1,error:n}}},async getBookingsByUser(t){try{const e=Te(ge(re,bt.BOOKINGS),me("userId","==",t),Wt("createdAt","desc"));return{success:!0,data:(await Re(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return console.error("   :",e),{success:!1,error:e,data:[]}}},async getBookingsByClinic(t){try{const e=Te(ge(re,bt.BOOKINGS),me("clinicId","==",t),Wt("date","asc"));return{success:!0,data:(await Re(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return console.error("   :",e),{success:!1,error:e,data:[]}}},async getTodayBookings(t){const e=new Date().toISOString().split("T")[0];try{const n=Te(ge(re,bt.BOOKINGS),me("clinicId","==",t),me("date","==",e));return{success:!0,data:(await Re(n)).docs.map(o=>({id:o.id,...o.data()}))}}catch(n){return console.error("   :",n),{success:!1,error:n,data:[]}}},subscribeToBookings(t,e){const n=Te(ge(re,bt.BOOKINGS),me("clinicId","==",t),Wt("date","asc"));return km(n,s=>{const r=s.docs.map(o=>({id:o.id,...o.data()}));e(r)})}},h5="BKEaMLnqCvGpIMgn0Qi8eWq3WgzyHtu-pVVcHkBOJLSLYK3WcZ7lZJI8p7Gja0lHM5MPEL8f9CVJEFcJW02SAXM";async function m5(t){var e,n,s;if(!Ua)return console.warn("Firebase Messaging  ."),null;try{if(!("serviceWorker"in navigator))return console.warn("Service Worker   ."),null;if(await Notification.requestPermission()!=="granted")return console.warn("   ."),null;const o=await b4(Ua,{vapidKey:h5});if(o){try{await nl(ct(re,"users",t),{fcmToken:o,fcmTokenUpdatedAt:new Date().toISOString()}),console.log("    :",o)}catch(a){a.code==="permission-denied"||(e=a.message)!=null&&e.includes("Missing or insufficient permissions")?console.warn("       (Firestore    ):",a.message):console.warn("    :",a)}return o}return null}catch(r){return r.code==="messaging/failed-service-worker-registration"||(n=r.message)!=null&&n.includes("ServiceWorker")||(s=r.message)!=null&&s.includes("404")?(console.warn("     (Service Worker ).   ."),null):(console.error("    :",r),null)}}async function f5(t,e,n,s={}){try{const r=Te(ge(re,"clinicStaff"),me("clinicId","==",t),me("isActive","==",!0)),o=await Re(r),a=[];for(const u of o.docs){const d=u.data(),h=await En(ct(re,"users",d.userId));if(h.exists()){const m=h.data();m.fcmToken&&a.push(m.fcmToken)}}if(a.length===0)return console.warn("    ."),{success:!1,message:"    ."};const l={type:"clinic_notification",clinicId:t,title:e,body:n,data:s,tokens:a,createdAt:new Date().toISOString(),sent:!1};return await en(ge(re,"notificationQueue"),l),console.log(`   : ${a.length}  `),{success:!0,tokensCount:a.length}}catch(r){return console.error("     :",r),{success:!1,error:r.message}}}function p5(t){return Ua?N4(Ua,e=>{console.log("  :",e),t&&t(e)}):null}const g5=async()=>{try{const t=ge(re,"clinics");try{const s=Te(t,me("name","=="," "),Wn(1)),r=await Re(s);if(!r.empty){const o=r.docs[0];return console.log("[]  clinicId:",o.id,o.data().name),o.id}}catch(s){console.warn("[fetchHappyVetClinicId] exact match :",s)}try{const s=Te(t,me("name","==",""),Wn(1)),r=await Re(s);if(!r.empty){const o=r.docs[0];return console.log("[]   clinicId:",o.id,o.data().name),o.id}}catch(s){console.warn("[fetchHappyVetClinicId] alt match :",s)}const e=await Re(t);let n=null;for(const s of e.docs){const r=s.data().name||"";if(r.includes(" "))return console.log("[]   -   :",s.id,r),s.id}for(const s of e.docs){const r=(s.data().name||"").toLowerCase();if(r.includes("")||r.includes("happy"))return console.log("[]   - /happy :",s.id,s.data().name),s.id}if(e.docs.length>0){const s=e.docs[0];return console.log("[] fallback  :",s.id,s.data().name),s.id}}catch(t){console.error("[fetchHappyVetClinicId] :",t)}return"happyvet_test_clinic"},ZN=t=>({id:t,name:" []  ",address:"   123",roadAddress:"   123",phone:"02-1234-5678",distance:0,lat:37.5012,lng:127.0396,category:"",is24Hours:!0,rating:"5.0",reviewCount:999,businessHours:"24  ()",isTestHospital:!0});let On=ZN("happyvet_test_clinic");const Ty=t=>{if(!t)return"";const e=new Date(t);return`${new Date().getFullYear()-e.getFullYear()}`},x5=async t=>{if(!t)return null;const e=new Date().toISOString().split("T")[0],n=`${t}_${e}`;try{const s=ct(re,"dailyLogs",n),r=await En(s);if(!r.exists())return null;const o=r.data(),a=o==null?void 0:o.weight;return typeof a=="number"?a:null}catch(s){return console.warn("[] dailyLogs   :",s),null}},Pm=t=>{if(Array.isArray(t))return t.map(e=>Pm(e));if(t&&typeof t=="object"){const e={};return Object.entries(t).forEach(([n,s])=>{s===void 0?e[n]=null:e[n]=Pm(s)}),e}return t};function Ay({petData:t,diagnosis:e,symptomData:n,onBack:s,onSelectHospital:r,onHome:o,currentUser:a}){const[l,u]=L.useState(null),[d,h]=L.useState(!0),[m,p]=L.useState(null),[x,v]=L.useState([]),[j,A]=L.useState(!0),[w,y]=L.useState(null),[E,R]=L.useState(!1),[$,D]=L.useState(null),[_,b]=L.useState({}),[S,I]=L.useState({}),[C,P]=L.useState("firestore"),[N,O]=L.useState("nearby"),[M,ie]=L.useState(!1),Ae=L.useRef(null),Q=L.useRef(null),[V,Y]=L.useState(!1),[T,B]=L.useState(null),[G,K]=L.useState(""),[te,le]=L.useState(""),[W,ne]=L.useState(""),[oe,xe]=L.useState(!1),[ce,de]=L.useState(On);L.useEffect(()=>{let z=!0;return(async()=>{window.scrollTo(0,0);try{try{const ue=await g5();if(z&&ue){const ke=ZN(ue);de(ke),On=ke,console.log("[]   ID :",ue)}}catch(ue){console.error("[] clinicId  :",ue)}if(e&&t&&!l)try{const ue=await Cm(t,e,n);z&&u(ue)}catch(ue){console.error("  :",ue)}z&&h(!1);try{const ue=await Ey();z&&(y(ue),R(ue.isReal),ue.error&&D(ue.error));try{console.log("[HospitalBooking]    ");const ke=await lh(ue.lat,ue.lng);if(z&&ke.length>0){console.log("[HospitalBooking]   :",ke.length,""),v([On,...ke]),P("kakao"),A(!1);return}}catch(ke){console.warn("[HospitalBooking]   , Firestore fallback:",ke)}try{console.log("[HospitalBooking] Firestore()   ");const ke=await ch(ue.lat,ue.lng,5);if(z&&ke.length>0){console.log("[HospitalBooking] Firestore  :",ke.length,""),v([On,...ke]),P("firestore"),A(!1);return}}catch(ke){console.warn("[HospitalBooking] Firestore  :",ke)}z&&(v([On]),P("kakao"),A(!1))}catch(ue){if(console.error("/  :",ue),z){y({lat:37.4979,lng:127.0276});try{const be=await lh(37.4979,127.0276);if(be.length>0){v([On,...be]),P("kakao"),A(!1);return}}catch(be){console.warn("[HospitalBooking]  fallback :",be)}try{const be=await ch(37.4979,127.0276,5);if(be.length>0){v([On,...be]),P("firestore"),A(!1);return}}catch(be){console.warn("[HospitalBooking] Firestore fallback :",be)}v([On,...[{id:"h1",name:"24 SNC ",address:"   823-33",roadAddress:"   152",phone:"02-555-7582",distance:850,lat:37.5012,lng:127.0396,category:"",is24Hours:!0,rating:"4.7",reviewCount:248,businessHours:"24 "},{id:"h2",name:"",address:"   1303-22",roadAddress:"   254",phone:"02-525-6645",distance:1200,lat:37.4916,lng:127.0076,category:"",is24Hours:!0,rating:"4.8",reviewCount:312,businessHours:"24 "}]]),A(!1)}}}catch(ue){console.error(" :",ue),z&&(h(!1),A(!1))}})(),()=>{z=!1}},[t,e,n]),L.useEffect(()=>{if(!w||!Q.current||x.length===0)return;(async()=>{try{const _e="kakao-map-container";let ue=document.getElementById(_e);if(Q.current.innerHTML==="")ue=document.createElement("div"),ue.id=_e,ue.style.width="100%",ue.style.height="300px",ue.style.borderRadius="12px",Q.current.appendChild(ue);else return;const ke=await i5(_e,w.lat,w.lng);Ae.current=ke;const At=await nd(),Ve=new At.maps.LatLng(w.lat,w.lng);new At.maps.Circle({center:Ve,radius:50,strokeWeight:2,strokeColor:"#4C6FFF",strokeOpacity:.7,fillColor:"#4C6FFF",fillOpacity:.2}).setMap(ke);for(const tt of x)await o5(ke,tt.lat,tt.lng,tt.name,tt.is24Hours);if(x.length>0){const tt=x[0],Qn=new At.maps.LatLng(tt.lat,tt.lng);ke.panTo(Qn)}}catch(_e){console.error("  :",_e)}})()},[w,x]);const he=z=>{B(z),Y(!0);const _e=new Date().toISOString().split("T")[0];if(K(_e),le(""),e){const ue=e.symptom||(n==null?void 0:n.symptomText)||"",ke=e.diagnosis||"",At=e.triage_level||"",Ve=e.hospitalVisitTime||"";let be="";ue&&(be+=`[] ${ue}
`),ke&&(be+=`[AI ] ${ke}
`),At&&(be+=`[] ${At==="red"?"":At==="orange"?" ":At==="yellow"?"":""}
`),Ve&&(be+=`[ ] ${Ve}
`),ne(be.trim())}else ne("")},[je,ut]=L.useState(!1);L.useEffect(()=>{V&&e&&ne(z=>{const _e=z.replace(/\n* AI   \.?/g,"").trim();return je?_e+`

 AI   .`:_e})},[je,V,e]);const St=async()=>{if(!G||!te){alert("  .");return}const z=t==null?void 0:t.id,_e=await x5(z),ue=typeof _e=="number"?_e:typeof(t==null?void 0:t.weight)=="number"?t.weight:t!=null&&t.weight&&Number(t.weight)||null,ke={id:(t==null?void 0:t.id)||null,name:(t==null?void 0:t.petName)||(t==null?void 0:t.name)||null,species:(t==null?void 0:t.species)||null,breed:(t==null?void 0:t.breed)||null,birthDate:(t==null?void 0:t.birthDate)||null,age:t!=null&&t.birthDate?Ty(t.birthDate):typeof(t==null?void 0:t.age)=="number"?t.age:null,sex:(t==null?void 0:t.sex)||null,neutered:typeof(t==null?void 0:t.neutered)=="boolean"?t.neutered:null,weight:ue,allergies:Array.isArray(t==null?void 0:t.allergies)?t.allergies:[],chronicConditions:Array.isArray(t==null?void 0:t.chronicConditions)?t.chronicConditions:[]},At=je&&e?{id:e.id,createdAt:e.created_at||e.createdAt,symptom:e.symptom||(n==null?void 0:n.symptomText),symptomTimeline:e.symptomTimeline,diagnosis:e.diagnosis,possibleDiseases:e.possible_diseases||[],probability:e.probability,triageScore:e.triage_score,triageLevel:e.triage_level,riskLevel:e.riskLevel||e.emergency,hospitalVisitTime:e.hospitalVisitTime,actions:e.actions||[],ownerSheet:e.ownerSheet,careGuide:e.careGuide,carePlan:e.carePlan,healthFlags:e.healthFlags}:null,Ve={id:"booking_"+Date.now(),petId:t==null?void 0:t.id,petName:t==null?void 0:t.petName,petSpecies:(t==null?void 0:t.species)||null,petBreed:(t==null?void 0:t.breed)||null,petProfile:ke,hospital:{id:T.id,name:T.name,address:T.roadAddress||T.address,phone:T.phone},date:G,time:te,message:W,status:"pending",createdAt:new Date().toISOString(),diagnosisId:je&&e?e.id:null,aiDiagnosis:At};try{const be=a==null?void 0:a.uid,tt=be?`petMedical_bookings_${be}`:"petMedical_bookings",Qn=JSON.parse(localStorage.getItem(tt)||"[]");Qn.push(Ve),localStorage.setItem(tt,JSON.stringify(Qn)),console.log("  localStorage  :",tt,Ve.id)}catch(be){console.error(" localStorage  :",be)}try{let be=T.id,tt=T.id;try{const Us=Te(ge(re,"clinics"),me("name","==",T.name),Wn(1)),Ar=await Re(Us);Ar.empty?console.warn("[] clinics    , animal_hospitals ID :",T.id):(be=Ar.docs[0].id,console.log("[] clinics ID :",be,":",T.name))}catch(Us){console.warn("[] clinics  :",Us)}const Qn={...Ve,userId:(a==null?void 0:a.uid)||(t==null?void 0:t.userId)||null,clinicId:be,clinicName:T.name,animalHospitalId:tt,hospitalId:tt},yo=Pm(Qn),_n=await d5.createBooking(yo);if(_n.success){if(console.log("  Firestore  :",_n.id,"clinicId:",be),console.log("  :",{clinicId:be,clinicName:T.name,date:G,time:te,petName:t==null?void 0:t.petName}),be)try{await f5(be,"  ",`${(t==null?void 0:t.petName)||""}  . (${G} ${te})`,{type:"booking_created",bookingId:_n.id,clinicId:be,petName:t==null?void 0:t.petName,date:G,time:te,url:"/clinic-dashboard"}),console.log("      ")}catch(Us){console.warn("    ( ):",Us)}}else console.error("  Firestore  :",_n.error),alert("  .  .")}catch(be){console.error("  Firestore  :",be),alert("    : "+be.message)}p(T),r&&r({...T,bookingDate:G,bookingTime:te,bookingMessage:W}),xe(!0)},Et=()=>{const z=[],_e=new Date,ue=_e.getHours(),ke=_e.getMinutes(),At=G===new Date().toISOString().split("T")[0];for(let Ve=9;Ve<=18;Ve++)At?(Ve>ue&&z.push(`${Ve.toString().padStart(2,"0")}:00`),Ve<18&&(Ve>ue||Ve===ue&&ke<30)&&z.push(`${Ve.toString().padStart(2,"0")}:30`)):(z.push(`${Ve.toString().padStart(2,"0")}:00`),Ve<18&&z.push(`${Ve.toString().padStart(2,"0")}:30`));return z},Fs=async()=>{A(!0),D(null);try{const z=await Ey();y(z),R(z.isReal),z.error&&D(z.error);const _e=await lh(z.lat,z.lng);v([On,..._e])}catch(z){console.error("  :",z)}finally{A(!1)}},et=z=>!z&&z!==0?"":z<1e3?`${z}m`:`${(z/1e3).toFixed(1)}km`,rt=async z=>{if(!(_[z.id]||S[z.id])){I(_e=>({..._e,[z.id]:!0}));try{const _e=xn(Vt.GEMINI);if(_e){const ue=`         .

: ${z.name}
: ${z.address}
24 : ${z.is24Hours?"":""}
: ${z.distance?(z.distance/1e3).toFixed(1)+"km":" "}

 :
- " ", "  ", " "      .
-      .
- 24 , ,     .
-     2-3  .
-    .`,ke=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${_e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:ue}]}]})});if(ke.ok){const Ve=(await ke.json()).candidates[0].content.parts[0].text;b(be=>({...be,[z.id]:Ve}))}else throw new Error("API  ")}else{let ue="";z.is24Hours?ue=" 24  !      .":ue=`${z.name}()   ${z.distance?(z.distance/1e3).toFixed(1)+"km":""}   .`,b(ke=>({...ke,[z.id]:ue}))}}catch(_e){console.error("   :",_e);let ue=z.is24Hours?" 24    .":`${z.name}()   .`;b(ke=>({...ke,[z.id]:ue}))}finally{I(_e=>{const ue={..._e};return delete ue[z.id],ue})}}},[Tt,gi]=L.useState(""),yn=async()=>{if(!Tt.trim()){if(w){ie(!0);try{const z=await ch(w.lat,w.lng,5);v([On,...z]),O("nearby")}catch(z){console.error("   :",z)}ie(!1)}return}ie(!0);try{console.log("[HospitalBooking] / :",Tt);const z=await l5(Tt,50);console.log("[HospitalBooking]  :",z.length,""),v([On,...z]),O("region"),P("firestore")}catch(z){console.error(" :",z),alert("   .")}ie(!1)},Ds=z=>{z.key==="Enter"&&yn()};if(!t)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:" "}),i.jsx("button",{onClick:s,className:"mt-4 bg-sky-500 text-white px-6 py-3 rounded-xl font-bold hover:bg-sky-600 transition-colors",children:""})]})});const vn=x.filter(z=>!Tt||z.name.toLowerCase().includes(Tt.toLowerCase())||z.address&&z.address.toLowerCase().includes(Tt.toLowerCase()));return i.jsxs("div",{className:"min-h-screen bg-slate-50",children:[i.jsxs("div",{className:"bg-white px-4 py-4 border-b border-slate-100",children:[i.jsx("div",{className:"flex items-center gap-3 mb-2",children:i.jsx("button",{onClick:s,className:"text-slate-600",children:i.jsx("span",{className:"text-sm",children:" "})})}),i.jsx("h1",{className:"text-xl font-bold text-slate-900",children:" "})]}),i.jsxs("div",{className:"px-4 pt-4 pb-24 space-y-4",children:[!E&&w&&i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3",children:i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx("span",{className:"text-amber-500 text-lg",children:""}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-sm font-medium text-amber-800",children:" ( )  "}),i.jsx("p",{className:"text-xs text-amber-600 mt-1",children:$||"       ."}),i.jsx("button",{onClick:Fs,className:"mt-2 px-3 py-1.5 bg-amber-500 text-white text-xs font-medium rounded-lg hover:bg-amber-600 transition-colors",children:"    "})]})]})}),E&&w&&i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-green-500 text-lg",children:""}),i.jsx("p",{className:"text-sm font-medium text-green-800",children:"     "}),i.jsx("button",{onClick:Fs,className:"ml-auto px-2 py-1 text-xs text-green-600 hover:bg-green-100 rounded",children:" "})]})}),e&&i.jsxs("div",{className:"bg-gradient-to-br from-primary/10 to-accent/10 rounded-2xl shadow-soft border border-primary/20 overflow-hidden",children:[i.jsx("div",{className:"bg-gradient-to-r from-primary to-primary/80 px-4 py-3",children:i.jsxs("h3",{className:"font-bold text-white flex items-center gap-2 font-display",children:[i.jsx("span",{className:"material-symbols-outlined",children:"smart_toy"}),"AI  "]})}),d?i.jsxs("div",{className:"p-8 text-center text-gray-500",children:[i.jsx("div",{className:"w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-2"}),"  ..."]}):i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-14 h-14 rounded-full bg-white shadow overflow-hidden",children:i.jsx("img",{src:mn(t,!1),alt:(t==null?void 0:t.petName)||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-slate-900",children:(t==null?void 0:t.petName)||""}),i.jsxs("p",{className:"text-sm text-slate-500",children:[t==null?void 0:t.breed,"  ",t!=null&&t.birthDate?Ty(t.birthDate):""]})]})]}),e.symptom&&i.jsxs("div",{className:"bg-white/60 rounded-lg p-3",children:[i.jsxs("p",{className:"text-xs text-slate-500 mb-1 flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"symptoms"})," "]}),i.jsx("p",{className:"text-slate-800 font-medium",children:e.symptom})]}),e.possible_diseases&&e.possible_diseases.length>0&&i.jsxs("div",{className:"bg-white/60 rounded-lg p-3",children:[i.jsxs("p",{className:"text-xs text-slate-500 mb-2 flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"psychology"}),"AI  "]}),i.jsx("div",{className:"space-y-2",children:e.possible_diseases.slice(0,2).map((z,_e)=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-slate-800 text-sm",children:z.name||z}),i.jsxs("span",{className:`text-sm font-bold ${_e===0?"text-primary":"text-slate-500"}`,children:[z.probability||z.probability_percent||"N/A","%"]})]},_e))})]}),i.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-slate-200",children:[i.jsx("span",{className:"text-xs text-slate-500",children:"    "}),i.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-600 font-medium",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"check_circle"}),"  "]})]})]})]}),!e&&i.jsx("div",{className:"bg-gradient-to-br from-accent/20 to-accent/10 border border-accent/30 rounded-2xl p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/30 flex items-center justify-center",children:i.jsx("span",{className:"material-symbols-outlined text-accent",children:"lightbulb"})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-slate-800 mb-1",children:"  "}),i.jsx("p",{className:"text-sm text-slate-600",children:"AI         .          ."})]})]})}),(e==null?void 0:e.triage_score)!==void 0&&i.jsxs("div",{className:"bg-surface-light p-4 rounded-lg shadow-soft border border-slate-200",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsxs("h3",{className:"font-bold text-slate-900 font-display flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-primary",children:"warning"})," "]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${e.triage_score>=4?"bg-red-100 text-red-600":e.triage_score>=3?"bg-orange-100 text-orange-600":"bg-green-100 text-green-600"}`,children:e.triage_level||"Normal"})]}),i.jsx("div",{className:"h-3 bg-gray-100 rounded-full overflow-hidden mb-2",children:i.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${e.triage_score>=4?"bg-red-500":e.triage_score>=3?"bg-orange-500":e.triage_score>=2?"bg-yellow-500":"bg-green-500"}`,style:{width:`${e.triage_score/5*100}%`}})}),i.jsxs("p",{className:"text-xs text-gray-500 text-right",children:[e.hospitalVisitTime||"24 "," "]})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"font-bold text-slate-900",children:N==="nearby"?"   ":` "${Tt}"  `}),N==="region"&&i.jsx("button",{onClick:()=>{gi(""),yn()},className:"text-sm text-sky-500 font-medium",children:" "})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[i.jsxs("span",{children:[" ",C==="firestore"?" ()":""]}),i.jsx("span",{children:""}),i.jsxs("span",{children:[x.length," "]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx("input",{type:"text",placeholder:"  (: , , )",value:Tt,onChange:z=>gi(z.target.value),onKeyDown:Ds,className:"w-full px-4 py-3 pl-10 bg-white border border-slate-200 rounded-xl text-sm focus:ring-2 focus:ring-sky-500 focus:border-sky-500"}),i.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:""})]}),i.jsx("button",{onClick:yn,disabled:M,className:"px-4 py-3 bg-sky-500 text-white font-bold rounded-xl hover:bg-sky-600 transition-colors disabled:opacity-50 whitespace-nowrap",children:M?"...":""})]}),i.jsxs("div",{className:"space-y-4",children:[M&&i.jsxs("div",{className:"text-center py-8 text-gray-500 bg-white rounded-2xl border border-slate-100",children:[i.jsx("div",{className:"w-6 h-6 border-2 border-sky-500 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),"  ..."]}),!M&&vn.length===0&&!j?i.jsx("div",{className:"text-center py-8 text-gray-500 bg-white rounded-2xl border border-slate-100",children:N==="region"?`"${Tt}"     .`:"    ."}):!M&&vn.map(z=>i.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100",children:[i.jsxs("div",{className:"mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("h4",{className:"font-bold text-sky-600 text-base",children:z.name}),i.jsx("a",{href:z.url||`https://map.kakao.com/link/search/${encodeURIComponent(z.name)}`,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-0.5 bg-[#FFEB00] text-[#3C1E1E] text-xs font-bold rounded hover:bg-[#F5E100] transition-colors",children:""}),z.is24Hours&&i.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded",children:"24"})]}),i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx("p",{className:"text-xs text-slate-500",children:z.roadAddress||z.address}),z.distance&&i.jsx("span",{className:"text-sm font-bold text-red-500",children:et(z.distance)})]})]}),i.jsx("div",{className:"mb-4",children:S[z.id]?i.jsxs("div",{className:"text-xs text-slate-400 flex items-center gap-1",children:[i.jsx("div",{className:"w-3 h-3 border-2 border-slate-300 border-t-transparent rounded-full animate-spin"}),"   ..."]}):_[z.id]?i.jsxs("div",{className:"bg-gradient-to-r from-sky-50 to-blue-50 rounded-xl p-3 border border-sky-200 shadow-sm",children:[i.jsxs("div",{className:"flex items-center gap-1.5 text-sky-700 font-bold text-sm mb-2",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{children:"AI  "})]}),i.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",children:_[z.id]})]}):i.jsxs("button",{onClick:()=>rt(z),className:"text-sm text-sky-600 hover:text-sky-700 font-bold flex items-center gap-1.5 bg-sky-50 px-3 py-2 rounded-lg hover:bg-sky-100 transition-colors",children:[i.jsx("span",{className:"text-base",children:""}),"AI   "]})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>he(z),className:"flex-1 py-2.5 text-center bg-sky-500 text-white rounded-xl text-sm font-bold hover:bg-sky-600 transition-colors flex items-center justify-center",children:""}),i.jsx("a",{href:w?`https://map.kakao.com/link/from/,${w.lat},${w.lng}/to/${encodeURIComponent(z.name)},${z.lat},${z.lng}`:`https://map.kakao.com/link/to/${encodeURIComponent(z.name)},${z.lat},${z.lng}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 py-2.5 text-center bg-[#FEE500] rounded-xl text-xs font-bold text-[#3C1E1E] hover:bg-[#F5DC00] transition-colors flex items-center justify-center",children:""}),i.jsxs("a",{href:"https://service.kakaomobility.com/launch/kakaot",target:"_blank",rel:"noopener noreferrer",className:"flex-1 py-2.5 text-center bg-[#1E1B4B] rounded-xl text-xs font-bold hover:bg-[#2d2a5a] transition-colors flex items-center justify-center gap-0.5",children:[i.jsx("span",{className:"text-[#FACC15]",children:"Kakao T"}),i.jsx("span",{className:"text-white",children:""})]})]})]},z.id))]})]}),V&&T&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-end justify-center z-50 animate-fade-in",children:i.jsx("div",{className:"bg-white rounded-t-3xl w-full max-w-md p-4 pb-6 animate-slide-up max-h-[85vh] overflow-y-auto",children:oe?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full mx-auto mb-4 flex items-center justify-center",children:i.jsx("span",{className:"material-symbols-outlined text-green-600 text-5xl",children:"check_circle"})}),i.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"  !"}),i.jsx("p",{className:"text-slate-500 mb-6",children:"    ."}),i.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 text-left mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("span",{className:"material-symbols-outlined text-primary",children:"local_hospital"}),i.jsx("span",{className:"font-bold text-slate-900",children:T.name})]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"calendar_today"}),G]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"}),te]})]})]}),i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-6",children:i.jsxs("p",{className:"text-sm text-amber-800 flex items-start gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-amber-600 text-sm mt-0.5",children:"info"}),"     ."]})}),i.jsx("button",{onClick:()=>{Y(!1),xe(!1)},className:"w-full py-3 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors",children:""})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-slate-900",children:""}),i.jsx("button",{onClick:()=>Y(!1),className:"p-2 text-slate-400 hover:text-slate-600 rounded-full hover:bg-slate-100",children:i.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),i.jsxs("div",{className:"bg-slate-50 rounded-lg p-2.5 mb-3",children:[i.jsx("p",{className:"font-bold text-slate-900 text-sm",children:T.name}),i.jsx("p",{className:"text-xs text-slate-500",children:T.roadAddress||T.address})]}),i.jsxs("div",{className:"flex gap-2 mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:" "}),i.jsx("input",{type:"date",value:G,onChange:z=>K(z.target.value),min:new Date().toISOString().split("T")[0],className:"w-full p-2 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:" "}),i.jsxs("select",{value:te,onChange:z=>le(z.target.value),className:"w-full p-2 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary",children:[i.jsx("option",{value:"",children:" "}),Et().map(z=>i.jsx("option",{value:z,children:z},z))]})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"block text-xs font-medium text-slate-700 mb-1",children:"   ()"}),i.jsx("textarea",{value:W,onChange:z=>ne(z.target.value),placeholder:"  ",rows:"2",className:"w-full p-2 text-sm border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary resize-none"})]}),e&&i.jsx("div",{className:"mb-3",children:i.jsxs("div",{className:`rounded-lg p-3 border-2 cursor-pointer transition-all ${je?"border-primary bg-primary/10":"border-slate-200 bg-slate-50"}`,onClick:()=>ut(!je),children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-5 h-5 rounded flex items-center justify-center ${je?"bg-primary":"bg-white border border-slate-300"}`,children:je&&i.jsx("span",{className:"material-symbols-outlined text-white text-sm",children:"check"})}),i.jsx("span",{className:"font-bold text-slate-800 text-sm",children:"AI   "}),i.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ml-auto ${je?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700"}`,children:je?" ":""})]}),!je&&i.jsx("p",{className:"text-xs text-slate-500 mt-1.5 ml-7",children:"        "})]})}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>Y(!1),className:"flex-1 py-3 bg-slate-200 text-slate-700 font-bold rounded-lg hover:bg-slate-300 transition-colors",children:""}),i.jsx("button",{onClick:St,className:"flex-1 py-3 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors shadow-lg shadow-primary/30",children:" "})]})]})})})]})}function y5({petData:t,diagnosis:e,hospital:n,hospitalPacket:s,onBack:r,onEdit:o,onSend:a,onSave:l}){var A,w;const[u,d]=L.useState(""),[h,m]=L.useState(!0),p=()=>mn(t,!1),x=()=>{if(!s)return null;const y=u.trim();let E=s.packet_text||"";return E.includes("[ ]")?E=E.replace(/\[ \]\n[\s\S]*$/,`[ ]
${y||"- "}`):E+=`

[ ]
${y||"- "}`,{...s,packet_text:E,packet_json:{...s.packet_json,owner_request_note:y},requestNote:y}};if(!t||!e||!n)return null;const v=y=>y>=4?"text-red-600 bg-red-100":y>=3?"text-orange-600 bg-orange-100":y>=2?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100",j=y=>y>=4?"":y>=3?"":y>=2?"":"";return i.jsxs("div",{className:"page-container",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("div",{className:"flex size-12 shrink-0 items-center text-slate-800",children:i.jsx("button",{onClick:r,className:"p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-full",children:i.jsx("span",{className:"material-symbols-outlined text-3xl",children:"arrow_back_ios_new"})})}),i.jsx("h2",{className:"text-slate-800 text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center font-display",children:" "}),i.jsx("div",{className:"flex size-12 shrink-0 items-center justify-end",children:i.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"more_horiz"})})]}),i.jsxs("div",{className:"px-4 pt-6 pb-40",children:[i.jsxs("div",{className:"flex items-center gap-3 px-1 pt-2 pb-6",children:[i.jsx("div",{className:"w-14 h-14 rounded-full bg-sky-100 overflow-hidden border-2 border-sky-200",children:i.jsx("img",{src:p(),alt:t.petName||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h1",{className:"text-slate-900 text-2xl font-bold leading-tight tracking-tight font-display whitespace-nowrap",children:"!"}),i.jsx("p",{className:"text-slate-500 text-sm font-normal leading-normal whitespace-nowrap",children:"    "})]})]}),i.jsxs("div",{className:"mb-6 rounded-lg bg-surface-light p-4 shadow-soft",children:[i.jsx("h3",{className:"text-slate-900 text-lg font-bold leading-tight tracking-[-0.015em] pb-4 font-display",children:"  "}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"flex items-center justify-center rounded-lg bg-primary/20 shrink-0 size-12 text-primary",children:i.jsx("span",{className:"material-symbols-outlined text-3xl",children:"local_hospital"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-slate-800 text-base font-medium leading-normal",children:n.name}),i.jsx("p",{className:"text-slate-500 text-sm font-normal leading-normal",children:n.distance?`${(n.distance/1e3).toFixed(1)}km`:""})]})]}),n.phone&&i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"flex items-center justify-center shrink-0 size-12",children:i.jsx("span",{className:"material-symbols-outlined text-slate-400 text-3xl",children:"call"})}),i.jsx("p",{className:"text-slate-800 text-base font-normal leading-normal flex-1",children:n.phone})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"flex items-center justify-center shrink-0 size-12",children:i.jsx("span",{className:"material-symbols-outlined text-slate-400 text-3xl",children:"location_on"})}),i.jsx("p",{className:"text-slate-800 text-base font-normal leading-normal flex-1",children:n.roadAddress||n.address})]})]})]}),i.jsxs("div",{className:"mb-6 rounded-lg bg-surface-light p-4 shadow-soft",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-slate-900 text-lg font-bold leading-tight tracking-[-0.015em] pb-4 font-display",children:[i.jsx("span",{className:"material-symbols-outlined text-secondary",children:"pets"}),i.jsx("span",{children:" "})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-4",children:[i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-sm text-slate-500",children:""}),i.jsx("span",{className:"text-slate-800 font-medium",children:t.petName})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-sm text-slate-500",children:""}),i.jsx("span",{className:"text-slate-800 font-medium",children:t.breed||""})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-sm text-slate-500",children:""}),i.jsx("span",{className:"text-slate-800 font-medium",children:t.birthDate?(()=>{const y=new Date(t.birthDate);return`${new Date().getFullYear()-y.getFullYear()}`})():""})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-sm text-slate-500",children:""}),i.jsx("span",{className:"text-slate-800 font-medium",children:t.sex==="M"?"":t.sex==="F"?"":""})]}),i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"text-sm text-slate-500",children:""}),i.jsx("span",{className:"text-slate-800 font-medium",children:t.neutered?"":""})]})]})]}),e.possible_diseases&&e.possible_diseases.length>0&&i.jsxs("div",{className:"mb-6 rounded-xl bg-gradient-to-r from-violet-500 to-purple-600 p-4 text-white",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"material-symbols-outlined",children:"diagnosis"}),i.jsx("span",{className:"font-bold",children:"AI "})]}),i.jsx("p",{className:"text-2xl font-bold",children:((A=e.possible_diseases[0])==null?void 0:A.name)||e.possible_diseases[0]}),((w=e.possible_diseases[0])==null?void 0:w.probability)&&i.jsxs("p",{className:"text-white/80 text-sm mt-1",children:["AI  : ",e.possible_diseases[0].probability,"%"]})]}),e.symptom&&i.jsxs("div",{className:"mb-6 rounded-lg bg-surface-light p-4 shadow-soft",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-slate-900 text-lg font-bold leading-tight tracking-[-0.015em] pb-4 font-display",children:[i.jsx("span",{className:"material-symbols-outlined text-secondary",children:"history"}),i.jsx("span",{children:"  &  "})]}),i.jsx("p",{className:"text-slate-800 font-medium pb-3",children:e.symptom}),e.symptomTimeline&&e.symptomTimeline.length>0?i.jsx("ul",{className:"space-y-2 pl-1",children:e.symptomTimeline.map((y,E)=>i.jsxs("li",{className:"flex items-start gap-3 text-slate-600",children:[i.jsx("span",{className:"material-symbols-outlined text-base mt-1 text-primary",children:"check_circle"}),i.jsx("p",{children:y})]},E))}):i.jsx("p",{className:"text-slate-600 text-sm",children:"   ."})]}),e.possible_diseases&&e.possible_diseases.length>0&&i.jsxs("div",{className:"mb-6 rounded-lg bg-surface-light p-4 shadow-soft",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-slate-900 text-lg font-bold leading-tight tracking-[-0.015em] pb-4 font-display",children:[i.jsx("span",{className:"material-symbols-outlined text-secondary",children:"smart_toy"}),i.jsx("span",{children:"AI  "})]}),i.jsx("div",{className:"space-y-3",children:e.possible_diseases.map((y,E)=>i.jsxs("div",{className:`rounded-lg border border-slate-200 p-3 ${E===0?"bg-slate-50/50":""}`,children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("p",{className:"text-base font-semibold text-slate-900",children:y.name||y}),i.jsxs("p",{className:`text-lg font-bold ${E===0?"text-primary":E===1?"text-primary/70":"text-primary/50"}`,children:[y.probability||y.probability_percent||"N/A","%"]})]}),y.related_area&&i.jsxs("p",{className:"text-sm text-slate-500",children:[" : ",y.related_area]})]},E))})]}),e.triage_score!==void 0&&i.jsx("div",{className:`mb-6 rounded-lg p-4 border ${v(e.triage_score)}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("span",{className:"material-symbols-outlined text-3xl",children:"warning"}),i.jsxs("div",{children:[i.jsxs("h3",{className:`text-lg font-bold leading-tight ${v(e.triage_score).split(" ")[0]}`,children:[": ",j(e.triage_score)]}),i.jsx("p",{className:"text-slate-700 mt-1",children:e.triage_note||"  ."}),i.jsxs("p",{className:"text-slate-800 mt-3 font-semibold",children:[" : ",e.hospitalVisitTime||"24 ","  "]})]})]})}),i.jsxs("div",{className:"mb-6 rounded-lg bg-surface-light p-4 shadow-soft",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-slate-900 text-lg font-bold leading-tight tracking-[-0.015em] pb-4 font-display",children:[i.jsx("span",{className:"material-symbols-outlined text-secondary",children:"edit_note"}),i.jsx("span",{children:"   ()"})]}),i.jsx("textarea",{className:"w-full rounded-lg border-slate-300 bg-slate-100 text-slate-900 focus:ring-primary focus:border-primary p-3 text-base",rows:"3",placeholder:"     ",value:u,onChange:y=>d(y.target.value)}),i.jsx("p",{className:"text-xs text-slate-400 mt-2",children:" AI   ."})]}),i.jsx("div",{className:"mb-6 rounded-xl border-2 border-sky-200 bg-sky-50 p-4",children:i.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:h,onChange:y=>m(y.target.checked),className:"w-5 h-5 mt-1 text-sky-500 rounded border-sky-300 focus:ring-sky-400"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"text-sky-600 text-lg",children:""}),i.jsx("span",{className:"font-bold text-slate-900",children:"AI   "}),i.jsx("span",{className:"px-2 py-0.5 bg-sky-500 text-white text-xs font-bold rounded-full",children:""})]}),i.jsx("p",{className:"text-sm text-slate-600 mb-3",children:"      "}),i.jsxs("div",{className:"space-y-2 pl-1",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[i.jsx("span",{className:"text-green-500",children:""}),i.jsx("span",{children:"  "})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[i.jsx("span",{className:"text-green-500",children:""}),i.jsx("span",{children:"  "})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[i.jsx("span",{className:"text-green-500",children:""}),i.jsx("span",{children:"AI  (Top 3  )"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[i.jsx("span",{className:"text-green-500",children:""}),i.jsx("span",{children:"    "})]})]})]})]})})]}),i.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-sm p-4 border-t border-slate-200",children:i.jsxs("div",{className:"flex flex-col space-y-3",children:[i.jsx("button",{onClick:o,className:"w-full bg-slate-200 text-slate-700 font-bold py-4 px-6 rounded-lg text-base hover:bg-slate-300 transition-colors",children:" "}),i.jsx("button",{onClick:()=>a&&a(x()),className:"w-full bg-primary text-white font-bold py-4 px-6 rounded-lg text-base hover:bg-primary/90 transition-colors shadow-lg shadow-primary/30",children:" "}),i.jsx("button",{onClick:()=>l&&l(x()),className:"w-full text-slate-500 font-medium py-2 px-6 rounded-lg text-sm hover:text-slate-700 transition-colors",children:" "})]})})]})}function v5({petData:t,hospital:e,bookingTime:n,bookingDate:s,onBack:r,onGetDirections:o,onHome:a}){var m;const[l,u]=L.useState(""),[d,h]=L.useState("");return L.useEffect(()=>{const p=Math.floor(1e3+Math.random()*9e3).toString();if(u(p),n&&n.includes(":")){const x=n.split(":"),v=parseInt(x[0],10),j=parseInt(x[1],10);if(!isNaN(v)&&!isNaN(j)){const A=v>=12?"":"";let w=v%12;w===0&&(w=12),h(`${A} ${w} ${j.toString().padStart(2,"0")}`)}else h(n)}else if(n)h(n);else{const x=new Date;x.setMinutes(x.getMinutes()+30);const v=x.getHours(),j=x.getMinutes(),A=v>=12?"":"";let w=v%12;w===0&&(w=12),h(`${A} ${w} ${j.toString().padStart(2,"0")}`)}},[n]),!t||!e?null:i.jsxs("div",{className:"page-container",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("div",{className:"flex size-12 shrink-0 items-center text-slate-800",children:i.jsx("button",{onClick:r,className:"p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-full",children:i.jsx("span",{className:"material-symbols-outlined text-3xl",children:"arrow_back_ios_new"})})}),i.jsx("h2",{className:"text-slate-800 text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center font-display",children:" "}),i.jsx("div",{className:"flex size-12 shrink-0 items-center justify-end"})]}),i.jsxs("div",{className:"px-4 pt-6 pb-40",children:[i.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[i.jsx("div",{className:"w-24 h-24 rounded-full bg-accent/20 flex items-center justify-center mb-4",children:i.jsx("span",{className:"material-symbols-outlined text-accent text-6xl",children:"pets"})}),i.jsx("h1",{className:"text-slate-900 text-2xl font-bold mb-2 font-display",children:"   !"}),i.jsx("p",{className:"text-slate-600 text-base text-center max-w-sm",children:"  ,      ."})]}),i.jsx("div",{className:"mb-4 rounded-lg bg-surface-light p-4 shadow-soft",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"flex items-center justify-center rounded-lg bg-primary/20 shrink-0 size-12 text-primary",children:i.jsx("span",{className:"material-symbols-outlined text-3xl",children:"local_hospital"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-slate-900 font-bold text-base mb-1 font-display",children:e.name}),i.jsx("p",{className:"text-slate-600 text-sm",children:e.roadAddress||e.address}),e.phone&&i.jsx("p",{className:"text-slate-500 text-sm mt-1",children:e.phone})]})]})}),i.jsx("div",{className:"mb-6 rounded-lg bg-surface-light p-4 shadow-soft",children:i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx("div",{className:"flex items-center justify-center rounded-lg bg-primary/20 shrink-0 size-12 text-primary",children:i.jsx("span",{className:"material-symbols-outlined text-3xl",children:"schedule"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"text-slate-900 font-bold text-base mb-2 font-display",children:"    "}),i.jsxs("p",{className:"text-slate-600 text-sm",children:["  : ",d]}),i.jsxs("p",{className:"text-slate-600 text-sm mt-1",children:[": ",t.petName," (",t.breed||" ",")"]})]})]})}),i.jsx("div",{className:"mb-6 rounded-lg bg-primary/10 p-6",children:i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsx("div",{className:"w-48 h-48 bg-white rounded-lg flex items-center justify-center mb-4 shadow-md",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-2",children:""}),i.jsx("p",{className:"text-xs text-slate-500",children:"QR Code"})]})}),i.jsx("p",{className:"text-slate-700 text-sm text-center mb-4",children:"      ."}),i.jsx("div",{className:"bg-white rounded-lg px-6 py-4 shadow-md",children:i.jsx("p",{className:"text-slate-900 text-3xl font-bold tracking-wider font-mono",children:((m=l.match(/.{1,4}/g))==null?void 0:m.join(" "))||l})})]})})]}),i.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-sm p-4 border-t border-slate-200 space-y-2",children:[i.jsxs("button",{onClick:o,className:"w-full bg-primary text-white font-bold py-4 px-6 rounded-lg text-base hover:bg-primary/90 transition-colors shadow-lg shadow-primary/30 flex items-center justify-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined",children:"directions"}),i.jsx("span",{children:""})]}),i.jsxs("a",{href:"https://service.kakaomobility.com/launch/kakaot",target:"_blank",rel:"noopener noreferrer",className:"w-full bg-[#1E1B4B] text-white font-bold py-4 px-6 rounded-lg text-base hover:bg-[#2d2a5a] transition-colors flex items-center justify-center gap-2",children:[i.jsx("span",{className:"text-[#FACC15] font-black text-xl",children:"T"}),i.jsx("span",{children:"Kakao T  "})]}),i.jsx("button",{onClick:a||r,className:"w-full text-slate-600 font-medium py-3 px-6 rounded-lg text-sm hover:text-slate-800 hover:bg-slate-100 transition-colors",children:" "})]})]})}const _5="petMedical_diagnoses",w5="petMedical_clinicResults",Cy="petMedical_medicationFeedback",b5=[{id:"visit_1",date:"2024-11-15",hospitalName:"",hospitalAddress:"   123-45",diagnosis:"  -   ",type:"visit",triage_score:2,possible_diseases:[{name:" ",probability:65},{name:" ",probability:25}]},{id:"visit_2",date:"2024-10-20",hospitalName:"24 ",hospitalAddress:"   456-78",diagnosis:"  -  ",type:"visit",triage_score:3,possible_diseases:[{name:" ",probability:70},{name:"",probability:20}]},{id:"visit_3",date:"2024-09-05",hospitalName:"",hospitalAddress:"   123-45",diagnosis:" -  ",type:"visit",triage_score:1}],N5=[{id:"med_1",date:"2024-11-28",medications:[" ()",""],pharmacyName:"",daysSupply:"7",status:"effective"},{id:"med_2",date:"2024-11-20",medications:[" ()",""],pharmacyName:"24 ",daysSupply:"5",status:"effective"},{id:"med_3",date:"2024-11-15",medications:[" (/)",""],pharmacyName:"",daysSupply:"3",status:"side_effect"},{id:"med_4",date:"2024-11-10",medications:[" ()",""],pharmacyName:"24 ",daysSupply:"10",status:"effective"},{id:"med_5",date:"2024-11-05",medications:["",""],pharmacyName:"",daysSupply:"14",status:"none"},{id:"med_6",date:"2024-10-28",medications:[" ()",""],pharmacyName:"24 ",daysSupply:"7",status:"none"},{id:"med_7",date:"2024-10-15",medications:[" "],pharmacyName:"",daysSupply:"1",status:"none"}],j5=[{id:"checkup_1",date:"2024-09-05",hospitalName:"",type:"",results:[{item:"",status:"normal",note:"   "},{item:"",status:"normal",note:" "},{item:"",status:"normal",note:"  "},{item:"",status:"normal",note:"  "}],overallStatus:""},{id:"checkup_2",date:"2024-03-15",hospitalName:"24 ",type:"",results:[{item:"",status:"normal",note:""},{item:"",status:"caution",note:"  (5.8kg  6.2kg)"},{item:"",status:"normal",note:"  "}],overallStatus:""}],k5=[{id:"care_1",date:"2024-11-29",meals:3,water:4,walks:2,treats:2,grooming:1,weight:6.2,notes:"     !"},{id:"care_2",date:"2024-11-28",meals:2,water:3,walks:1,treats:3,grooming:0,weight:null,notes:""},{id:"care_3",date:"2024-11-27",meals:3,water:5,walks:2,treats:1,grooming:1,weight:6.1,notes:" "},{id:"care_4",date:"2024-11-26",meals:2,water:4,walks:2,treats:2,grooming:0,weight:null,notes:""}],I5=[{id:"vac_1",date:"2024-08-20",name:" (DHPPL)",hospitalName:"",nextDue:"2025-08-20",status:"completed"},{id:"vac_2",date:"2024-11-01",name:" ",hospitalName:"",nextDue:"2024-12-01",status:"completed"},{id:"vac_3",date:"2024-07-15",name:" ",hospitalName:"",nextDue:"2025-07-15",status:"completed"},{id:"vac_4",date:"2024-06-10",name:" ",hospitalName:"24 ",nextDue:"2025-06-10",status:"completed"}];function S5({petData:t,onBack:e,onViewDiagnosis:n,onOCR:s,onHome:r,onHospitalBooking:o}){var N,O,M,ie,Ae,Q,V,Y;const[a,l]=L.useState("visits"),[u,d]=L.useState([]),[h,m]=L.useState([]),[p,x]=L.useState({}),[v,j]=L.useState(!0);L.useEffect(()=>{const T=localStorage.getItem(_5);if(T){const G=JSON.parse(T).filter(K=>K.petId===(t==null?void 0:t.id));d(G)}},[t]),L.useEffect(()=>{const T=localStorage.getItem(w5);if(T){const G=JSON.parse(T).filter(K=>K.petId===(t==null?void 0:t.id));m(G)}},[t]),L.useEffect(()=>{const T=localStorage.getItem(Cy);T&&x(JSON.parse(T))},[]);const A=(T,B)=>{const G={...p,[T]:{status:B,updatedAt:new Date().toISOString(),petId:t==null?void 0:t.id}};x(G),localStorage.setItem(Cy,JSON.stringify(G))},w=T=>T?new Date(T).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}):"",y=[{id:"visits",label:"",icon:"local_hospital"},{id:"medication",label:"",icon:"medication"},{id:"checkup",label:"",icon:"assignment"},{id:"vaccination",label:"",icon:"vaccines"},{id:"care",label:"",icon:"favorite"}],E=(()=>{const T=h.map(K=>({id:K.id,date:K.visitDate||K.createdAt,hospitalName:K.hospitalName,hospitalAddress:K.hospitalAddress||"",diagnosis:K.finalDiagnosis||K.diagnosis,type:"visit",triage_score:K.triageScore,treatment:K.treatment,medications:K.medications,totalCost:K.totalCost,nextVisitDate:K.nextVisitDate,doctorNote:K.doctorNote,source:"clinic"})),B=u.filter(K=>K.type==="visit"||!K.type).map(K=>({...K,source:"ai"})),G=[...T,...B].sort((K,te)=>new Date(te.date||te.created_at)-new Date(K.date||K.created_at));return v?[...G,...b5]:G})(),R=(()=>{const T=h.filter(K=>K.medications&&K.medications.length>0).flatMap(K=>K.medications.map((te,le)=>{var W;return{id:`${K.id}_med_${le}`,resultId:K.id,date:K.visitDate||K.createdAt,name:te.name,dosage:te.dosage,days:te.days,instructions:te.instructions,hospitalName:K.hospitalName,petId:K.petId,source:"clinic",feedbackStatus:((W=p[`${K.id}_med_${le}`])==null?void 0:W.status)||"none"}})),B=u.filter(K=>K.medications||K.prescription).map(K=>{var te;return{id:K.id,date:K.created_at||K.date,medications:K.medications||K.prescription||[],hospitalName:"AI ",source:"ai",feedbackStatus:((te=p[K.id])==null?void 0:te.status)||"none"}}),G=[...T,...B].sort((K,te)=>new Date(te.date)-new Date(K.date));return v?[...G,...N5]:G})(),$=v?j5:[],D=v?I5:[],_=v?k5:[],b=R.filter(T=>T.feedbackStatus==="effective").length,S=R.filter(T=>T.feedbackStatus==="side_effect").length,I=R.filter(T=>T.feedbackStatus==="none"||!T.feedbackStatus).length,C=T=>{switch(T){case"normal":return"text-green-600 bg-green-50";case"caution":return"text-yellow-600 bg-yellow-50";case"warning":return"text-red-600 bg-red-50";default:return"text-slate-600 bg-slate-50"}},P=T=>{switch(T){case"normal":return"check_circle";case"caution":return"warning";case"warning":return"error";default:return"help"}};return i.jsxs("div",{className:"min-h-screen bg-slate-50",children:[i.jsxs("div",{className:"bg-white px-4 py-4 border-b border-slate-100",children:[i.jsx("div",{className:"flex items-center gap-3 mb-2",children:i.jsx("button",{onClick:e,className:"text-slate-600",children:i.jsx("span",{className:"text-sm",children:" "})})}),i.jsx("h1",{className:"text-xl font-bold text-slate-900",children:" "})]}),i.jsxs("div",{className:"px-4 pt-4 pb-24 space-y-4",children:[i.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-slate-100",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"font-bold text-slate-800",children:" "}),i.jsx("span",{className:"text-xs text-slate-400",children:new Date().toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\. /g,"-").replace(".","")})]}),i.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"w-11 h-11 rounded-xl bg-slate-50 flex flex-col items-center justify-center",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-slate-600",children:"2"})]}),i.jsx("span",{className:"text-xs text-slate-500 mt-1",children:""})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"w-11 h-11 rounded-xl bg-slate-50 flex flex-col items-center justify-center",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-slate-600",children:"3"})]}),i.jsx("span",{className:"text-xs text-slate-500 mt-1",children:""})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"w-11 h-11 rounded-xl bg-slate-50 flex flex-col items-center justify-center",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-slate-600",children:"2"})]}),i.jsx("span",{className:"text-xs text-slate-500 mt-1",children:""})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"w-11 h-11 rounded-xl bg-slate-50 flex flex-col items-center justify-center",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-slate-600",children:"1"})]}),i.jsx("span",{className:"text-xs text-slate-500 mt-1",children:""})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"w-11 h-11 rounded-xl bg-slate-50 flex flex-col items-center justify-center",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-[10px] text-slate-600",children:"2"})]}),i.jsx("span",{className:"text-xs text-slate-500 mt-1",children:""})]})]})]}),E.length>0&&i.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-slate-100",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h3",{className:"font-bold text-slate-800",children:"  "}),i.jsx("span",{className:"text-xs text-slate-400",children:w(((N=E[0])==null?void 0:N.date)||((O=E[0])==null?void 0:O.created_at))})]}),i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${((M=E[0])==null?void 0:M.source)==="clinic"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:((ie=E[0])==null?void 0:ie.source)==="clinic"?" ":"AI "}),i.jsx("span",{className:"text-sm text-slate-700",children:((Ae=E[0])==null?void 0:Ae.hospitalName)||"AI "})]}),i.jsx("p",{className:"text-sm text-slate-600",children:((Q=E[0])==null?void 0:Q.diagnosis)||"  "}),((Y=(V=E[0])==null?void 0:V.medications)==null?void 0:Y.length)>0&&i.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["  ",E[0].medications.length,""]})]}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[i.jsx("div",{className:"flex border-b border-slate-100 overflow-x-auto",children:y.map(T=>i.jsxs("button",{onClick:()=>l(T.id),className:`flex-1 min-w-[80px] py-3 px-2 text-center transition-colors ${a===T.id?"bg-primary/5 text-primary border-b-2 border-primary":"text-slate-500 hover:bg-slate-50"}`,children:[i.jsx("span",{className:"material-symbols-outlined text-lg block mb-0.5",children:T.icon}),i.jsx("span",{className:"text-xs font-medium",children:T.label})]},T.id))}),i.jsxs("div",{className:"p-4",children:[a==="visits"&&i.jsx("div",{className:"space-y-4",children:E.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-5xl mb-4",children:""}),i.jsx("p",{className:"text-slate-500",children:"  ."}),i.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"AI      "})]}):E.map(T=>{var B;return i.jsxs("div",{onClick:()=>n&&n(T),className:"bg-slate-50 rounded-xl p-4 cursor-pointer hover:bg-slate-100 transition-all",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${T.source==="clinic"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:T.source==="clinic"?"":"AI"}),i.jsx("p",{className:"text-slate-500 text-xs",children:w(T.date||T.created_at)})]}),i.jsx("h3",{className:"text-slate-900 font-bold text-base mb-1",children:T.hospitalName||"AI "})]}),i.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"chevron_right"})]}),T.diagnosis&&i.jsx("p",{className:"text-slate-700 text-sm mb-2",children:T.diagnosis}),T.source==="clinic"&&i.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[T.treatment&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-50 text-green-700 rounded text-xs",children:[i.jsx("span",{className:"material-symbols-outlined text-xs",children:"healing"}),T.treatment]}),((B=T.medications)==null?void 0:B.length)>0&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-orange-50 text-orange-700 rounded text-xs",children:[i.jsx("span",{className:"material-symbols-outlined text-xs",children:"medication"})," ",T.medications.length,""]}),T.totalCost>0&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs",children:[" ",T.totalCost.toLocaleString(),""]}),T.nextVisitDate&&i.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-primary/10 text-primary rounded text-xs",children:[i.jsx("span",{className:"material-symbols-outlined text-xs",children:"event"}),": ",w(T.nextVisitDate)]})]})]},T.id)})}),a==="medication"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-4 mb-4",children:[i.jsx("h4",{className:"text-sm font-bold text-slate-700 mb-3",children:"  "}),i.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[i.jsxs("div",{className:"bg-white rounded-lg p-3 text-center shadow-sm",children:[i.jsx("span",{className:"material-symbols-outlined text-green-500 text-2xl",children:"check_circle"}),i.jsx("p",{className:"text-xl font-bold text-green-600 mt-1",children:b}),i.jsx("p",{className:"text-xs text-slate-500",children:"  "})]}),i.jsxs("div",{className:"bg-white rounded-lg p-3 text-center shadow-sm",children:[i.jsx("span",{className:"material-symbols-outlined text-red-500 text-2xl",children:"warning"}),i.jsx("p",{className:"text-xl font-bold text-red-600 mt-1",children:S}),i.jsx("p",{className:"text-xs text-slate-500",children:""})]}),i.jsxs("div",{className:"bg-white rounded-lg p-3 text-center shadow-sm",children:[i.jsx("span",{className:"material-symbols-outlined text-slate-400 text-2xl",children:"pending"}),i.jsx("p",{className:"text-xl font-bold text-slate-600 mt-1",children:I}),i.jsx("p",{className:"text-xs text-slate-500",children:" "})]})]}),i.jsx("p",{className:"text-xs text-slate-500 mt-3 text-center",children:"           "})]}),R.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-5xl mb-4",children:""}),i.jsx("p",{className:"text-slate-500",children:"  ."}),i.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"    "})]}):R.map(T=>i.jsxs("div",{className:"bg-slate-50 rounded-xl p-4",children:[T.source==="clinic"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:" "}),i.jsx("span",{className:"text-xs text-slate-500",children:w(T.date)})]}),i.jsx("h4",{className:"text-slate-900 font-bold text-base",children:T.name}),i.jsx("p",{className:"text-slate-500 text-sm",children:T.hospitalName})]}),T.feedbackStatus==="effective"&&i.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-xs",children:"check"})," "]}),T.feedbackStatus==="side_effect"&&i.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-medium flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-xs",children:"warning"}),""]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[T.dosage&&i.jsxs("span",{className:"px-2 py-1 bg-white text-slate-600 rounded text-xs",children:[" ",T.dosage]}),T.days&&i.jsxs("span",{className:"px-2 py-1 bg-white text-slate-600 rounded text-xs",children:[" ",T.days,""]}),T.instructions&&i.jsxs("span",{className:"px-2 py-1 bg-white text-slate-600 rounded text-xs",children:[" ",T.instructions]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:B=>{B.stopPropagation(),A(T.id,"effective")},className:`flex-1 flex items-center justify-center gap-1 px-3 py-2.5 rounded-lg text-sm font-medium transition-all ${T.feedbackStatus==="effective"?"bg-green-500 text-white shadow-md":"bg-green-50 text-green-700 hover:bg-green-100"}`,children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"thumb_up"})," "]}),i.jsxs("button",{onClick:B=>{B.stopPropagation(),A(T.id,"side_effect")},className:`flex-1 flex items-center justify-center gap-1 px-3 py-2.5 rounded-lg text-sm font-medium transition-all ${T.feedbackStatus==="side_effect"?"bg-red-500 text-white shadow-md":"bg-red-50 text-red-700 hover:bg-red-100"}`,children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"thumb_down"})," "]})]})]}),T.source==="ai"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"flex justify-between items-start mb-3",children:i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",children:"AI "}),i.jsx("span",{className:"text-xs text-slate-500",children:w(T.date)})]}),i.jsx("p",{className:"text-slate-900 font-bold text-base mb-1",children:Array.isArray(T.medications)&&T.medications.length>0?T.medications.length>1?`${typeof T.medications[0]=="string"?T.medications[0]:T.medications[0].name}  ${T.medications.length-1}`:typeof T.medications[0]=="string"?T.medications[0]:T.medications[0].name:" "})]})}),Array.isArray(T.medications)&&T.medications.length>0&&i.jsx("div",{className:"flex flex-wrap gap-1",children:T.medications.map((B,G)=>i.jsxs("span",{className:"px-2 py-1 bg-white text-slate-600 rounded text-xs",children:[" ",typeof B=="string"?B:B.name]},G))})]})]},T.id))]}),a==="checkup"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-primary/10 rounded-lg p-3 mb-4 flex items-start gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-primary text-sm",children:"info"}),i.jsx("p",{className:"text-slate-700 text-sm flex-1",children:"  10   ."}),i.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"arrow_forward_ios"})]}),$.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("p",{className:"text-slate-500",children:"  ."})]}):$.map(T=>i.jsxs("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-slate-500 text-sm mb-1",children:w(T.date)}),i.jsx("h3",{className:"text-slate-900 font-bold text-base mb-1 font-display",children:T.type}),i.jsxs("p",{className:"text-slate-500 text-sm flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"location_on"}),T.hospitalName]})]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${T.overallStatus===""?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:T.overallStatus})]}),i.jsx("div",{className:"space-y-2 mt-4",children:T.results.map((B,G)=>i.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg ${C(B.status)}`,children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:P(B.status)}),i.jsx("span",{className:"text-sm font-medium",children:B.item})]}),i.jsx("span",{className:"text-xs",children:B.note})]},G))}),i.jsxs("button",{className:"w-full mt-4 py-2 text-primary text-sm font-medium flex items-center justify-center gap-1 hover:bg-primary/5 rounded-lg transition-colors",children:["  ",i.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_forward_ios"})]})]},T.id))]}),a==="vaccination"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-slate-900 font-bold text-base mb-3 font-display",children:"  "}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft",children:i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-slate-900 font-bold text-sm mb-1",children:" (DHPPL)"}),i.jsx("p",{className:"text-slate-500 text-xs",children:"1 1  ."})]}),i.jsx("button",{onClick:()=>o&&o(),className:"px-3 py-1.5 bg-primary text-white rounded-lg text-xs font-medium hover:bg-primary/90 transition-colors",children:" "})]})}),i.jsx("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft",children:i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-slate-900 font-bold text-sm mb-1",children:" "}),i.jsx("p",{className:"text-slate-500 text-xs",children:"1 1  ."})]}),i.jsx("button",{onClick:()=>o&&o(),className:"px-3 py-1.5 bg-primary text-white rounded-lg text-xs font-medium hover:bg-primary/90 transition-colors",children:" "})]})}),i.jsx("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft",children:i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-slate-900 font-bold text-sm mb-1",children:" "}),i.jsx("p",{className:"text-slate-500 text-xs",children:"1 1  ( )"})]}),i.jsx("button",{onClick:()=>o&&o(),className:"px-3 py-1.5 bg-primary text-white rounded-lg text-xs font-medium hover:bg-primary/90 transition-colors",children:" "})]})})]})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-slate-900 font-bold text-base mb-3 font-display",children:"  "}),D.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("p",{className:"text-slate-500",children:"  ."})]}):i.jsx("div",{className:"space-y-3",children:D.map(T=>i.jsx("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:i.jsx("span",{className:"material-symbols-outlined text-green-600",children:"vaccines"})}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-slate-900 font-bold text-sm mb-1",children:T.name}),i.jsxs("p",{className:"text-slate-500 text-xs",children:[w(T.date),"  ",T.hospitalName]}),i.jsxs("p",{className:"text-primary text-xs mt-1 flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-xs",children:"event"})," : ",w(T.nextDue)]})]})]}),i.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium",children:""})]})},T.id))})]})]}),a==="care"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft mb-4",children:[i.jsx("h3",{className:"text-slate-900 font-bold text-base mb-3 font-display",children:"   "}),i.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl mb-1",children:""}),i.jsx("p",{className:"text-xs text-slate-500",children:""}),i.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[_.reduce((T,B)=>T+(B.meals||0),0),""]})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl mb-1",children:""}),i.jsx("p",{className:"text-xs text-slate-500",children:""}),i.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[_.reduce((T,B)=>T+(B.water||0),0),""]})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl mb-1",children:""}),i.jsx("p",{className:"text-xs text-slate-500",children:""}),i.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[_.reduce((T,B)=>T+(B.walks||0),0),""]})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl mb-1",children:""}),i.jsx("p",{className:"text-xs text-slate-500",children:""}),i.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[_.reduce((T,B)=>T+(B.treats||0),0),""]})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl mb-1",children:""}),i.jsx("p",{className:"text-xs text-slate-500",children:""}),i.jsxs("p",{className:"text-sm font-bold text-slate-800",children:[_.reduce((T,B)=>T+(B.grooming||0),0),""]})]})]})]}),i.jsx("h3",{className:"text-slate-900 font-bold text-base mb-3 font-display",children:" "}),_.length===0?i.jsxs("div",{className:"text-center py-20",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("p",{className:"text-slate-500",children:"  ."}),i.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"   !"})]}):i.jsx("div",{className:"space-y-3",children:_.map(T=>i.jsxs("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("p",{className:"text-slate-500 text-sm font-medium",children:w(T.date)}),T.weight&&i.jsxs("span",{className:"px-2 py-1 bg-primary/10 text-primary rounded text-xs font-medium",children:[T.weight,"kg"]})]}),i.jsxs("div",{className:"flex gap-4 text-sm",children:[T.meals>0&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-slate-700",children:T.meals})]}),T.water>0&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-slate-700",children:T.water})]}),T.walks>0&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-slate-700",children:T.walks})]}),T.treats>0&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-slate-700",children:T.treats})]}),T.grooming>0&&i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-slate-700",children:T.grooming})]})]}),T.notes&&i.jsxs("p",{className:"text-slate-600 text-sm mt-3 p-2 bg-slate-50 rounded-lg",children:[" ",T.notes]})]},T.id))})]})]})]})]})]})}async function E5(t,e=7){const n=XN(t.id,e);if(!n.length)return null;const s=xn(Vt.GEMINI);if(!s)return console.warn("Gemini API  .  > API   ."),{earIssue:!1,digestionIssue:n.some(a=>a.poopCount>=3),skinIssue:!1,energyLevel:.7,fever:!1};const r=`     AI.
 ${e}   ,       JSON .

 :
{
  "health_flags": {
    "earIssue": boolean,
    "digestionIssue": boolean,
    "skinIssue": boolean,
    "energyLevel": number,  // 0~1
    "fever": boolean
  },
  "patterns": [
    "   1",
    "   2"
  ],
  "predictions": [
    " 3  1",
    " 3  2"
  ],
  "risk_changes": {
    "description": "  ",
    "trend": "up" | "down" | "stable"
  }
}

 JSON .    .`,o=` :
- : ${t.petName||t.name}
- : ${t.species==="dog"?"":t.species==="cat"?"":t.species}
- : ${t.breed||""}

 ${n.length}  :
${n.map(a=>`- ${a.date}:  ${a.mealCount||0},  ${a.waterCount||0},  ${a.walkCount||0},  ${a.poopCount||0},  ${a.weight||"?"}kg, : ${a.note||""}`).join(`
`)}

  :
1.    (: " 3  20% ", "  ")
2.  3  (: "  ", "  ")
3. health_flags 

JSON .`;try{const a=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:r},{text:o}]}]})});if(!a.ok)throw new Error(`Gemini API : ${a.status}`);const d=(await a.json()).candidates[0].content.parts[0].text.match(/\{[\s\S]*\}/);if(d){const h=JSON.parse(d[0]);return h.health_flags?{...h.health_flags,patterns:h.patterns||[],predictions:h.predictions||[],risk_changes:h.risk_changes||null}:h}throw new Error("JSON  ")}catch(a){console.error("  :",a);const l=n.reduce((h,m)=>h+(m.mealCount||0),0)/n.length,u=n.reduce((h,m)=>h+(m.walkCount||0),0)/n.length;return{earIssue:!1,digestionIssue:n.reduce((h,m)=>h+(m.poopCount||0),0)/n.length>3||n.some(h=>(h.note||"").toLowerCase().includes("")||(h.note||"").toLowerCase().includes("")),skinIssue:n.some(h=>(h.note||"").toLowerCase().includes("")||(h.note||"").toLowerCase().includes("")),energyLevel:Math.min(1,Math.max(0,u/3*.5+l/2*.5)),fever:n.some(h=>(h.note||"").toLowerCase().includes("")||(h.note||"").toLowerCase().includes(""))}}}function T5({currentTab:t,onTabChange:e,onModeSwitch:n,showModeSwitch:s,hideInDiagnosis:r=!1}){const o=[{id:"care",label:"",icon:"home"},{id:"diagnosis",label:"AI",icon:"medical_services"},{id:"hospital",label:"",icon:"local_hospital"},{id:"records",label:"",icon:"receipt_long"},{id:"mypage",label:"",icon:"person"}];return r?null:i.jsx("div",{className:"fixed bottom-0 left-0 right-0 md:left-1/2 md:-translate-x-1/2 md:w-[430px] md:bottom-2 md:rounded-b-[2.5rem] bg-white/95 backdrop-blur-sm border-t border-slate-200 z-50 overflow-hidden",children:i.jsxs("div",{className:"flex items-center h-16 px-0.5",children:[o.map(a=>i.jsxs("button",{className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${t===a.id?"text-sky-500":"text-slate-400"}`,onClick:()=>e(a.id),children:[i.jsx("span",{className:`material-symbols-outlined text-[18px] mb-0.5 ${t===a.id?"font-bold":""}`,children:a.icon}),i.jsx("span",{className:`text-[9px] font-medium ${t===a.id?"text-sky-500":"text-slate-400"}`,children:a.label})]},a.id)),s&&n&&i.jsxs("button",{className:"flex flex-col items-center justify-center flex-1 h-full transition-colors text-emerald-500 hover:text-emerald-600",onClick:n,title:"   ",children:[i.jsx("span",{className:"material-symbols-outlined text-[18px] mb-0.5",children:"swap_horiz"}),i.jsx("span",{className:"text-[9px] font-medium text-emerald-500",children:""})]})]})})}function ej({petData:t,diagnosisResult:e,symptomData:n,onClose:s,onGoToHospital:r,onGoToTreatment:o}){var E,R;const[a,l]=L.useState(!1),[u,d]=L.useState(!1),h=L.useRef(null),p=(()=>{if(!t)return{name:"",age:"",weight:"",breed:"",species:"dog"};const $=t.petName||t.name||"";let D="";if(t.age)D=t.age;else if(t.birthDate){const N=new Date(t.birthDate),O=new Date,M=O.getFullYear()-N.getFullYear(),ie=O.getMonth()-N.getMonth();M>0?D=`${M}`:ie>0?D=`${ie}`:D="1 "}const _=t.weight?`${t.weight}kg`:"",b=t.breed||"",S=t.species||"dog",I=t.sex||t.gender,C=mn(t,!1),P=t.character||null;return{name:$,age:D,weight:_,breed:b,species:S,gender:I,profileImage:C,character:P}})(),x=new Date().toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=($=>{switch($){case"high":return{text:"",color:"#ef4444",icon:"",desc:"   "};case"medium":return{text:"",color:"#f59e0b",icon:"",desc:"  "};default:return{text:"",color:"#22c55e",icon:"",desc:"   "}}})(e==null?void 0:e.emergency),A=async()=>{l(!0);try{if(typeof html2canvas>"u"){const $=w(),D=new Blob([$],{type:"text/plain;charset=utf-8"}),_=URL.createObjectURL(D),b=document.createElement("a");b.href=_,b.download=`_${(t==null?void 0:t.name)||""}_${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(_),alert("   .")}}catch($){console.error(" :",$),alert("   .")}finally{l(!1)}},w=()=>{var $,D;return`

        PetMedical.AI 


 : ${x}
  : PMD-${Date.now().toString(36).toUpperCase()}


               

 : ${p.name}
 : ${p.age}
 : ${p.weight}
 : ${p.breed}
${p.gender?` : ${p.gender==="M"?"":""}`:""}


               

  : ${(n==null?void 0:n.description)||""}
   : ${(n==null?void 0:n.duration)||""}
  : ${(($=n==null?void 0:n.symptoms)==null?void 0:$.join(", "))||" "}


               

 : ${(e==null?void 0:e.diagnosis)||" "}

${j.icon} : ${j.text} - ${j.desc}
${e!=null&&e.triage_score?` Triage Score: ${e.triage_score}/5`:""}


               

${(e==null?void 0:e.description)||"  "}


               

${((D=e==null?void 0:e.actions)==null?void 0:D.map((_,b)=>`${b+1}. ${_}`).join(`
`))||""}

${e!=null&&e.hospitalVisit?`

             

  : ${e.hospitalVisitTime||" "}
 ${j.desc}
`:""}


       AI  .
        
    .

`},y=()=>{d(!0),setTimeout(()=>{d(!1),r&&r()},1e3)};return i.jsx("div",{className:"diagnosis-report-overlay",children:i.jsxs("div",{className:"diagnosis-report-container",children:[i.jsx("button",{className:"report-close-btn",onClick:s,children:""}),i.jsxs("div",{className:"diagnosis-report-paper",ref:h,children:[i.jsxs("div",{className:"report-header",children:[i.jsx("div",{className:"report-logo",children:""}),i.jsx("h1",{children:"PetMedical.AI "}),i.jsx("p",{className:"report-subtitle",children:"AI     "})]}),i.jsxs("div",{className:"report-meta",children:[i.jsxs("span",{className:"report-date",children:[" ",x]}),i.jsxs("span",{className:"report-number",children:["No. PMD-",Date.now().toString(36).toUpperCase().slice(-6)]})]}),i.jsxs("div",{className:"report-section patient-info",children:[i.jsx("h2",{children:"  "}),i.jsxs("div",{className:"patient-grid",style:{display:"flex",alignItems:"center",gap:"16px"},children:[i.jsx("div",{className:"patient-avatar",style:{width:"72px",height:"72px",minWidth:"72px",borderRadius:"50%",overflow:"hidden",backgroundColor:"#f0f9ff",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid #e0f2fe"},children:i.jsx("img",{src:p.profileImage,alt:p.name,style:{width:"100%",height:"100%",objectFit:"cover",objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"patient-details",style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",gap:"16px",marginBottom:"8px",flexWrap:"wrap"},children:[i.jsxs("div",{className:"detail-row",style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("span",{className:"label",style:{color:"#64748b",fontSize:"13px"},children:""}),i.jsx("span",{className:"value",style:{fontWeight:"600",color:"#1e293b"},children:p.name})]}),i.jsxs("div",{className:"detail-row",style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("span",{className:"label",style:{color:"#64748b",fontSize:"13px"},children:""}),i.jsx("span",{className:"value",style:{fontWeight:"500",color:"#334155"},children:p.breed})]})]}),i.jsxs("div",{style:{display:"flex",gap:"16px",flexWrap:"wrap"},children:[i.jsxs("div",{className:"detail-row",style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("span",{className:"label",style:{color:"#64748b",fontSize:"13px"},children:""}),i.jsx("span",{className:"value",style:{fontWeight:"500",color:"#334155"},children:p.age})]}),i.jsxs("div",{className:"detail-row",style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("span",{className:"label",style:{color:"#64748b",fontSize:"13px"},children:""}),i.jsx("span",{className:"value",style:{fontWeight:"500",color:"#334155"},children:p.weight})]}),p.gender&&i.jsxs("div",{className:"detail-row",style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("span",{className:"label",style:{color:"#64748b",fontSize:"13px"},children:""}),i.jsx("span",{className:"value",style:{fontWeight:"500",color:"#334155"},children:p.gender==="M"?"":""})]})]})]})]})]}),i.jsxs("div",{className:"report-section symptoms-summary",children:[i.jsx("h2",{children:"  "}),(n==null?void 0:n.department)&&i.jsxs("p",{className:"symptom-duration",style:{marginBottom:"8px"},children:[" : ",n.department]}),((E=n==null?void 0:n.selectedSymptoms)==null?void 0:E.length)>0&&i.jsxs("div",{style:{marginBottom:"8px"},children:[i.jsx("span",{style:{fontWeight:"bold",fontSize:"14px"},children:" : "}),n.selectedSymptoms.map(($,D)=>i.jsx("span",{style:{display:"inline-block",background:"#e0f2fe",color:"#0369a1",padding:"4px 8px",borderRadius:"8px",margin:"2px",fontSize:"12px"},children:$},D))]}),((n==null?void 0:n.userDescription)||(n==null?void 0:n.description))&&i.jsx("p",{className:"symptom-description",children:(n==null?void 0:n.userDescription)||(n==null?void 0:n.description)}),(n==null?void 0:n.duration)&&i.jsxs("p",{className:"symptom-duration",children:["  : ",n.duration]})]}),i.jsxs("div",{className:"report-section diagnosis-main",children:[i.jsx("h2",{children:"  "}),i.jsx("div",{className:"diagnosis-box",children:i.jsx("p",{className:"diagnosis-name",children:(e==null?void 0:e.diagnosis)||"  "})}),i.jsxs("div",{className:"emergency-row",children:[i.jsxs("div",{className:"emergency-badge-report",style:{backgroundColor:j.color},children:[j.icon," ",j.text]}),i.jsx("span",{className:"emergency-desc",children:j.desc})]}),(e==null?void 0:e.triage_score)!==void 0&&i.jsxs("div",{className:"triage-section",children:[i.jsx("span",{className:"triage-label",children:" "}),i.jsxs("div",{className:"triage-visual",children:[i.jsx("div",{className:"triage-bar",children:[1,2,3,4,5].map($=>i.jsx("div",{className:`triage-dot ${$<=e.triage_score?"active":""}`,style:{backgroundColor:$<=e.triage_score?e.triage_score>=4?"#ef4444":e.triage_score>=3?"#f59e0b":"#22c55e":"#e5e7eb"}},$))}),i.jsxs("span",{className:"triage-score",children:[e.triage_score,"/5"]})]})]})]}),(e==null?void 0:e.description)&&i.jsxs("div",{className:"report-section description-section",children:[i.jsx("h2",{children:"  "}),i.jsx("p",{children:e.description})]}),i.jsxs("div",{className:"report-section actions-section",children:[i.jsx("h2",{children:"  "}),i.jsx("ul",{className:"actions-list",children:(R=e==null?void 0:e.actions)==null?void 0:R.map(($,D)=>i.jsxs("li",{children:[i.jsx("span",{className:"action-number",children:D+1}),i.jsx("span",{children:$})]},D))})]}),(e==null?void 0:e.hospitalVisit)&&i.jsxs("div",{className:"report-section hospital-notice",children:[i.jsx("h2",{children:"   "}),i.jsxs("div",{className:"hospital-time-box",children:[i.jsx("span",{className:"time-icon",children:""}),i.jsxs("span",{className:"time-text",children:[i.jsx("strong",{children:e.hospitalVisitTime||" "}),"   "]})]})]}),i.jsxs("div",{className:"report-footer",children:[i.jsx("div",{className:"footer-divider"}),i.jsxs("p",{className:"disclaimer",children:["   AI  , .",i.jsx("br",{}),"     ."]}),i.jsxs("div",{className:"footer-logo",children:[i.jsx("span",{children:""})," PetMedical.AI"]})]})]}),i.jsxs("div",{className:"report-actions",children:[i.jsx("button",{className:"report-action-btn save",onClick:A,disabled:a,children:a?" ...":"  "}),i.jsx("button",{className:"report-action-btn send",onClick:y,disabled:u,children:u?" ...":"  "}),i.jsx("button",{className:"report-action-btn treatment",onClick:o,children:"  "})]})]})})}const Py=new vs,A5=()=>{const t=navigator.userAgent||navigator.vendor||window.opera;return/KAKAOTALK|FBAN|FBAV|Instagram|Line|NAVER|Daum/i.test(t)||t.indexOf("wv")>-1||/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(t)},$r={async register(t,e,n,s="guardian"){try{const o=(await tC(Zn,t,e)).user;return await rC(o,{displayName:n}),await wn.saveUser(o.uid,{email:o.email,displayName:n,userMode:s,createdAt:new Date().toISOString()}),{success:!0,user:{uid:o.uid,email:o.email,displayName:n,userMode:s,roles:[],defaultClinicId:null}}}catch(r){console.error(" :",r);let o=" .";return r.code==="auth/email-already-in-use"?o="   .":r.code==="auth/weak-password"?o=" 6  .":r.code==="auth/invalid-email"&&(o="   ."),{success:!1,error:o}}},async login(t,e){try{const s=(await nC(Zn,t,e)).user,o=(await wn.getUser(s.uid)).data||{};return{success:!0,user:{uid:s.uid,email:s.email,displayName:s.displayName||o.displayName,userMode:o.userMode||"guardian",roles:o.roles||[],defaultClinicId:o.defaultClinicId||null}}}catch(n){console.error(" :",n.code,n.message);let s=" .";return n.code==="auth/user-not-found"?s="  .   .":n.code==="auth/wrong-password"?s="  .":n.code==="auth/invalid-credential"?s=`    .
    .`:n.code==="auth/invalid-email"?s="   .":n.code==="auth/user-disabled"?s=" .  .":n.code==="auth/too-many-requests"&&(s="   .    ."),{success:!1,error:s}}},async loginWithGoogle(t="guardian"){var e,n,s;try{if(A5()){const r=window.location.href;return/android/i.test(navigator.userAgent)?window.location.href=`intent://${r.replace(/^https?:\/\//,"")}#Intent;scheme=https;package=com.android.chrome;end`:/iPhone|iPad|iPod/i.test(navigator.userAgent)&&(window.location.href=r),{success:!1,error:`     .

 (Safari, Chrome) .

  (  )  "  "`,isEmbeddedBrowser:!0}}try{console.log("   ");const r=window.onerror;window.onerror=(o,a,l,u,d)=>o!=null&&o.includes("Cross-Origin-Opener-Policy")||o!=null&&o.includes("window.closed")?(console.warn("[Google Login] COOP  :",o),!0):r?r(o,a,l,u,d):!1;try{const o=await EC(Zn,Py);window.onerror=r;const a=o.user;let l={};try{const u=await wn.getUser(a.uid);l=u.data||{},u.data||await wn.saveUser(a.uid,{email:a.email,displayName:a.displayName,photoURL:a.photoURL,userMode:t,createdAt:new Date().toISOString()})}catch(u){console.warn("Firestore  ():",u)}return{success:!0,user:{uid:a.uid,email:a.email,displayName:a.displayName,photoURL:a.photoURL,userMode:l.userMode||t,roles:l.roles||[],defaultClinicId:l.defaultClinicId||null}}}catch(o){throw window.onerror=r,o}}catch(r){return console.error("  :",r),r.code==="auth/popup-blocked"||r.code==="auth/popup-closed-by-user"||(e=r.message)!=null&&e.includes("Cross-Origin-Opener-Policy")||(n=r.message)!=null&&n.includes("window.close")||(s=r.message)!=null&&s.includes("window.closed")?(console.log("[Google Login]  ,   "),sessionStorage.setItem("pendingUserMode",t),await OC(Zn,Py),{success:!1,redirecting:!0}):{success:!1,error:"  : "+r.message}}}catch(r){return console.error("  :",r),{success:!1,error:"  : "+r.message}}},async handleRedirectResult(){try{const t=await LC(Zn);if(t){const e=t.user,n=sessionStorage.getItem("pendingUserMode")||"guardian";sessionStorage.removeItem("pendingUserMode");let s={};try{const r=await wn.getUser(e.uid);s=r.data||{},r.data||await wn.saveUser(e.uid,{email:e.email,displayName:e.displayName,photoURL:e.photoURL,userMode:n,createdAt:new Date().toISOString()})}catch(r){console.warn("Firestore   (  ):",r)}return{success:!0,user:{uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,userMode:s.userMode||n,roles:s.roles||[],defaultClinicId:s.defaultClinicId||null}}}return{success:!1,noResult:!0}}catch(t){return console.error("   :",t),{success:!1,error:"     ."}}},async sendPasswordReset(t){try{return await eC(Zn,t),{success:!0}}catch(e){console.error("  :",e);let n="    .";return e.code==="auth/user-not-found"?n="  .":e.code==="auth/invalid-email"&&(n="   ."),{success:!1,error:n}}},async logout(){try{return await lC(Zn),{success:!0}}catch(t){return console.error(" :",t),{success:!1,error:" ."}}},async updateUserMode(t,e){try{return await wn.saveUser(t,{userMode:e}),{success:!0}}catch(n){return console.error("  :",n),{success:!1,error:n}}},getCurrentUser(){return Zn.currentUser},onAuthStateChange(t){return aC(Zn,async e=>{if(e){const s=(await wn.getUser(e.uid)).data||{};t({uid:e.uid,email:e.email,displayName:e.displayName||s.displayName,photoURL:e.photoURL,userMode:s.userMode||"guardian",roles:s.roles||[],defaultClinicId:s.defaultClinicId||null})}else t(null)})}},tj="6a6433ff3ccbbc31a0448cae49055e4d",C5="jNNfgEPny8kfcQ6NLBtGmegCRa558c4m",nj=window.location.origin+window.location.pathname,P5=(t="guardian")=>new Promise(async(e,n)=>{try{sessionStorage.removeItem("pendingKakaoLogin"),sessionStorage.removeItem("pendingUserMode"),sessionStorage.setItem("pendingUserMode",t),sessionStorage.setItem("pendingKakaoLogin","true");const s=`https://kauth.kakao.com/oauth/authorize?client_id=${tj}&redirect_uri=${encodeURIComponent(nj)}&response_type=code`;console.log("  :",s),window.location.href=s,e({success:!1,redirecting:!0})}catch(s){console.error("   :",s),n({success:!1,error:"    ."})}}),R5=()=>new Promise(async(t,e)=>{var n,s,r,o,a;try{if(!sessionStorage.getItem("pendingKakaoLogin")){t({success:!1,noPending:!0});return}const u=new URLSearchParams(window.location.search),d=u.get("code"),h=u.get("error"),m=u.get("error_description");if(h){sessionStorage.removeItem("pendingKakaoLogin"),sessionStorage.removeItem("pendingUserMode"),window.history.replaceState({},document.title,window.location.pathname),e({success:!1,error:m||"  ."});return}if(d){window.history.replaceState({},document.title,window.location.pathname);try{const p=await fetch("https://kauth.kakao.com/oauth/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"},body:new URLSearchParams({grant_type:"authorization_code",client_id:tj,client_secret:C5,redirect_uri:nj,code:d})});if(!p.ok){const E=await p.json();throw new Error(E.error_description||"  ")}const v=(await p.json()).access_token,j=await fetch("https://kapi.kakao.com/v2/user/me",{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"}});if(!j.ok)throw new Error("   ");const A=await j.json(),w=sessionStorage.getItem("pendingUserMode")||"guardian";sessionStorage.removeItem("pendingKakaoLogin"),sessionStorage.removeItem("pendingUserMode");const y={uid:`kakao_${A.id}`,email:((n=A.kakao_account)==null?void 0:n.email)||`kakao_${A.id}@kakao.com`,displayName:((r=(s=A.kakao_account)==null?void 0:s.profile)==null?void 0:r.nickname)||" ",photoURL:((a=(o=A.kakao_account)==null?void 0:o.profile)==null?void 0:a.profile_image_url)||null,provider:"kakao",kakaoId:A.id,userMode:w};t({success:!0,user:y})}catch(p){sessionStorage.removeItem("pendingKakaoLogin"),sessionStorage.removeItem("pendingUserMode"),console.error("   :",p),e({success:!1,error:p.message||"   ."})}return}sessionStorage.removeItem("pendingKakaoLogin"),t({success:!1,noCode:!0})}catch(l){sessionStorage.removeItem("pendingKakaoLogin"),sessionStorage.removeItem("pendingUserMode"),console.error("    :",l),e({success:!1,error:"Kakao   ."})}}),sj=(t=new Date)=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${s}`};async function Ba(t){try{const e=Te(ge(re,"clinicStaff"),me("userId","==",t),me("isActive","==",!0)),n=await Re(e);if(n.empty)return[];const s=[];for(const r of n.docs){const o=r.data(),a=await En(ct(re,"clinics",o.clinicId));a.exists()&&s.push({...a.data(),staffRole:o.role,staffId:r.id})}return s}catch(e){throw console.error("   :",e),e}}async function O5(t){try{const n=sj(new Date),s=await En(ct(re,"clinics",t)),r=s.exists()?s.data():null,o=r==null?void 0:r.name,a=Te(ge(re,"bookings"),me("clinicId","==",t),me("date","==",n),Wt("time","asc"));let l=null;o&&(l=Te(ge(re,"bookings"),me("clinicName","==",o),me("date","==",n)));let u=null;r!=null&&r.animalHospitalId&&(u=Te(ge(re,"bookings"),me("animalHospitalId","==",r.animalHospitalId),me("date","==",n)));const d=[Re(a)];l&&d.push(Re(l)),u&&d.push(Re(u));const h=await Promise.all(d),m=new Map;for(const x of h)for(const v of x.docs)m.has(v.id)||m.set(v.id,v);const p=[];for(const x of m.values()){const v=x.data();let j=null;v.petId&&(j=await En(ct(re,"pets",v.petId)));let A=null;v.userId&&(A=await En(ct(re,"users",v.userId))),p.push({id:x.id,...v,pet:j!=null&&j.exists()?j.data():v.pet||v.petProfile||null,owner:A!=null&&A.exists()?A.data():v.owner||null})}return p.sort((x,v)=>{const j=x.time||"00:00",A=v.time||"00:00";return j.localeCompare(A)}),p}catch(e){throw console.error("   :",e),e}}async function M5(t,e,n){try{const s=`${e}-${String(n).padStart(2,"0")}-01`,r=n===12?`${e+1}-01-01`:`${e}-${String(n+1).padStart(2,"0")}-01`,o=await En(ct(re,"clinics",t)),a=o.exists()?o.data():null,l=a==null?void 0:a.name,u=Te(ge(re,"bookings"),me("clinicId","==",t),me("date",">=",s),me("date","<",r),Wt("date","asc"),Wt("time","asc"));let d=null;l&&(d=Te(ge(re,"bookings"),me("clinicName","==",l),me("date",">=",s),me("date","<",r)));let h=null;a!=null&&a.animalHospitalId&&(h=Te(ge(re,"bookings"),me("animalHospitalId","==",a.animalHospitalId),me("date",">=",s),me("date","<",r)));const m=[Re(u)];d&&m.push(Re(d)),h&&m.push(Re(h));const p=await Promise.all(m),x=new Map;for(const j of p)for(const A of j.docs)x.has(A.id)||x.set(A.id,A);const v=Array.from(x.values()).map(j=>({id:j.id,...j.data()}));return v.sort((j,A)=>{const w=(j.date||"").localeCompare(A.date||"");return w!==0?w:(j.time||"00:00").localeCompare(A.time||"00:00")}),v}catch(s){throw console.error("   :",s),s}}async function L5(t,e={}){try{let n=Te(ge(re,"clinicPatients"),me("clinicId","==",t));return e.orderBy?n=Te(n,Wt(e.orderBy,"desc")):n=Te(n,Wt("lastVisitDate","desc")),e.limit&&(n=Te(n,Wn(e.limit))),(await Re(n)).docs.map(r=>({id:r.id,...r.data()}))}catch(n){throw console.error("   :",n),n}}async function V5(t){try{const e=sj(),n=e.substring(0,7),s=Te(ge(re,"bookings"),me("clinicId","==",t),me("date","==",e)),r=await Re(s),o=Te(ge(re,"clinicResults"),me("clinicId","==",t),me("visitDate",">=",`${n}-01`)),a=await Re(o),l=Te(ge(re,"clinicPatients"),me("clinicId","==",t)),u=await Re(l),d=Te(ge(re,"vaccinations"),me("clinicId","==",t),me("status","==","scheduled"),me("scheduledDate",">=",e)),h=await Re(d);return{todayBookings:r.size,monthlyVisits:a.size,totalPatients:u.size,upcomingVaccinations:h.size}}catch(e){throw console.error("  :",e),e}}async function $5(t){try{return{success:!0,clinicId:(await en(ge(re,"clinics"),{name:t.name,address:t.address||null,phone:t.phone||null,licenseNumber:t.licenseNumber||null,verified:!1,isActive:!0,createdAt:hn(),updatedAt:hn()})).id}}catch(e){return console.error("  :",e),{success:!1,error:e}}}async function F5(t,e,n="director"){try{return{success:!0,staffId:(await en(ge(re,"clinicStaff"),{clinicId:t,userId:e,role:n,isActive:!0,joinedAt:hn(),updatedAt:hn()})).id}}catch(s){return console.error("  :",s),{success:!1,error:s}}}async function rj(t,e){try{const n=await $5(e);if(!n.success)throw new Error("  ");const s=n.clinicId,r=await F5(s,t,"director");if(!r.success)throw new Error("  ");return await nl(ct(re,"users",t),{roles:[{clinicId:s,role:"director"}],defaultClinicId:s,updatedAt:hn()}),{success:!0,clinicId:s,staffId:r.staffId}}catch(n){return console.error("  :",n),{success:!1,error:n}}}async function D5(t,e){try{const n=await Ba(t);if(n.length>0)return console.log(" clinicStaff  :",n.length),{success:!0,alreadyMigrated:!0,clinics:n};const s=e.clinicInfo||{name:e.displayName?`${e.displayName} `:" ",address:null,phone:null,licenseNumber:null};console.log("    :",t,s);const r=await rj(t,s);return r.success&&console.log(" :",r.clinicId),r}catch(n){return console.error("    :",n),{success:!1,error:n}}}const U5=$r.logout;function B5({onLogin:t,onGoToRegister:e,onSkipLogin:n}){const[s,r]=L.useState({email:"",password:""}),[o,a]=L.useState("guardian"),[l,u]=L.useState(""),[d,h]=L.useState(!1),[m,p]=L.useState(!1),[x,v]=L.useState(!1),[j,A]=L.useState(""),[w,y]=L.useState(!1);L.useEffect(()=>{(async()=>{const b=sessionStorage.getItem("pendingUserMode"),S=sessionStorage.getItem("pendingKakaoLogin");if(!(!b&&!S)){h(!0);try{if(b){const I=b,C=await $r.handleRedirectResult();if(C.success){sessionStorage.removeItem("pendingUserMode"),t({...C.user,userMode:I}),h(!1);return}}if(S)try{const I=await R5();if(I.success){try{await wn.saveUser(I.user.uid,{email:I.user.email,displayName:I.user.displayName,photoURL:I.user.photoURL,provider:"kakao",userMode:I.user.userMode,createdAt:new Date().toISOString()})}catch(C){console.warn("Firestore   (  ):",C)}t(I.user)}}catch(I){I.error&&u(I.error),console.error("    :",I)}}catch(I){console.error("   :",I)}h(!1)}})()},[t]);const E=async _=>{_.preventDefault(),u(""),h(!0);const b=await $r.login(s.email,s.password);b.success?(await $r.updateUserMode(b.user.uid,o),t({...b.user,userMode:o})):u(b.error),h(!1)},R=async _=>{if(_.preventDefault(),!j){u(" .");return}u(""),h(!0);const b=await $r.sendPasswordReset(j);b.success?y(!0):u(b.error),h(!1)},$=async()=>{u(""),h(!0);const _=await $r.loginWithGoogle(o);if(_.success)t({..._.user,userMode:o});else{if(_.redirecting)return;_.isEmbeddedBrowser,u(_.error)}h(!1)},D=async()=>{u(""),h(!0);try{const _=await P5(o);if(_.success){try{await wn.saveUser(_.user.uid,{email:_.user.email,displayName:_.user.displayName,photoURL:_.user.photoURL,provider:"kakao",userMode:o,createdAt:new Date().toISOString()})}catch(b){console.warn("Firestore   (  ):",b)}t({..._.user,userMode:o})}else{if(_.redirecting)return;u(_.error||"  .")}}catch(_){console.error("  :",_),u(_.error||"  .")}h(!1)};return i.jsxs("div",{className:"min-h-screen bg-background-light flex flex-col items-center justify-center p-6 pt-12",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"w-20 h-20 bg-white rounded-2xl shadow-lg mx-auto mb-4 flex items-center justify-center",children:i.jsx("span",{className:"text-4xl",children:""})}),i.jsx("h1",{className:"text-2xl font-bold text-slate-900 font-display",children:"PetMedical.AI"}),i.jsx("p",{className:"text-slate-500 mt-1 text-sm",children:"AI     "})]}),i.jsx("div",{className:"w-full max-w-sm mb-6",children:i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{type:"button",onClick:()=>a("guardian"),className:`flex-1 py-5 px-4 rounded-xl bg-white shadow-md transition-all flex flex-col items-center gap-3 ${o==="guardian"?"ring-2 ring-sky-500 bg-sky-50":"hover:shadow-lg"}`,children:[i.jsx("img",{src:"/icon/login/main_friend.png",alt:"",className:"w-16 h-16 object-contain"}),i.jsx("span",{className:"font-bold text-slate-800",children:""}),i.jsx("span",{className:"text-xs text-slate-500",children:"  "})]}),i.jsxs("button",{type:"button",onClick:()=>a("clinic"),className:`flex-1 py-5 px-4 rounded-xl bg-white shadow-md transition-all flex flex-col items-center gap-3 ${o==="clinic"?"ring-2 ring-sky-500 bg-sky-50":"hover:shadow-lg"}`,children:[i.jsx("img",{src:"/icon/login/main_hospital.png",alt:"",className:"w-16 h-16 object-contain"}),i.jsx("span",{className:"font-bold text-slate-800",children:""}),i.jsx("span",{className:"text-xs text-slate-500",children:"   "})]})]})}),i.jsxs("div",{className:"w-full max-w-sm",children:[m?x?i.jsx("div",{className:"space-y-4",children:w?i.jsxs("div",{className:"text-center py-6",children:[i.jsx("div",{className:"text-5xl mb-4",children:""}),i.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:" "}),i.jsxs("p",{className:"text-sm text-slate-600 mb-4",children:[j,"    ."]}),i.jsx("button",{onClick:()=>{v(!1),y(!1),A("")},className:"w-full py-3 bg-gradient-to-r from-cyan-500 to-cyan-600 text-white font-bold rounded-xl hover:from-cyan-600 hover:to-cyan-700 transition-all",children:" "})]}):i.jsxs("form",{onSubmit:R,className:"space-y-3",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("div",{className:"text-4xl mb-2",children:""}),i.jsx("h3",{className:"font-bold text-slate-800",children:" "}),i.jsx("p",{className:"text-sm text-slate-500",children:"    "})]}),i.jsx("input",{type:"email",placeholder:" ",value:j,onChange:_=>A(_.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-cyan-500 bg-white",required:!0}),i.jsx("button",{type:"submit",disabled:d,className:"w-full py-4 bg-gradient-to-r from-cyan-500 to-cyan-600 text-white font-bold rounded-xl hover:from-cyan-600 hover:to-cyan-700 transition-all disabled:opacity-50",children:d?" ...":"  "}),i.jsx("button",{type:"button",onClick:()=>{v(!1),u("")},className:"w-full py-2 text-slate-500 text-sm hover:text-slate-700",children:" "})]})}):i.jsxs("form",{onSubmit:E,className:"space-y-3",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-800",children:" "}),i.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"  "})]}),i.jsx("div",{children:i.jsx("input",{type:"email",placeholder:"",value:s.email,onChange:_=>r({...s,email:_.target.value}),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-sky-500 bg-white",required:!0})}),i.jsx("div",{children:i.jsx("input",{type:"password",placeholder:"",value:s.password,onChange:_=>r({...s,password:_.target.value}),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-sky-500 bg-white",required:!0})}),i.jsx("button",{type:"submit",disabled:d,className:"w-full py-4 bg-gradient-to-r from-cyan-500 to-cyan-600 text-white font-bold rounded-xl hover:from-cyan-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-cyan-500/30",children:d?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):""}),i.jsxs("div",{className:"flex justify-between items-center pt-2",children:[i.jsx("button",{type:"button",onClick:()=>{p(!1),u("")},className:"text-slate-500 text-sm hover:text-slate-700",children:"   "}),i.jsx("button",{type:"button",onClick:()=>{v(!0),u("")},className:"text-cyan-600 text-sm hover:underline font-medium",children:" "})]}),i.jsxs("div",{className:"text-center pt-2 border-t border-slate-200 mt-4",children:[i.jsx("span",{className:"text-slate-500 text-sm",children:" ? "}),i.jsx("button",{type:"button",onClick:e,className:"text-cyan-600 font-bold text-sm hover:underline",children:""})]})]}):i.jsx("button",{onClick:()=>p(!0),disabled:d,className:"w-full py-4 bg-gradient-to-r from-cyan-500 to-cyan-600 text-white font-bold rounded-xl hover:from-cyan-600 hover:to-cyan-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-cyan-500/30",children:d?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):" "}),l&&i.jsxs("div",{className:"mt-4 bg-red-50 text-red-600 text-sm p-3 rounded-lg flex items-start gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-sm mt-0.5",children:"error"}),i.jsx("span",{className:"whitespace-pre-line",children:l})]}),!m&&i.jsxs("div",{className:"mt-6",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-0 flex items-center",children:i.jsx("div",{className:"w-full border-t border-slate-300"})}),i.jsx("div",{className:"relative flex justify-center text-sm",children:i.jsx("span",{className:"px-3 bg-gradient-to-b from-cyan-50 to-blue-50 text-slate-500",children:""})})]}),i.jsxs("div",{className:"mt-4 flex gap-3",children:[i.jsxs("button",{onClick:D,disabled:d,className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl bg-[#FEE500] hover:bg-[#FDD835] transition-colors disabled:opacity-50 font-medium",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsx("span",{className:"text-slate-900 font-bold",children:""})]}),i.jsxs("button",{onClick:$,disabled:d,className:"flex-1 flex items-center justify-center gap-2 py-3 border border-slate-300 rounded-xl bg-white hover:bg-slate-50 transition-colors disabled:opacity-50",children:[i.jsx("span",{className:"text-lg font-bold text-blue-500",children:"G"}),i.jsx("span",{className:"font-bold text-slate-700",children:""})]})]})]}),!m&&!x&&i.jsxs("div",{className:"mt-8 text-center",children:[i.jsx("span",{className:"text-slate-500 text-sm",children:" ? "}),i.jsx("button",{onClick:e,className:"text-sky-600 font-bold text-sm hover:underline",children:""})]}),n&&i.jsx("div",{className:"mt-4",children:i.jsxs("button",{onClick:n,className:"w-full py-3 bg-white/80 text-cyan-700 font-medium rounded-xl hover:bg-white transition-all flex items-center justify-center gap-2 border border-cyan-200 shadow-sm",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"rocket_launch"}),"   "]})})]})]})}function z5({onRegister:t,onGoToLogin:e}){const[n,s]=L.useState(1),[r,o]=L.useState({userMode:"",name:"",email:"",password:"",passwordConfirm:"",phone:"",gender:"",birthYear:"",clinicName:"",clinicAddress:"",clinicPhone:"",licenseNumber:"",agreeTerms:!1,agreePrivacy:!1,agreeMarketing:!1}),[a,l]=L.useState(""),[u,d]=L.useState(!1),[h,m]=L.useState(null),p=()=>!r.name||r.name.length<2?(l(" 2  ."),!1):!r.email||!r.email.includes("@")?(l("  ."),!1):!r.password||r.password.length<6?(l(" 6  ."),!1):r.password!==r.passwordConfirm?(l("  ."),!1):r.userMode==="clinic"&&(!r.clinicName||r.clinicName.length<2)?(l(" ."),!1):!0,x=()=>{if(l(""),n===1){if(!r.userMode){l(" .");return}s(2)}else n===2&&p()&&s(3)},v=async()=>{if(!r.agreeTerms||!r.agreePrivacy){l("  .");return}d(!0),l("");const j=await $r.register(r.email,r.password,r.name,r.userMode);if(j.success){try{const A={phone:r.phone||null,gender:r.gender||null,ageGroup:r.birthYear||null,agreeMarketing:r.agreeMarketing};if(r.userMode==="clinic"){const w={name:r.clinicName,address:r.clinicAddress||null,phone:r.clinicPhone||null,licenseNumber:r.licenseNumber||null},y=await rj(j.user.uid,w);y.success?(A.defaultClinicId=y.clinicId,A.roles=[{clinicId:y.clinicId,role:"director"}]):console.warn("  :",y.error)}await wn.saveUser(j.user.uid,A)}catch(A){console.warn("Firestore    :",A)}m({...j.user,userMode:r.userMode}),s(4)}else l(j.error);d(!1)};return i.jsxs("div",{className:"min-h-screen bg-background-light flex flex-col items-center justify-center p-6 pt-12",children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-lg mx-auto mb-3 flex items-center justify-center",children:i.jsx("span",{className:"text-3xl",children:""})}),i.jsx("h1",{className:"text-xl font-bold text-slate-900 font-display",children:""})]}),i.jsxs("div",{className:"w-full max-w-sm mb-6",children:[i.jsx("div",{className:"flex items-center justify-center gap-2",children:[1,2,3,4].map(j=>i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${j<=n?"bg-primary text-white":"bg-slate-200 text-slate-400"}`,children:j===4&&n===4?"":j}),j<4&&i.jsx("div",{className:`w-8 h-1 ${j<n?"bg-primary":"bg-slate-200"}`})]},j))}),i.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mt-2 px-1",children:[i.jsx("span",{children:""}),i.jsx("span",{children:""}),i.jsx("span",{children:""}),i.jsx("span",{children:""})]})]}),i.jsxs("div",{className:"w-full max-w-sm bg-white rounded-2xl shadow-xl p-6",children:[n===1&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center mb-4",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"  ?"}),i.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"    "})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("button",{type:"button",onClick:()=>o({...r,userMode:"guardian"}),className:`w-full p-5 rounded-xl border-2 transition-all flex items-start gap-4 text-left ${r.userMode==="guardian"?"border-sky-500 bg-sky-50":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"}`,children:[i.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center text-3xl ${r.userMode==="guardian"?"bg-sky-100":"bg-slate-100"}`,children:""}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-bold text-slate-900",children:""}),r.userMode==="guardian"&&i.jsx("span",{className:"text-sky-500 text-sm font-bold",children:" "})]}),i.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"  , AI      ."}),i.jsxs("div",{className:"flex gap-2 mt-2",children:[i.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded",children:"AI "}),i.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded",children:""}),i.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded",children:""})]})]})]}),i.jsxs("button",{type:"button",onClick:()=>o({...r,userMode:"clinic"}),className:`w-full p-5 rounded-xl border-2 transition-all flex items-start gap-4 text-left ${r.userMode==="clinic"?"border-sky-500 bg-sky-50":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"}`,children:[i.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center text-3xl ${r.userMode==="clinic"?"bg-sky-100":"bg-slate-100"}`,children:""}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-bold text-slate-900",children:" (/)"}),r.userMode==="clinic"&&i.jsx("span",{className:"text-sky-500 text-sm font-bold",children:" "})]}),i.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"       ."}),i.jsxs("div",{className:"flex gap-2 mt-2",children:[i.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded",children:""}),i.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded",children:""}),i.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-1 rounded",children:""})]})]})]})]}),a&&i.jsxs("div",{className:"bg-red-50 text-red-600 text-sm p-3 rounded-lg flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"error"}),a]}),i.jsx("button",{onClick:x,disabled:!r.userMode,className:"w-full py-3 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:""})]}),n===2&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"text-2xl",children:r.userMode==="guardian"?"":""}),i.jsxs("span",{className:"text-sm font-medium text-slate-500",children:[r.userMode==="guardian"?"":""," "]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" *"}),i.jsx("input",{type:"text",required:!0,placeholder:"",value:r.name,onChange:j=>o({...r,name:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" *"}),i.jsx("input",{type:"email",required:!0,placeholder:"example@email.com",value:r.email,onChange:j=>o({...r,email:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" *"}),i.jsx("input",{type:"password",required:!0,placeholder:"6 ",value:r.password,onChange:j=>o({...r,password:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"  *"}),i.jsx("input",{type:"password",required:!0,placeholder:" ",value:r.passwordConfirm,onChange:j=>o({...r,passwordConfirm:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" "}),i.jsx("input",{type:"tel",placeholder:"010-1234-5678",value:r.phone,onChange:j=>o({...r,phone:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),r.userMode==="clinic"&&i.jsxs("div",{className:"pt-4 border-t border-slate-200 space-y-4",children:[i.jsxs("p",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[i.jsx("span",{children:""}),"  "]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" *"}),i.jsx("input",{type:"text",required:!0,placeholder:" ",value:r.clinicName,onChange:j=>o({...r,clinicName:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" "}),i.jsx("input",{type:"text",placeholder:"   123",value:r.clinicAddress,onChange:j=>o({...r,clinicAddress:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" "}),i.jsx("input",{type:"tel",placeholder:"02-1234-5678",value:r.clinicPhone,onChange:j=>o({...r,clinicPhone:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),i.jsx("input",{type:"text",placeholder:"123-45-67890",value:r.licenseNumber,onChange:j=>o({...r,licenseNumber:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"})]})]}),r.userMode==="guardian"&&i.jsxs("div",{className:"pt-2 border-t border-slate-200",children:[i.jsx("p",{className:"text-xs text-slate-400 mb-3",children:" "}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),i.jsxs("select",{value:r.gender,onChange:j=>o({...r,gender:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary bg-white",children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"male",children:""}),i.jsx("option",{value:"female",children:""})]})]}),i.jsxs("div",{className:"flex-1",children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),i.jsxs("select",{value:r.birthYear,onChange:j=>o({...r,birthYear:j.target.value}),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary bg-white",children:[i.jsx("option",{value:"",children:""}),i.jsx("option",{value:"10",children:"10"}),i.jsx("option",{value:"20",children:"20"}),i.jsx("option",{value:"30",children:"30"}),i.jsx("option",{value:"40",children:"40"}),i.jsx("option",{value:"50",children:"50"}),i.jsx("option",{value:"60",children:"60"}),i.jsx("option",{value:"70 ",children:"70 "})]})]})]})]}),a&&i.jsxs("div",{className:"bg-red-50 text-red-600 text-sm p-3 rounded-lg flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"error"}),a]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>s(1),className:"flex-1 py-3 bg-slate-200 text-slate-700 font-bold rounded-lg hover:bg-slate-300 transition-colors",children:""}),i.jsx("button",{onClick:x,className:"flex-1 py-3 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors",children:""})]})]}),n===3&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900",children:" "}),i.jsx("div",{className:"p-4 bg-slate-50 rounded-lg",children:i.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:r.agreeTerms&&r.agreePrivacy&&r.agreeMarketing,onChange:j=>o({...r,agreeTerms:j.target.checked,agreePrivacy:j.target.checked,agreeMarketing:j.target.checked}),className:"w-5 h-5 text-primary rounded focus:ring-primary"}),i.jsx("span",{className:"font-bold text-slate-900",children:" "})]})}),i.jsxs("div",{className:"space-y-3 pl-2",children:[i.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:r.agreeTerms,onChange:j=>o({...r,agreeTerms:j.target.checked}),className:"w-5 h-5 text-primary rounded focus:ring-primary"}),i.jsx("span",{className:"text-slate-700",children:"[]  "})]}),i.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"chevron_right"})]}),i.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:r.agreePrivacy,onChange:j=>o({...r,agreePrivacy:j.target.checked}),className:"w-5 h-5 text-primary rounded focus:ring-primary"}),i.jsx("span",{className:"text-slate-700",children:"[]   "})]}),i.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"chevron_right"})]}),i.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("input",{type:"checkbox",checked:r.agreeMarketing,onChange:j=>o({...r,agreeMarketing:j.target.checked}),className:"w-5 h-5 text-primary rounded focus:ring-primary"}),i.jsx("span",{className:"text-slate-700",children:"[]    "})]}),i.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"chevron_right"})]})]}),a&&i.jsxs("div",{className:"bg-red-50 text-red-600 text-sm p-3 rounded-lg flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"error"}),a]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>s(2),className:"flex-1 py-3 bg-slate-200 text-slate-700 font-bold rounded-lg hover:bg-slate-300 transition-colors",children:""}),i.jsx("button",{onClick:v,disabled:u,className:"flex-1 py-3 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:u?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})," ..."]}):""})]})]}),n===4&&i.jsxs("div",{className:"text-center py-6",children:[i.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full mx-auto mb-4 flex items-center justify-center",children:i.jsx("span",{className:"material-symbols-outlined text-green-600 text-4xl",children:"check_circle"})}),i.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:" !"}),i.jsxs("p",{className:"text-slate-500 mb-2",children:[", ",r.name,"!"]}),i.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-100 rounded-full mb-6",children:[i.jsx("span",{className:"text-lg",children:r.userMode==="guardian"?"":""}),i.jsxs("span",{className:"text-sm font-medium text-slate-700",children:[r.userMode==="guardian"?"":""," "]})]}),i.jsx("p",{className:"text-slate-500 text-sm mb-6",children:r.userMode==="guardian"?"    .":"        ."}),i.jsx("button",{onClick:()=>t(h),className:"w-full py-3 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors",children:""})]}),n<4&&i.jsxs("div",{className:"mt-6 text-center",children:[i.jsx("p",{className:"text-slate-500 text-sm",children:"  ?"}),i.jsx("button",{onClick:e,className:"text-primary font-medium hover:underline mt-1",children:""})]})]})]})}const H5=t=>new Promise((e,n)=>{const s=new FileReader;s.onload=()=>{const r=s.result.split(",")[1];e(r)},s.onerror=n,s.readAsDataURL(t)});async function q5(t,e="auto",n="image/jpeg"){const s=xn(Vt.GEMINI);if(!s)return console.warn("Gemini API  .  > API   ."),K5(e);const r=W5(e);try{const o=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{inline_data:{mime_type:n,data:t}},{text:r}]}],generationConfig:{temperature:.1,maxOutputTokens:4096}})});if(!o.ok)throw new Error(`Gemini API : ${o.status}`);const l=(await o.json()).candidates[0].content.parts[0].text,u=l.match(/\{[\s\S]*\}/);return u?{success:!0,data:JSON.parse(u[0]),rawText:l}:{success:!1,error:"JSON  ",rawText:l}}catch(o){return console.error("OCR  :",o),{success:!1,error:o.message}}}function W5(t){const e=`    OCR .
    JSON .

 :
1.      
2.   YYYY-MM-DD 
3.    ( )
4. , ,   
5.    " " 

`,n={receipt:`  :
{
  "documentType": "receipt",
  "hospital": {
    "name": "",
    "address": "",
    "phone": "",
    "businessNumber": ""
  },
  "patient": {
    "petName": "()",
    "species": "",
    "ownerName": ""
  },
  "visitDate": "YYYY-MM-DD",
  "items": [
    {
      "category": "  (/// )",
      "name": "",
      "quantity": ,
      "unitPrice": ,
      "amount": 
    }
  ],
  "summary": {
    "subtotal": ,
    "discount": ,
    "total": ,
    "paid": ,
    "paymentMethod": ""
  },
  "notes": ""
}`,prescription:` :
{
  "documentType": "prescription",
  "hospital": {
    "name": "",
    "vetName": "",
    "licenseNumber": ""
  },
  "patient": {
    "petName": "",
    "species": "",
    "breed": "",
    "weight": "(kg)",
    "age": ""
  },
  "prescriptionDate": "YYYY-MM-DD",
  "diagnosis": "",
  "medications": [
    {
      "name": "",
      "dosage": "",
      "frequency": " ",
      "duration": " ",
      "instructions": " ",
      "warnings": ""
    }
  ],
  "nextVisit": " ",
  "notes": ""
}`,diagnosis:` :
{
  "documentType": "diagnosis",
  "hospital": {
    "name": "",
    "vetName": ""
  },
  "patient": {
    "petName": "",
    "species": "",
    "breed": "",
    "birthDate": "",
    "sex": "",
    "ownerName": ""
  },
  "visitDate": "YYYY-MM-DD",
  "chiefComplaint": "",
  "symptoms": ["1", "2"],
  "diagnosis": {
    "primary": "",
    "secondary": ["1", "2"]
  },
  "testResults": [
    {
      "testName": "",
      "result": "",
      "normalRange": "",
      "interpretation": ""
    }
  ],
  "treatment": {
    "procedures": ["1", "2"],
    "medications": ["1", "2"]
  },
  "prognosis": "",
  "followUp": " "
}`,vaccination:`  :
{
  "documentType": "vaccination",
  "hospital": {
    "name": "",
    "vetName": ""
  },
  "patient": {
    "petName": "",
    "species": "",
    "breed": "",
    "birthDate": "",
    "microchipNumber": ""
  },
  "vaccinations": [
    {
      "vaccineName": "",
      "manufacturer": "",
      "lotNumber": "",
      "administrationDate": "",
      "nextDueDate": "  ",
      "vetSignature": "  "
    }
  ],
  "issuedDate": ""
}`,test_result:`  :
{
  "documentType": "test_result",
  "hospital": {
    "name": ""
  },
  "patient": {
    "petName": "",
    "species": ""
  },
  "testDate": "YYYY-MM-DD",
  "testType": "  (// )",
  "results": [
    {
      "item": " ",
      "value": "",
      "unit": "",
      "normalRange": "",
      "status": "//"
    }
  ],
  "interpretation": " ",
  "recommendations": ""
}`,auto:`       .
    ,     JSON .
documentType     : receipt, prescription, diagnosis, vaccination, test_result

{
  "documentType": "  ",
  ...      ...
}`};return e+(n[t]||n.auto)+`

JSON .    .`}function K5(t){const e={receipt:{documentType:"receipt",hospital:{name:" ",address:"   123",phone:"02-1234-5678",businessNumber:"123-45-67890"},patient:{petName:"",species:"",ownerName:""},visitDate:new Date().toISOString().split("T")[0],items:[{category:"",name:" ",quantity:1,unitPrice:15e3,amount:15e3},{category:"",name:"",quantity:1,unitPrice:35e3,amount:35e3},{category:"",name:"",quantity:7,unitPrice:2e3,amount:14e3}],summary:{subtotal:64e3,discount:0,total:64e3,paid:64e3,paymentMethod:""},notes:""},prescription:{documentType:"prescription",hospital:{name:" ",vetName:"",licenseNumber:"12345"},patient:{petName:"",species:"",breed:"",weight:"5.2",age:"3"},prescriptionDate:new Date().toISOString().split("T")[0],diagnosis:" ",medications:[{name:"",dosage:"250mg",frequency:"1 2",duration:"7",instructions:" ",warnings:""}],nextVisit:"",notes:""}};return{success:!0,data:e[t]||e.receipt,isDummy:!0}}function G5(t,e){var s,r,o,a,l,u,d;const n={id:`record_${Date.now()}`,petId:e,source:"ocr",createdAt:new Date().toISOString(),originalDocument:t.documentType};switch(t.documentType){case"receipt":return{...n,type:"visit",date:t.visitDate,hospital:(s=t.hospital)==null?void 0:s.name,items:t.items,totalCost:(r=t.summary)==null?void 0:r.total,notes:t.notes};case"prescription":return{...n,type:"prescription",date:t.prescriptionDate,hospital:(o=t.hospital)==null?void 0:o.name,veterinarian:(a=t.hospital)==null?void 0:a.vetName,diagnosis:t.diagnosis,medications:t.medications,nextVisit:t.nextVisit};case"diagnosis":return{...n,type:"diagnosis",date:t.visitDate,hospital:(l=t.hospital)==null?void 0:l.name,symptoms:t.symptoms,diagnosis:t.diagnosis,treatment:t.treatment,testResults:t.testResults,prognosis:t.prognosis};case"vaccination":return{...n,type:"vaccination",date:t.issuedDate,hospital:(u=t.hospital)==null?void 0:u.name,vaccinations:t.vaccinations};case"test_result":return{...n,type:"test",date:t.testDate,hospital:(d=t.hospital)==null?void 0:d.name,testType:t.testType,results:t.results,interpretation:t.interpretation};default:return{...n,type:"other",rawData:t}}}function Q5(t){const e="petMedical_records";try{const n=JSON.parse(localStorage.getItem(e)||"[]");return n.unshift(t),localStorage.setItem(e,JSON.stringify(n)),!0}catch(n){return console.error("   :",n),!1}}function J5({petData:t,onBack:e,onSaveRecord:n}){const[s,r]=L.useState(null),[o,a]=L.useState(null),[l,u]=L.useState("auto"),[d,h]=L.useState(!1),[m,p]=L.useState(null),[x,v]=L.useState(null),[j,A]=L.useState(!1),[w,y]=L.useState(null),E=L.useRef(null),R=I=>{var P;const C=(P=I.target.files)==null?void 0:P[0];if(C){if(!C.type.startsWith("image/")){v("   .");return}if(C.size>10*1024*1024){v("  10MB  .");return}r(C),a(URL.createObjectURL(C)),p(null),v(null),A(!1)}},$=async()=>{if(s){h(!0),v(null);try{const I=await H5(s),C=s.type,P=await q5(I,l,C);P.success?(p(P),y(P.data)):v(P.error||"OCR  .")}catch(I){v("   : "+I.message)}finally{h(!1)}}},D=()=>{if(!w||!t)return;const I=G5(w,t.id);Q5(I)?(n&&n(I),alert("  ."),r(null),a(null),p(null),y(null),A(!1)):v(" .")},_=I=>{I.preventDefault(),I.stopPropagation()},b=I=>{var P;I.preventDefault(),I.stopPropagation();const C=(P=I.dataTransfer.files)==null?void 0:P[0];C&&R({target:{files:[C]}})},S=(I,C)=>{y(P=>{const N=JSON.parse(JSON.stringify(P)),O=I.split(".");let M=N;for(let ie=0;ie<O.length-1;ie++)M=M[O[ie]];return M[O[O.length-1]]=C,N})};return i.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-sky-50 to-white pb-24",children:[i.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-10",children:i.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[i.jsx("button",{onClick:e,className:"p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-full transition",children:i.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),i.jsx("h1",{className:"text-lg font-bold text-slate-800",children:" "}),i.jsx("div",{className:"w-10"})]})}),i.jsxs("div",{className:"p-4 space-y-4",children:[t&&i.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-sky-100 flex items-center justify-center text-2xl",children:t.species==="dog"?"":t.species==="cat"?"":""}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-slate-800",children:t.petName||t.name}),i.jsx("div",{className:"text-sm text-slate-500",children:t.breed||" "})]})]}),i.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:" "}),i.jsxs("select",{value:l,onChange:I=>u(I.target.value),className:"w-full px-4 py-3 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-sky-400 bg-white",children:[i.jsx("option",{value:"auto",children:" "}),i.jsx("option",{value:"receipt",children:" "}),i.jsx("option",{value:"prescription",children:""}),i.jsx("option",{value:"diagnosis",children:""}),i.jsx("option",{value:"vaccination",children:" "}),i.jsx("option",{value:"test_result",children:" "})]})]}),i.jsxs("div",{className:`bg-white rounded-xl p-6 shadow-sm border-2 border-dashed transition-colors ${s?"border-sky-400 bg-sky-50/50":"border-slate-200 hover:border-sky-300"}`,onDragOver:_,onDrop:b,onClick:()=>{var I;return(I=E.current)==null?void 0:I.click()},children:[i.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:R,className:"hidden"}),o?i.jsxs("div",{className:"space-y-4",children:[i.jsx("img",{src:o,alt:"",className:"max-h-64 mx-auto rounded-lg shadow-md"}),i.jsx("p",{className:"text-center text-sm text-slate-500",children:s==null?void 0:s.name}),i.jsx("button",{onClick:I=>{I.stopPropagation(),r(null),a(null),p(null)},className:"mx-auto block text-sm text-red-500 hover:text-red-600",children:" "})]}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx("span",{className:"material-symbols-outlined text-5xl text-sky-400 mb-3 block",children:"document_scanner"}),i.jsx("p",{className:"text-slate-600 font-medium",children:"  "}),i.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"   "}),i.jsx("p",{className:"text-xs text-slate-400 mt-2",children:" : JPG, PNG, HEIC ( 10MB)"})]})]}),x&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[i.jsx("span",{className:"material-symbols-outlined text-red-500",children:"error"}),i.jsx("p",{className:"text-sm text-red-700",children:x})]}),s&&!m&&i.jsx("button",{onClick:$,disabled:d,className:"w-full py-4 bg-gradient-to-r from-sky-500 to-sky-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:d?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"AI   ..."]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"material-symbols-outlined",children:"auto_awesome"}),"AI  "]})}),m&&w&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h2",{className:"font-bold text-slate-800 flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-sky-500",children:"check_circle"})," "]}),i.jsx("button",{onClick:()=>A(!j),className:`px-3 py-1 rounded-lg text-sm font-medium transition ${j?"bg-sky-500 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:j?" ":""})]}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"description"}),Y5(w.documentType),m.isDummy&&i.jsx("span",{className:"ml-2 px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full text-xs",children:" "})]})]}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:i.jsx(X5,{data:w,editMode:j,onEdit:S})}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>{p(null),y(null)},className:"flex-1 py-3 bg-slate-100 text-slate-700 font-semibold rounded-xl hover:bg-slate-200 transition",children:" "}),i.jsxs("button",{onClick:D,className:"flex-1 py-3 bg-gradient-to-r from-sky-500 to-sky-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition flex items-center justify-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined",children:"save"})," "]})]})]}),i.jsxs("div",{className:"bg-sky-50 rounded-xl p-4 mt-4",children:[i.jsxs("h3",{className:"font-medium text-sky-800 flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"info"})," "]}),i.jsxs("ul",{className:"text-sm text-sky-700 space-y-1",children:[i.jsx("li",{children:"  , ,   "}),i.jsx("li",{children:"      "}),i.jsx("li",{children:" AI    "}),i.jsx("li",{children:"     "})]})]})]})]})}function Y5(t){return{receipt:" ",prescription:"",diagnosis:"",vaccination:" ",test_result:" "}[t]||" "}function X5({data:t,editMode:e,onEdit:n}){var s;return t?i.jsxs("div",{className:"divide-y divide-slate-100",children:[t.hospital&&i.jsxs(ps,{title:" ",icon:"local_hospital",children:[i.jsx(Qt,{label:"",value:t.hospital.name,editMode:e,onEdit:r=>n("hospital.name",r)}),t.hospital.address&&i.jsx(Qt,{label:"",value:t.hospital.address,editMode:e,onEdit:r=>n("hospital.address",r)}),t.hospital.phone&&i.jsx(Qt,{label:"",value:t.hospital.phone,editMode:e,onEdit:r=>n("hospital.phone",r)}),t.hospital.vetName&&i.jsx(Qt,{label:"",value:t.hospital.vetName,editMode:e,onEdit:r=>n("hospital.vetName",r)})]}),t.patient&&i.jsxs(ps,{title:" ",icon:"pets",children:[i.jsx(Qt,{label:"",value:t.patient.petName,editMode:e,onEdit:r=>n("patient.petName",r)}),t.patient.species&&i.jsx(Qt,{label:"",value:t.patient.species,editMode:e,onEdit:r=>n("patient.species",r)}),t.patient.breed&&i.jsx(Qt,{label:"",value:t.patient.breed,editMode:e,onEdit:r=>n("patient.breed",r)}),t.patient.ownerName&&i.jsx(Qt,{label:"",value:t.patient.ownerName,editMode:e,onEdit:r=>n("patient.ownerName",r)})]}),t.items&&t.items.length>0&&i.jsxs(ps,{title:" ",icon:"receipt_long",children:[i.jsx("div",{className:"space-y-2",children:t.items.map((r,o)=>{var a;return i.jsxs("div",{className:"flex justify-between items-center py-2 px-1 bg-slate-50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-xs text-slate-500",children:r.category}),i.jsx("p",{className:"text-sm font-medium text-slate-700",children:r.name})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("p",{className:"text-sm font-semibold text-slate-800",children:[(a=r.amount)==null?void 0:a.toLocaleString(),""]}),r.quantity>1&&i.jsxs("span",{className:"text-xs text-slate-500",children:[r.quantity,""]})]})]},o)})}),t.summary&&i.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200",children:i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-slate-500",children:" "}),i.jsxs("span",{className:"font-bold text-sky-600",children:[(s=t.summary.total)==null?void 0:s.toLocaleString(),""]})]})})]}),t.medications&&t.medications.length>0&&i.jsx(ps,{title:" ",icon:"medication",children:i.jsx("div",{className:"space-y-3",children:t.medications.map((r,o)=>i.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[i.jsx("p",{className:"font-medium text-slate-800",children:r.name}),i.jsxs("div",{className:"mt-1 text-sm text-slate-600 space-y-0.5",children:[i.jsxs("p",{children:[": ",r.dosage]}),i.jsxs("p",{children:[": ",r.frequency,", ",r.duration]}),r.instructions&&i.jsxs("p",{children:[": ",r.instructions]}),r.warnings&&i.jsxs("p",{className:"text-amber-600",children:[" ",r.warnings]})]})]},o))})}),t.diagnosis&&i.jsx(ps,{title:"",icon:"medical_information",children:typeof t.diagnosis=="string"?i.jsx(Qt,{label:"",value:t.diagnosis,editMode:e,onEdit:r=>n("diagnosis",r)}):i.jsxs(i.Fragment,{children:[i.jsx(Qt,{label:"",value:t.diagnosis.primary,editMode:e,onEdit:r=>n("diagnosis.primary",r)}),t.diagnosis.secondary&&t.diagnosis.secondary.length>0&&i.jsxs("div",{className:"mt-2",children:[i.jsx("span",{className:"text-xs text-slate-500",children:""}),i.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:t.diagnosis.secondary.map((r,o)=>i.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-600 text-sm rounded",children:r},o))})]})]})}),t.results&&t.results.length>0&&i.jsx(ps,{title:" ",icon:"biotech",children:i.jsx("div",{className:"space-y-2",children:t.results.map((r,o)=>i.jsxs("div",{className:"flex justify-between items-center py-2 px-1",children:[i.jsx("span",{className:"text-sm text-slate-600",children:r.item}),i.jsxs("div",{className:"text-right",children:[i.jsxs("span",{className:`text-sm font-medium ${r.status===""?"text-red-600":r.status===""?"text-blue-600":"text-green-600"}`,children:[r.value," ",r.unit]}),r.normalRange&&i.jsxs("p",{className:"text-xs text-slate-400",children:[": ",r.normalRange]})]})]},o))})}),t.vaccinations&&t.vaccinations.length>0&&i.jsx(ps,{title:" ",icon:"vaccines",children:i.jsx("div",{className:"space-y-3",children:t.vaccinations.map((r,o)=>i.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg",children:[i.jsx("p",{className:"font-medium text-slate-800",children:r.vaccineName}),i.jsxs("div",{className:"mt-1 text-sm text-slate-600 space-y-0.5",children:[i.jsxs("p",{children:[": ",r.administrationDate]}),r.nextDueDate&&i.jsxs("p",{children:[" : ",r.nextDueDate]}),r.manufacturer&&i.jsxs("p",{children:[": ",r.manufacturer]})]})]},o))})}),(t.visitDate||t.prescriptionDate||t.testDate||t.issuedDate)&&i.jsx(ps,{title:"",icon:"event",children:i.jsx(Qt,{label:"",value:t.visitDate||t.prescriptionDate||t.testDate||t.issuedDate,editMode:e,onEdit:r=>n(t.visitDate?"visitDate":t.prescriptionDate?"prescriptionDate":t.testDate?"testDate":"issuedDate",r)})}),(t.notes||t.interpretation||t.prognosis)&&i.jsxs(ps,{title:"",icon:"notes",children:[t.notes&&i.jsx(Qt,{label:"",value:t.notes,editMode:e,onEdit:r=>n("notes",r)}),t.interpretation&&i.jsx(Qt,{label:"",value:t.interpretation,editMode:e,onEdit:r=>n("interpretation",r)}),t.prognosis&&i.jsx(Qt,{label:"",value:t.prognosis,editMode:e,onEdit:r=>n("prognosis",r)})]})]}):null}function ps({title:t,icon:e,children:n}){return i.jsxs("div",{className:"p-4",children:[i.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2 mb-3",children:[i.jsx("span",{className:"material-symbols-outlined text-sky-500 text-lg",children:e}),t]}),n]})}function Qt({label:t,value:e,editMode:n,onEdit:s}){return e?i.jsxs("div",{className:"flex items-center justify-between py-1.5",children:[i.jsx("span",{className:"text-sm text-slate-500",children:t}),n?i.jsx("input",{type:"text",value:e,onChange:r=>s(r.target.value),className:"text-sm text-right bg-white border border-slate-200 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-sky-400 max-w-[60%]"}):i.jsx("span",{className:"text-sm font-medium text-slate-800",children:e})]}):null}const Ry="petMedical_bookings",ou="petMedical_clinicResults",Z5="petMedical_medicationFeedback";function e3({onBack:t,onLogout:e,onModeSwitch:n,onHome:s}){const[r,o]=L.useState("today"),[a,l]=L.useState([]),[u,d]=L.useState(null),[h,m]=L.useState(!1),[p,x]=L.useState(null),[v,j]=L.useState({name:" ",doctorName:""});L.useEffect(()=>{A()},[]);const A=()=>{try{const _=localStorage.getItem(Ry),b=_?JSON.parse(_):[];l(b)}catch(_){console.error("  :",_)}},w=(_,b)=>{try{const S=a.map(I=>I.id===_?{...I,status:b,updatedAt:new Date().toISOString()}:I);localStorage.setItem(Ry,JSON.stringify(S)),l(S)}catch(S){console.error("  :",S)}},y=(_,b)=>{try{const S=JSON.parse(localStorage.getItem(ou)||"[]");S.push({id:`result_${Date.now()}`,bookingId:_,...b,createdAt:new Date().toISOString(),clinic:v}),localStorage.setItem(ou,JSON.stringify(S)),w(_,"completed"),m(!1),d(null)}catch(S){console.error("  :",S)}},E=new Date().toISOString().split("T")[0],R=a.filter(_=>_.date===E),$=a.filter(_=>_.status==="pending"),D=a.filter(_=>_.status==="confirmed");return i.jsxs("div",{className:"min-h-screen bg-slate-50",children:[i.jsxs("div",{className:"bg-white border-b border-slate-200",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-4",children:[i.jsx("button",{onClick:t,className:"text-slate-600",children:i.jsx("span",{className:"text-sm",children:" "})}),i.jsxs("div",{className:"flex items-center gap-2",children:[n&&i.jsx("button",{onClick:n,className:"p-2 text-sky-500 hover:bg-sky-50 rounded-full transition",title:"  ",children:i.jsx("span",{className:"material-symbols-outlined text-xl",children:"swap_horiz"})}),i.jsx("button",{onClick:e,className:"p-2 text-slate-500 hover:bg-slate-100 rounded-full transition",title:"",children:i.jsx("span",{className:"material-symbols-outlined text-xl",children:"logout"})})]})]}),i.jsxs("div",{className:"px-4 pb-4",children:[i.jsxs("h1",{className:"text-xl font-bold text-slate-900",children:[" ",v.name]}),i.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"  "})]}),i.jsxs("div",{className:"px-4 pb-4 grid grid-cols-3 gap-3",children:[i.jsxs("div",{className:"bg-sky-50 rounded-xl p-3 text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-sky-600",children:R.length}),i.jsx("p",{className:"text-xs text-slate-500",children:" "})]}),i.jsxs("div",{className:"bg-amber-50 rounded-xl p-3 text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-amber-600",children:$.length}),i.jsx("p",{className:"text-xs text-slate-500",children:" "})]}),i.jsxs("div",{className:"bg-green-50 rounded-xl p-3 text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-green-600",children:D.length}),i.jsx("p",{className:"text-xs text-slate-500",children:""})]})]})]}),i.jsx("div",{className:"bg-white border-b border-slate-200 sticky top-0 z-10 overflow-x-auto scrollbar-hide",children:i.jsx("div",{className:"flex min-w-max",children:[{id:"today",label:" ",icon:"calendar_today"},{id:"schedule",label:" ",icon:"schedule"},{id:"monthly",label:"",icon:"calendar_month"},{id:"records",label:" ",icon:"folder_shared"},{id:"settings",label:"",icon:"settings"}].map(_=>i.jsxs("button",{onClick:()=>o(_.id),className:`flex-1 min-w-[70px] py-3 text-center text-xs font-medium transition border-b-2 ${r===_.id?"border-sky-500 text-sky-600":"border-transparent text-slate-500 hover:text-slate-700"}`,children:[i.jsx("span",{className:"material-symbols-outlined text-lg block mb-0.5",children:_.icon}),_.label]},_.id))})}),i.jsxs("div",{className:"p-4 pb-24",children:[r==="today"&&i.jsx(t3,{bookings:R,allBookings:a,onSelectBooking:_=>{d(_)},onUpdateStatus:w,onCompleteVisit:_=>{d(_),m(!0)}}),r==="schedule"&&i.jsx(s3,{bookings:a}),r==="monthly"&&i.jsx(r3,{bookings:a,selectedDay:p,onSelectDay:x,onSelectBooking:_=>{d(_)},onUpdateStatus:w}),r==="records"&&i.jsx(i3,{bookings:a}),r==="settings"&&i.jsx(a3,{clinicInfo:v,onUpdate:j})]}),u&&!h&&i.jsx(l3,{booking:u,onClose:()=>d(null),onUpdateStatus:w,onStartVisit:()=>m(!0)}),h&&u&&i.jsx(c3,{booking:u,onClose:()=>{m(!1),d(null)},onSave:_=>y(u.id,_)})]})}function t3({bookings:t,allBookings:e,onSelectBooking:n,onUpdateStatus:s,onCompleteVisit:r}){new Date().toISOString().split("T")[0];const o=[...t].sort((a,l)=>!a.time||!l.time?0:a.time.localeCompare(l.time));return o.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("span",{className:"material-symbols-outlined text-5xl text-slate-300 mb-3 block",children:"event_available"}),i.jsx("p",{className:"text-slate-500",children:"   "}),i.jsx("p",{className:"text-sm text-slate-400 mt-1",children:e.length>0?` ${e.length}  `:"  "})]}):i.jsxs("div",{className:"space-y-3",children:[i.jsxs("h2",{className:"font-bold text-slate-800 flex items-center gap-2",children:["   (",o.length,")"]}),o.map(a=>i.jsx(n3,{booking:a,onSelectBooking:n,onConfirm:()=>s(a.id,"confirmed"),onComplete:()=>r(a)},a.id))]})}function n3({booking:t,onSelectBooking:e,onConfirm:n,onComplete:s}){const r=au(t.status),o=t.petProfile||{};return i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-slate-100",children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsx("div",{className:"text-lg font-bold text-slate-900",children:t.time||" "}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${r.color}`,children:r.label})]}),i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-sky-400 to-violet-400 overflow-hidden",children:i.jsx("img",{src:mn(o||{species:o.species||"dog"},!1),alt:t.petName||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("h3",{className:"text-base font-semibold text-slate-900",children:[t.petName," ",o.breed&&`(${o.breed}, ${o.age||" "})`]}),i.jsxs("p",{className:"text-sm text-slate-500",children:[": ",t.ownerName||" ","  ",t.ownerPhone||" "]})]})]}),t.message&&i.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 mb-3",children:[i.jsx("div",{className:"text-xs text-slate-500 mb-1",children:""}),i.jsx("div",{className:"text-sm text-slate-900",children:t.message})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[i.jsxs("button",{onClick:()=>e(t),className:`p-2 rounded-lg text-xs font-semibold transition flex flex-col items-center gap-1 ${t.diagnosisId||t.aiDiagnosis?"bg-purple-50 border border-purple-200 text-purple-700 hover:bg-purple-100":"bg-white border border-slate-200 text-slate-600 hover:bg-slate-50"}`,children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"smart_toy"})," "]}),i.jsxs("button",{onClick:()=>e(t),className:"p-2 bg-white border border-slate-200 rounded-lg text-xs font-semibold text-slate-600 hover:bg-slate-50 transition flex flex-col items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"description"}),""]}),i.jsxs("button",{onClick:()=>alert("   "),className:"p-2 bg-white border border-slate-200 rounded-lg text-xs font-semibold text-slate-600 hover:bg-slate-50 transition flex flex-col items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"history"})," "]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.status==="pending"?i.jsxs("button",{onClick:a=>{a.stopPropagation(),n()},className:"py-2.5 bg-sky-500 text-white text-sm font-bold rounded-lg hover:bg-sky-600 transition flex items-center justify-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"check_circle"})," "]}):i.jsxs("button",{className:"py-2.5 bg-slate-100 text-slate-500 text-sm font-semibold rounded-lg cursor-default flex items-center justify-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"check_circle"})," "]}),i.jsxs("button",{onClick:a=>{a.stopPropagation(),s()},className:"py-2.5 bg-sky-500 text-white text-sm font-bold rounded-lg hover:bg-sky-600 transition flex items-center justify-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"play_arrow"})," "]})]})]})}function s3({bookings:t}){const e=new Date,n=new Date(e);n.setDate(e.getDate()-e.getDay());const s=Array.from({length:7},(l,u)=>{const d=new Date(n);return d.setDate(n.getDate()+u),d}),r={};t.forEach(l=>{r[l.date]||(r[l.date]=[]),r[l.date].push(l)});const o=["","","","","","",""],a=e.toISOString().split("T")[0];return i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"section-title",children:"   "}),i.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("button",{className:"bg-slate-100 p-2 rounded-lg hover:bg-slate-200 transition",children:i.jsx("span",{className:"material-symbols-outlined text-slate-600",children:"chevron_left"})}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"font-bold text-slate-900",children:[s[0].getMonth()+1," ",s[0].getDate()," - ",s[6].getMonth()+1," ",s[6].getDate(),""]}),i.jsx("div",{className:"text-xs text-slate-500 mt-1",children:" "})]}),i.jsx("button",{className:"bg-slate-100 p-2 rounded-lg hover:bg-slate-200 transition",children:i.jsx("span",{className:"material-symbols-outlined text-slate-600",children:"chevron_right"})})]})}),s.slice(0,2).map((l,u)=>{const d=l.toISOString().split("T")[0],h=(r[d]||[]).filter(p=>p.status!=="cancelled").sort((p,x)=>(p.time||"").localeCompare(x.time||"")),m=d===a;return i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsxs("div",{className:`flex flex-col items-center rounded-xl p-2 min-w-[3.5rem] shadow-md ${m?"bg-gradient-to-br from-sky-500 to-sky-600 text-white":"bg-white border-2 border-slate-200 text-slate-900"}`,children:[i.jsx("div",{className:`text-xs font-semibold ${m?"opacity-90":"text-slate-500"}`,children:o[l.getDay()]}),i.jsx("div",{className:"text-2xl font-bold",children:l.getDate()})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"font-bold text-slate-900",children:[l.getMonth()+1," ",l.getDate()," (",o[l.getDay()],")"]}),i.jsxs("div",{className:"text-sm text-slate-500",children:[m?"":"","  ",h.length,""]})]})]}),i.jsxs("div",{className:"relative pl-[4.25rem]",children:[i.jsx("div",{className:"absolute left-7 top-0 bottom-0 w-0.5 bg-gradient-to-b from-sky-200 to-sky-300"}),i.jsxs("div",{className:"space-y-3",children:[h.map((p,x)=>{var w,y;const v=p.status==="confirmed"?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200":"bg-gradient-to-br from-amber-50 to-yellow-50 border-amber-200",j=p.status==="confirmed"?"":"",A=p.status==="confirmed"?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700";return i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:`absolute left-[-2.5rem] top-2 w-3 h-3 rounded-full border-2 border-white shadow-md ${p.status==="confirmed"?"bg-sky-500":"bg-amber-500"}`}),i.jsxs("div",{className:`${v} border rounded-xl p-3.5 transition-all hover:shadow-md hover:translate-x-1`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-bold text-slate-900 text-lg",children:p.time}),i.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${A}`,children:j})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-10 h-10 bg-white rounded-full overflow-hidden shadow-sm",children:i.jsx("img",{src:mn(p.petProfile||{species:((w=p.petProfile)==null?void 0:w.species)||"dog"},!1),alt:p.petName||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold text-slate-900",children:p.petName}),i.jsxs("span",{className:"text-slate-500",children:["  ",((y=p.petProfile)==null?void 0:y.breed)||" "]})]})]})]})]},p.id)}),h.length===0&&i.jsxs("div",{className:"text-center py-8 text-slate-400",children:[i.jsx("span",{className:"material-symbols-outlined text-3xl mb-2 block",children:"event_busy"})," "]})]})]})]},d)}),i.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"info"}),i.jsx("span",{children:" : 5  "})]})})]})}function r3({bookings:t,selectedDay:e,onSelectDay:n,onSelectBooking:s,onUpdateStatus:r}){const o=new Date,a=o.getMonth(),l=o.getFullYear(),u=o.getDate(),d=new Date(l,a,1).getDay(),h=new Date(l,a+1,0).getDate(),m={};t.forEach(v=>{const j=new Date(v.date);if(j.getMonth()===a&&j.getFullYear()===l){const A=j.getDate();m[A]=(m[A]||0)+1}});const p=e?`${l}-${String(a+1).padStart(2,"0")}-${String(e).padStart(2,"0")}`:null,x=p?t.filter(v=>v.date===p):[];return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-gradient-to-br from-sky-50 to-blue-50 rounded-2xl p-6 shadow-md",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("button",{className:"bg-white p-2 rounded-lg hover:bg-sky-50 transition shadow-sm",children:i.jsx("span",{className:"material-symbols-outlined text-sky-600",children:"chevron_left"})}),i.jsxs("h2",{className:"text-xl font-bold text-sky-900",children:[l," ",a+1,""]}),i.jsx("button",{className:"bg-white p-2 rounded-lg hover:bg-sky-50 transition shadow-sm",children:i.jsx("span",{className:"material-symbols-outlined text-sky-600",children:"chevron_right"})})]}),i.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["","","","","","",""].map((v,j)=>i.jsx("div",{className:`text-center text-sm font-bold py-2 ${j===0?"text-red-600":j===6?"text-blue-600":"text-sky-900"}`,children:v},v))}),i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:d},(v,j)=>i.jsx("div",{className:"aspect-square"},`empty-${j}`)),Array.from({length:h},(v,j)=>{const A=j+1,w=A===u,y=A===e,E=m[A]||0,R=(d+j)%7,$=R===0,D=R===6;let _;return y?_="bg-gradient-to-br from-sky-500 to-sky-600 text-white shadow-md":w?_="bg-white border-2 border-sky-500 text-sky-600 shadow-sm":E>0?_="bg-white/90 border border-slate-200 text-slate-900 shadow-sm":_="bg-white/30 text-slate-400",i.jsxs("button",{onClick:()=>E>0&&n(A),className:`aspect-square rounded-xl flex flex-col items-center justify-center relative transition-all ${_} ${E>0?"hover:scale-105 cursor-pointer":"cursor-default"}`,children:[i.jsx("span",{className:`text-sm font-bold ${y||w||E>0?"":$?"text-red-400":D?"text-blue-400":""}`,children:A}),E>0&&i.jsx("span",{className:`absolute bottom-1 px-1.5 py-0.5 rounded-full text-xs font-bold ${y?"bg-white text-sky-600":"bg-gradient-to-r from-amber-500 to-orange-500 text-white"} shadow-sm`,children:E})]},A)})]})]}),e&&x.length>0&&i.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-md border-2 border-sky-500",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"font-bold text-slate-900 flex items-center gap-2",children:[i.jsxs("span",{className:"bg-gradient-to-r from-sky-500 to-sky-600 text-white px-3 py-1 rounded-lg shadow-sm",children:[e,""]}),i.jsx("span",{className:"text-slate-600 text-sm",children:" "})]}),i.jsx("button",{onClick:()=>n(null),className:"p-2 bg-slate-100 rounded-lg hover:bg-slate-200 transition",children:i.jsx("span",{className:"material-symbols-outlined text-slate-600",children:"close"})})]}),i.jsx("div",{className:"space-y-3",children:x.map(v=>{var A,w;const j=au(v.status);return i.jsxs("div",{className:`rounded-xl p-3 border transition-all cursor-pointer hover:shadow-md hover:translate-x-1 ${v.status==="confirmed"?"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200":"bg-gradient-to-br from-amber-50 to-yellow-50 border-amber-200"}`,onClick:()=>s(v),children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-bold text-slate-900",children:v.time}),i.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${j.color}`,children:j.label})]}),i.jsxs("div",{className:"flex items-center gap-2.5 mb-2",children:[i.jsx("div",{className:"w-10 h-10 bg-white rounded-full overflow-hidden shadow-sm",children:i.jsx("img",{src:mn(v.petProfile||{species:((A=v.petProfile)==null?void 0:A.species)||"dog"},!1),alt:v.petName||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"font-semibold text-slate-900 text-sm",children:[v.petName," ",i.jsxs("span",{className:"font-normal text-slate-500",children:[" ",((w=v.petProfile)==null?void 0:w.breed)||" "]})]}),i.jsxs("div",{className:"text-xs text-slate-500",children:[": ",v.ownerName||" "]})]})]}),v.message&&i.jsxs("div",{className:"bg-white rounded-lg p-2 text-xs text-slate-600",children:[i.jsx("span",{className:"font-semibold",children:":"})," ",v.message]})]},v.id)})})]}),e&&x.length===0&&i.jsxs("div",{className:"bg-white rounded-xl p-8 text-center shadow-sm",children:[i.jsx("span",{className:"material-symbols-outlined text-5xl text-slate-300 mb-2 block",children:"event_busy"}),i.jsxs("p",{className:"text-slate-500",children:[e,"  "]}),i.jsx("button",{onClick:()=>n(null),className:"mt-4 bg-slate-100 px-4 py-2 rounded-lg text-slate-600 text-sm font-medium hover:bg-slate-200 transition",children:""})]}),!e&&i.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"info"}),i.jsx("span",{children:"      "})]})})]})}function i3({bookings:t}){const e=t.reduce((n,s)=>{var r;return s.petId&&!n.find(o=>o.petId===s.petId)&&n.push({petId:s.petId,petName:s.petName,petProfile:s.petProfile,visitCount:t.filter(o=>o.petId===s.petId).length,lastVisit:(r=t.filter(o=>o.petId===s.petId).sort((o,a)=>new Date(a.date)-new Date(o.date))[0])==null?void 0:r.date}),n},[]);return e.length===0?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-5xl mb-3",children:""}),i.jsx("p",{className:"text-slate-500",children:"  "})]}):i.jsxs("div",{className:"space-y-3",children:[i.jsx("h2",{className:"font-bold text-slate-800",children:"   "}),e.map(n=>i.jsx(o3,{pet:n},n.petId))]})}function o3({pet:t}){var o,a,l;const e=((o=t.petProfile)==null?void 0:o.species)==="cat"?"":"",s=JSON.parse(localStorage.getItem(ou)||"[]").filter(u=>u.petId===t.petId),r=[];return i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-slate-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-sky-400 to-violet-400 flex items-center justify-center text-2xl",children:e}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("h3",{className:"font-bold text-slate-900",children:[t.petName," (",((a=t.petProfile)==null?void 0:a.breed)||" ",", ",((l=t.petProfile)==null?void 0:l.age)||" ",")"]}),i.jsxs("p",{className:"text-sm text-slate-500",children:[" ",t.visitCount,"   ",t.lastVisit||" "]})]})]}),i.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-4 border border-green-200 mb-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-8 h-8 bg-white rounded-lg flex items-center justify-center",children:""}),i.jsx("span",{className:"font-bold text-green-800 text-sm",children:" "})]}),i.jsxs("span",{className:"bg-green-500 text-white px-2.5 py-1 rounded-full text-xs font-bold",children:[s.length,""]})]}),s.length>0?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"text-sm text-green-700 mb-3 space-y-1",children:s.slice(0,2).map((u,d)=>i.jsxs("div",{children:[" ",new Date(u.createdAt).toLocaleDateString("ko-KR")," ",u.diagnosis]},d))}),i.jsxs("button",{className:"w-full bg-white border-2 border-green-500 text-green-700 py-2.5 rounded-xl font-bold text-sm hover:bg-green-50 transition flex items-center justify-center gap-2 shadow-sm",children:[i.jsx("span",{className:"material-symbols-outlined",children:"send"})," "]})]}):i.jsx("div",{className:"text-sm text-green-600 text-center py-2",children:"  "})]}),i.jsxs("div",{className:`rounded-xl p-4 border mb-3 ${r.length>0?"bg-gradient-to-br from-amber-50 to-yellow-50 border-amber-200":"bg-gradient-to-br from-slate-50 to-slate-100 border-slate-200 border-dashed"}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`w-8 h-8 bg-white rounded-lg flex items-center justify-center ${r.length===0&&"opacity-50"}`,children:""}),i.jsx("span",{className:`font-bold text-sm ${r.length>0?"text-amber-800":"text-slate-500"}`,children:" "})]}),r.length>0&&i.jsxs("span",{className:"bg-amber-500 text-white px-2.5 py-1 rounded-full text-xs font-bold",children:[r.length,""]})]}),i.jsx("div",{className:`text-sm text-center py-2 ${r.length>0?"text-amber-700":"text-slate-400"}`,children:"  "})]}),i.jsxs("button",{className:"w-full bg-gradient-to-r from-purple-500 to-violet-500 text-white py-3 rounded-xl font-bold text-sm hover:from-purple-600 hover:to-violet-600 transition flex items-center justify-center gap-2 shadow-md",children:[i.jsx("span",{className:"material-symbols-outlined text-xl",children:"timeline"}),"  "]})]})}function a3({clinicInfo:t,onUpdate:e}){const[n,s]=L.useState(!1),[r,o]=L.useState(t),a=()=>{e(r),s(!1)};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h2",{className:"font-bold text-slate-800 flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"settings"}),"  "]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),n?i.jsx("input",{type:"text",value:r.name,onChange:l=>o({...r,name:l.target.value}),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-400"}):i.jsx("p",{className:"text-slate-800",children:t.name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" "}),n?i.jsx("input",{type:"text",value:r.doctorName,onChange:l=>o({...r,doctorName:l.target.value}),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-400"}):i.jsx("p",{className:"text-slate-800",children:t.doctorName})]}),n?i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>s(!1),className:"flex-1 py-2 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 transition",children:""}),i.jsx("button",{onClick:a,className:"flex-1 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition",children:""})]}):i.jsx("button",{onClick:()=>s(!0),className:"w-full py-2 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 transition",children:""})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm divide-y divide-slate-100",children:[i.jsxs("button",{className:"w-full p-4 flex items-center justify-between text-left hover:bg-slate-50 transition",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"notifications"}),i.jsx("span",{className:"text-slate-700",children:" "})]}),i.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"chevron_right"})]}),i.jsxs("button",{className:"w-full p-4 flex items-center justify-between text-left hover:bg-slate-50 transition",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"calendar_month"}),i.jsx("span",{className:"text-slate-700",children:" "})]}),i.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"chevron_right"})]}),i.jsxs("button",{className:"w-full p-4 flex items-center justify-between text-left hover:bg-slate-50 transition",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"help"}),i.jsx("span",{className:"text-slate-700",children:""})]}),i.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"chevron_right"})]})]})]})}function l3({booking:t,onClose:e,onUpdateStatus:n,onStartVisit:s}){const[r,o]=L.useState(null),a=t.petProfile||{};return L.useEffect(()=>{if(t.aiDiagnosis)o(t.aiDiagnosis);else if(t.diagnosisId)try{const u=JSON.parse(localStorage.getItem("petMedical_diagnoses")||"[]").find(d=>d.id===t.diagnosisId);o(u)}catch(l){console.error("   :",l)}},[t.aiDiagnosis,t.diagnosisId]),i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end",children:i.jsxs("div",{className:"bg-white w-full rounded-t-2xl max-h-[85vh] overflow-y-auto animate-slide-up",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-100 p-4 flex items-center justify-between z-10",children:[i.jsx("h2",{className:"font-bold text-lg text-slate-800",children:" "}),i.jsx("button",{onClick:e,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-full transition",children:i.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsx("div",{className:"bg-sky-50 rounded-xl p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-16 h-16 rounded-full bg-white overflow-hidden shadow-sm",children:i.jsx("img",{src:mn(a||{species:a.species||"dog"},!1),alt:t.petName||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-bold text-lg text-sky-800",children:t.petName}),i.jsxs("p",{className:"text-sm text-sky-600",children:[": ",t.date," ",t.time]}),i.jsx("span",{className:`inline-block mt-1 px-2 py-0.5 rounded-full text-xs font-medium ${au(t.status).color}`,children:au(t.status).label})]})]})}),a&&Object.keys(a).length>1&&i.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl overflow-hidden",children:[i.jsx("div",{className:"p-3 bg-sky-50 border-b border-sky-100",children:i.jsxs("h3",{className:"font-semibold text-sky-800 flex items-center gap-2 text-sm",children:[i.jsx("span",{className:"material-symbols-outlined text-sky-500 text-lg",children:"pets"})," "]})}),i.jsxs("div",{className:"p-3 grid grid-cols-2 gap-2 text-sm",children:[a.breed&&i.jsxs("div",{children:[i.jsx("span",{className:"text-slate-500 text-xs",children:""}),i.jsx("p",{className:"font-medium text-slate-800",children:a.breed})]}),a.age&&i.jsxs("div",{children:[i.jsx("span",{className:"text-slate-500 text-xs",children:""}),i.jsx("p",{className:"font-medium text-slate-800",children:a.age})]}),a.sex&&i.jsxs("div",{children:[i.jsx("span",{className:"text-slate-500 text-xs",children:""}),i.jsxs("p",{className:"font-medium text-slate-800",children:[a.sex==="M"?"":a.sex==="F"?"":a.sex,a.neutered?" ()":""]})]}),a.weight&&i.jsxs("div",{children:[i.jsx("span",{className:"text-slate-500 text-xs",children:""}),i.jsxs("p",{className:"font-medium text-slate-800",children:[a.weight,"kg"]})]}),a.allergies&&a.allergies.length>0&&i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"text-slate-500 text-xs",children:" "}),i.jsx("p",{className:"font-medium text-red-600",children:a.allergies.join(", ")})]}),a.chronicConditions&&a.chronicConditions.length>0&&i.jsxs("div",{className:"col-span-2",children:[i.jsx("span",{className:"text-slate-500 text-xs",children:" "}),i.jsx("p",{className:"font-medium text-amber-600",children:a.chronicConditions.join(", ")})]})]})]}),t.message&&i.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4",children:[i.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2 mb-2 text-sm",children:[i.jsx("span",{className:"material-symbols-outlined text-sky-500",children:"chat"})," "]}),i.jsx("p",{className:"text-slate-600",children:t.message})]}),r&&i.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl overflow-hidden",children:[i.jsxs("div",{className:"p-4",children:[i.jsxs("h3",{className:"font-semibold text-amber-800 flex items-center gap-2 mb-3",children:[i.jsx("span",{className:"material-symbols-outlined text-amber-500",children:"auto_awesome"}),"AI   "]}),r.image&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:" "}),i.jsx("img",{src:r.image,alt:" ",className:"w-full max-h-48 object-cover rounded-lg border border-amber-200"})]}),r.symptoms&&r.symptoms.length>0&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:" "}),i.jsx("div",{className:"flex flex-wrap gap-1",children:r.symptoms.map((l,u)=>i.jsx("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-sm rounded-lg",children:l},u))})]}),r.symptom&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:"  "}),i.jsx("p",{className:"text-sm text-amber-800 bg-white p-2 rounded-lg border border-amber-200",children:r.symptom})]}),r.onsetDate&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:" "}),i.jsx("p",{className:"text-sm text-amber-800",children:r.onsetDate})]}),r.diagnosis&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:"AI  "}),i.jsx("p",{className:"text-amber-800 font-medium",children:typeof r.diagnosis=="string"?r.diagnosis:r.diagnosis.primary||JSON.stringify(r.diagnosis)})]}),r.possibleDiseases&&r.possibleDiseases.length>0||r.suspectedConditions&&r.suspectedConditions.length>0?i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:" AI  (Top 3  )"}),i.jsx("div",{className:"space-y-2",children:(r.possibleDiseases||r.suspectedConditions||[]).slice(0,3).map((l,u)=>{const d=l.probability||l.probability_percent||0,h=typeof d=="number"&&d<=1?d*100:d;return i.jsxs("div",{className:"bg-white p-2 rounded-lg border border-amber-200",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium text-amber-800",children:l.name||l.name_kor}),i.jsxs("span",{className:`text-sm font-bold ${h>=70?"text-red-600":h>=40?"text-amber-600":"text-green-600"}`,children:[Math.round(h),"%"]})]}),i.jsx("div",{className:"h-1.5 bg-amber-100 rounded-full mt-1 overflow-hidden",children:i.jsx("div",{className:`h-full ${h>=70?"bg-red-500":h>=40?"bg-amber-500":"bg-green-500"}`,style:{width:`${h}%`}})}),l.related_area&&i.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[" : ",l.related_area]})]},u)})})]}):null,(r.triageScore!==void 0||r.triageLevel||r.riskLevel)&&i.jsxs("div",{className:"mb-3 p-3 bg-white rounded-lg border border-amber-200",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-2",children:"   (Triage)"}),i.jsxs("div",{className:"flex items-center gap-3",children:[r.triageScore!==void 0&&i.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[i.jsx("div",{className:"flex-1 h-3 bg-slate-200 rounded-full overflow-hidden",children:i.jsx("div",{className:`h-full transition-all ${r.triageScore>=4?"bg-red-500":r.triageScore>=3?"bg-orange-500":r.triageScore>=2?"bg-yellow-500":"bg-green-500"}`,style:{width:`${r.triageScore/5*100}%`}})}),i.jsxs("span",{className:"text-lg font-bold text-slate-800",children:[r.triageScore,"/5"]})]}),(r.triageLevel||r.riskLevel)&&i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${(r.triageLevel||"").includes("red")||r.riskLevel==="high"?"bg-red-100 text-red-700":(r.triageLevel||"").includes("orange")||r.riskLevel==="medium"?"bg-orange-100 text-orange-700":(r.triageLevel||"").includes("yellow")?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:r.triageLevel||(r.riskLevel==="high"?"":r.riskLevel==="medium"?"":"")})]}),r.hospitalVisitTime&&i.jsxs("p",{className:"text-sm text-red-600 mt-2 font-medium",children:["   : ",r.hospitalVisitTime]})]}),r.actions&&r.actions.length>0&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:" AI  "}),i.jsx("ul",{className:"text-sm text-amber-800 space-y-1 bg-white p-2 rounded-lg border border-amber-200",children:r.actions.map((l,u)=>i.jsxs("li",{className:"flex items-start gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-green-500 text-sm mt-0.5",children:"check_circle"}),l]},u))})]}),r.recommendations&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:"AI "}),i.jsx("p",{className:"text-sm text-amber-700",children:r.recommendations})]}),r.suggestedTreatments&&r.suggestedTreatments.length>0&&i.jsxs("div",{className:"mb-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:" "}),i.jsx("ul",{className:"text-sm text-amber-700 list-disc list-inside space-y-1",children:r.suggestedTreatments.map((l,u)=>i.jsx("li",{children:l},u))})]}),r.hospitalVisitTime&&i.jsxs("div",{className:"p-2 bg-red-50 border border-red-200 rounded-lg",children:[i.jsxs("p",{className:"text-xs font-medium text-red-700 flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"warning"}),"  "]}),i.jsxs("p",{className:"text-sm font-bold text-red-800",children:[r.hospitalVisitTime,"   "]})]})]}),i.jsxs("div",{className:"px-4 py-2 bg-amber-100/50 border-t border-amber-200 text-xs text-amber-600",children:[": ",r.created_at?new Date(r.created_at).toLocaleString("ko-KR"):r.date||" "]})]}),i.jsx(u3,{petId:t.petId}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[t.status==="pending"&&i.jsx("button",{onClick:()=>{n(t.id,"confirmed"),e()},className:"flex-1 py-3 bg-sky-500 text-white font-semibold rounded-xl hover:bg-sky-600 transition",children:" "}),t.status!=="completed"&&i.jsx("button",{onClick:s,className:"flex-1 py-3 bg-sky-500 text-white font-semibold rounded-xl hover:bg-sky-600 transition",children:" "}),t.status==="pending"&&i.jsx("button",{onClick:()=>{n(t.id,"cancelled"),e()},className:"py-3 px-4 bg-slate-100 text-slate-600 font-semibold rounded-xl hover:bg-slate-200 transition",children:""})]})]})]})})}function c3({booking:t,onClose:e,onSave:n}){const[s,r]=L.useState({diagnosis:"",treatment:"",notes:"",followUp:"",totalCost:""}),[o,a]=L.useState([{name:"",dosage:"",days:"",instructions:""}]),l=()=>{a([...o,{name:"",dosage:"",days:"",instructions:""}])},u=p=>{o.length>1&&a(o.filter((x,v)=>v!==p))},d=(p,x,v)=>{const j=[...o];j[p][x]=v,a(j)},h=()=>{if(!s.diagnosis.trim()){alert(" .");return}const p=o.filter(x=>x.name.trim());n({petId:t.petId,petName:t.petName,petProfile:t.petProfile,...s,medications:p,totalCost:s.totalCost?parseInt(s.totalCost):0})},m=t.petProfile||{};return i.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end",children:i.jsxs("div",{className:"bg-white w-full rounded-t-2xl max-h-[90vh] overflow-y-auto animate-slide-up",children:[i.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-100 p-4 flex items-center justify-between z-10",children:[i.jsx("h2",{className:"font-bold text-lg text-slate-800",children:"  "}),i.jsx("button",{onClick:e,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-full transition",children:i.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsxs("div",{className:"bg-sky-50 rounded-xl p-3 flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-white overflow-hidden shadow-sm",children:i.jsx("img",{src:mn(m||{species:m.species||"dog"},!1),alt:t.petName||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-sky-800",children:t.petName}),i.jsxs("p",{className:"text-xs text-sky-600",children:[m.breed&&`${m.breed}  `,m.age&&`${m.age}  `,t.date," "]})]})]}),t.aiDiagnosis&&i.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3",children:[i.jsx("p",{className:"text-xs font-medium text-amber-700 mb-1",children:" AI  "}),i.jsx("p",{className:"text-sm text-amber-800 font-medium",children:t.aiDiagnosis.diagnosis}),t.aiDiagnosis.triageScore&&i.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[": ",t.aiDiagnosis.triageScore,"/5 (",t.aiDiagnosis.triageLevel||"",")"]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[" ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{type:"text",value:s.diagnosis,onChange:p=>r({...s,diagnosis:p.target.value}),placeholder:":  ",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sky-400"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" "}),i.jsx("textarea",{value:s.treatment,onChange:p=>r({...s,treatment:p.target.value}),placeholder:"   ",rows:3,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sky-400 resize-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-lg text-sky-500",children:"medication"}),""]})}),i.jsxs("div",{className:"space-y-3",children:[o.map((p,x)=>i.jsxs("div",{className:"bg-slate-50 rounded-xl p-3 space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{className:"text-xs text-slate-500",children:[" ",x+1]}),o.length>1&&i.jsx("button",{onClick:()=>u(x),className:"text-red-400 hover:text-red-600",children:i.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]}),i.jsx("input",{type:"text",value:p.name,onChange:v=>d(x,"name",v.target.value),placeholder:" (:  16mg)",className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("input",{type:"text",value:p.dosage,onChange:v=>d(x,"dosage",v.target.value),placeholder:" (: 1 2)",className:"px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"}),i.jsx("input",{type:"text",value:p.days,onChange:v=>d(x,"days",v.target.value),placeholder:" (: 7)",className:"px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"})]}),i.jsx("input",{type:"text",value:p.instructions,onChange:v=>d(x,"instructions",v.target.value),placeholder:"  (:  30)",className:"w-full px-3 py-2 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-400"})]},x)),i.jsxs("button",{onClick:l,className:"w-full py-2 border-2 border-dashed border-slate-300 rounded-xl text-slate-500 text-sm hover:border-sky-400 hover:text-sky-500 transition flex items-center justify-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})," "]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" / "}),i.jsx("textarea",{value:s.notes,onChange:p=>r({...s,notes:p.target.value}),placeholder:"   ",rows:2,className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sky-400 resize-none"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"  "}),i.jsx("input",{type:"date",value:s.followUp,onChange:p=>r({...s,followUp:p.target.value}),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sky-400"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" ()"}),i.jsx("input",{type:"number",value:s.totalCost,onChange:p=>r({...s,totalCost:p.target.value}),placeholder:"0",className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-sky-400"})]}),i.jsxs("div",{className:"bg-sky-50 rounded-xl p-3 flex items-start gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-sky-500 text-lg",children:"info"}),i.jsx("p",{className:"text-sm text-sky-700",children:"      .    /   ."})]}),i.jsxs("div",{className:"flex gap-3 pt-2",children:[i.jsx("button",{onClick:e,className:"flex-1 py-3 bg-slate-100 text-slate-600 font-semibold rounded-xl hover:bg-slate-200 transition",children:""}),i.jsxs("button",{onClick:h,className:"flex-1 py-3 bg-sky-500 text-white font-semibold rounded-xl hover:bg-sky-600 transition flex items-center justify-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined",children:"save"}),""]})]})]})]})})}function u3({petId:t}){const[e,n]=L.useState([]),[s,r]=L.useState(!1);if(L.useEffect(()=>{if(!t)return;const l=JSON.parse(localStorage.getItem(ou)||"[]"),u=JSON.parse(localStorage.getItem(Z5)||"{}"),h=l.filter(m=>m.petId===t).flatMap(m=>(m.medications||[]).map((p,x)=>{var v;return{id:`${m.id}_med_${x}`,name:p.name,dosage:p.dosage,days:p.days,instructions:p.instructions,hospitalName:((v=m.clinic)==null?void 0:v.name)||m.hospitalName||"  ",date:m.visitDate||m.createdAt,feedback:u[`${m.id}_med_${x}`]||null}})).sort((m,p)=>new Date(p.date)-new Date(m.date));n(h)},[t]),e.length===0)return null;const o=e.filter(l=>{var u;return((u=l.feedback)==null?void 0:u.status)==="effective"}),a=e.filter(l=>{var u;return((u=l.feedback)==null?void 0:u.status)==="side_effect"});return i.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl overflow-hidden",children:[i.jsxs("button",{onClick:()=>r(!s),className:"w-full p-3 bg-purple-50 border-b border-purple-100 flex items-center justify-between",children:[i.jsxs("h3",{className:"font-semibold text-purple-800 flex items-center gap-2 text-sm",children:[i.jsx("span",{className:"material-symbols-outlined text-purple-500 text-lg",children:"history"}),"   (",e.length,")"]}),i.jsx("span",{className:"material-symbols-outlined text-purple-500",children:s?"expand_less":"expand_more"})]}),s&&i.jsxs("div",{className:"p-3",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[o.length>0&&i.jsxs("div",{className:"bg-green-50 rounded-lg p-2 flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-green-500",children:"thumb_up"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-green-600",children:"  "}),i.jsxs("p",{className:"font-bold text-green-700",children:[o.length,""]})]})]}),a.length>0&&i.jsxs("div",{className:"bg-red-50 rounded-lg p-2 flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-red-500",children:"thumb_down"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-xs text-red-600",children:"  "}),i.jsxs("p",{className:"font-bold text-red-700",children:[a.length,""]})]})]})]}),a.length>0&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-3",children:[i.jsxs("p",{className:"text-xs font-bold text-red-700 mb-2 flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"warning"}),"    ( )"]}),i.jsx("div",{className:"space-y-1",children:a.map(l=>i.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-800",children:[i.jsx("span",{className:"material-symbols-outlined text-xs",children:"medication"}),i.jsx("span",{className:"font-medium",children:l.name}),i.jsxs("span",{className:"text-red-500 text-xs",children:["(",new Date(l.date).toLocaleDateString("ko-KR"),")"]})]},l.id))})]}),o.length>0&&i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-3",children:[i.jsxs("p",{className:"text-xs font-bold text-green-700 mb-2 flex items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-sm",children:"check_circle"}),"   ( )"]}),i.jsx("div",{className:"space-y-1",children:o.map(l=>i.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-800",children:[i.jsx("span",{className:"material-symbols-outlined text-xs",children:"medication"}),i.jsx("span",{className:"font-medium",children:l.name}),i.jsxs("span",{className:"text-green-500 text-xs",children:["(",new Date(l.date).toLocaleDateString("ko-KR"),")"]})]},l.id))})]}),i.jsx("p",{className:"text-xs font-medium text-slate-500 mb-2",children:"  "}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:e.map(l=>i.jsxs("div",{className:"bg-slate-50 rounded-lg p-2 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"font-medium text-slate-800",children:l.name}),l.feedback&&i.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${l.feedback.status==="effective"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:l.feedback.status==="effective"?"  ":" "})]}),i.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[l.hospitalName,"  ",new Date(l.date).toLocaleDateString("ko-KR"),l.dosage&&`  ${l.dosage}`]})]},l.id))})]})]})}function au(t){switch(t){case"confirmed":return{label:"",color:"bg-green-100 text-green-700"};case"cancelled":return{label:"",color:"bg-red-100 text-red-700"};case"completed":return{label:"",color:"bg-slate-100 text-slate-700"};default:return{label:"",color:"bg-amber-100 text-amber-700"}}}const ij=document.createElement("style");ij.textContent=`
  @keyframes slide-up {
    from { transform: translateY(100%); }
    to { transform: translateY(0); }
  }
  .animate-slide-up {
    animation: slide-up 0.3s ease-out;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
`;document.head.appendChild(ij);function We(t=0){const e=new Date;return e.setDate(e.getDate()-t),Fe.fromDate(e)}async function d3(t,e){console.log(`
     : ${e} (${t})
`);try{console.log("   ...");const n={userId:t,petName:"",species:"dog",breed:"",gender:"male",birthDate:We(365*3),neutered:!0,weight:3.5,createdAt:We(30),updatedAt:We(0)},r=(await en(ge(re,"pets"),n)).id;console.log(`       (ID: ${r})`);const o={userId:t,petName:"",species:"cat",breed:"",gender:"female",birthDate:We(365*2),neutered:!0,weight:4.2,createdAt:We(20),updatedAt:We(0)},l=(await en(ge(re,"pets"),o)).id;console.log(`       (ID: ${l})`),console.log(`
 AI    ...`);const u=[{userId:t,petId:r,petName:"",diagnosis:" ",description:"      .   ,    .",emergencyLevel:"medium",triageLevel:"medium",actions:[{type:"home_care",title:"  ",description:" 1  "},{type:"medication",title:"",description:"   "},{type:"monitor",title:" ",description:"3     "}],symptomTags:["","",""],createdAt:We(5)},{userId:t,petId:r,petName:"",diagnosis:"",description:"    .         .",emergencyLevel:"low",triageLevel:"low",actions:[{type:"diet",title:" ",description:"12    "},{type:"hydration",title:" ",description:"  "}],symptomTags:["",""],createdAt:We(10)},{userId:t,petId:l,petName:"",diagnosis:"  ",description:"     .        .",emergencyLevel:"high",triageLevel:"high",actions:[{type:"hospital",title:" ",description:"24    "},{type:"monitor",title:"  ",description:"    "}],symptomTags:["","",""],createdAt:We(3)},{userId:t,petId:l,petName:"",diagnosis:" ",description:"      .     .",emergencyLevel:"medium",triageLevel:"medium",actions:[{type:"hospital",title:" ",description:"    "},{type:"diet",title:" ",description:"     "}],symptomTags:["",""],createdAt:We(15)}];for(const h of u)await en(ge(re,"diagnoses"),h);console.log("      4  "),console.log(`
     ...`);const d=[];for(let h=0;h<7;h++)d.push({userId:t,petId:r,petName:"",date:We(h),activities:[{type:"meal",time:"08:00",note:" 1"},{type:"walk",time:"10:00",note:" 30"},{type:"meal",time:"18:00",note:" 1"}],notes:h===0?"  ":null,createdAt:We(h)}),d.push({userId:t,petId:l,petName:"",date:We(h),activities:[{type:"meal",time:"09:00",note:"  1"},{type:"play",time:"15:00",note:" "},{type:"meal",time:"20:00",note:"  1"}],notes:h===2?"  ":null,createdAt:We(h)});for(const h of d)await en(ge(re,"dailyLogs"),h);return console.log("      14  "),console.log(`
     !`),{success:!0,pets:[r,l],diagnoses:4,careLogs:14}}catch(n){throw console.error("    :",n),n}}async function h3(t,e){console.log(`
     : ${e} (${t})
`);try{console.log("    ...");const n=await En(ct(re,"users",t));let s=null;if(n.exists()&&(s=n.data().defaultClinicId,s)){const x=await En(ct(re,"clinics",s));x.exists()?console.log(`       : ${x.data().name}`):s=null}if(!s){const p={name:"",address:"   123",phone:"02-1234-5678",ownerUserId:t,createdAt:We(60),updatedAt:We(0)};s=(await en(ge(re,"clinics"),p)).id,await nl(ct(re,"users",t),{defaultClinicId:s,userMode:"clinic",roles:["clinic_owner"]}),console.log(`       :  (ID: ${s})`)}console.log(`
    ...`);const r=[],o=["pending","confirmed","completed","cancelled"],a=["09:00","10:00","11:00","14:00","15:00","16:00","17:00"];for(let p=0;p<50;p++){const x=Math.floor(p/7),v=o[Math.floor(Math.random()*o.length)],j=a[Math.floor(Math.random()*a.length)];r.push({userId:`U${String(Math.floor(Math.random()*1e3)).padStart(4,"0")}`,petId:`PET${String(Math.floor(Math.random()*1e3)).padStart(4,"0")}`,clinicId:s,hospitalName:"",date:We(x),time:j,status:v,reason:["",""," "," "][Math.floor(Math.random()*4)],createdAt:We(x+1),updatedAt:We(x)})}const l=[];for(const p of r){const x=await en(ge(re,"bookings"),p);l.push(x.id)}console.log("      50  "),console.log(`
    ...`);const u=r.filter(p=>p.status==="completed").slice(0,40),d=[];for(let p=0;p<u.length;p++){const x=u[p];d.push({userId:x.userId,petId:x.petId,clinicId:s,hospitalName:"",bookingId:l[r.indexOf(x)],diagnosis:["",""," "," ",""][Math.floor(Math.random()*5)],treatment:"    ",prescription:["","","",""][Math.floor(Math.random()*4)],notes:"  ",createdAt:x.date,updatedAt:x.date})}for(const p of d)await en(ge(re,"clinicResults"),p);console.log(`      ${d.length}  `),console.log(`
    ...`);const h=12,m=[];for(let p=0;p<h;p++){const x=["dog","cat"][Math.floor(Math.random()*2)],v=x==="dog"?["","","",""]:["","","",""];m.push({clinicId:s,clinicName:"",petId:`PET${String(p+1).padStart(4,"0")}`,petName:["","","","","","","","","",""][p],species:x,speciesLabelKo:x==="dog"?"":"",breed:v[Math.floor(Math.random()*v.length)],birthDate:We(365*(2+Math.floor(Math.random()*5))),ownerUserId:`U${String(p+1).padStart(4,"0")}`,visitCount:Math.floor(Math.random()*5)+1,lastVisitDate:We(Math.floor(Math.random()*30)),lastDiagnosis:["","",""][Math.floor(Math.random()*3)],lastTriageLevel:["low","medium","high"][Math.floor(Math.random()*3)],lastWeightKg:(2+Math.random()*5).toFixed(1),createdAt:We(30+p),updatedAt:We(Math.floor(Math.random()*30))})}for(const p of m)await en(ge(re,"clinicPatients"),p);return console.log(`      ${h}  `),console.log(`
     !`),{success:!0,clinicId:s,bookings:50,clinicResults:d.length,patients:h}}catch(n){throw console.error("    :",n),n}}const m3=(t=new Date)=>{const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${s}`};function f3({currentUser:t,onBack:e}){const[n,s]=L.useState(!0),[r,o]=L.useState(null),[a,l]=L.useState([]),[u,d]=L.useState("today"),[h,m]=L.useState([]),[p,x]=L.useState([]),[v,j]=L.useState([]),[A,w]=L.useState({}),[y,E]=L.useState(null),[R,$]=L.useState(new Date);L.useEffect(()=>{t!=null&&t.uid&&D()},[t]),L.useEffect(()=>{r&&_()},[r]),L.useEffect(()=>{if(!(r!=null&&r.id))return;const V=m3();console.log("[  ] clinicId:",r.id,":",r.name,":",V);const Y=[];try{const T=Te(ge(re,"bookings"),me("clinicId","==",r.id),me("date","==",V),Wt("time","asc")),B=km(T,async G=>{console.log("[] clinics ID  :",G.docs.length,"");const K=[];for(const te of G.docs){const le=te.data();let W=null;if(le.petId)try{const oe=await En(ct(re,"pets",le.petId));W=oe.exists()?oe.data():le.pet||le.petProfile||null}catch{W=le.pet||le.petProfile||null}let ne=null;if(le.userId)try{const oe=await En(ct(re,"users",le.userId));ne=oe.exists()?oe.data():le.owner||null}catch{ne=le.owner||null}K.push({id:te.id,...le,pet:W,owner:ne})}K.sort((te,le)=>{const W=te.time||"00:00",ne=le.time||"00:00";return W.localeCompare(ne)}),m(K),console.log("[]     :",K.length,"")},G=>{console.error("[]  clinics ID  :",G)});Y.push(B)}catch(T){console.error("[] clinics ID   :",T)}if(r.name)try{const T=Te(ge(re,"bookings"),me("clinicName","==",r.name),me("date","==",V)),B=km(T,G=>{console.log("[]   :",G.docs.length,""),m(K=>{const te=new Set(K.map(W=>W.id)),le=[];for(const W of G.docs)if(!te.has(W.id)){const ne=W.data();le.push({id:W.id,...ne,pet:ne.pet||ne.petProfile||null,owner:ne.owner||null})}if(le.length>0){const W=[...K,...le];return W.sort((ne,oe)=>{const xe=ne.time||"00:00",ce=oe.time||"00:00";return xe.localeCompare(ce)}),console.log("[]    :",le.length,""),W}return K})},G=>{console.error("[]    :",G)});Y.push(B)}catch(T){console.error("[]    :",T)}return()=>{console.log("[  ]"),Y.forEach(T=>T())}},[r==null?void 0:r.id,r==null?void 0:r.name]),L.useEffect(()=>{r&&b()},[R,r]);const D=async()=>{try{s(!0);let V=await Ba(t.uid);if(V.length===0){console.log("clinicStaff  ,  ...");const T=(await wn.getUser(t.uid)).data||{},B=await D5(t.uid,{...T,displayName:t.displayName||T.displayName});B.success?(V=await Ba(t.uid),console.log("   :",V.length)):console.error(" :",B.error)}if(V.length===0){alert("    .  ."),e();return}l(V),o(V[0])}catch(V){console.error("   :",V),alert("  .")}finally{s(!1)}},_=async()=>{try{s(!0);const V=await V5(r.id);w(V);const Y=await O5(r.id);m(Y);const T=await L5(r.id,{limit:50});j(T)}catch(V){console.error("   :",V)}finally{s(!1)}},b=async()=>{try{const V=R.getFullYear(),Y=R.getMonth()+1,T=await M5(r.id,V,Y);x(T)}catch(V){console.error("   :",V)}},S=()=>{confirm(" ?")&&e()},I=V=>({confirmed:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",completed:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800",waiting:"bg-sky-100 text-sky-800"})[V]||"bg-gray-100 text-gray-800",C=V=>({confirmed:"",pending:" ",completed:"",cancelled:"",waiting:""})[V]||V,P=async V=>{alert("    .")},N=async V=>{alert("    .")},O=V=>{E(y===V?null:V)},M=()=>{const V=new Date(R);V.setMonth(V.getMonth()-1),$(V),E(null)},ie=()=>{const V=new Date(R);V.setMonth(V.getMonth()+1),$(V),E(null)},Ae=()=>{const V=R.getFullYear(),Y=R.getMonth(),T=new Date(V,Y,1).getDay(),B=new Date(V,Y+1,0).getDate(),G={};p.forEach(ne=>{const oe=new Date(ne.date);if(oe.getMonth()===Y&&oe.getFullYear()===V){const xe=oe.getDate();G[xe]=(G[xe]||0)+1}});const K=new Date,le=K.getMonth()===Y&&K.getFullYear()===V?K.getDate():null,W=[];for(let ne=0;ne<T;ne++)W.push(i.jsx("div",{className:"aspect-square"},`empty-${ne}`));for(let ne=1;ne<=B;ne++){const oe=G[ne]||0,xe=ne===le,ce=ne===y,de=(T+ne-1)%7,he=de===0,je=de===6;W.push(i.jsxs("div",{onClick:()=>oe>0&&O(ne),className:`aspect-square flex flex-col items-center justify-center rounded-xl transition-all cursor-pointer
            ${ce?"bg-gradient-to-br from-sky-600 to-sky-700 text-white shadow-lg scale-105":xe?"bg-white border-2 border-sky-600 shadow-md":oe>0?"bg-white/90 shadow-sm hover:shadow-md hover:scale-105":"bg-white/30"}
            ${oe>0||xe?"border border-gray-200":""}
          `,style:{position:"relative"},children:[i.jsx("div",{className:`text-sm font-bold
            ${ce?"text-white":xe?"text-sky-600":oe>0?"text-gray-900":he?"text-red-400":je?"text-blue-400":"text-gray-400"}`,children:ne}),oe>0&&i.jsx("div",{className:`absolute bottom-1 text-xs px-1.5 py-0.5 rounded-full font-bold shadow-sm
              ${ce?"bg-white text-sky-600":"bg-gradient-to-r from-amber-500 to-orange-500 text-white"}`,children:oe})]},ne))}return W},Q=()=>{if(!y)return[];const V=R.getFullYear(),Y=R.getMonth();return p.filter(T=>{const B=new Date(T.date);return B.getDate()===y&&B.getMonth()===Y&&B.getFullYear()===V}).sort((T,B)=>T.time.localeCompare(B.time))};return n?i.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:i.jsxs("div",{className:"flex flex-col items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-sky-600 rounded-full animate-spin"}),i.jsx("p",{className:"text-gray-600",children:"   ..."})]})}):i.jsxs("div",{className:"min-h-screen bg-gray-50",children:[i.jsx("style",{children:`
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
        .animate-spin {
          animation: spin 1s linear infinite;
        }
      `}),i.jsxs("div",{className:"bg-white border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between p-4",children:[i.jsx("button",{onClick:e,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx("span",{className:"text-sm",children:" "})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:e,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors",title:"  ",children:i.jsx("span",{className:"material-symbols-outlined",children:"swap_horiz"})}),i.jsx("button",{onClick:S,className:"p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors",title:"",children:i.jsx("span",{className:"material-symbols-outlined",children:"logout"})})]})]}),i.jsxs("div",{className:"px-4 pb-4",children:[i.jsxs("h1",{className:"text-xl font-bold text-gray-900",children:[" ",(r==null?void 0:r.name)||" "]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"  "})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-3 px-4 pb-4",children:[i.jsxs("div",{className:"bg-sky-50 p-3 rounded-xl text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-sky-600",children:h.length}),i.jsx("div",{className:"text-xs text-gray-600",children:" "})]}),i.jsxs("div",{className:"bg-amber-50 p-3 rounded-xl text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-amber-600",children:h.filter(V=>V.status==="pending").length}),i.jsx("div",{className:"text-xs text-gray-600",children:" "})]}),i.jsxs("div",{className:"bg-green-50 p-3 rounded-xl text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:h.filter(V=>V.status==="confirmed").length}),i.jsx("div",{className:"text-xs text-gray-600",children:""})]})]})]}),i.jsx("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 flex overflow-x-auto",children:[{id:"today",icon:"calendar_today",label:" "},{id:"schedule",icon:"schedule",label:" "},{id:"monthly",icon:"calendar_month",label:""},{id:"records",icon:"folder_shared",label:" "},{id:"settings",icon:"settings",label:""}].map(V=>i.jsxs("button",{onClick:()=>d(V.id),className:`flex-1 min-w-[70px] px-3 py-3 text-xs font-medium text-center border-b-2 transition-all
              ${u===V.id?"text-sky-600 border-sky-600":"text-gray-600 border-transparent hover:text-gray-900"}`,children:[i.jsx("span",{className:"material-symbols-outlined block text-xl mb-1",children:V.icon}),V.label]},V.id))}),i.jsxs("div",{className:"p-4 pb-24",children:[u==="today"&&i.jsxs("div",{children:[i.jsxs("h2",{className:"font-bold text-gray-900 mb-3",children:["   (",h.length,")"]}),h.length===0?i.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-10 text-center",children:[i.jsx("div",{className:"text-6xl mb-3",children:""}),i.jsx("p",{className:"text-gray-400",children:"  "})]}):i.jsx("div",{className:"space-y-3",children:h.map((V,Y)=>{var T,B,G,K,te,le,W;return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-4 shadow-sm",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:V.time||" "}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${I(V.status)}`,children:C(V.status)})]}),i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-sky-400 to-purple-400 overflow-hidden",children:i.jsx("img",{src:mn(V.pet||{species:((T=V.pet)==null?void 0:T.species)||"dog"},!1),alt:((B=V.pet)==null?void 0:B.name)||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:[((G=V.pet)==null?void 0:G.name)||""," (",((K=V.pet)==null?void 0:K.breed)||" ",", ",((te=V.pet)==null?void 0:te.age)||"?",")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[": ",((le=V.owner)==null?void 0:le.name)||"  ","  ",((W=V.owner)==null?void 0:W.phone)||""]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-3",children:[i.jsx("div",{className:"text-xs text-gray-600 mb-1",children:""}),i.jsx("div",{className:"text-sm text-gray-900",children:V.symptom||" "})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[i.jsxs("button",{className:"p-2 bg-white border border-gray-200 rounded-lg text-xs font-semibold text-gray-700 hover:bg-gray-50 transition-colors flex flex-col items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-xl",children:"smart_toy"})," "]}),i.jsxs("button",{className:"p-2 bg-white border border-gray-200 rounded-lg text-xs font-semibold text-gray-700 hover:bg-gray-50 transition-colors flex flex-col items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-xl",children:"description"}),""]}),i.jsxs("button",{className:"p-2 bg-white border border-gray-200 rounded-lg text-xs font-semibold text-gray-700 hover:bg-gray-50 transition-colors flex flex-col items-center gap-1",children:[i.jsx("span",{className:"material-symbols-outlined text-xl",children:"history"})," "]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("button",{onClick:()=>P(V.id),className:`py-2.5 rounded-lg text-sm font-semibold transition-colors flex items-center justify-center gap-1.5
                          ${V.status==="confirmed"?"bg-gray-100 text-gray-700 cursor-default":"bg-sky-600 text-white hover:bg-sky-700"}`,disabled:V.status==="confirmed",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"check_circle"}),V.status==="confirmed"?" ":" "]}),i.jsxs("button",{onClick:()=>N(V.id),className:"py-2.5 bg-sky-600 text-white rounded-lg text-sm font-semibold hover:bg-sky-700 transition-colors flex items-center justify-center gap-1.5",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"play_arrow"})," "]})]})]},V.id||Y)})})]}),u==="schedule"&&i.jsxs("div",{children:[i.jsx("h2",{className:"font-bold text-gray-900 mb-3",children:"   "}),i.jsx("div",{className:"bg-white rounded-2xl p-4 mb-4 shadow-sm",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("button",{className:"bg-gray-100 p-2 rounded-lg hover:bg-gray-200 transition-colors",onClick:M,children:i.jsx("span",{className:"material-symbols-outlined text-gray-600",children:"chevron_left"})}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"font-bold text-gray-900",children:R.toLocaleDateString("ko-KR",{year:"numeric",month:"long"})}),i.jsx("div",{className:"text-xs text-gray-600 mt-1",children:" "})]}),i.jsx("button",{className:"bg-gray-100 p-2 rounded-lg hover:bg-gray-200 transition-colors",onClick:ie,children:i.jsx("span",{className:"material-symbols-outlined text-gray-600",children:"chevron_right"})})]})}),i.jsx("div",{className:"bg-white rounded-2xl p-4 shadow-sm",children:i.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"info"}),i.jsx("span",{children:"    "})]})})]}),u==="monthly"&&i.jsxs("div",{children:[i.jsxs("div",{className:"bg-gradient-to-br from-sky-50 to-sky-100 rounded-3xl p-6 mb-4 shadow-md",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("button",{onClick:M,className:"bg-white p-2 rounded-lg shadow-sm hover:bg-sky-50 transition-colors",children:i.jsx("span",{className:"material-symbols-outlined text-sky-600",children:"chevron_left"})}),i.jsxs("div",{className:"text-center",children:[i.jsxs("h2",{className:"text-xl font-bold text-sky-900",children:[R.getFullYear()," ",R.getMonth()+1,""]}),i.jsx("p",{className:"text-xs text-sky-700 mt-1",children:" "})]}),i.jsx("button",{onClick:ie,className:"bg-white p-2 rounded-lg shadow-sm hover:bg-sky-50 transition-colors",children:i.jsx("span",{className:"material-symbols-outlined text-sky-600",children:"chevron_right"})})]}),i.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["","","","","","",""].map((V,Y)=>i.jsx("div",{className:`text-center text-sm font-bold py-2 ${Y===0?"text-red-600":Y===6?"text-blue-600":"text-sky-900"}`,children:V},V))}),i.jsx("div",{className:"grid grid-cols-7 gap-1",children:Ae()})]}),y&&i.jsxs("div",{className:"bg-white border-2 border-sky-600 rounded-2xl p-5 mb-4 shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[i.jsxs("span",{className:"bg-gradient-to-r from-sky-600 to-sky-700 text-white px-3 py-1 rounded-lg",children:[y,""]}),i.jsx("span",{className:"text-gray-600 text-base",children:" "})]}),i.jsx("button",{onClick:()=>E(null),className:"bg-gray-100 p-2 rounded-lg hover:bg-gray-200 transition-colors",children:i.jsx("span",{className:"material-symbols-outlined text-xl text-gray-600",children:"close"})})]}),i.jsx("div",{className:"space-y-3",children:Q().length===0?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("span",{className:"material-symbols-outlined text-5xl text-gray-300 block mb-2",children:"event_busy"}),i.jsxs("p",{className:"text-gray-500 text-sm",children:[y,"  "]})]}):Q().map((V,Y)=>{var T,B,G,K;return i.jsxs("div",{className:`bg-gradient-to-r ${V.status==="confirmed"?"from-green-50 to-emerald-50 border-green-200":"from-yellow-50 to-amber-50 border-yellow-200"} p-4 rounded-xl border transition-all hover:shadow-md`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("span",{className:"font-bold text-gray-900",children:V.time}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${V.status==="confirmed"?"bg-green-600 text-white":"bg-yellow-600 text-white"} shadow-sm`,children:C(V.status)})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden",children:i.jsx("img",{src:mn(V.pet||{species:((T=V.pet)==null?void 0:T.species)||"dog"},!1),alt:((B=V.pet)==null?void 0:B.name)||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-semibold text-gray-900",children:((G=V.pet)==null?void 0:G.name)||""}),i.jsxs("span",{className:"text-gray-600",children:["  ",((K=V.pet)==null?void 0:K.breed)||" "]})]})]})]},Y)})})]}),!y&&i.jsx("div",{className:"bg-white rounded-2xl p-4 shadow-sm",children:i.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-2",children:[i.jsx("span",{className:"material-symbols-outlined text-lg",children:"info"}),i.jsx("span",{children:"      "})]})})]}),u==="records"&&i.jsxs("div",{children:[i.jsx("h2",{className:"font-bold text-gray-900 mb-3",children:"   "}),v.length===0?i.jsxs("div",{className:"bg-white rounded-2xl p-10 text-center",children:[i.jsx("div",{className:"text-6xl mb-3",children:""}),i.jsx("p",{className:"text-gray-400",children:"  "})]}):i.jsx("div",{className:"space-y-3",children:v.map((V,Y)=>i.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-4 shadow-sm",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-sky-400 to-purple-400 overflow-hidden",children:i.jsx("img",{src:mn(V||{species:V.species||"dog"},!1),alt:V.petName||V.name||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"}})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("h3",{className:"text-base font-semibold text-gray-900",children:[V.petName," (",V.speciesLabelKo||V.species,")"]}),i.jsxs("p",{className:"text-sm text-gray-600",children:[": ",V.ownerName,"  ",V.ownerPhone]})]})]}),i.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 p-4 rounded-xl mb-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-8 h-8 bg-white rounded-lg flex items-center justify-center text-xl",children:""}),i.jsx("span",{className:"text-sm font-bold text-green-800",children:" "})]}),i.jsxs("span",{className:"bg-green-600 text-white px-3 py-1 rounded-full text-xs font-bold",children:[V.visitCount||0,""]})]}),i.jsxs("div",{className:"text-xs text-green-800 leading-relaxed mb-3",children:["  : ",V.lastVisitDate||"  ",i.jsx("br",{}),"  : ",V.lastDiagnosis||"  "]}),i.jsxs("button",{className:"w-full text-sm py-3 bg-white text-green-800 border-2 border-green-600 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-green-50 transition-colors shadow-sm",children:[i.jsx("span",{className:"material-symbols-outlined text-xl",children:"send"})," "]})]}),i.jsxs("button",{className:"w-full py-3 bg-gradient-to-r from-purple-500 to-indigo-500 text-white rounded-xl font-bold text-sm flex items-center justify-center gap-2 shadow-md hover:shadow-lg transition-all",children:[i.jsx("span",{className:"material-symbols-outlined text-2xl",children:"timeline"}),"  "]})]},V.id||Y))})]}),u==="settings"&&i.jsxs("div",{children:[i.jsx("h2",{className:"font-bold text-gray-900 mb-3",children:"  "}),i.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm space-y-5",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-2",children:""}),i.jsx("div",{className:"text-base text-gray-900",children:r==null?void 0:r.name})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-2",children:""}),i.jsx("div",{className:"text-base text-gray-600",children:(r==null?void 0:r.address)||"  "})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-2",children:""}),i.jsx("div",{className:"text-base text-gray-600",children:(r==null?void 0:r.phone)||"  "})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-2",children:" "}),i.jsx("div",{className:"text-base text-gray-600",children:(r==null?void 0:r.staffRole)==="director"?"":(r==null?void 0:r.staffRole)==="vet"?"":(r==null?void 0:r.staffRole)==="nurse"?"":""})]})]})]})]})]})}function p3(){const t=[],e=new Date;for(let n=6;n>=0;n--){const s=new Date(e);s.setDate(s.getDate()-n);const r=s.toISOString().slice(0,10),o=Math.random();t.push({date:r,mealCount:o>.3?2:1,waterCount:Math.floor(2+Math.random()*3),walkCount:o>.5?2:1,poopCount:o>.4?2:1,weight:(5.2+Math.random()*.3).toFixed(1),note:n===3?"   ":n===1?" ":"",mood:o>.6?"happy":o>.3?"normal":"tired"})}return t}function g3({petData:t,onBack:e,onHome:n}){const[s,r]=L.useState([]),[o,a]=L.useState(null),[l,u]=L.useState(!0),[d,h]=L.useState(!1);L.useEffect(()=>{t&&m()},[t]);const m=async()=>{u(!0);let v=XN(t.id,7);!v||v.length<2?(v=p3(),h(!0)):h(!1),r(v);try{const j=await E5(t,7);a(j||p(v,t))}catch(j){console.error("AI  :",j),a(p(v))}u(!1)},p=(v,j)=>{const A=v.reduce(($,D)=>$+(D.mealCount||0),0)/v.length,w=v.reduce(($,D)=>$+(D.walkCount||0),0)/v.length,y=v.reduce(($,D)=>$+(D.poopCount||0),0)/v.length,E=[],R=[];return A<1.5&&(E.push("  ."),R.push("    .")),w<1&&(E.push("  ."),R.push(" .")),y>3&&(E.push("  ."),R.push("  .")),E.length===0&&(E.push("    ."),R.push("   .")),{earIssue:!1,digestionIssue:y>3,skinIssue:!1,energyLevel:Math.min(1,Math.max(.3,w/2)),fever:!1,patterns:E,predictions:R,risk_changes:{description:"    .",trend:"stable"}}},x=()=>{!t||!d||(s.forEach(v=>{t5(t.id,v)}),h(!1),alert("  !"))};return l?i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-5xl mb-4 animate-bounce",children:""}),i.jsx("p",{className:"text-slate-600",children:"7    ..."})]})}):i.jsxs("div",{className:"min-h-screen bg-slate-50 pb-24",children:[i.jsxs("div",{className:"bg-gradient-to-r from-violet-500 to-purple-600 text-white px-4 py-6",children:[i.jsx("div",{className:"flex items-center gap-3 mb-4",children:i.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-lg hover:bg-white/10",children:" "})}),i.jsx("h1",{className:"text-xl font-bold",children:"AI   "}),i.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[(t==null?void 0:t.petName)||(t==null?void 0:t.name)," 7   "]})]}),i.jsxs("div",{className:"p-4 space-y-4",children:[d&&i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("span",{className:"text-2xl",children:""}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-bold text-amber-800 mb-1",children:"   "}),i.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"        .       !"}),i.jsx("button",{onClick:x,className:"text-sm bg-amber-500 text-white px-3 py-1.5 rounded-lg hover:bg-amber-600",children:"  "})]})]})}),i.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-slate-100",children:[i.jsxs("h2",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[i.jsx("span",{className:"text-xl",children:""})," 7  "]}),i.jsx("div",{className:"space-y-2",children:s.map((v,j)=>i.jsxs("div",{className:"flex items-center gap-3 py-2 border-b border-slate-100 last:border-0",children:[i.jsx("span",{className:"text-xs text-slate-400 w-20",children:v.date}),i.jsxs("div",{className:"flex-1 flex gap-3 text-sm",children:[i.jsxs("span",{children:[" ",v.mealCount||0]}),i.jsxs("span",{children:[" ",v.waterCount||0]}),i.jsxs("span",{children:[" ",v.walkCount||0]}),i.jsxs("span",{children:[" ",v.poopCount||0]}),v.weight&&i.jsxs("span",{className:"text-slate-500",children:[" ",v.weight,"kg"]})]})]},j))})]}),o&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-slate-100",children:[i.jsxs("h2",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[i.jsx("span",{className:"text-xl",children:""}),"  "]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsx("div",{className:`p-3 rounded-xl ${o.digestionIssue?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:i.jsx("span",{className:"text-sm",children:o.digestionIssue?"  ":"  "})}),i.jsx("div",{className:`p-3 rounded-xl ${o.skinIssue?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:i.jsx("span",{className:"text-sm",children:o.skinIssue?"  ":"  "})}),i.jsx("div",{className:`p-3 rounded-xl ${o.earIssue?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:i.jsx("span",{className:"text-sm",children:o.earIssue?"  ":"  "})}),i.jsx("div",{className:`p-3 rounded-xl ${o.fever?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:i.jsx("span",{className:"text-sm",children:o.fever?"  ":"  "})})]}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[i.jsx("span",{className:"text-slate-600",children:" "}),i.jsxs("span",{className:"font-medium",children:[Math.round((o.energyLevel||.5)*100),"%"]})]}),i.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3",children:i.jsx("div",{className:`h-3 rounded-full transition-all ${(o.energyLevel||.5)>.7?"bg-green-500":(o.energyLevel||.5)>.4?"bg-yellow-500":"bg-red-500"}`,style:{width:`${(o.energyLevel||.5)*100}%`}})})]})]}),o.patterns&&o.patterns.length>0&&i.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-slate-100",children:[i.jsxs("h2",{className:"font-bold text-slate-800 mb-4 flex items-center gap-2",children:[i.jsx("span",{className:"text-xl",children:""})," "]}),i.jsx("ul",{className:"space-y-2",children:o.patterns.map((v,j)=>i.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-700",children:[i.jsx("span",{className:"text-violet-500",children:""}),v]},j))})]}),o.predictions&&o.predictions.length>0&&i.jsxs("div",{className:"bg-gradient-to-br from-violet-50 to-purple-50 rounded-2xl p-5 border border-violet-100",children:[i.jsxs("h2",{className:"font-bold text-violet-800 mb-4 flex items-center gap-2",children:[i.jsx("span",{className:"text-xl",children:""}),"AI "]}),i.jsx("ul",{className:"space-y-2",children:o.predictions.map((v,j)=>i.jsxs("li",{className:"flex items-start gap-2 text-sm text-violet-700",children:[i.jsx("span",{className:"text-violet-500",children:""}),v]},j))})]}),o.risk_changes&&i.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-slate-100",children:[i.jsxs("h2",{className:"font-bold text-slate-800 mb-3 flex items-center gap-2",children:[i.jsx("span",{className:"text-xl",children:""})," "]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`px-3 py-1.5 rounded-full text-sm font-medium ${o.risk_changes.trend==="up"?"bg-red-100 text-red-700":o.risk_changes.trend==="down"?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:o.risk_changes.trend==="up"?" ":o.risk_changes.trend==="down"?" ":" "}),i.jsx("span",{className:"text-sm text-slate-600",children:o.risk_changes.description})]})]})]}),i.jsx("button",{onClick:m,className:"w-full py-3 bg-violet-500 hover:bg-violet-600 text-white font-bold rounded-xl transition-colors",children:" "})]})]})}const x3=[{species_code:"dog",species_label_ko:"",department_code:"dermatology",department_label_ko:"",symptom_tag:"itching",symptom_label_ko:"",question_ko:"     ?",answer_ko:"    , ,      .      1~2    .",keywords:["","","",""]},{species_code:"dog",species_label_ko:"",department_code:"dermatology",department_label_ko:"",symptom_tag:"hair_loss",symptom_label_ko:"",question_ko:"       ?",answer_ko:"   , ,        .         .",keywords:["","","",""]},{species_code:"dog",species_label_ko:"",department_code:"dermatology",department_label_ko:"",symptom_tag:"bump",symptom_label_ko:"/",question_ko:"   . ?",answer_ko:"   . , ,    .   , ,    .",keywords:["","","",""]},{species_code:"dog",species_label_ko:"",department_code:"internal_medicine",department_label_ko:"",symptom_tag:"vomiting",symptom_label_ko:"",question_ko:"     . ?",answer_ko:"         .             .",keywords:["","","",""]},{species_code:"dog",species_label_ko:"",department_code:"internal_medicine",department_label_ko:"",symptom_tag:"diarrhea",symptom_label_ko:"",question_ko:"   .   ?",answer_ko:"            .  2   ,     .",keywords:[""," ","",""]},{species_code:"dog",species_label_ko:"",department_code:"internal_medicine",department_label_ko:"",symptom_tag:"no_appetite",symptom_label_ko:"",question_ko:"   .    .",answer_ko:"1~2     , 3           .      .",keywords:[""," ","",""]},{species_code:"dog",species_label_ko:"",department_code:"ophthalmology",department_label_ko:"",symptom_tag:"eye_discharge",symptom_label_ko:"/",question_ko:"      ?",answer_ko:"        ,         .     .",keywords:["","","",""]},{species_code:"dog",species_label_ko:"",department_code:"ophthalmology",department_label_ko:"",symptom_tag:"red_eye",symptom_label_ko:"",question_ko:"  .   ?",answer_ko:"  ,  ,     .           .",keywords:[" ",""," "]},{species_code:"dog",species_label_ko:"",department_code:"orthopedics",department_label_ko:"",symptom_tag:"limping",symptom_label_ko:"",question_ko:"   .   ?",answer_ko:"  , ,      .         .",keywords:["","","",""]},{species_code:"cat",species_label_ko:"",department_code:"urology",department_label_ko:"",symptom_tag:"urination_issue",symptom_label_ko:" ",question_ko:"       .",answer_ko:"      .        . 24     .",keywords:["","","",""]},{species_code:"cat",species_label_ko:"",department_code:"urology",department_label_ko:"",symptom_tag:"blood_in_urine",symptom_label_ko:"",question_ko:"    . ?",answer_ko:" , ,     .        .    .",keywords:["",""," "]},{species_code:"cat",species_label_ko:"",department_code:"internal_medicine",department_label_ko:"",symptom_tag:"vomiting",symptom_label_ko:"",question_ko:"  . ?",answer_ko:"     ,             .    .",keywords:["","",""]},{species_code:"cat",species_label_ko:"",department_code:"internal_medicine",department_label_ko:"",symptom_tag:"weight_loss",symptom_label_ko:" ",question_ko:"    .  ?",answer_ko:"      , ,       .     .",keywords:["","","",""]},{species_code:"cat",species_label_ko:"",department_code:"dermatology",department_label_ko:"",symptom_tag:"over_grooming",symptom_label_ko:" ",question_ko:"       .",answer_ko:"  , ,      .        .",keywords:["",""," "]},{species_code:"all",species_label_ko:" ",department_code:"preventive",department_label_ko:"",symptom_tag:"vaccination",symptom_label_ko:"",question_ko:"   ?",answer_ko:"    6~8   .     .     .",keywords:["","",""]},{species_code:"all",species_label_ko:" ",department_code:"preventive",department_label_ko:"",symptom_tag:"checkup",symptom_label_ko:"",question_ko:"    ?",answer_ko:"7   1, 7  /  2  .       .",keywords:["","",""]}];function y3(t,e="all",n=""){const s=t.toLowerCase(),r=s.split(/\s+/);return x3.filter(o=>{if(!(o.species_code==="all"||o.species_code===e))return!1;const l=o.keywords.some(d=>s.includes(d.toLowerCase())),u=o.question_ko.split(/\s+/).some(d=>r.some(h=>d.includes(h)||h.includes(d)));return l||u}).sort((o,a)=>{const l=o.keywords.filter(d=>s.includes(d.toLowerCase())).length;return a.keywords.filter(d=>s.includes(d.toLowerCase())).length-l}).slice(0,3)}function v3(t,e="dog"){const n=y3(t,e);if(n.length===0)return"";let s=`

[ FAQ ]
`;return n.forEach((r,o)=>{s+=`
${o+1}. Q: ${r.question_ko}
   A: ${r.answer_ko}
`}),s}const oj="petMedical_pets",za="petMedical_diagnoses",aj=t=>`petMedical_pets_${t}`,dc=t=>{if(!t)return[];try{const e=localStorage.getItem(aj(t));return e?JSON.parse(e):[]}catch{return[]}},lj=async(t,e,n=null)=>{if(t)try{if(localStorage.setItem(aj(t),JSON.stringify(e)),n)try{const s=await c5.addPet(t,{petName:n.petName||n.name,species:n.species||"dog",breed:n.breed||"",sex:n.sex||"",birthDate:n.birthDate||null,weight:n.weight||null,neutered:n.neutered||!1,character:n.character||null,profileImage:n.profileImage||null});s.success&&console.log(" Firestore  :",s.id)}catch(s){console.warn(" Firestore   (  ):",s)}}catch(s){console.error("Failed to save pets:",s)}},_3=()=>{try{const t=localStorage.getItem(oj);return t?JSON.parse(t):[]}catch{return[]}},w3=t=>{try{localStorage.setItem(oj,JSON.stringify(t))}catch(e){console.error("Failed to save pets:",e)}},Oy=async(t,e=null)=>{try{let n={...t};n.healthFlags||(n.healthFlags=M4(t));const s={...n,id:n.id||Date.now().toString(),date:new Date().toISOString()},r=JSON.parse(localStorage.getItem(za)||"[]");r.unshift(s),localStorage.setItem(za,JSON.stringify(r));try{const o={...s,userId:e||s.userId||null,petId:s.petId||null,symptom:s.symptom||s.description||"",species:s.species||"dog",created_at:new Date().toISOString()},a=await u5.saveDiagnosis(o);a.success&&console.log("  Firestore  :",a.id)}catch(o){console.warn("Firestore   (  ):",o)}}catch(n){console.error("Failed to save diagnosis:",n)}},b3=t=>{try{const n=JSON.parse(localStorage.getItem(za)||"[]").filter(s=>s.petId===t);return n.length===0?null:n[0]}catch(e){return console.error("Failed to get latest diagnosis:",e),null}},My=t=>{if(!t)return" ";const e=new Date(t);return`${new Date().getFullYear()-e.getFullYear()}`},Rm=[{id:"dog",label:"",emoji:"",icon:"/icon/profile_background_less/dog-removebg-preview.png"},{id:"cat",label:"",emoji:"",icon:"/icon/profile_background_less/cat-removebg-preview.png"},{id:"rabbit",label:"",emoji:"",icon:"/icon/profile_background_less/rabbit-removebg-preview.png"},{id:"hamster",label:"",emoji:"",icon:"/icon/profile_background_less/hamster-removebg-preview.png"},{id:"bird",label:"",emoji:"",icon:"/icon/profile_background_less/bird-removebg-preview.png"},{id:"hedgehog",label:"",emoji:"",icon:"/icon/profile_background_less/hedgehog-removebg-preview.png"},{id:"reptile",label:"",emoji:"",icon:"/icon/profile_background_less/reptile-removebg-preview.png"},{id:"other",label:"",emoji:"",icon:"/icon/profile_background_less/etc-removebg-preview.png"}],N3=["","","","","","","","","","","","","","","","","","","",""],j3=["","","","","","","","","","","","","","","","",""],k3=[" "," ","","","","",""],I3=["","","","","",""],S3=["","","","","","","",""],E3=["","","","","",""],T3=["","","","","","","",""],cj=[""],A3={dog:N3,cat:j3,rabbit:k3,hamster:I3,bird:S3,hedgehog:E3,reptile:T3,other:cj};function C3({onComplete:t,userId:e}){var p;const[n,s]=L.useState({petName:"",species:"dog",breed:"",birthDate:"",sex:"M",neutered:!0,sido:"",sigungu:"",profileImage:null,character:"dog_white"}),[r,o]=L.useState(!1),[a,l]=L.useState(null),u=x=>{const v=x.target.files[0];if(v){if(v.size>5*1024*1024){alert("  5MB  .");return}const j=new FileReader;j.onload=A=>{const w=A.target.result;l(w),s(y=>({...y,profileImage:w}))},j.readAsDataURL(v)}},d=x=>{const j={dog:"dog_white",cat:"cat_orange",bird:"bird_parrot",hamster:"hamster_gold",rabbit:"rabbit_white",hedgehog:"hedgehog_normal",reptile:"reptile_lizard",other:"other_pet"}[x]||"other_pet",A=x!=="dog"&&x!=="cat";s(w=>({...w,species:x,character:j,breed:A?"":w.breed}))},h={:["","","","","","","","","","","","","","","","","","","","","","","","",""],:["","","","","","","","","","","","","","","",""],:["","","","","","","",""],:["","","","","","","","","",""],:["","","","",""],:["","","","",""],:["","","","",""],:[""],:[""," "," "," ","","","","","","","","",""," "," "," "," "," "," "," ",""," "," ",""," "," ","","","","",""," "," "," ","","","","","","","",""],:["","","","","","","","","","","","","","","","","",""],:["","","","","","","","",""," "," "," "," ",""],:["","","","","","","","","","",""," "," ","","",""],:["","","","","","","","","","",""," "," ","",""],:["","","","","","","","","","","","","","","","","","","","","",""],:["","","","","","","","","","","","","","","","","","","","","",""," "," "],:["","","","","","","","","","","",""," "," "," "," "," ","","","","",""],:["",""]},m=x=>{x.preventDefault(),o(!0),setTimeout(()=>{const v={...n,id:Date.now(),userId:e,createdAt:new Date().toISOString()};if(e){const j=dc(e);j.push(v),lj(e,j,v)}else{const j=_3();j.push(v),w3(j)}t(v)},1e3)};return i.jsx("div",{className:"registration-container",children:i.jsxs("div",{className:"registration-card",children:[i.jsxs("div",{className:"header-gradient",children:[i.jsx("h1",{children:" PetMedical.AI"}),i.jsx("p",{children:"   "})]}),r?i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"spinner"}),i.jsx("p",{children:" ..."})]}):i.jsxs("form",{onSubmit:m,className:"registration-form",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:" *"}),i.jsx("div",{className:"species-grid",children:Rm.map(x=>i.jsxs("button",{type:"button",className:`species-btn ${n.species===x.id?"active":""}`,onClick:()=>d(x.id),children:[i.jsx("img",{src:x.icon,alt:x.label,className:"species-icon",onError:v=>{v.target.style.display="none",v.target.nextSibling.style.display="inline"}}),i.jsx("span",{className:"species-emoji",style:{display:"none"},children:x.emoji}),i.jsx("span",{className:"species-label",children:x.label})]},x.id))})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:" "}),i.jsxs("div",{className:"profile-selector",children:[i.jsx("div",{className:"profile-preview-container",children:a?i.jsxs("div",{className:"profile-preview",children:[i.jsx("img",{src:a,alt:" "}),i.jsx("button",{type:"button",className:"remove-image-btn",onClick:()=>{l(null),s(x=>({...x,profileImage:null}))},children:""})]}):i.jsx("div",{className:"profile-preview character",style:{backgroundColor:"#e0f2fe"},children:(()=>{const x=Rm.find(j=>j.id===n.species),v=(x==null?void 0:x.icon)||null;return v?i.jsx("img",{src:v,alt:x.label,className:"profile-species-icon",onError:j=>{j.target.style.display="none",j.target.parentElement.innerHTML=`<span class="character-emoji">${(x==null?void 0:x.emoji)||""}</span>`}}):i.jsx("span",{className:"character-emoji",children:(x==null?void 0:x.emoji)||""})})()})}),i.jsx("div",{className:"profile-options",children:i.jsxs("label",{className:"upload-btn",children:["  ",i.jsx("input",{type:"file",accept:"image/*",onChange:u,style:{display:"none"}})]})})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"  *"}),i.jsx("input",{type:"text",required:!0,placeholder:": ",value:n.petName,onChange:x=>s({...n,petName:x.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:""}),i.jsxs("select",{value:n.breed,onChange:x=>s({...n,breed:x.target.value}),className:"breed-select",children:[i.jsx("option",{value:"",children:" "}),(A3[n.species]||cj).map(x=>i.jsx("option",{value:x,children:x},x))]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:" *"}),i.jsx("input",{type:"date",required:!0,value:n.birthDate,onChange:x=>s({...n,birthDate:x.target.value})})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:" *"}),i.jsxs("div",{className:"radio-group",children:[i.jsxs("div",{className:`radio-item ${n.sex==="M"?"active":""}`,children:[i.jsx("input",{type:"radio",id:"male",name:"sex",value:"M",checked:n.sex==="M",onChange:x=>s({...n,sex:x.target.value})}),i.jsx("label",{htmlFor:"male",children:" "})]}),i.jsxs("div",{className:`radio-item ${n.sex==="F"?"active":""}`,children:[i.jsx("input",{type:"radio",id:"female",name:"sex",value:"F",checked:n.sex==="F",onChange:x=>s({...n,sex:x.target.value})}),i.jsx("label",{htmlFor:"female",children:" "})]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"  *"}),i.jsxs("div",{className:"radio-group",children:[i.jsxs("div",{className:`radio-item ${n.neutered===!0?"active":""}`,children:[i.jsx("input",{type:"radio",id:"neutered-yes",name:"neutered",checked:n.neutered===!0,onChange:()=>s({...n,neutered:!0})}),i.jsx("label",{htmlFor:"neutered-yes",children:" "})]}),i.jsxs("div",{className:`radio-item ${n.neutered===!1?"active":""}`,children:[i.jsx("input",{type:"radio",id:"neutered-no",name:"neutered",checked:n.neutered===!1,onChange:()=>s({...n,neutered:!1})}),i.jsx("label",{htmlFor:"neutered-no",children:" "})]})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{children:"  *"}),i.jsxs("select",{required:!0,value:n.sido,onChange:x=>s({...n,sido:x.target.value,sigungu:""}),children:[i.jsx("option",{value:"",children:"/ "}),Object.keys(h).map(x=>i.jsx("option",{value:x,children:x},x))]})]}),n.sido&&i.jsx("div",{className:"form-group",children:i.jsxs("select",{required:!0,value:n.sigungu,onChange:x=>s({...n,sigungu:x.target.value}),children:[i.jsx("option",{value:"",children:"// "}),(p=h[n.sido])==null?void 0:p.map(x=>i.jsx("option",{value:x,children:x},x))]})}),i.jsx("button",{type:"submit",className:"submit-btn",children:" "})]})]})})}function P3({pets:t,onSelectPet:e,onAddNew:n,onNavigate:s}){return i.jsxs("div",{className:"min-h-screen bg-slate-50",children:[i.jsx("div",{className:"fixed top-0 left-0 right-0 h-16 bg-white/80 backdrop-blur-md border-b border-gray-200 flex items-center px-4 z-50",children:i.jsxs("div",{className:"max-w-md mx-auto w-full flex items-center justify-between",children:[i.jsx("h1",{className:"text-lg font-bold text-gray-900",children:" "}),i.jsx("button",{className:"bg-teal-600 text-white px-4 py-2 rounded-xl text-sm font-bold hover:bg-teal-700 transition-colors",onClick:n,children:"+  "})]})}),i.jsx("div",{className:"pt-20 p-4 max-w-md mx-auto space-y-4",children:t.length===0?i.jsxs("div",{className:"text-center py-20 animate-fade-in",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"  "}),i.jsx("p",{className:"text-gray-500 mb-6",children:"  "}),i.jsx("button",{className:"bg-teal-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-teal-700 transition-colors",onClick:n,children:" "})]}):i.jsx("div",{className:"space-y-4 animate-fade-in",children:t.map(r=>i.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex items-center gap-4 hover:shadow-md hover:border-teal-200 transition-all cursor-pointer",onClick:()=>e(r),children:[i.jsx("div",{className:"w-16 h-16 rounded-full bg-teal-100 flex items-center justify-center overflow-hidden",children:i.jsx("img",{src:mn(r,!1),alt:r.petName||r.name,className:"w-full h-full object-cover"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:r.petName}),i.jsx("p",{className:"text-sm text-gray-500",children:r.breed||" "}),i.jsxs("p",{className:"text-xs text-gray-400",children:[r.sido," ",r.sigungu]})]}),i.jsx("div",{className:"w-8 h-8 rounded-full bg-teal-50 text-teal-600 flex items-center justify-center",children:""})]},r.id))})})]})}function R3({petData:t,pets:e,onNavigate:n,onSelectPet:s}){const[r,o]=L.useState(null),[a,l]=L.useState([]),[u,d]=L.useState(null),[h,m]=L.useState(null),[p,x]=L.useState(null),[v,j]=L.useState(!1),[A,w]=L.useState(100),[y,E]=L.useState(""),[R,$]=L.useState(!1),[D,_]=L.useState({meal:0,water:0,walk:0,treats:0,grooming:0,play:0}),b=()=>{if(!(t!=null&&t.id))return;const N=new Date().toISOString().split("T")[0],O={date:N,petId:t.id,weight:y?parseFloat(y):null,actions:D,savedAt:new Date().toISOString()},M=JSON.parse(localStorage.getItem(`petMedical_careRecords_${t.id}`)||"[]"),ie=M.findIndex(Q=>Q.date===N);ie>=0?M[ie]=O:M.unshift(O);const Ae=M.slice(0,30);localStorage.setItem(`petMedical_careRecords_${t.id}`,JSON.stringify(Ae)),$(!0),setTimeout(()=>$(!1),2e3)};L.useEffect(()=>{if(!(t!=null&&t.id))return;const N=new Date().toISOString().split("T")[0],M=JSON.parse(localStorage.getItem(`petMedical_careRecords_${t.id}`)||"[]").find(ie=>ie.date===N);M&&(M.weight&&E(M.weight.toString()),M.actions&&_(M.actions))},[t==null?void 0:t.id]),L.useEffect(()=>{if(t)try{const N=localStorage.getItem(`petMedical_healthPoints_${t.id}`);N&&w(parseInt(N))}catch(N){console.error("   :",N)}},[t]),L.useEffect(()=>{if(!t)return;const N=e5(t.id);l(N);const O=b3(t.id);if(O){if(O.healthFlags){const M=Am(O.healthFlags);o(M)}O.triage_score!==void 0&&m(O.triage_score)}N.length>=3&&!(O!=null&&O.healthFlags)&&s5(t,N).then(M=>{if(d(M),M.health_flags){const ie=Am(M.health_flags);x(ie)}}).catch(M=>console.error("  :",M))},[t]),{...r||p||{earIssue:!1,digestionIssue:!1,skinIssue:!1,fever:!1,energyLevel:.7}};const I=()=>{if(!t)return Vi("dog");if(t.profileImage)return t.profileImage;const N=t.species||"dog";return Vi(N)},C=()=>{if(!t)return"";if(t.species==="dog"||t.species==="cat")return t.breed||(t.species==="dog"?"":"");const N=Rm.find(O=>O.id===t.species);return(N==null?void 0:N.label)||""},P=()=>t!=null&&t.sex?t.sex==="M"?"":"":null;return i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-200 via-sky-100 to-blue-200",children:[i.jsxs("div",{className:"hidden",children:[i.jsx("div",{className:"flex-shrink-0 flex items-center justify-center",children:i.jsx("div",{className:"relative w-[430px] h-[932px] rounded-[3rem] shadow-2xl border-8 border-gray-800 overflow-hidden bg-white",children:i.jsxs("div",{className:"h-full overflow-y-auto overflow-x-hidden bg-slate-50 pb-20",children:[i.jsx("header",{className:"bg-gradient-to-r from-sky-400 to-sky-500 text-white px-4 pt-4 pb-4 shadow-lg",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"w-9 h-9 bg-white rounded-lg flex items-center justify-center shadow-md flex-shrink-0",children:i.jsx("span",{className:"text-xl",children:""})}),i.jsxs("div",{className:"text-center ml-2",children:[i.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"PetMedical.AI"}),i.jsx("p",{className:"text-sky-100 text-xs font-medium",children:"AI     "})]})]})}),i.jsx("div",{className:"px-4 pt-4 pb-4",children:t?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-lg border border-slate-100 relative overflow-hidden mb-4",children:[i.jsxs("div",{className:"relative flex items-stretch gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-24 h-36 bg-white/80 rounded-2xl shadow-md overflow-hidden border-2 border-white flex items-center justify-center",children:i.jsx("img",{src:I(),alt:(t==null?void 0:t.petName)||(t==null?void 0:t.name)||"",className:"w-full h-full object-contain",style:{objectPosition:"center",display:"block"},onError:N=>{if(N.target.dataset.retryAttempted==="true"){console.warn("   ,    "),N.target.style.display="none";return}console.error("  :",N.target.src),N.target.dataset.retryAttempted="true";const O=(t==null?void 0:t.species)||"dog",M=Vi(O);N.target.src!==M?N.target.src=M:N.target.style.display="none"}})}),i.jsxs("div",{className:"flex-1 flex flex-col justify-between py-1",children:[i.jsxs("div",{className:"flex flex-col items-center justify-center text-center w-full",children:[i.jsx("p",{className:"text-base font-bold text-gray-800 w-full",children:"AI   24 "}),i.jsxs("p",{className:"text-base font-bold text-gray-800 mt-1 w-full",children:[(t==null?void 0:t.petName)||(t==null?void 0:t.name)||"","  "]}),i.jsx("p",{className:"text-base font-bold text-sky-700 mt-2 w-full",children:"   !"})]}),i.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap mt-2",children:[i.jsx("span",{className:"text-[11px] text-gray-600 font-medium bg-white/80 px-2 py-0.5 rounded-full",children:C()}),P()&&i.jsx("span",{className:"text-[11px] text-gray-600 font-medium bg-white/80 px-2 py-0.5 rounded-full",children:P()}),i.jsx("span",{className:"text-[11px] text-gray-600 font-medium bg-white/80 px-2 py-0.5 rounded-full",children:My(t.birthDate)}),y&&i.jsxs("span",{className:"text-[11px] text-gray-600 font-medium bg-white/80 px-2 py-0.5 rounded-full",children:[y,"kg"]}),i.jsx("button",{onClick:()=>n("profile-list"),className:"px-3 py-1 bg-sky-500 text-white text-[11px] font-bold rounded-full shadow-md hover:bg-sky-600 transition-colors",children:""})]})]})]}),i.jsx("button",{onClick:()=>n("symptom-input"),className:"w-full mt-3 bg-gradient-to-r from-sky-400 to-sky-500 text-white font-bold text-sm py-3 rounded-xl shadow-md hover:shadow-lg transition-all",children:"PetMedical.AI    >"})]}),i.jsxs("div",{className:"bg-amber-50 rounded-2xl p-3 shadow-lg border-2 border-amber-200 relative overflow-hidden mb-4",children:[i.jsxs("div",{className:"relative flex items-center justify-center gap-2 mb-2",children:[i.jsx("span",{className:"text-2xl",children:""}),i.jsx("h3",{className:"text-gray-800 font-bold text-base",children:"AI  "})]}),i.jsx("button",{onClick:()=>n("ai-consultation"),className:"w-full bg-gradient-to-r from-amber-400 to-yellow-500 text-gray-900 font-bold text-sm py-2 rounded-xl shadow-md hover:shadow-lg hover:scale-[1.02] transition-all",children:"7  AI  >"})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsxs("h3",{className:"text-base font-bold text-gray-800",children:[(t==null?void 0:t.petName)||(t==null?void 0:t.name)||"","  "]})]}),i.jsx("button",{onClick:()=>n("records"),className:"text-xs text-sky-600 font-semibold",children:" >"})]}),i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-lg border border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3 py-3 border-b border-gray-100",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-2xl",children:""})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-0.5",children:" "}),i.jsx("p",{className:"text-xs text-gray-500",children:" : 2025 12 15"})]}),i.jsx("span",{className:"text-gray-400 text-lg",children:">"})]}),i.jsxs("div",{className:"flex items-center gap-3 py-3 border-b border-gray-100",children:[i.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-2xl",children:""})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-0.5",children:" "}),i.jsx("p",{className:"text-xs text-gray-500",children:"  (2 )"})]}),i.jsx("span",{className:"text-gray-400 text-lg",children:">"})]}),i.jsxs("div",{className:"flex items-center gap-3 py-3",children:[i.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-2xl",children:""})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-0.5",children:""}),i.jsx("p",{className:"text-xs text-gray-500",children:"   "})]}),i.jsx("span",{className:"text-gray-400 text-lg",children:">"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-lg border border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-base font-bold text-gray-800",children:" "}),i.jsx("span",{className:"text-xs text-gray-400",children:new Date().toISOString().split("T")[0]})]}),i.jsx("div",{className:"grid grid-cols-5 gap-2 mb-4",children:[{icon:"",label:"",key:"meal"},{icon:"",label:"",key:"water"},{icon:"",label:"",key:"walk"},{icon:"",label:"",key:"treats"},{icon:"",label:"",key:"grooming"}].map(N=>i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{className:"w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm",onClick:()=>{_(O=>({...O,[N.key]:O[N.key]+1})),w(O=>{const M=Math.min(100,O+5);return t!=null&&t.id&&localStorage.setItem(`petMedical_healthPoints_${t.id}`,M.toString()),M})},children:i.jsx("span",{className:"text-xl",children:N.icon})}),D[N.key]>0&&i.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1 shadow-md",children:D[N.key]})]}),i.jsx("span",{className:"text-[10px] font-semibold text-gray-500 mt-1",children:N.label})]},N.key))})]})]}):i.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-100",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:" "}),i.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"      "}),i.jsx("button",{onClick:()=>n("profile-registration"),className:"w-full py-3 bg-gradient-to-r from-sky-400 to-sky-500 text-white font-bold rounded-xl hover:shadow-lg transition-all",children:" "})]})})]})})}),i.jsx("main",{className:"flex-1 p-8 overflow-y-auto",children:i.jsxs("div",{className:"max-w-6xl mx-auto",children:[i.jsxs("div",{className:"mb-8",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:t?`${(t==null?void 0:t.petName)||(t==null?void 0:t.name)||""}  `:" "}),i.jsx("p",{className:"text-gray-500 mt-2 text-lg",children:"AI 24   "})]}),i.jsx("div",{className:"space-y-6",children:t?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("button",{onClick:()=>n("symptom-input"),className:"bg-gradient-to-br from-sky-400 to-sky-500 text-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all text-left",children:[i.jsx("span",{className:"text-3xl mb-3 block",children:""}),i.jsx("h3",{className:"text-lg font-bold",children:"AI "}),i.jsx("p",{className:"text-sky-100 text-sm mt-1",children:"  AI "})]}),i.jsxs("button",{onClick:()=>n("ai-consultation"),className:"bg-gradient-to-br from-amber-400 to-yellow-500 text-gray-900 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all text-left",children:[i.jsx("span",{className:"text-3xl mb-3 block",children:""}),i.jsx("h3",{className:"text-lg font-bold",children:"AI  "}),i.jsx("p",{className:"text-amber-800 text-sm mt-1",children:"7   "})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[i.jsx("span",{children:""}),"  "]}),i.jsx("button",{onClick:()=>n("records"),className:"text-sm text-sky-600 font-medium",children:" >"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-xl",children:[i.jsx("span",{className:"text-2xl",children:""}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:" "}),i.jsx("p",{className:"text-sm text-gray-500",children:" : 2025 12 15"})]})]}),i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-xl",children:[i.jsx("span",{className:"text-2xl",children:""}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:" "}),i.jsx("p",{className:"text-sm text-gray-500",children:"  (2 )"})]})]}),i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-orange-50 rounded-xl",children:[i.jsx("span",{className:"text-2xl",children:""}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:""}),i.jsx("p",{className:"text-sm text-gray-500",children:"   "})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900",children:" "}),i.jsx("span",{className:"text-sm text-gray-400",children:new Date().toISOString().split("T")[0]})]}),i.jsx("div",{className:"grid grid-cols-5 gap-3 mb-4",children:[{icon:"",label:"",key:"meal",bg:"bg-gray-50",points:5},{icon:"",label:"",key:"water",bg:"bg-sky-50",points:3},{icon:"",label:"",key:"walk",bg:"bg-yellow-50",points:10},{icon:"",label:"",key:"treats",bg:"bg-orange-50",points:2},{icon:"",label:"",key:"grooming",bg:"bg-amber-50",points:7}].map(N=>i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("button",{className:`w-12 h-12 ${N.bg} rounded-full flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm relative`,onClick:()=>{_(O=>({...O,[N.key]:O[N.key]+1})),w(O=>{const M=Math.min(100,O+N.points);return t!=null&&t.id&&localStorage.setItem(`petMedical_healthPoints_${t.id}`,M.toString()),M})},children:[i.jsx("span",{className:"text-xl",children:N.icon}),D[N.key]>0&&i.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center",children:D[N.key]})]}),i.jsx("span",{className:"text-xs text-gray-500 mt-1",children:N.label})]},N.key))}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  (kg)"}),i.jsx("input",{type:"number",step:"0.1",placeholder:"5.2",value:y,onChange:N=>E(N.target.value),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:border-sky-400 focus:outline-none"})]}),i.jsx("button",{onClick:b,className:`w-full py-3 rounded-xl font-bold text-sm transition-all ${R?"bg-green-500 text-white":"bg-gradient-to-r from-sky-400 to-sky-500 text-white hover:shadow-lg"}`,children:R?" !":` ${(t==null?void 0:t.petName)||(t==null?void 0:t.name)||""}  `})]})]})]})]}):i.jsx("div",{className:"bg-white rounded-2xl p-8 shadow-lg",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:" "}),i.jsx("p",{className:"text-gray-500 mb-6",children:" AI   "}),i.jsx("button",{onClick:()=>n("profile-registration"),className:"px-8 py-3 bg-gradient-to-r from-sky-400 to-sky-500 text-white font-bold rounded-xl hover:shadow-lg transition-all",children:" "})]})})})]})})]}),i.jsxs("div",{className:"md:flex md:items-center md:justify-center md:p-8 md:min-h-screen",children:[i.jsx("div",{className:"hidden md:block fixed inset-0 pointer-events-none",children:i.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-200 via-sky-100 to-blue-200"})}),i.jsx("div",{className:"relative md:w-[430px] md:h-[932px] md:rounded-[3rem] md:shadow-2xl md:border-8 md:border-gray-800 overflow-hidden",children:i.jsxs("div",{className:"h-full overflow-y-auto overflow-x-hidden bg-slate-50 pb-20",children:[i.jsx("header",{className:"bg-gradient-to-r from-sky-400 to-sky-500 text-white px-4 pt-4 pb-4 shadow-lg",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"w-9 h-9 bg-white rounded-lg flex items-center justify-center shadow-md flex-shrink-0",children:i.jsx("span",{className:"text-xl",children:""})}),i.jsxs("div",{className:"text-center ml-2",children:[i.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"PetMedical.AI"}),i.jsx("p",{className:"text-sky-100 text-xs font-medium",children:"AI     "})]})]})}),i.jsx("div",{className:"px-4 pt-4 pb-4",children:t?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-lg border border-slate-100 relative overflow-hidden mb-4",children:[i.jsxs("div",{className:"relative flex items-stretch gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-24 h-36 bg-white/80 rounded-2xl shadow-md overflow-hidden border-2 border-white",children:i.jsx("img",{src:I(),alt:(t==null?void 0:t.petName)||"",className:"w-full h-full object-cover",style:{objectPosition:"center",display:"block"},onError:N=>{if(N.target.dataset.retryAttempted==="true"){console.warn("   ,    "),N.target.style.display="none";return}console.error("  :",N.target.src),N.target.dataset.retryAttempted="true";const O=(t==null?void 0:t.species)||"dog",M=Vi(O);N.target.src!==M?N.target.src=M:N.target.style.display="none"}})}),i.jsxs("div",{className:"flex-1 flex flex-col justify-between py-1",children:[i.jsxs("div",{className:"flex flex-col items-center justify-center text-center w-full",children:[i.jsx("p",{className:"text-base font-bold text-gray-800 w-full",children:"AI   24 "}),i.jsxs("p",{className:"text-base font-bold text-gray-800 mt-1 w-full",children:[(t==null?void 0:t.petName)||(t==null?void 0:t.name)||"","  "]}),i.jsx("p",{className:"text-base font-bold text-sky-700 mt-2 w-full",children:"   !"})]}),i.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap mt-2",children:[i.jsx("span",{className:"text-[11px] text-gray-600 font-medium bg-white/80 px-2 py-0.5 rounded-full",children:C()}),P()&&i.jsx("span",{className:"text-[11px] text-gray-600 font-medium bg-white/80 px-2 py-0.5 rounded-full",children:P()}),i.jsx("span",{className:"text-[11px] text-gray-600 font-medium bg-white/80 px-2 py-0.5 rounded-full",children:My(t.birthDate)}),y&&i.jsxs("span",{className:"text-[11px] text-gray-600 font-medium bg-white/80 px-2 py-0.5 rounded-full",children:[y,"kg"]}),i.jsx("button",{onClick:()=>n("profile-list"),className:"px-3 py-1 bg-sky-500 text-white text-[11px] font-bold rounded-full shadow-md hover:bg-sky-600 transition-colors",children:""})]})]})]}),i.jsx("button",{onClick:()=>n("symptom-input"),className:"w-full mt-3 bg-gradient-to-r from-sky-400 to-sky-500 text-white font-bold text-sm py-3 rounded-xl shadow-md hover:shadow-lg transition-all",children:"PetMedical.AI    >"})]}),i.jsxs("div",{className:"bg-amber-50 rounded-2xl p-3 shadow-lg border-2 border-amber-200 relative overflow-hidden mb-4",children:[i.jsxs("div",{className:"relative flex items-center justify-center gap-2 mb-2",children:[i.jsx("span",{className:"text-2xl",children:""}),i.jsx("h3",{className:"text-gray-800 font-bold text-base",children:"AI  "})]}),i.jsx("button",{onClick:()=>n("ai-consultation"),className:"w-full bg-gradient-to-r from-amber-400 to-yellow-500 text-gray-900 font-bold text-sm py-2 rounded-xl shadow-md hover:shadow-lg hover:scale-[1.02] transition-all",children:"7  AI  >"})]}),i.jsxs("div",{className:"mb-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-lg",children:""}),i.jsxs("h3",{className:"text-base font-bold text-gray-800",children:[(t==null?void 0:t.petName)||(t==null?void 0:t.name)||"","  "]})]}),i.jsx("button",{onClick:()=>n("records"),className:"text-xs text-sky-600 font-semibold",children:" >"})]}),i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-lg border border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-3 py-3 border-b border-gray-100",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-2xl",children:""})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-0.5",children:" "}),i.jsx("p",{className:"text-xs text-gray-500",children:" : 2025 12 15"})]}),i.jsx("span",{className:"text-gray-400 text-lg",children:">"})]}),i.jsxs("div",{className:"flex items-center gap-3 py-3 border-b border-gray-100",children:[i.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-2xl",children:""})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-0.5",children:" "}),i.jsx("p",{className:"text-xs text-gray-500",children:"  (2 )"})]}),i.jsx("span",{className:"text-gray-400 text-lg",children:">"})]}),i.jsxs("div",{className:"flex items-center gap-3 py-3",children:[i.jsx("div",{className:"w-12 h-12 bg-orange-50 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-2xl",children:""})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-0.5",children:""}),i.jsx("p",{className:"text-xs text-gray-500",children:"   "})]}),i.jsx("span",{className:"text-gray-400 text-lg",children:">"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-2xl p-5 shadow-lg border border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-base font-bold text-gray-800",children:" "}),i.jsx("span",{className:"text-xs text-gray-400",children:new Date().toISOString().split("T")[0]})]}),i.jsxs("div",{className:"grid grid-cols-5 gap-2 mb-4",children:[i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{className:"w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm",onClick:()=>{_(N=>({...N,meal:N.meal+1})),w(N=>{const O=Math.min(100,N+5);return t!=null&&t.id&&localStorage.setItem(`petMedical_healthPoints_${t.id}`,O.toString()),O})},children:i.jsx("span",{className:"text-xl",children:""})}),D.meal>0&&i.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1 shadow-md",children:D.meal})]}),i.jsx("span",{className:"text-[10px] font-semibold text-gray-500 mt-1",children:""})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{className:"w-12 h-12 bg-sky-50 rounded-full flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm",onClick:()=>{_(N=>({...N,water:N.water+1})),w(N=>{const O=Math.min(100,N+3);return t!=null&&t.id&&localStorage.setItem(`petMedical_healthPoints_${t.id}`,O.toString()),O})},children:i.jsx("span",{className:"text-xl",children:""})}),D.water>0&&i.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1 shadow-md",children:D.water})]}),i.jsx("span",{className:"text-[10px] font-semibold text-gray-500 mt-1",children:""})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{className:"w-12 h-12 bg-yellow-50 rounded-full flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm",onClick:()=>{_(N=>({...N,walk:N.walk+1})),w(N=>{const O=Math.min(100,N+10);return t!=null&&t.id&&localStorage.setItem(`petMedical_healthPoints_${t.id}`,O.toString()),O})},children:i.jsx("span",{className:"text-xl",children:""})}),D.walk>0&&i.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1 shadow-md",children:D.walk})]}),i.jsx("span",{className:"text-[10px] font-semibold text-gray-500 mt-1",children:""})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{className:"w-12 h-12 bg-orange-50 rounded-full flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm",onClick:()=>{_(N=>({...N,treats:N.treats+1})),w(N=>{const O=Math.min(100,N+2);return t!=null&&t.id&&localStorage.setItem(`petMedical_healthPoints_${t.id}`,O.toString()),O})},children:i.jsx("span",{className:"text-xl",children:""})}),D.treats>0&&i.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1 shadow-md",children:D.treats})]}),i.jsx("span",{className:"text-[10px] font-semibold text-gray-500 mt-1",children:""})]}),i.jsxs("div",{className:"flex flex-col items-center",children:[i.jsxs("div",{className:"relative",children:[i.jsx("button",{className:"w-12 h-12 bg-amber-50 rounded-full flex items-center justify-center hover:scale-105 active:scale-95 transition-all shadow-sm",onClick:()=>{_(N=>({...N,grooming:N.grooming+1})),w(N=>{const O=Math.min(100,N+7);return t!=null&&t.id&&localStorage.setItem(`petMedical_healthPoints_${t.id}`,O.toString()),O})},children:i.jsx("span",{className:"text-xl",children:""})}),D.grooming>0&&i.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1 shadow-md",children:D.grooming})]}),i.jsx("span",{className:"text-[10px] font-semibold text-gray-500 mt-1",children:""})]})]}),i.jsxs("div",{className:"mb-3",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"  (kg)"}),i.jsx("input",{type:"number",step:"0.1",placeholder:"5.2",value:y,onChange:N=>E(N.target.value),className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-sky-400 focus:outline-none text-sm"})]}),i.jsxs("div",{className:"mb-4",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:" "}),i.jsx("input",{type:"text",placeholder:"  ",className:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:border-sky-400 focus:outline-none text-sm"})]}),i.jsx("button",{onClick:b,className:`w-full py-3 rounded-xl font-bold text-sm transition-all ${R?"bg-green-500 text-white":"bg-gradient-to-r from-sky-400 to-sky-500 text-white hover:shadow-lg"}`,children:R?" !":` ${(t==null?void 0:t.petName)||(t==null?void 0:t.name)||""}  `})]})]}):i.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-100",children:[i.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:" "}),i.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"      "}),i.jsx("button",{onClick:()=>n("profile-registration"),className:"w-full py-3 bg-gradient-to-r from-sky-400 to-sky-500 text-white font-bold rounded-xl hover:shadow-lg transition-all",children:" "})]})})]})})]})]})}function O3({petData:t,onComplete:e,onBack:n,onRegister:s}){const[r,o]=L.useState(""),[a,l]=L.useState([]),[u,d]=L.useState(!1),[h,m]=L.useState(""),[p,x]=L.useState([]),v={:{icon:"",desc:", ,  "},:{icon:"",desc:", , "},:{icon:"",desc:",  "},:{icon:"",desc:",  "},:{icon:"",desc:", "},:{icon:"",desc:"  "},:{icon:"",desc:",  "},:{icon:"",desc:",  "},:{icon:"",desc:",  "},:{icon:"",desc:",  "},:{icon:"",desc:", , "},:{icon:"",desc:", , "}," ":{icon:"",desc:"  "},:{icon:"",desc:" "}," ":{icon:"",desc:"  "}},j={dog:["","","","","","","","","",""],cat:["","","","","","","","",""],rabbit:["","","","",""],hamster:["","","",""],bird:[" ","","",""],hedgehog:["","","",""],reptile:[" ","","",""],other:["","","",""]},A={dog:{:[" ","","",""," "],:["","( )","/"," "," "],:[""," "," ","/"," "],:[" "," "," "," ","  "],:[" ","  "," "," ","   "],:[""," ","/ "," "," "],:["  ","  ","  "," ","  "],:["","  ","/","  "," "],:[" "," "," ","/",""],:["",""," "," ",""],:[""," "," ",""," "],:["",""," ","/"," "]},cat:{:[" ","",""," ",""],:[""," "," ","/"," "],:[""," ",""," "," "],:["/"," "," "," "," "],:[" ","  "," ","  "," "],:[""," "," "," "," "],:["  ","   ","  "," ","  "],:[" "," ","","/"," "],:[" "," "," "," /",""]},rabbit:{:[" ",""," "," "," "],:[" "," "," "," ",""],:[" "," "," ",""," "],:[" ",""," "," "," "],:["",""," "," "," "]},hamster:{:[" ",""," "," "," "],:[" "," ","","",""],:[" "," "," ","  ","  "],:[" "," "," ","",""]},bird:{" ":[" "," ",""," "," "],:[" ","",""," ",""],:[" "," "," "," "," "],:[" ","  "," ",""," "]},hedgehog:{:[" ",""," "," "," "],:[" "," ","",""," "],:[" "," ","","",""],:["",""," ","",""]},reptile:{" ":[" "," ",""," "," "],:[" "," ","","",""],:[" "," ","","",""],:["  ","",""," ",""]},other:{:[" ",""," "," "," "],:[" ","","",""," "],:["","","",""," "],:["/ ","","","",""]}};if(!t)return i.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg border border-slate-100 text-center max-w-sm",children:[i.jsx("div",{className:"w-20 h-20 bg-sky-100 rounded-full mx-auto mb-4 flex items-center justify-center",children:i.jsx("span",{className:"text-4xl",children:""})}),i.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:" "}),i.jsxs("p",{className:"text-sm text-slate-500 mb-6",children:["   ",i.jsx("br",{})," AI     "]}),i.jsx("button",{onClick:()=>s?s():n(),className:"w-full py-3 bg-sky-500 text-white font-bold rounded-xl hover:bg-sky-600 transition-colors",children:" "}),i.jsx("button",{onClick:n,className:"w-full mt-3 py-3 bg-slate-100 text-slate-600 font-medium rounded-xl hover:bg-slate-200 transition-colors",children:""})]})});const w=j[t.species]||j.other,y=A[t.species]||A.other,E=h?y[h]||[]:[],R=S=>{const C=Array.from(S.target.files).map(P=>new Promise(N=>{const O=new FileReader;O.onload=M=>N(M.target.result),O.readAsDataURL(P)}));Promise.all(C).then(P=>{l(N=>[...N,...P])})},$=S=>{l(I=>I.filter((C,P)=>P!==S))},D=()=>{if(!h){alert(" .");return}if(p.length===0&&!r.trim()&&a.length===0){alert("  .");return}d(!0);const S=[...p];r.trim()&&S.push(r.trim());const I=S.join(", ");setTimeout(()=>{e({symptomText:I,selectedSymptoms:p,userDescription:r,department:h,images:a,petData:t})},500)},_=S=>{x(I=>I.includes(S)?I.filter(C=>C!==S):[...I,S])},b=S=>{h===S?m(""):(m(S),x([]))};return i.jsxs("div",{className:"min-h-screen bg-slate-50",children:[i.jsxs("div",{className:"bg-white px-4 py-4 border-b border-slate-100",children:[i.jsx("div",{className:"flex items-center gap-3 mb-2",children:i.jsx("button",{onClick:n,className:"text-slate-600",children:i.jsx("span",{className:"text-sm",children:" "})})}),i.jsx("h1",{className:"text-xl font-bold text-slate-900",children:"AI  "}),i.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[t.petName||t.name||"","  "]})]}),i.jsxs("div",{className:"px-4 pt-4 pb-24 space-y-4",children:[i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-slate-100",children:[i.jsx("h3",{className:"font-bold text-slate-800 mb-1 text-sm",children:"  ? *"}),i.jsx("p",{className:"text-xs text-slate-500 mb-3",children:" "}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:w.map(S=>{const I=v[S]||{icon:"",desc:" "},C=h===S;return i.jsxs("button",{onClick:()=>b(S),className:`p-3 rounded-xl text-left transition-all border-2 ${C?"bg-sky-50 border-sky-500":"bg-white border-slate-200 hover:border-slate-300"}`,children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"text-lg",children:I.icon}),i.jsx("span",{className:`font-bold text-sm ${C?"text-sky-700":"text-slate-800"}`,children:S})]}),i.jsx("p",{className:`text-xs ${C?"text-sky-600":"text-slate-500"}`,children:I.desc})]},S)})})]}),h&&E.length>0&&i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-slate-100",children:[i.jsxs("h3",{className:"font-bold text-slate-800 mb-1 text-sm",children:[h,"  "]}),i.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"   "}),i.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(S=>i.jsx("button",{onClick:()=>_(S),className:`px-3 py-2 rounded-xl text-sm font-medium transition-all border ${p.includes(S)?"bg-sky-500 text-white border-sky-500":"bg-slate-50 text-slate-700 border-slate-200 hover:border-sky-300"}`,children:S},S))}),p.length>0&&i.jsx("div",{className:"mt-3 p-3 bg-sky-50 rounded-xl",children:i.jsxs("p",{className:"text-xs text-sky-700 font-medium",children:[" : ",p.join(", ")]})})]}),i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-slate-100",children:[i.jsx("h3",{className:"font-bold text-slate-800 mb-1 text-sm",children:"  "}),i.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"     "}),i.jsx("textarea",{className:"w-full p-3 rounded-xl border border-slate-200 bg-slate-50 text-slate-900 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 min-h-[80px] text-sm resize-none",placeholder:": 3     ,   ...",value:r,onChange:S=>o(S.target.value)})]}),i.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-slate-100",children:[i.jsx("h3",{className:"font-bold text-slate-800 mb-3 text-sm",children:"   ()"}),i.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-2",children:[a.map((S,I)=>i.jsxs("div",{className:"relative shrink-0",children:[i.jsx("img",{src:S,alt:`  ${I+1}`,className:"w-20 h-20 object-cover rounded-xl"}),i.jsx("button",{onClick:()=>$(I),className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full text-xs flex items-center justify-center",children:""})]},I)),i.jsxs("label",{className:"w-20 h-20 shrink-0 border-2 border-dashed border-slate-300 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:border-sky-500 hover:bg-sky-50 transition-all",children:[i.jsx("span",{className:"text-2xl text-slate-400",children:""}),i.jsx("span",{className:"text-[10px] text-slate-400 mt-1",children:""}),i.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:R,className:"hidden"})]})]}),i.jsx("p",{className:"text-xs text-slate-400 mt-2",children:", ,          "})]})]}),i.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-sm border-t border-slate-100 p-6 z-50",children:i.jsx("button",{onClick:D,disabled:u||p.length===0&&!r.trim()&&a.length===0,className:"w-full bg-sky-500 text-white py-6 px-8 rounded-xl font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-sky-600 active:bg-sky-700 transition-all flex items-center justify-center gap-3 shadow-lg shadow-sky-500/30 hover:shadow-xl hover:shadow-sky-500/40",children:u?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-6 h-6 border-2 border-white/30 border-t-white rounded-full animate-spin"}),i.jsx("span",{className:"text-lg font-bold",children:"AI  ..."})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"material-symbols-outlined text-2xl",children:"psychology"}),i.jsx("span",{className:"text-lg font-bold",children:"AI "})]})})})]})}const M3=t=>{const e=t.toLowerCase();return e.includes("")||e.includes("ear")?{diagnosis:" ( 75%)",emergency:"medium",actions:["    (  )","   (   )","  ","  (  )"],hospitalVisit:!0,hospitalVisitTime:"24 ",description:"      .        ."}:e.includes("")||e.includes("cough")||e.includes("")?{diagnosis:"   ( 70%)",emergency:"medium",actions:["  ","  ","   (20-22)","     "],hospitalVisit:!0,hospitalVisitTime:"48 ",description:"      .       ."}:e.includes("")||e.includes("")||e.includes("")||e.includes("appetite")?{diagnosis:" ( 65%)",emergency:e.includes("")||e.includes("")?"high":"medium",actions:["  ","   (,  )","  ","/     "],hospitalVisit:e.includes("")||e.includes(""),hospitalVisitTime:e.includes("")||e.includes("")?"":"24 ",description:"     .          ."}:e.includes("")||e.includes("diarrhea")||e.includes("")?{diagnosis:"  ( 70%)",emergency:"high",actions:["  ( )","  (12-24)","  ","   "],hospitalVisit:!0,hospitalVisitTime:"",description:"    .           ."}:e.includes("")||e.includes("")||e.includes("seizure")?{diagnosis:"   ( 80%)",emergency:"high",actions:["  ","    ","    ","  "],hospitalVisit:!0,hospitalVisitTime:"",description:"     .  5       ."}:{diagnosis:"   ( 60%)",emergency:"low",actions:["  ","  ","  ","    "],hospitalVisit:!1,hospitalVisitTime:"  ",description:"  ,       ."}};function L3({petData:t,symptomData:e,onComplete:n,onBack:s,onDiagnosisResult:r,currentUser:o}){const[a,l]=L.useState([]),[u,d]=L.useState(0),[h,m]=L.useState(!1),[p,x]=L.useState({medical:!0,triage:!0,care:!0}),[v,j]=L.useState(null),[A,w]=L.useState(!0),[y,E]=L.useState(""),[R,$]=L.useState(!1),[D,_]=L.useState(!1),[b,S]=L.useState([]),[I,C]=L.useState(!1),P=L.useRef(null),[N,O]=L.useState([]),[M,ie]=L.useState({}),[Ae,Q]=L.useState(!1),[V,Y]=L.useState(""),T=L.useRef(null);L.useEffect(()=>{P.current&&P.current.scrollIntoView({behavior:"smooth"})},[a]),L.useEffect(()=>{let W=!0;return(async()=>{var oe;try{w(!0),l([]),d(0);const ce=await U4(t,e,de=>{W&&(de.isQuestionPhase||(l(he=>he.some(ut=>ut.agent===de.agent&&ut.content===de.content)?he:[...he,{agent:de.agent,role:de.role,icon:de.icon,type:de.type,content:de.content,timestamp:de.timestamp}]),d(he=>he+1)))},de=>new Promise(he=>{if(!W){he({});return}O(de),ie({}),Q(!0),Y(""),T.current=he}));if(!W)return;if(console.log("[MultiAgentDiagnosis]  :",ce),console.log("[MultiAgentDiagnosis] finalDiagnosis:",ce==null?void 0:ce.finalDiagnosis),!ce||!ce.finalDiagnosis){console.error("[MultiAgentDiagnosis]   :",ce),w(!1),alert("     .  .");return}setTimeout(()=>{try{j(ce.finalDiagnosis),m(!0),w(!1),$(!0),Oy(ce.finalDiagnosis,o==null?void 0:o.uid),r&&r(ce.finalDiagnosis),console.log("[MultiAgentDiagnosis]   ")}catch(de){console.error("[MultiAgentDiagnosis]   :",de),w(!1),alert("    .")}},1500)}catch(xe){console.error("AI  :",xe);const ce=(e==null?void 0:e.symptomText)||"  ",de=((oe=e==null?void 0:e.images)==null?void 0:oe.length)>0,he=M3(ce),je=[{agent:"CS Agent",role:" ",icon:"",type:"cs",content:`, ${(t==null?void 0:t.petName)||(t==null?void 0:t.name)||""} .

 .

 :
 : ${(t==null?void 0:t.petName)||(t==null?void 0:t.name)||""}
 : ${qt(t.species)}
 : ${t.breed||""}

:
${ce}
${de?`
 ${e.images.length}  
`:""}
 Information Agent .`},{agent:"Information Agent",role:"",icon:"",type:"info",content:`     ...

${de?`  :    ...
`:""}   :   ...
   :    ...
   : AI   ...

  . Veterinarian Agent .`},{agent:"Veterinarian Agent",role:" ",icon:"",type:"medical",content:`   ...

   :
${he.description}

  :
 ${he.diagnosis}

 : ${he.emergency==="low"?"":he.emergency==="medium"?"":""}
 : ${he.emergency==="low"?" ":he.emergency==="medium"?" ":" "}

 Data Agent,   .`},{agent:"Data Agent",role:" ",icon:"",type:"data",content:`   ...

    
   
    
  PDF   

   !`}];je.forEach((ut,St)=>{setTimeout(()=>{l(Et=>[...Et,ut]),d(St+1),St===je.length-1&&setTimeout(()=>{const Et={...he,id:Date.now().toString(),created_at:Date.now(),petId:t.id,petName:(t==null?void 0:t.petName)||(t==null?void 0:t.name)||"",symptom:ce};j(Et),m(!0),w(!1),$(!0),Oy(Et,o==null?void 0:o.uid),r&&r(Et)},1500)},St*3e3)})}})(),()=>{W=!1}},[t==null?void 0:t.id,e==null?void 0:e.symptomText]);const B=(W,ne,oe)=>{ie(xe=>{if(oe){const ce=xe[W]||[];if(ce.includes(ne))return{...xe,[W]:ce.filter(de=>de!==ne)};{if(ne==="")return{...xe,[W]:[""]};const de=ce.filter(he=>he!=="");return{...xe,[W]:[...de,ne]}}}else return{...xe,[W]:ne}})},G=()=>{if(!N.every(xe=>{const ce=M[xe.id];return xe.type==="multiple",ce&&ce.length>0})){alert("   .");return}const ne={...M,additionalComment:V.trim()||""},oe=N.map(xe=>{const ce=M[xe.id],de=Array.isArray(ce)?ce.join(", "):ce;return` ${xe.question}
   ${de}`}).join(`

`);l(xe=>[...xe,{agent:"",role:"",icon:"",type:"user",content:`   

${oe}${V?`

  : ${V}`:""}`,isUser:!0,timestamp:Date.now()}]),T.current&&(T.current(ne),T.current=null),Q(!1),O([])},K=async()=>{var ne,oe;if(!y.trim()||!v)return;const W=y.trim();l(xe=>[...xe,{agent:"",role:"",icon:"",type:"user",content:`: ${W}`,isUser:!0,isQuestion:!0}]),E(""),w(!0);try{const xe=xn(Vt.ANTHROPIC);if(!xe)throw new Error("Claude API   .  > API   .");const ce=v.diagnosis||"  ",de=v.riskLevel||v.emergency||"moderate",he=v.actions||[],je=v.careGuide||"",ut=v.ownerSheet||{},St=ut.immediate_home_actions||he,Et=ut.things_to_avoid||[],Fs=ut.monitoring_guide||[],et=v.carePlan||{},rt=et.follow_up_guide||{},Tt=`  10   .       .

 :
-     ,     .
-     (:   ,   )
-      .
-     .`,gi=`[ ]
- : ${(t==null?void 0:t.petName)||(t==null?void 0:t.name)||""}
- : ${qt(t.species)}
- : ${t.breed||""}
- : ${t.age||""}
${t.weight?`- : ${t.weight}kg`:""}

[  ]
- : ${ce}
- : ${de}
- : ${v.triage_level||"yellow"}
- Triage Score: ${v.triage_score||"N/A"}/5
-    : ${et.hospital_needed?"":" "}

[ ]
${St.length>0?St.map((z,_e)=>`${_e+1}. ${z}`).join(`
`):"  "}

[  ]
${Et.length>0?Et.map((z,_e)=>`${_e+1}. ${z}`).join(`
`):""}

[ ]
${Fs.length>0?Fs.map((z,_e)=>`${_e+1}. ${z}`).join(`
`):""}

[ ]
-  : ${rt.home_care_duration||"2~3 "}
-   : ${rt.condition_for_hospital||"  "}

${je?`[ ]
${je}`:""}
${v3(W,t.species)}

[ ]
${W}

     :
1.      ( FAQ    )
2.     
3.    (:  ,  , )
4.      (   )

    ,   . 2-3   .`,yn=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":xe,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1024,system:Tt,messages:[{role:"user",content:gi}]})});if(!yn.ok){const z=await yn.json().catch(()=>({}));throw console.error("Claude API :",yn.status,z),new Error(`API  : ${yn.status} - ${((ne=z.error)==null?void 0:ne.message)||"   "}`)}const Ds=await yn.json();if(!Ds.content||!Ds.content[0]||!Ds.content[0].text)throw new Error("API   ");const vn=Ds.content[0].text;if(!vn||vn.trim().length===0)throw new Error("  ");l(z=>[...z,{agent:"Veterinarian Agent",role:" ",icon:"",type:"medical",content:vn.trim(),isResponse:!0,timestamp:Date.now()}])}catch(xe){console.error("  :",xe);let ce="";const de=W.toLowerCase();if(de.includes("")||de.includes("")||de.includes("")||de.includes(""))ce=`       :

1. **  **:  ( ), ( ),    
2. ** **:    ,    
3. ** **:          
4. ** **:       
5. ** **:     

 ****:
-       .
- 24         .
-   (${v.diagnosis||"  "})      .`;else if(de.includes("")||de.includes("")||de.includes("")){const he=v.triage_level||"yellow";ce=`    :

** **: ${he==="red"?"":he==="orange"?" ":he==="yellow"?"24~48 ":"  "}

${he==="red"?"   .    .":he==="orange"?"     .    .":he==="yellow"?" 24~48    .   .":"   ,   ."}

**    **:
-   (   )
-     
-   ,   
-   ( )

**  **:
-  ,  , /
-     
- / 
-    `}else if(de.includes("")||de.includes("")||de.includes("")){const he=v.actions||[];ce=`      :

** **:
${he.length>0?he.map((je,ut)=>`${ut+1}. ${je}`).join(`
`):`-   .
-     .`}

**  **:
1.    
2.   
3.   
4.     
5.   

****:
-        .
-   ,   .`}else ce=` .

 ${t.petName}   "${v.diagnosis||"  "}".

****:
${W}   ,       :

-  : ${v.riskLevel||""}
-  : ${((oe=v.actions)==null?void 0:oe.join(", "))||"  "}

        :
1.    
2.     
3.   

            .`;l(he=>[...he,{agent:"Veterinarian Agent",role:" ",icon:"",type:"medical",content:ce,isResponse:!0,timestamp:Date.now()}])}finally{w(!1)}},te=async()=>{if(!y.trim())return;if(v&&!A){K();return}const W=y.trim();l(ne=>[...ne,{agent:"",role:"",icon:"",type:"user",content:W,isUser:!0,timestamp:Date.now()}]),E(""),A&&setTimeout(()=>{l(ne=>[...ne,{agent:"CS Agent",role:"   ",icon:"",type:"cs",content:", .   . AI        .  !",timestamp:Date.now()}])},500)},le=W=>{const ne={cs:{bg:"#EFF6FF",icon:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",border:"#BFDBFE"},info:{bg:"#F0FDF4",icon:"linear-gradient(135deg, #10b981 0%, #059669 100%)",border:"#BBF7D0"},medical:{bg:"#F5F3FF",icon:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",border:"#DDD6FE"},triage:{bg:"#FEF2F2",icon:"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",border:"#FECACA"},data:{bg:"#FFF7ED",icon:"linear-gradient(135deg, #f97316 0%, #ea580c 100%)",border:"#FED7AA"},care:{bg:"#ECFEFF",icon:"linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)",border:"#A5F3FC"},summary:{bg:"#F8FAFC",icon:"linear-gradient(135deg, #64748b 0%, #475569 100%)",border:"#E2E8F0"}};return ne[W]||ne.cs};return i.jsxs("div",{className:"diagnosis-container",children:[i.jsxs("div",{className:"diagnosis-header",children:[i.jsx("button",{className:"back-btn",onClick:s,style:{position:"absolute",left:"20px",top:"20px",background:"none",border:"none",fontSize:"20px",cursor:"pointer"},children:""}),i.jsx("h1",{children:" AI  "}),i.jsxs("p",{children:["AI  ",(t==null?void 0:t.petName)||(t==null?void 0:t.name)||""," "]})]}),i.jsxs("div",{className:"chat-messages-container",style:{padding:"16px",display:"flex",flexDirection:"column",gap:"12px",maxHeight:"calc(100vh - 400px)",overflowY:"auto",background:"#f8fafc",borderRadius:"12px",margin:"0 16px"},children:[a.length===0&&A&&i.jsxs("div",{className:"initial-loading",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"40px",gap:"16px"},children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{style:{margin:0,fontSize:"16px",color:"#333"},children:"AI   ..."}),i.jsx("p",{style:{margin:0,fontSize:"14px",color:"#666"},children:" "})]}),a.map((W,ne)=>{const oe=W.agent===""||W.isUser,xe=W.type==="system",ce=le(W.type);return xe?i.jsx("div",{style:{textAlign:"center",padding:"8px 16px",margin:"4px 0",fontSize:"12px",color:"#64748b",fontWeight:"500"},children:W.content},ne):i.jsxs("div",{style:{display:"flex",flexDirection:oe?"row-reverse":"row",gap:"8px",alignItems:"flex-start",marginBottom:"8px"},children:[!oe&&i.jsx("div",{style:{width:"36px",height:"36px",minWidth:"36px",borderRadius:"50%",background:ce.icon,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",boxShadow:"0 2px 6px rgba(0,0,0,0.1)"},children:W.icon||""}),i.jsxs("div",{style:{maxWidth:"70%",display:"flex",flexDirection:"column",gap:"4px"},children:[!oe&&i.jsx("div",{style:{fontSize:"11px",color:"#64748b",fontWeight:"600",paddingLeft:"12px"},children:W.role||W.agent}),i.jsxs("div",{style:{background:oe?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":ce.bg,color:oe?"white":"#1e293b",borderRadius:oe?"16px 16px 4px 16px":"16px 16px 16px 4px",padding:"12px 16px",fontSize:"14px",lineHeight:"1.6",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",border:oe?"none":`1px solid ${ce.border}`,wordBreak:"break-word"},children:[W.content.split(`
`).map((de,he)=>i.jsx("div",{style:{marginBottom:de?"4px":"0",whiteSpace:"pre-wrap"},children:de},he)),W.isQuestion&&W.questionData&&!W.answered&&i.jsx("div",{style:{marginTop:"12px",display:"flex",flexDirection:"column",gap:"6px"},children:W.questionData.options.map((de,he)=>i.jsx("button",{onClick:()=>{l(je=>{const ut=[...je],St=ut.findIndex(Et=>Et.timestamp===W.timestamp);return St!==-1&&(ut[St]={...ut[St],answered:!0}),ut}),l(je=>[...je,{agent:"",role:"",icon:"",type:"user",content:de,isUser:!0,timestamp:Date.now()}])},style:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #cbd5e1",background:"white",color:"#1e293b",fontSize:"13px",cursor:"pointer",transition:"all 0.2s",textAlign:"left"},onMouseEnter:je=>{je.target.style.background="#f1f5f9",je.target.style.borderColor="#94a3b8"},onMouseLeave:je=>{je.target.style.background="white",je.target.style.borderColor="#cbd5e1"},children:de},he))})]}),i.jsx("div",{style:{fontSize:"10px",color:"#94a3b8",paddingLeft:oe?"0":"12px",paddingRight:oe?"12px":"0",textAlign:oe?"right":"left"},children:new Date(W.timestamp||Date.now()).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})})]}),oe&&i.jsx("div",{style:{width:"36px",height:"36px",minWidth:"36px",borderRadius:"50%",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",boxShadow:"0 2px 6px rgba(0,0,0,0.1)"},children:""})]},ne)}),A&&a.length>0&&i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"flex-start",marginBottom:"8px"},children:[i.jsx("div",{style:{width:"36px",height:"36px",minWidth:"36px",borderRadius:"50%",background:"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",boxShadow:"0 2px 6px rgba(0,0,0,0.1)"},children:""}),i.jsx("div",{style:{background:"white",borderRadius:"16px 16px 16px 4px",padding:"16px 20px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:i.jsxs("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:[i.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#6366f1",animation:"pulse 1.4s infinite",animationDelay:"0s"}}),i.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#6366f1",animation:"pulse 1.4s infinite",animationDelay:"0.2s"}}),i.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#6366f1",animation:"pulse 1.4s infinite",animationDelay:"0.4s"}})]})})]}),Ae&&N.length>0&&i.jsxs("div",{style:{background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",borderRadius:"16px",padding:"20px",margin:"12px 0",border:"2px solid #0ea5e9",boxShadow:"0 4px 12px rgba(14, 165, 233, 0.15)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"16px"},children:[i.jsx("span",{style:{fontSize:"24px"},children:""}),i.jsxs("div",{children:[i.jsx("h3",{style:{margin:0,fontSize:"16px",fontWeight:"700",color:"#0369a1"},children:" "}),i.jsx("p",{style:{margin:"4px 0 0",fontSize:"13px",color:"#0284c7"},children:"      "})]})]}),N.map((W,ne)=>{const oe=W.type==="multiple",xe=M[W.id]||(oe?[]:"");return i.jsxs("div",{style:{marginBottom:"20px",padding:"16px",background:"white",borderRadius:"12px",boxShadow:"0 2px 6px rgba(0,0,0,0.06)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"12px"},children:[i.jsx("span",{style:{background:"#0ea5e9",color:"white",width:"24px",height:"24px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"700",flexShrink:0},children:ne+1}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:0,fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:W.question}),oe&&i.jsx("span",{style:{fontSize:"11px",color:"#64748b",marginTop:"4px",display:"block"},children:"  "})]})]}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:W.options.map((ce,de)=>{const he=oe?xe.includes(ce):xe===ce;return i.jsxs("button",{onClick:()=>B(W.id,ce,oe),style:{padding:"10px 16px",borderRadius:"20px",border:he?"2px solid #0ea5e9":"2px solid #e2e8f0",background:he?"linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%)":"white",color:he?"white":"#475569",fontSize:"13px",fontWeight:he?"600":"500",cursor:"pointer",transition:"all 0.2s ease",boxShadow:he?"0 2px 8px rgba(14, 165, 233, 0.3)":"none"},children:[he&&i.jsx("span",{style:{marginRight:"4px"},children:""}),ce]},de)})})]},W.id)}),i.jsxs("div",{style:{marginBottom:"16px",padding:"16px",background:"white",borderRadius:"12px",boxShadow:"0 2px 6px rgba(0,0,0,0.06)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"10px"},children:[i.jsx("span",{style:{fontSize:"16px"},children:""}),i.jsx("p",{style:{margin:0,fontSize:"14px",fontWeight:"600",color:"#1e293b"},children:"   ? ()"})]}),i.jsx("textarea",{value:V,onChange:W=>Y(W.target.value),placeholder:":       /    ",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #e2e8f0",fontSize:"14px",minHeight:"80px",resize:"vertical",fontFamily:"inherit",boxSizing:"border-box"}})]}),i.jsxs("button",{onClick:G,style:{width:"100%",padding:"14px",borderRadius:"12px",border:"none",background:"linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%)",color:"white",fontSize:"14px",fontWeight:"700",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",boxShadow:"0 4px 12px rgba(14, 165, 233, 0.3)",transition:"all 0.2s ease",whiteSpace:"nowrap"},children:[i.jsx("span",{children:"    "}),i.jsx("span",{style:{fontSize:"16px"},children:""})]})]}),i.jsx("div",{ref:P})]}),!h&&!Ae&&i.jsxs("div",{style:{padding:"16px",borderTop:"1px solid #e2e8f0",background:"white",position:"sticky",bottom:0,zIndex:10},children:[i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",maxWidth:"100%",margin:"0 auto"},children:[i.jsx("input",{type:"text",value:y,onChange:W=>E(W.target.value),onKeyPress:W=>{W.key==="Enter"&&!W.shiftKey&&y.trim()&&(W.preventDefault(),te())},placeholder:A?"AI  ...":"   ...",disabled:A,style:{flex:1,padding:"12px 16px",borderRadius:"24px",border:"2px solid #e2e8f0",fontSize:"14px",outline:"none",transition:"border-color 0.2s",background:A?"#f1f5f9":"white"},onFocus:W=>W.target.style.borderColor="#6366f1",onBlur:W=>W.target.style.borderColor="#e2e8f0"}),i.jsx("button",{onClick:te,disabled:A||!y.trim(),style:{width:"44px",height:"44px",borderRadius:"50%",border:"none",background:A||!y.trim()?"#cbd5e1":"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)",color:"white",fontSize:"18px",cursor:A||!y.trim()?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:A||!y.trim()?"none":"0 2px 8px rgba(99, 102, 241, 0.3)",transition:"all 0.2s"},children:""})]}),i.jsx("div",{style:{fontSize:"11px",color:"#94a3b8",marginTop:"8px",textAlign:"center"},children:"    "})]}),h&&v&&i.jsxs("div",{className:"diagnosis-result",children:[i.jsxs("div",{className:"result-header",children:[i.jsx("h2",{children:"  !"}),i.jsx("p",{className:"result-date",children:new Date().toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})})]}),i.jsxs("div",{className:"result-card",children:[i.jsxs("div",{className:"result-section",children:[i.jsx("h3",{children:"  "}),i.jsx("p",{className:"diagnosis-text",children:i.jsx("strong",{children:v.diagnosis})}),v.triage_score!==void 0&&i.jsxs("div",{className:"triage-display-inline",children:[i.jsx("div",{className:"triage-label",children:"   (Triage)"}),i.jsxs("div",{className:"triage-score-inline",children:[i.jsxs("span",{className:"triage-number",children:[v.triage_score,"/5"]}),i.jsx("div",{className:"triage-bar-inline",children:i.jsx("div",{className:"triage-fill-inline",style:{width:`${v.triage_score/5*100}%`,backgroundColor:v.triage_score>=4?"#f44336":v.triage_score>=3?"#ff9800":v.triage_score>=2?"#ffc107":"#4caf50"}})}),i.jsx("span",{className:"triage-level-text",children:v.triage_level||"Moderate"})]})]}),i.jsx("div",{className:"emergency-badge",style:{backgroundColor:F3(v.emergency),color:"white",padding:"10px 20px",borderRadius:"25px",display:"inline-block",marginTop:"15px",fontSize:"14px",fontWeight:"600"},children:v.emergency==="low"?"  -   ":v.emergency==="medium"?"  -   ":"  -    "})]}),v.description&&i.jsxs("div",{className:"result-section",children:[i.jsx("h3",{children:"  "}),i.jsx("p",{className:"description-text",children:v.description})]}),i.jsxs("div",{className:"result-section",children:[i.jsx("h3",{children:"   "}),i.jsx("ul",{className:"action-list",children:v.actions.map((W,ne)=>i.jsxs("li",{children:[i.jsx("span",{className:"action-icon",children:""}),i.jsx("span",{children:W})]},ne))})]}),v.hospitalVisit&&i.jsxs("div",{className:"result-section hospital-section",children:[i.jsx("h3",{children:"   "}),i.jsxs("div",{className:"hospital-alert",children:[i.jsxs("p",{className:"hospital-time",children:[i.jsx("strong",{children:v.hospitalVisitTime}),"    ."]}),v.emergency==="high"&&i.jsx("p",{className:"emergency-warning",children:"  .     ."})]})]}),i.jsxs("div",{className:"action-buttons",style:{display:"flex",flexWrap:"wrap",gap:"10px",justifyContent:"center",padding:"16px"},children:[i.jsx("button",{className:"action-btn primary",onClick:()=>n("treatment"),style:{flex:"1 1 45%",minWidth:"140px",padding:"14px 16px",borderRadius:"12px",fontWeight:"600"},children:"  "}),i.jsx("button",{className:"action-btn secondary",onClick:()=>n("hospital"),style:{flex:"1 1 45%",minWidth:"140px",padding:"14px 16px",borderRadius:"12px",fontWeight:"600"},children:"  "}),i.jsx("button",{className:"action-btn highlight",onClick:()=>C(!0),style:{flex:"1 1 100%",minWidth:"140px",padding:"14px 16px",borderRadius:"12px",fontWeight:"600"},children:"  "}),i.jsx("button",{className:"action-btn outline",onClick:()=>n("home"),style:{flex:"1 1 100%",padding:"12px 16px",borderRadius:"12px",fontWeight:"500",background:"#f1f5f9",color:"#475569"},children:" "})]})]})]}),I&&v&&i.jsx(ej,{petData:t,diagnosisResult:v,symptomData:e,onClose:()=>C(!1),onGoToHospital:()=>{C(!1),n("hospital")},onGoToTreatment:()=>{C(!1),n("treatment")}})]})}function V3({petData:t,diagnosisResult:e,symptomData:n,onGoToTreatment:s,onGoToHospital:r,onBack:o}){var h;const[a,l]=L.useState(!1),d=(m=>{switch(m){case"high":return{text:"",color:"#ef4444",icon:"",desc:"   "};case"medium":return{text:"",color:"#f59e0b",icon:"",desc:"  "};default:return{text:"",color:"#22c55e",icon:"",desc:"   "}}})(e==null?void 0:e.emergency);return i.jsxs("div",{className:"diagnosis-result-view",style:{minHeight:"100vh",background:"#f8fafc"},children:[i.jsx("div",{style:{background:"linear-gradient(135deg, #0ea5e9, #3b82f6)",padding:"16px 20px",color:"white"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("button",{onClick:o,style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",padding:"8px 12px",color:"white",cursor:"pointer"},children:" "}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("p",{style:{fontSize:"10px",opacity:.9,margin:0},children:" PetMedical.AI"}),i.jsx("h1",{style:{fontSize:"18px",fontWeight:"bold",margin:"4px 0 0"},children:"AI  "})]}),i.jsx("div",{style:{width:"60px"}})]})}),i.jsxs("div",{className:"result-view-content",style:{padding:"16px"},children:[i.jsxs("div",{className:"result-card-summary",style:{background:"white",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[i.jsxs("div",{className:"pet-info-mini",style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[i.jsx("span",{className:"pet-avatar",style:{fontSize:"32px"},children:(t==null?void 0:t.species)==="cat"?"":""}),i.jsx("span",{className:"pet-name",style:{fontWeight:"bold",fontSize:"18px"},children:(t==null?void 0:t.name)||(t==null?void 0:t.petName)||""})]}),i.jsxs("div",{className:"diagnosis-main-box",children:[i.jsxs("h2",{children:[" ",(e==null?void 0:e.diagnosis)||"  "]}),i.jsxs("div",{className:"emergency-badge-inline",style:{backgroundColor:d.color},children:[d.icon," ",d.text," - ",d.desc]})]}),(e==null?void 0:e.triage_score)!==void 0&&i.jsxs("div",{className:"triage-summary",children:[i.jsx("span",{children:" : "}),i.jsxs("strong",{children:[e.triage_score,"/5"]})]}),(e==null?void 0:e.description)&&i.jsxs("div",{className:"description-summary",children:[i.jsx("h3",{children:" "}),i.jsx("p",{children:e.description})]}),i.jsxs("div",{className:"actions-summary",children:[i.jsx("h3",{children:"  "}),i.jsx("ul",{children:(h=e==null?void 0:e.actions)==null?void 0:h.map((m,p)=>i.jsx("li",{children:m},p))})]})]}),i.jsxs("div",{className:"result-view-actions",style:{display:"flex",flexWrap:"wrap",gap:"10px",justifyContent:"center",padding:"16px"},children:[i.jsx("button",{className:"action-btn primary",onClick:s,style:{flex:"1 1 45%",minWidth:"140px",padding:"14px 16px",borderRadius:"12px",fontWeight:"600",background:"linear-gradient(135deg, #f59e0b, #d97706)",color:"white",border:"none"},children:"  "}),i.jsx("button",{className:"action-btn secondary",onClick:r,style:{flex:"1 1 45%",minWidth:"140px",padding:"14px 16px",borderRadius:"12px",fontWeight:"600",background:"linear-gradient(135deg, #8b5cf6, #7c3aed)",color:"white",border:"none"},children:"  "}),i.jsx("button",{className:"action-btn highlight",onClick:()=>l(!0),style:{flex:"1 1 45%",minWidth:"140px",padding:"14px 16px",borderRadius:"12px",fontWeight:"600",background:"linear-gradient(135deg, #ef4444, #dc2626)",color:"white",border:"none"},children:"  "}),i.jsx("button",{className:"action-btn outline",onClick:o,style:{flex:"1 1 45%",minWidth:"140px",padding:"14px 16px",borderRadius:"12px",fontWeight:"600",background:"#f1f5f9",color:"#475569",border:"1px solid #e2e8f0"},children:" "})]})]}),a&&i.jsx(ej,{petData:t,diagnosisResult:e,symptomData:n,onClose:()=>l(!1),onGoToHospital:()=>{l(!1),r()},onGoToTreatment:()=>{l(!1),s()}})]})}function $3({petData:t,diagnosisResult:e,onBack:n}){const s=`petMedical_checklist_${(t==null?void 0:t.id)||"default"}_${new Date().toISOString().split("T")[0]}`,r=[{id:"observe",label:"   ",checked:!1},{id:"water",label:"  ",checked:!1},{id:"appetite",label:"  ",checked:!1},{id:"stool",label:"  ",checked:!1},{id:"activity",label:" ",checked:!1}],[o,a]=L.useState(()=>{try{const A=localStorage.getItem(s);return A?JSON.parse(A):r}catch{return r}}),[l,u]=L.useState(""),d=A=>{a(w=>{const y=w.map(E=>E.id===A?{...E,checked:!E.checked}:E);try{localStorage.setItem(s,JSON.stringify(y))}catch(E){console.error("  :",E)}return y})},h=()=>{try{localStorage.setItem(s,JSON.stringify(o)),u("  !"),setTimeout(()=>u(""),2e3)}catch{u("  ."),setTimeout(()=>u(""),2e3)}},m=o.filter(A=>A.checked).length,p=o.length,v=(()=>{if(!e)return[{step:1,title:" ",description:"   ."},{step:2,title:" ",description:"   ."},{step:3,title:" ",description:"   ."}];const A=e.emergency,w=[{step:1,title:" ",description:e.actions[0]||" "},{step:2,title:" ",description:"   ."},{step:3,title:"  ",description:"    ."}];return A==="low"?[...w,{step:4,title:" ",description:"24-48   ."},{step:5,title:" ",description:"     ."}]:[...w,{step:4,title:"",description:"    ."},{step:5,title:" ",description:" ,  ,  /    ."}]})(),j=(e==null?void 0:e.emergency)==="low"?"3-5":(e==null?void 0:e.emergency)==="medium"?"5-7":"   ";return i.jsxs("div",{className:"treatment-container",children:[i.jsxs("div",{className:"treatment-header",children:[i.jsx("button",{className:"back-btn",onClick:n,children:" "}),i.jsx("h1",{children:"   "})]}),i.jsxs("div",{className:"treatment-content",children:[i.jsx("div",{className:"treatment-intro",children:i.jsxs("div",{className:"pet-info-card",children:[i.jsx("span",{className:"pet-icon-large",children:t.species==="dog"?"":""}),i.jsxs("div",{children:[i.jsxs("h2",{children:[(t==null?void 0:t.petName)||(t==null?void 0:t.name)||"","  "]}),e&&i.jsx("p",{className:"diagnosis-summary",children:e.diagnosis})]})]})}),i.jsxs("div",{className:"treatment-steps",children:[i.jsx("h3",{children:"   "}),v.map((A,w)=>i.jsxs("div",{className:"treatment-step-card",children:[i.jsx("div",{className:"step-number",children:A.step}),i.jsxs("div",{className:"step-content",children:[i.jsx("h4",{children:A.title}),i.jsx("p",{children:A.description})]})]},w))]}),e&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"treatment-info",children:[i.jsx("h3",{children:"   "}),i.jsx("p",{className:"recovery-time",children:j})]}),i.jsxs("div",{className:"treatment-warnings",children:[i.jsx("h3",{children:" "}),i.jsxs("ul",{children:[i.jsx("li",{children:"       ."}),i.jsx("li",{children:"     ."}),i.jsx("li",{children:" ( ,  ,   )   ."}),i.jsx("li",{children:"  ,      ."})]})]}),i.jsxs("div",{className:"treatment-checklist",children:[i.jsxs("div",{className:"checklist-header",children:[i.jsx("h3",{children:"  "}),i.jsxs("span",{className:"checklist-progress",children:[m,"/",p," "]})]}),i.jsx("div",{className:"checklist-progress-bar",children:i.jsx("div",{className:"checklist-progress-fill",style:{width:`${m/p*100}%`}})}),i.jsx("div",{className:"checklist-items",children:o.map(A=>i.jsxs("label",{className:A.checked?"checked":"",children:[i.jsx("input",{type:"checkbox",checked:A.checked,onChange:()=>d(A.id)}),i.jsx("span",{className:"checkmark",children:A.checked?"":""}),i.jsx("span",{className:"label-text",children:A.label})]},A.id))}),i.jsxs("div",{className:"checklist-actions",children:[i.jsx("button",{className:"save-checklist-btn",onClick:h,children:"  "}),l&&i.jsx("span",{className:"save-message",children:l})]}),i.jsx("p",{className:"checklist-note",children:"    "})]})]}),i.jsxs("div",{className:"treatment-actions",children:[i.jsx("button",{className:"action-btn secondary",onClick:n,children:" "}),(e==null?void 0:e.hospitalVisit)&&i.jsx("button",{className:"action-btn primary",onClick:()=>window.location.reload(),children:" "})]})]})]})}const F3=t=>{switch(t){case"low":case"Low":return"#4caf50";case"medium":case"Moderate":return"#ff9800";case"high":case"High":case"Emergency":return"#f44336";default:return"#666"}};function D3(){var V,Y;const[t,e]=L.useState("login"),[n,s]=L.useState(null),[r,o]=L.useState("guardian"),[a,l]=L.useState(!1),[u,d]=L.useState("care"),[h,m]=L.useState(null),[p,x]=L.useState(null),[v,j]=L.useState([]),[A,w]=L.useState(null),[y,E]=L.useState(null),[R,$]=L.useState(null),[D,_]=L.useState(null),b=T=>{if(o(T),m(null),d("care"),localStorage.setItem("petMedical_userMode",T),n){const B={...n,userMode:T};s(B)}},S=()=>{m(null),d("care")};L.useEffect(()=>{d("care"),window.auth=Zn,window.seedGuardianData=async(T,B)=>{try{const G=await d3(T,B);return console.log("  :",G),G}catch(G){throw console.error("  :",G),G}},window.seedClinicData=async(T,B)=>{try{const G=await h3(T,B);return console.log("  :",G),G}catch(G){throw console.error("  :",G),G}},console.log("     ."),console.log("   : const user = window.auth.currentUser; await window.seedGuardianData(user.uid, user.email);")},[]);const I=async T=>{let B=T.userMode||"guardian",G=!1;if(T.roles&&T.roles.length>0||T.defaultClinicId)try{const te=await Ba(T.uid);G=te&&te.length>0,G?B="clinic":console.warn(":  roles     . guardian  .")}catch(te){console.error("   :",te),G=!1}l(G),s(T),o(B),e(null),localStorage.setItem("petMedical_userMode",B);const K=dc(T.uid);j(K),K.length>0?x(K[0]):x(null);try{await m5(T.uid),console.log("    ")}catch(te){console.warn("   :",te)}p5(te=>{var le,W,ne,oe,xe;console.log("   :",te),"Notification"in window&&Notification.permission==="granted"&&new Notification(((le=te.notification)==null?void 0:le.title)||((W=te.data)==null?void 0:W.title)||"",{body:((ne=te.notification)==null?void 0:ne.body)||((oe=te.data)==null?void 0:oe.body)||"",icon:"/icon/dog.png",tag:((xe=te.data)==null?void 0:xe.type)||"notification",data:te.data||{}})})},C=async T=>{let B=T.userMode||"guardian",G=!1;if(T.roles&&T.roles.length>0||T.defaultClinicId)try{const K=await Ba(T.uid);G=K&&K.length>0,G?B="clinic":console.warn(":  roles     . guardian  .")}catch(K){console.error("   :",K),G=!1}l(G),s(T),o(B),e(null),j([]),x(null)},P=()=>{U5(),localStorage.removeItem("petMedical_userMode"),s(null),o("guardian"),l(!1),j([]),x(null),e("login")},N=()=>{const T={uid:"guest_test_user",email:"guest@test.com",displayName:" ",userMode:"guardian"},B=dc(T.uid);if(B.length>0){j(B),x(B[0]);try{const G=localStorage.getItem(za);if(G){const te=JSON.parse(G).filter(le=>le.petId===B[0].id).sort((le,W)=>new Date(W.created_at||W.createdAt)-new Date(le.created_at||le.createdAt));te.length>0&&E(te[0])}}catch(G){console.error("   :",G)}}else{const G={id:Date.now(),userId:T.uid,name:"",species:"dog",breed:"",birthDate:"2022-01-01",sex:"M",neutered:!0,weight:8.5,sido:"",sigungu:"",profileImage:null,character:"dog_white",createdAt:new Date().toISOString()};lj(T.uid,[G],G),j([G]),x(G)}s(T),o("guardian"),e(null)};if(t==="login")return i.jsx(B5,{onLogin:I,onGoToRegister:()=>e("register"),onSkipLogin:N});if(t==="register")return i.jsx(z5,{onRegister:C,onGoToLogin:()=>e("login")});const O=T=>{if(n!=null&&n.uid){const B=dc(n.uid);j(B)}x(T),m(null),d("care")},M=T=>{if(x(T),m(null),d("care"),T!=null&&T.id)try{const B=localStorage.getItem(za);if(B){const K=JSON.parse(B).filter(te=>te.petId===T.id).sort((te,le)=>new Date(le.created_at||le.createdAt)-new Date(te.created_at||te.createdAt));K.length>0&&E(K[0])}}catch(B){console.error("   :",B)}},ie=T=>{w(T),m("diagnosis"),d(null)},Ae=(T,B)=>{B&&E(B),T==="treatment"?m("treatment"):T==="hospital"?(d("hospital"),m(null)):(m(null),d("care"))},Q=T=>{m(null),T==="diagnosis"?(m("symptom-input"),d(null)):d(T)};return i.jsxs("div",{className:"App app-root",children:[i.jsx(X4,{variant:"default"}),r==="clinic"&&!h&&n&&i.jsx(f3,{currentUser:n,onBack:()=>{b("guardian")},onLogout:()=>{P()},onModeSwitch:()=>b("guardian"),onHome:S}),(r==="guardian"||h)&&i.jsxs(i.Fragment,{children:[h==="registration"&&i.jsx(C3,{onComplete:O,userId:n==null?void 0:n.uid}),h==="profile-list"&&i.jsx(P3,{pets:v,onSelectPet:M,onAddNew:()=>m("registration"),onNavigate:T=>m(T)}),h==="symptom-input"&&i.jsx(O3,{petData:p,onComplete:ie,onBack:()=>{m(null),d("care")},onRegister:()=>m("registration")}),h==="diagnosis"&&p&&A&&i.jsx(L3,{petData:p,symptomData:A,currentUser:n,onComplete:T=>Ae(T,y),onBack:()=>m("symptom-input"),onDiagnosisResult:T=>E(T)}),h==="treatment"&&p&&i.jsx($3,{petData:p,diagnosisResult:y,onBack:()=>m("diagnosis-result")}),h==="diagnosis-result"&&p&&y&&i.jsx(V3,{petData:p,diagnosisResult:y,symptomData:A,onGoToTreatment:()=>m("treatment"),onGoToHospital:()=>{d("hospital"),m(null)},onBack:()=>{m(null),d("care")}}),h==="hospital"&&p&&i.jsx(Ay,{petData:p,diagnosis:y||null,symptomData:A||null,currentUser:n,onBack:()=>{m(null),d("care")},onHome:S,onSelectHospital:async T=>{if($(T),y)try{const B=await Cm(p,y,A);_(B),m("hospital-review")}catch(B){console.error("  :",B)}}}),h==="hospital-review"&&p&&y&&R&&D&&i.jsx(y5,{petData:p,diagnosis:y,hospital:R,hospitalPacket:D,onBack:()=>m("hospital"),onEdit:()=>m("hospital"),onSend:T=>{console.log(" :",T),m("hospital-sent")},onSave:T=>{console.log(" :",T),m(null),d("care")}}),h==="hospital-sent"&&p&&R&&i.jsx(v5,{petData:p,hospital:R,onBack:()=>{m(null),d("care"),$(null),_(null)},onHome:()=>{m(null),d("care"),$(null),_(null)},onGetDirections:()=>{const T=`https://map.kakao.com/link/to/${R.name},${R.lat},${R.lng}`;window.open(T,"_blank")}}),h==="mypage"&&i.jsx(Sy,{onBack:()=>{m(null),d("care")},onHome:S,onSelectPet:T=>{x(T),m(null),d("care")},onViewDiagnosis:T=>{E(T);const B=v.find(G=>G.id===T.petId);B&&x(B),m("diagnosis-view")},onClinicMode:()=>m("clinic-admin"),userId:n==null?void 0:n.uid}),h==="diagnosis-view"&&p&&y&&i.jsxs("div",{className:"page-container",children:[i.jsxs("div",{className:"page-header",children:[i.jsx("div",{className:"flex size-12 shrink-0 items-center",children:i.jsx("button",{onClick:()=>m("mypage"),className:"p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-full",children:i.jsx("span",{className:"material-symbols-outlined text-3xl",children:"arrow_back_ios_new"})})}),i.jsx("h2",{className:"text-slate-800 text-lg font-bold flex-1 text-center",children:" "}),i.jsx("div",{className:"flex size-12 shrink-0 items-center justify-end"})]}),i.jsxs("div",{className:"px-4 pt-4 pb-24 space-y-4",children:[i.jsx("div",{className:"text-center text-sm text-slate-500",children:new Date(y.created_at||y.date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}),i.jsxs("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft border border-slate-200",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-slate-900 font-bold mb-3",children:[i.jsx("span",{className:"material-symbols-outlined text-primary",children:"pets"})," "]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center text-3xl",children:p.species==="dog"?"":""}),i.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-slate-500",children:""}),i.jsx("p",{className:"font-medium text-slate-900",children:p.petName||""})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-slate-500",children:""}),i.jsx("p",{className:"font-medium text-slate-900",children:p.breed||""})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-slate-500",children:""}),i.jsx("p",{className:"font-medium text-slate-900",children:p.birthDate?(()=>{const T=new Date(p.birthDate);return`${new Date().getFullYear()-T.getFullYear()}`})():""})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-slate-500",children:""}),i.jsx("p",{className:"font-medium text-slate-900",children:p.weight?`${p.weight}kg`:""})]})]})]})]}),i.jsxs("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft border border-slate-200",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-slate-900 font-bold mb-3",children:[i.jsx("span",{className:"material-symbols-outlined text-primary",children:"diagnosis"})," "]}),i.jsx("p",{className:"text-lg font-semibold text-slate-900 mb-2",children:y.diagnosis||((Y=(V=y.suspectedConditions)==null?void 0:V[0])==null?void 0:Y.name)||"  "}),i.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-bold ${y.riskLevel==="High"||y.emergency==="high"?"bg-red-100 text-red-600":y.riskLevel==="Moderate"||y.emergency==="medium"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-600"}`,children:y.riskLevel==="Low"||y.emergency==="low"?"":y.riskLevel==="Moderate"||y.emergency==="medium"?"":y.riskLevel==="High"||y.emergency==="high"?"":""})]}),y.description&&i.jsxs("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft border border-slate-200",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-slate-900 font-bold mb-3",children:[i.jsx("span",{className:"material-symbols-outlined text-primary",children:"description"})," "]}),i.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",children:y.description})]}),y.actions&&y.actions.length>0&&i.jsxs("div",{className:"bg-surface-light rounded-lg p-4 shadow-soft border border-slate-200",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-slate-900 font-bold mb-3",children:[i.jsx("span",{className:"material-symbols-outlined text-primary",children:"medication"}),"  "]}),i.jsx("ul",{className:"space-y-2",children:y.actions.map((T,B)=>i.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-700",children:[i.jsx("span",{className:"material-symbols-outlined text-green-500 text-base mt-0.5",children:"check_circle"}),i.jsx("span",{children:T})]},B))})]}),y.hospitalVisit&&i.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-orange-800 font-bold mb-2",children:[i.jsx("span",{className:"material-symbols-outlined",children:"local_hospital"}),"  "]}),i.jsxs("p",{className:"text-orange-700 text-sm",children:[i.jsx("strong",{children:y.hospitalVisitTime||"24 "}),"   ."]})]}),!y.visitedHospital&&i.jsxs("div",{className:"bg-primary/5 rounded-lg p-4 border border-primary/20",children:[i.jsxs("h3",{className:"flex items-center gap-2 text-slate-900 font-bold mb-3",children:[i.jsx("span",{className:"material-symbols-outlined text-primary",children:"event_available"})," "]}),i.jsx("p",{className:"text-slate-600 text-sm mb-4",children:"AI      .   ."}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:()=>{w({symptomText:y.symptom||y.description}),d("hospital"),m(null)},className:"flex-1 py-3 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors flex items-center justify-center gap-2 shadow-lg shadow-primary/30",children:[i.jsx("span",{className:"material-symbols-outlined",children:"local_hospital"})," "]}),i.jsxs("a",{href:"https://service.kakaomobility.com/launch/kakaot",target:"_blank",rel:"noopener noreferrer",className:"flex-1 py-3 bg-[#1E1B4B] text-white font-bold rounded-lg hover:bg-[#2d2a5a] transition-colors flex items-center justify-center gap-2",children:[i.jsx("span",{className:"text-[#FACC15] font-black text-lg",children:"T"}),""]})]})]})]})]}),h==="history"&&i.jsxs("div",{className:"history-container",children:[i.jsx("button",{className:"back-btn",onClick:()=>{m(null),d("care")},children:" "}),i.jsx("h1",{children:"  "}),i.jsx("div",{className:"history-content",children:i.jsx("p",{children:"   ."})})]}),h==="ocr"&&i.jsx(J5,{petData:p,onBack:()=>m(null),onSaveRecord:T=>{console.log("  :",T)}}),h==="ai-consultation"&&p&&i.jsx(g3,{petData:p,onBack:()=>{m(null),d("care")},onHome:S}),h==="clinic-admin"&&i.jsx(e3,{onBack:()=>{m(null),d("care")},onLogout:()=>{m(null),d("care")},onModeSwitch:()=>b("guardian"),onHome:S}),r==="guardian"&&!h&&u&&i.jsxs("div",{className:"main-content",style:{paddingBottom:"80px"},children:[u==="care"&&p&&i.jsx(R3,{petData:p,pets:v,onNavigate:T=>{T==="hospital"||T==="records"?d(T):m(T)},onSelectPet:M}),u==="hospital"&&(p?i.jsx(Ay,{petData:p,diagnosis:y||null,symptomData:A||null,currentUser:n,onBack:()=>d("care"),onHome:S,onSelectHospital:async T=>{if($(T),y)try{const B=await Cm(p,y,A);_(B),m("hospital-review")}catch(B){console.error("  :",B)}}}):i.jsx("div",{className:"min-h-screen bg-background-light flex items-center justify-center p-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:" "}),i.jsx("button",{onClick:()=>m("registration"),className:"mt-4 bg-primary text-white px-6 py-3 rounded-lg font-bold hover:bg-primary/90 transition-colors",children:" "})]})})),u==="records"&&p&&i.jsx(S5,{petData:p,onBack:()=>d("care"),onHome:S,onViewDiagnosis:T=>{E(T),m("diagnosis-view")},onOCR:()=>m("ocr"),onHospitalBooking:()=>d("hospital")}),u==="mypage"&&i.jsx(Sy,{onBack:()=>d("care"),onHome:S,onAddPet:()=>m("registration"),onSelectPet:T=>{x(T),d("care")},onViewDiagnosis:T=>{E(T);const B=v.find(G=>G.id===T.petId);B&&x(B),m("diagnosis-view")},onClinicMode:()=>m("clinic-admin"),userId:n==null?void 0:n.uid}),!p&&u==="care"&&i.jsx("div",{className:"page-container",children:i.jsxs("div",{className:"px-4 pt-8 pb-24",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"!"}),i.jsx("p",{className:"text-slate-600",children:"  AI   "})]}),i.jsxs("div",{className:"space-y-4 mb-8",children:[i.jsx("div",{className:"bg-surface-light p-4 rounded-lg shadow-soft border border-slate-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 bg-primary/20 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"material-symbols-outlined text-primary",children:"smart_toy"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-slate-900",children:"AI  "}),i.jsx("p",{className:"text-sm text-slate-600",children:"  AI "})]})]})}),i.jsx("div",{className:"bg-surface-light p-4 rounded-lg shadow-soft border border-slate-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 bg-accent/20 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"material-symbols-outlined text-accent",children:"local_hospital"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-slate-900",children:" "}),i.jsx("p",{className:"text-sm text-slate-600",children:"    "})]})]})}),i.jsx("div",{className:"bg-surface-light p-4 rounded-lg shadow-soft border border-slate-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 bg-secondary/20 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"material-symbols-outlined text-secondary",children:"monitor_heart"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-slate-900",children:" "}),i.jsx("p",{className:"text-sm text-slate-600",children:"     "})]})]})})]}),i.jsx("button",{onClick:()=>m("registration"),className:"w-full bg-primary text-white px-6 py-4 rounded-xl font-bold hover:bg-primary/90 transition-colors shadow-lg shadow-primary/30",children:" "})]})}),!p&&u&&u!=="care"&&i.jsx("div",{className:"page-container flex items-center justify-center",children:i.jsxs("div",{className:"text-center p-4",children:[i.jsx("div",{className:"text-5xl mb-4",children:""}),i.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-2",children:"  "}),i.jsx("button",{onClick:()=>m("registration"),className:"mt-4 bg-primary text-white px-6 py-3 rounded-xl font-bold hover:bg-primary/90 transition-colors",children:" "})]})})]}),r==="guardian"&&u&&i.jsx(T5,{currentTab:u,onTabChange:Q,onModeSwitch:()=>b("clinic"),showModeSwitch:!!n,hideInDiagnosis:h==="symptom-input"})]})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/firebase-messaging-sw.js").then(t=>{console.log(" Service Worker  :",t.scope)}).catch(t=>{var e,n;(e=t.message)!=null&&e.includes("404")||(n=t.message)!=null&&n.includes("bad HTTP response code")?console.warn(" Service Worker  .    ."):console.error(" Service Worker  :",t)})});uh.createRoot(document.getElementById("root")).render(i.jsx(Gj.StrictMode,{children:i.jsx(D3,{})}));
